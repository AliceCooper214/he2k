import{d as J,cm as W,J as Z,bj as x,r as d,N as z,v as N,a as S,b as s,g as o,o as p,l as K,c as n,cp as c,c1 as Q,c$ as k,bM as ee,H as ae,bY as te,U as I,x as M,cr as re,e as oe,f as le,bZ as ne,b_ as se,ct as ue,d4 as ie,F as de,aR as ce,bN as pe,_ as fe}from"./index.954a2cbc.js";import{i as me}from"./regs.08fe82e6.js";import{u as ve}from"./index.56c1474b.js";const Se={class:"dns-lookup-wrapper"},ye=J({__name:"index",props:{clipboardValue:null,searchValue:null,renderOnSearch:{type:Boolean}},emits:["acceptClipboardCb"],setup(_,{emit:P}){const f=_,{t:y}=W();Z(()=>{var e,a,t;(((e=f.clipboardValue)==null?void 0:e.isDomain())||((a=f.clipboardValue)==null?void 0:a.isUrl()))&&(l.value.domain=m((t=f.clipboardValue)==null?void 0:t.getOriginData()),P("acceptClipboardCb"),R())});function m(e){return e=e.trim(),x(e)&&(e=ve(e).hostname),e}const C={google:["8.8.8.8","8.8.4.4","2001:4860:4860::8888","2001:4860:4860::8844"],cloudflare:["1.1.1.1"],opendns:["208.67.222.222","208.67.220.220"]},A=d(),l=d({domain:"",dnsServer:"google",recordType:"ANY",customServers:[]}),V=d([{required:!0,whitespace:!0,transform:m,validator:(e,a)=>a===""||!x(a)&&!me(a)?Promise.reject():Promise.resolve(),message:y("dnsLookup.validDomainInputError"),trigger:"blur"}]),X=d([{required:!0,message:y("dnsLookup.validDNSServerInputError"),trigger:"blur"}]),D=d([{label:"Google DNS",value:"google"},{label:"Cloudflare DNS",value:"cloudflare"},{label:"OpenDNS",value:"opendns"},{label:"Custom",value:"custom"}]),b=d([{label:"All",value:"ANY"},{label:"A",value:"A"},{label:"AAAA",value:"AAAA"},{label:"CNAME",value:"CNAME"},{label:"MX",value:"MX"},{label:"NS",value:"NS"},{label:"PTR",value:"PTR"},{label:"SOA",value:"SOA"},{label:"SRV",value:"SRV"},{label:"TXT",value:"TXT"}]);function E(){const e=l.value.dnsServer;return e==="custom"?l.value.customServers.slice(0):N.exports.get(C,e,[])}const v=d(!1);async function R(){var g;try{await((g=A.value)==null?void 0:g.validateFields())}catch{return}const{domain:e,recordType:a}=l.value,t=m(e),u=E();v.value=!0,O(),b.value.filter(i=>i.value!=="ANY"&&(i.value===a||a==="ANY")).map(i=>i.value).forEach(i=>{z.domainResolve(t,i,u).then(h=>{L(i,h)}).catch(h=>{}).finally(()=>{})}),v.value=!1}const r=d({A:{title:"A Record",enabled:!1,dataSource:[],columns:[{title:"IP",dataIndex:"ip",key:"ip"},{title:"TTL",dataIndex:"ttl",key:"ttl"}]},AAAA:{title:"AAAA Record",enabled:!1,dataSource:[],columns:[{title:"IP",dataIndex:"ip",key:"ip"},{title:"TTL",dataIndex:"ttl",key:"ttl"}]},CNAME:{title:"CNAME Record",enabled:!1,dataSource:[],columns:[{title:"CNAME",dataIndex:"cname",key:"cname"}]},MX:{title:"MX Record",enabled:!1,dataSource:[],columns:[{title:"Exchange",dataIndex:"exchange",key:"exchange"},{title:"Priority",dataIndex:"priority",key:"priority"}]},NS:{title:"NS Record",enabled:!1,dataSource:[],columns:[{title:"Name Server",dataIndex:"ns",key:"ns"}]},PTR:{title:"PTR Record",enabled:!1,dataSource:[],columns:[{title:"PTR",dataIndex:"ptr",key:"ptr"}]},SOA:{title:"SOA Record",enabled:!1,dataSource:[],columns:[{title:"Primary Name Server",dataIndex:"ns",key:"ns"},{title:"Responsible Person",dataIndex:"hostmaster",key:"hostmaster"},{title:"Serial",dataIndex:"serial",key:"serial"},{title:"Refresh",dataIndex:"refresh",key:"refresh"},{title:"Retry",dataIndex:"retry",key:"retry"},{title:"Expire",dataIndex:"expire",key:"expire"},{title:"Minimum TTL",dataIndex:"minttl",key:"minttl"}]},SRV:{title:"SRV Record",enabled:!1,dataSource:[],columns:[{title:"Priority",dataIndex:"priority",key:"priority"},{title:"Weight",dataIndex:"weight",key:"weight"},{title:"Port",dataIndex:"port",key:"port"},{title:"Target",dataIndex:"target",key:"target"}]},TXT:{title:"TXT Record",enabled:!1,dataSource:[],columns:[{title:"Record",dataIndex:"txt",key:"txt"}]}});function O(){Object.keys(r.value).forEach(e=>{r.value[e].dataSource=[],r.value[e].enabled=!1})}const w={A:j,AAAA:F,CNAME:U,MX:B,NS:$,PTR:q,SOA:Y,SRV:G,TXT:H};function L(e,a){const t=N.exports.get(w,e);t&&t(a)}function j(e){const a=r.value.A.dataSource;if(Array.isArray(e))for(const t of e)typeof t=="string"?a.push({ip:t,ttl:0}):a.push({ip:t.address,ttl:t.ttl});r.value.A.dataSource=a,r.value.A.enabled=!0}function F(e){const a=r.value.AAAA.dataSource;if(Array.isArray(e))for(const t of e)typeof t=="string"?a.push({ip:t,ttl:0}):a.push({ip:t.address,ttl:t.ttl});else typeof e=="object"&&a.push({ip:e.address,ttl:e.ttl});r.value.AAAA.dataSource=a,r.value.AAAA.enabled=!0}function U(e){const a=r.value.CNAME.dataSource;for(const t of e)typeof t=="string"?a.push({cname:t}):a.push({cname:t.value});r.value.CNAME.dataSource=a,r.value.CNAME.enabled=!0}function B(e){const a=r.value.MX.dataSource;for(const t of e)a.push({exchange:t.exchange,priority:t.priority});a.sort((t,u)=>t.priority-u.priority),r.value.MX.dataSource=a,r.value.MX.enabled=!0}function $(e){const a=r.value.NS.dataSource;for(const t of e)a.push({ns:t});r.value.NS.dataSource=a,r.value.NS.enabled=!0}function q(e){const a=r.value.PTR.dataSource;for(const t of e)a.push({ptr:t});r.value.PTR.dataSource=a,r.value.PTR.enabled=!0}function Y(e){const a=r.value.SOA.dataSource;typeof e=="object"&&a.push({ns:e.nsname,hostmaster:e.hostmaster,serial:e.serial,refresh:e.refresh,retry:e.retry,expire:e.expire,minttl:e.minttl}),r.value.SOA.dataSource=a,r.value.SOA.enabled=!0}function G(e){const a=r.value.SRV.dataSource;for(const t of e)a.push({priority:t.priority,weight:t.weight,port:t.port,target:t.name});a.sort((t,u)=>t.priority-u.priority),r.value.SRV.dataSource=a,r.value.SRV.enabled=!0}function H(e){const a=r.value.TXT.dataSource;if(Array.isArray(e)){for(const t of e)if(Array.isArray(t))for(const u of t)a.push({txt:u});else if(typeof t=="object")for(const u of t.entries)a.push({txt:u})}r.value.TXT.dataSource=a,r.value.TXT.enabled=!0}return(e,a)=>(p(),S(o(pe),{"max-width":1280},{one:s(()=>[K("div",Se,[n(o(re),{ref_key:"formRef",ref:A,"label-col":{span:4},"wrapper-col":{span:20},model:l.value,"hide-required-mark":"",onFinish:R},{default:s(()=>[n(o(c),{rules:V.value,name:"domain",label:e.$t("dnsLookup.domain")},{default:s(()=>[n(o(Q),{value:l.value.domain,"onUpdate:value":a[0]||(a[0]=t=>l.value.domain=t),autofocus:""},null,8,["value"])]),_:1},8,["rules","label"]),n(o(c),{label:e.$t("dnsLookup.dnsServer")},{default:s(()=>[n(o(k),{value:l.value.dnsServer,"onUpdate:value":a[1]||(a[1]=t=>l.value.dnsServer=t),"option-type":"button","button-style":"solid",options:D.value},null,8,["value","options"])]),_:1},8,["label"]),l.value.dnsServer==="custom"?(p(),S(o(c),{key:0,rules:X.value,name:"customServers",label:e.$t("dnsLookup.customDNSServer")},{default:s(()=>[n(o(ee),{value:l.value.customServers,"onUpdate:value":a[2]||(a[2]=t=>l.value.customServers=t),mode:"tags"},null,8,["value"])]),_:1},8,["rules","label"])):ae("",!0),n(o(c),{label:e.$t("dnsLookup.recordType")},{default:s(()=>[n(o(k),{value:l.value.recordType,"onUpdate:value":a[3]||(a[3]=t=>l.value.recordType=t),options:b.value,"option-type":"button","button-style":"solid"},null,8,["value","options"])]),_:1},8,["label"]),n(o(c),{"wrapper-col":{offset:4,span:12}},{default:s(()=>[n(o(te),{type:"primary","html-type":"submit"},{default:s(()=>[I(M(e.$t("common.query")),1)]),_:1})]),_:1})]),_:1},8,["model"]),n(o(ce),{spinning:v.value},{default:s(()=>[(p(!0),oe(de,null,le(r.value,(t,u,T)=>ne((p(),S(o(ue),{key:T,class:"dns-lookup-wrapper-table","data-source":t.dataSource,columns:t.columns,pagination:!1},{title:s(()=>[n(o(ie),{level:2},{default:s(()=>[I(M(t.title),1)]),_:2},1024)]),_:2},1032,["data-source","columns"])),[[se,t.enabled]])),128))]),_:1},8,["spinning"])])]),_:1}))}});const Te=fe(ye,[["__scopeId","data-v-10603e34"]]);export{Te as default};
