import{i as D}from"./index.eec0a9c6.js";import{d as N,cm as B,J as A,r as c,N as g,bj as P,bx as F,as as M,a as _,b as o,g as t,v as l,o as b,l as R,c as s,cp as C,dE as U,H as x,cq as j,cr as z,dF as E,dG as m,U as f,x as i,e as T,aR as O,bN as G}from"./index.954a2cbc.js";import{u as H}from"./index.56c1474b.js";const J={class:"ip-location-wrapper"},Z=["src"],X=N({__name:"index",props:{clipboardValue:null,renderOnSearch:{type:Boolean}},emits:["acceptClipboardCb"],setup(L,{emit:S}){const v=L,{t:V}=B();A(()=>{var e,a,u;(((e=v.clipboardValue)==null?void 0:e.isIPv4())||((a=v.clipboardValue)==null?void 0:a.isUrl())||((u=v.clipboardValue)==null?void 0:u.isDomain()))&&(d.value.address=y(v.clipboardValue.getOriginData()),S("acceptClipboardCb"))});const I=c(),w=c();function y(e){return e=e.trim(),g.isIP(e)==4||P(e)&&(e=H(e).hostname),e}const d=c({address:""}),$={address:[{required:!0,whitespace:!0,transform:y,validator:(e,a)=>a===""||g.isIP(a)!==4&&!P(a)&&!F(a)?Promise.reject():Promise.resolve(),message:V("ipLocation.validInputError")}]},r=c(),k=M(()=>{const e=l.exports.get(r.value,"latitude",0),a=l.exports.get(r.value,"longitude",0);return e===0||a===0?"":`https://maps.google.com/maps?hl=en;z=14&q=${e},${a}&output=embed`}),h=c(!1),p=c("");async function q(){var u;try{await((u=I.value)==null?void 0:u.validateFields())}catch{return}const e=y(d.value.address);let a="";if(p.value="",g.isIP(e)==4)a=e;else try{a=(await g.domainLookup(e,{family:4})).address}catch(n){p.value=(n==null?void 0:n.toString())||""}h.value=!0,D(a).then(n=>{r.value=n}).catch(n=>{p.value=n.toString()||""}).finally(()=>{h.value=!1})}return(e,a)=>(b(),_(t(G),{"max-width":1280},{one:o(()=>[R("div",J,[s(t(z),{ref_key:"formRef",ref:I,rules:$,model:d.value,"hide-required-mark":""},{default:o(()=>[p.value!==""?(b(),_(t(C),{key:0},{default:o(()=>[s(t(U),{message:p.value,type:"error",banner:""},null,8,["message"])]),_:1})):x("",!0),s(t(C),{label:"IP/Domain",name:"address"},{default:o(()=>[s(t(j),{value:d.value.address,"onUpdate:value":a[0]||(a[0]=u=>d.value.address=u),"enter-button":e.$t("common.query"),"allow-clear":"",autofocus:"",onSearch:q},null,8,["value","enter-button"])]),_:1})]),_:1},8,["model"]),s(t(O),{spinning:h.value},{default:o(()=>[r.value?(b(),_(t(E),{key:0,bordered:"",column:1},{default:o(()=>[s(t(m),{label:e.$t("ip.result.city")},{default:o(()=>[f(i(t(l.exports.get)(r.value,"city")),1)]),_:1},8,["label"]),s(t(m),{label:e.$t("ip.result.country")},{default:o(()=>[f(i(t(l.exports.get)(r.value,["country","code"],"")+" | "+t(l.exports.get)(r.value,["country","name"],"")),1)]),_:1},8,["label"]),s(t(m),{label:e.$t("ip.result.longitudeAndLatitude")},{default:o(()=>[f(i(t(l.exports.get)(r.value,["latitude"]))+" , "+i(t(l.exports.get)(r.value,["longitude"])),1)]),_:1},8,["label"]),s(t(m),{label:e.$t("ip.result.timeZone")},{default:o(()=>[f(i(t(l.exports.get)(r.value,["country","timezone","code"]))+"("+i(t(l.exports.get)(r.value,["country","timezone","offset"]))+") ",1)]),_:1},8,["label"]),s(t(m),{label:e.$t("ip.result.callingCode")},{default:o(()=>[f(i(t(l.exports.get)(r.value,["country","callingCode"])),1)]),_:1},8,["label"])]),_:1})):x("",!0),t(k)!==""?(b(),T("iframe",{key:1,ref_key:"ipLocationMapIframe",ref:w,src:t(k),style:{height:"237px",width:"100%"}},null,8,Z)):x("",!0)]),_:1},8,["spinning"])])]),_:1}))}});export{X as default};
