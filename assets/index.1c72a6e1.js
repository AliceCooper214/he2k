import{co as Y}from"./index.954a2cbc.js";const{BigInteger:D}=Y.exports;function Ft(e){let t=e.toString(16);if(t[0]!=="-")t.length%2===1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t);else{t=t.substr(1);let n=t.length;n%2===1?n+=1:t.match(/^[0-7]/)||(n+=2);let s="";for(let r=0;r<n;r++)s+="f";s=new D(s,16),t=s.xor(e).add(D.ONE),t=t.toString(16).replace(/^-/,"")}return t}class st{constructor(){this.tlv=null,this.t="00",this.l="00",this.v=""}getEncodedHex(){return this.tlv||(this.v=this.getValue(),this.l=this.getLength(),this.tlv=this.t+this.l+this.v),this.tlv}getLength(){const t=this.v.length/2;let n=t.toString(16);return n.length%2===1&&(n="0"+n),t<128?n:(128+n.length/2).toString(16)+n}getValue(){return""}}class X extends st{constructor(t){super(),this.t="02",t&&(this.v=Ft(t))}getValue(){return this.v}}class yt extends st{constructor(t){super(),this.t="30",this.asn1Array=t}getValue(){return this.v=this.asn1Array.map(t=>t.getEncodedHex()).join(""),this.v}}function rt(e,t){return+e[t+2]<8?1:+e.substr(t+2,2)&127+1}function Q(e,t){const n=rt(e,t),s=e.substr(t+2,n*2);return s?(+s[0]<8?new D(s,16):new D(s.substr(2),16)).intValue():-1}function M(e,t){const n=rt(e,t);return t+(n+1)*2}var mt={encodeDer(e,t){const n=new X(e),s=new X(t);return new yt([n,s]).getEncodedHex()},decodeDer(e){const t=M(e,0),n=M(e,t),s=Q(e,t),r=e.substr(n,s*2),o=n+r.length,i=M(e,o),c=Q(e,o),x=e.substr(i,c*2),l=new D(r,16),h=new D(x,16);return{r:l,s:h}}};const{BigInteger:m}=Y.exports,J=new m("2"),_=new m("3");class H{constructor(t,n){this.x=n,this.q=t}equals(t){return t===this?!0:this.q.equals(t.q)&&this.x.equals(t.x)}toBigInteger(){return this.x}negate(){return new H(this.q,this.x.negate().mod(this.q))}add(t){return new H(this.q,this.x.add(t.toBigInteger()).mod(this.q))}subtract(t){return new H(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))}multiply(t){return new H(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))}divide(t){return new H(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))}square(){return new H(this.q,this.x.square().mod(this.q))}}class A{constructor(t,n,s,r){this.curve=t,this.x=n,this.y=s,this.z=r==null?m.ONE:r,this.zinv=null}getX(){return this.zinv===null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}getY(){return this.zinv===null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}equals(t){return t===this?!0:this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(m.ZERO)?t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(m.ZERO):!1}isInfinity(){return this.x===null&&this.y===null?!0:this.z.equals(m.ZERO)&&!this.y.toBigInteger().equals(m.ZERO)}negate(){return new A(this.curve,this.x,this.y.negate(),this.z)}add(t){if(this.isInfinity())return t;if(t.isInfinity())return this;const n=this.x.toBigInteger(),s=this.y.toBigInteger(),r=this.z,o=t.x.toBigInteger(),i=t.y.toBigInteger(),c=t.z,x=this.curve.q,l=n.multiply(c).mod(x),h=o.multiply(r).mod(x),u=l.subtract(h),a=s.multiply(c).mod(x),g=i.multiply(r).mod(x),d=a.subtract(g);if(m.ZERO.equals(u))return m.ZERO.equals(d)?this.twice():this.curve.infinity;const I=l.add(h),B=r.multiply(c).mod(x),p=u.square().mod(x),F=u.multiply(p).mod(x),E=B.multiply(d.square()).subtract(I.multiply(p)).mod(x),ht=u.multiply(E).mod(x),gt=d.multiply(p.multiply(l).subtract(E)).subtract(a.multiply(F)).mod(x),dt=F.multiply(B).mod(x);return new A(this.curve,this.curve.fromBigInteger(ht),this.curve.fromBigInteger(gt),dt)}twice(){if(this.isInfinity())return this;if(!this.y.toBigInteger().signum())return this.curve.infinity;const t=this.x.toBigInteger(),n=this.y.toBigInteger(),s=this.z,r=this.curve.q,o=this.curve.a.toBigInteger(),i=t.square().multiply(_).add(o.multiply(s.square())).mod(r),c=n.shiftLeft(1).multiply(s).mod(r),x=n.square().mod(r),l=x.multiply(t).multiply(s).mod(r),h=c.square().mod(r),u=i.square().subtract(l.shiftLeft(3)).mod(r),a=c.multiply(u).mod(r),g=i.multiply(l.shiftLeft(2).subtract(u)).subtract(h.shiftLeft(1).multiply(x)).mod(r),d=c.multiply(h).mod(r);return new A(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(g),d)}multiply(t){if(this.isInfinity())return this;if(!t.signum())return this.curve.infinity;const n=t.multiply(_),s=this.negate();let r=this;for(let o=n.bitLength()-2;o>0;o--){r=r.twice();const i=n.testBit(o),c=t.testBit(o);i!==c&&(r=r.add(i?this:s))}return r}}class bt{constructor(t,n,s){this.q=t,this.a=this.fromBigInteger(n),this.b=this.fromBigInteger(s),this.infinity=new A(this,null,null)}equals(t){return t===this?!0:this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)}fromBigInteger(t){return new H(this.q,t)}decodePointHex(t){switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:const n=this.fromBigInteger(new m(t.substr(2),16));let s=this.fromBigInteger(n.multiply(n.square()).add(n.multiply(this.a)).add(this.b).toBigInteger().modPow(this.q.divide(new m("4")).add(m.ONE),this.q));return s.toBigInteger().mod(J).equals(new m(t.substr(0,2),16).subtract(J))||(s=s.negate()),new A(this,n,s);case 4:case 6:case 7:const r=(t.length-2)/2,o=t.substr(2,r),i=t.substr(r+2,r);return new A(this,this.fromBigInteger(new m(o,16)),this.fromBigInteger(new m(i,16)));default:return null}}}var pt={ECPointFp:A,ECCurveFp:bt};const{BigInteger:v,SecureRandom:wt}=Y.exports,{ECCurveFp:vt}=pt,It=new wt,{curve:O,G:Bt,n:tt}=ot();function qt(){return O}function ot(){const e=new v("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF",16),t=new v("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC",16),n=new v("28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93",16),s=new vt(e,t,n),r="32C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7",o="BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0",i=s.decodePointHex("04"+r+o),c=new v("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123",16);return{curve:s,G:i,n:c}}function Pt(e,t,n){const r=(e?new v(e,t,n):new v(tt.bitLength(),It)).mod(tt.subtract(v.ONE)).add(v.ONE),o=L(r.toString(16),64),i=Bt.multiply(r),c=L(i.getX().toBigInteger().toString(16),64),x=L(i.getY().toBigInteger().toString(16),64),l="04"+c+x;return{privateKey:o,publicKey:l}}function Ht(e){if(e.length!==130)throw new Error("Invalid public key to compress");const t=(e.length-2)/2,n=e.substr(2,t),s=new v(e.substr(t+2,t),16);let r="03";return s.mod(new v("2")).equals(v.ZERO)&&(r="02"),r+n}function Tt(e){e=unescape(encodeURIComponent(e));const t=e.length,n=[];for(let r=0;r<t;r++)n[r>>>2]|=(e.charCodeAt(r)&255)<<24-r%4*8;const s=[];for(let r=0;r<t;r++){const o=n[r>>>2]>>>24-r%4*8&255;s.push((o>>>4).toString(16)),s.push((o&15).toString(16))}return s.join("")}function L(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e}function At(e){return e.map(t=>(t=t.toString(16),t.length===1?"0"+t:t)).join("")}function Et(e){const t=[];let n=0;for(let s=0;s<e.length*2;s+=2)t[s>>>3]|=parseInt(e[n],10)<<24-s%8*4,n++;try{const s=[];for(let r=0;r<e.length;r++){const o=t[r>>>2]>>>24-r%4*8&255;s.push(String.fromCharCode(o))}return decodeURIComponent(escape(s.join("")))}catch{throw new Error("Malformed UTF-8 data")}}function Ct(e){const t=[];let n=e.length;n%2!==0&&(e=L(e,n+1)),n=e.length;for(let s=0;s<n;s+=2)t.push(parseInt(e.substr(s,2),16));return t}function St(e){const t=O.decodePointHex(e);if(!t)return!1;const n=t.getX();return t.getY().square().equals(n.multiply(n.square()).add(n.multiply(O.a)).add(O.b))}function Rt(e,t){const n=O.decodePointHex(e);if(!n)return!1;const s=O.decodePointHex(t);return s?n.equals(s):!1}var zt={getGlobalCurve:qt,generateEcparam:ot,generateKeyPairHex:Pt,compressPublicKeyHex:Ht,utf8ToHex:Tt,leftPad:L,arrayToHex:At,arrayToUtf8:Et,hexToArray:Ct,verifyPublicKey:St,comparePublicKeyHex:Rt};function w(e,t){const n=[],s=~~(t/8),r=t%8;for(let o=0,i=e.length;o<i;o++)n[o]=(e[(o+s)%i]<<r&255)+(e[(o+s+1)%i]>>>8-r&255);return n}function y(e,t){const n=[];for(let s=e.length-1;s>=0;s--)n[s]=(e[s]^t[s])&255;return n}function j(e,t){const n=[];for(let s=e.length-1;s>=0;s--)n[s]=e[s]&t[s]&255;return n}function W(e,t){const n=[];for(let s=e.length-1;s>=0;s--)n[s]=(e[s]|t[s])&255;return n}function q(e,t){const n=[];let s=0;for(let r=e.length-1;r>=0;r--){const o=e[r]+t[r]+s;o>255?(s=1,n[r]=o&255):(s=0,n[r]=o&255)}return n}function Ot(e){const t=[];for(let n=e.length-1;n>=0;n--)t[n]=~e[n]&255;return t}function Dt(e){return y(y(e,w(e,9)),w(e,17))}function $t(e){return y(y(e,w(e,15)),w(e,23))}function Lt(e,t,n,s){return s>=0&&s<=15?y(y(e,t),n):W(W(j(e,t),j(e,n)),j(t,n))}function jt(e,t,n,s){return s>=0&&s<=15?y(y(e,t),n):W(j(e,t),j(Ot(e),n))}function kt(e,t){const n=[],s=[];for(let F=0;F<16;F++){const E=F*4;n.push(t.slice(E,E+4))}for(let F=16;F<68;F++)n.push(y(y($t(y(y(n[F-16],n[F-9]),w(n[F-3],15))),w(n[F-13],7)),n[F-6]));for(let F=0;F<64;F++)s.push(y(n[F],n[F+4]));const r=[121,204,69,25],o=[122,135,157,138];let i=e.slice(0,4),c=e.slice(4,8),x=e.slice(8,12),l=e.slice(12,16),h=e.slice(16,20),u=e.slice(20,24),a=e.slice(24,28),g=e.slice(28,32),d,I,B,p;for(let F=0;F<64;F++){const E=F>=0&&F<=15?r:o;d=w(q(q(w(i,12),h),w(E,F)),7),I=y(d,w(i,12)),B=q(q(q(Lt(i,c,x,F),l),I),s[F]),p=q(q(q(jt(h,u,a,F),g),d),n[F]),l=x,x=w(c,9),c=i,i=B,g=a,a=w(u,19),u=h,h=Dt(p)}return y([].concat(i,c,x,l,h,u,a,g),e)}function Z(e){let t=e.length*8,n=t%512;n=n>=448?512-n%448-1:448-n-1;const s=new Array((n-7)/8);for(let x=0,l=s.length;x<l;x++)s[x]=0;const r=[];t=t.toString(2);for(let x=7;x>=0;x--)if(t.length>8){const l=t.length-8;r[x]=parseInt(t.substr(l),2),t=t.substr(0,l)}else t.length>0?(r[x]=parseInt(t,2),t=""):r[x]=0;const o=[].concat(e,[128],s,r),i=o.length/64;let c=[115,128,22,111,73,20,178,185,23,36,66,215,218,138,6,0,169,111,48,188,22,49,56,170,227,141,238,77,176,251,14,78];for(let x=0;x<i;x++){const l=64*x,h=o.slice(l,l+64);c=kt(c,h)}return c}const k=64,it=new Array(k),xt=new Array(k);for(let e=0;e<k;e++)it[e]=54,xt[e]=92;function Gt(e,t){for(t.length>k&&(t=Z(t));t.length<k;)t.push(0);let s=y(t,it).concat(e);return s=Z(s),s=y(t,xt).concat(s),s=Z(s),s}var ct={sm3:Z,hmac:Gt};const{BigInteger:b}=Y.exports,{encodeDer:Kt,decodeDer:Nt}=mt,f=zt,$=ct.sm3,{G:S,curve:ft,n:R}=f.generateEcparam(),lt=0;function Ut(e,t,n=1){e=typeof e=="string"?f.hexToArray(f.utf8ToHex(e)):Array.prototype.slice.call(e),t=f.getGlobalCurve().decodePointHex(t);const s=f.generateKeyPairHex(),r=new b(s.privateKey,16);let o=s.publicKey;o.length>128&&(o=o.substr(o.length-128));const i=t.multiply(r),c=f.hexToArray(f.leftPad(i.getX().toBigInteger().toRadix(16),64)),x=f.hexToArray(f.leftPad(i.getY().toBigInteger().toRadix(16),64)),l=f.arrayToHex($([].concat(c,e,x)));let h=1,u=0,a=[];const g=[].concat(c,x),d=()=>{a=$([...g,h>>24&255,h>>16&255,h>>8&255,h&255]),h++,u=0};d();for(let B=0,p=e.length;B<p;B++)u===a.length&&d(),e[B]^=a[u++]&255;const I=f.arrayToHex(e);return n===lt?o+I+l:o+l+I}function Zt(e,t,n=1,{output:s="string"}={}){t=new b(t,16);let r=e.substr(128,64),o=e.substr(128+64);n===lt&&(r=e.substr(e.length-64),o=e.substr(128,e.length-128-64));const i=f.hexToArray(o),x=f.getGlobalCurve().decodePointHex("04"+e.substr(0,128)).multiply(t),l=f.hexToArray(f.leftPad(x.getX().toBigInteger().toRadix(16),64)),h=f.hexToArray(f.leftPad(x.getY().toBigInteger().toRadix(16),64));let u=1,a=0,g=[];const d=[].concat(l,h),I=()=>{g=$([...d,u>>24&255,u>>16&255,u>>8&255,u&255]),u++,a=0};I();for(let p=0,F=i.length;p<F;p++)a===g.length&&I(),i[p]^=g[a++]&255;return f.arrayToHex($([].concat(l,i,h)))===r.toLowerCase()?s==="array"?i:f.arrayToUtf8(i):s==="array"?[]:""}function Yt(e,t,{pointPool:n,der:s,hash:r,publicKey:o,userId:i}={}){let c=typeof e=="string"?f.utf8ToHex(e):f.arrayToHex(e);r&&(o=o||Vt(t),c=ut(c,o,i));const x=new b(t,16),l=new b(c,16);let h=null,u=null,a=null;do{do{let g;n&&n.length?g=n.pop():g=at(),h=g.k,u=l.add(g.x1).mod(R)}while(u.equals(b.ZERO)||u.add(h).equals(R));a=x.add(b.ONE).modInverse(R).multiply(h.subtract(u.multiply(x))).mod(R)}while(a.equals(b.ZERO));return s?Kt(u,a):f.leftPad(u.toString(16),64)+f.leftPad(a.toString(16),64)}function Mt(e,t,n,{der:s,hash:r,userId:o}={}){let i=typeof e=="string"?f.utf8ToHex(e):f.arrayToHex(e);r&&(i=ut(i,n,o));let c,x;if(s){const d=Nt(t);c=d.r,x=d.s}else c=new b(t.substring(0,64),16),x=new b(t.substring(64),16);const l=ft.decodePointHex(n),h=new b(i,16),u=c.add(x).mod(R);if(u.equals(b.ZERO))return!1;const a=S.multiply(x).add(l.multiply(u)),g=h.add(a.getX().toBigInteger()).mod(R);return c.equals(g)}function ut(e,t,n="1234567812345678"){n=f.utf8ToHex(n);const s=f.leftPad(S.curve.a.toBigInteger().toRadix(16),64),r=f.leftPad(S.curve.b.toBigInteger().toRadix(16),64),o=f.leftPad(S.getX().toBigInteger().toRadix(16),64),i=f.leftPad(S.getY().toBigInteger().toRadix(16),64);let c,x;if(t.length===128)c=t.substr(0,64),x=t.substr(64,64);else{const a=S.curve.decodePointHex(t);c=f.leftPad(a.getX().toBigInteger().toRadix(16),64),x=f.leftPad(a.getY().toBigInteger().toRadix(16),64)}const l=f.hexToArray(n+s+r+o+i+c+x),h=n.length*4;l.unshift(h&255),l.unshift(h>>8&255);const u=$(l);return f.arrayToHex($(u.concat(f.hexToArray(e))))}function Vt(e){const t=S.multiply(new b(e,16)),n=f.leftPad(t.getX().toBigInteger().toString(16),64),s=f.leftPad(t.getY().toBigInteger().toString(16),64);return"04"+n+s}function at(){const e=f.generateKeyPairHex(),t=ft.decodePointHex(e.publicKey);return e.k=new b(e.privateKey,16),e.x1=t.getX().toBigInteger(),e}var Wt={generateKeyPairHex:f.generateKeyPairHex,compressPublicKeyHex:f.compressPublicKeyHex,comparePublicKeyHex:f.comparePublicKeyHex,doEncrypt:Ut,doDecrypt:Zt,doSignature:Yt,doVerifySignature:Mt,getPoint:at,verifyPublicKey:f.verifyPublicKey};const{sm3:Xt,hmac:Qt}=ct;function Jt(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e}function et(e){return e.map(t=>(t=t.toString(16),t.length===1?"0"+t:t)).join("")}function _t(e){const t=[];let n=e.length;n%2!==0&&(e=Jt(e,n+1)),n=e.length;for(let s=0;s<n;s+=2)t.push(parseInt(e.substr(s,2),16));return t}function te(e){const t=[];for(let n=0,s=e.length;n<s;n++){const r=e.codePointAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>>6),t.push(128|r&63);else if(r<=55295||r>=57344&&r<=65535)t.push(224|r>>>12),t.push(128|r>>>6&63),t.push(128|r&63);else if(r>=65536&&r<=1114111)n++,t.push(240|r>>>18&28),t.push(128|r>>>12&63),t.push(128|r>>>6&63),t.push(128|r&63);else throw t.push(r),new Error("input is not supported")}return t}var ee=function(e,t){if(e=typeof e=="string"?te(e):Array.prototype.slice.call(e),t){if((t.mode||"hmac")!=="hmac")throw new Error("invalid mode");let s=t.key;if(!s)throw new Error("invalid key");return s=typeof s=="string"?_t(s):Array.prototype.slice.call(s),et(Qt(e,s))}return et(Xt(e))};const P=0,ne=32,C=16,G=[214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5,43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153,156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98,228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166,71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168,104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53,30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135,212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158,234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161,224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227,29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111,213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81,141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216,10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176,137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132,24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72],K=[462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257];function V(e){const t=[];for(let n=0,s=e.length;n<s;n+=2)t.push(parseInt(e.substr(n,2),16));return t}function se(e){return e.map(t=>(t=t.toString(16),t.length===1?"0"+t:t)).join("")}function re(e){const t=[];for(let n=0,s=e.length;n<s;n++){const r=e.codePointAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>>6),t.push(128|r&63);else if(r<=55295||r>=57344&&r<=65535)t.push(224|r>>>12),t.push(128|r>>>6&63),t.push(128|r&63);else if(r>=65536&&r<=1114111)n++,t.push(240|r>>>18&28),t.push(128|r>>>12&63),t.push(128|r>>>6&63),t.push(128|r&63);else throw t.push(r),new Error("input is not supported")}return t}function oe(e){const t=[];for(let n=0,s=e.length;n<s;n++)e[n]>=240&&e[n]<=247?(t.push(String.fromCodePoint(((e[n]&7)<<18)+((e[n+1]&63)<<12)+((e[n+2]&63)<<6)+(e[n+3]&63))),n+=3):e[n]>=224&&e[n]<=239?(t.push(String.fromCodePoint(((e[n]&15)<<12)+((e[n+1]&63)<<6)+(e[n+2]&63))),n+=2):e[n]>=192&&e[n]<=223?(t.push(String.fromCodePoint(((e[n]&31)<<6)+(e[n+1]&63))),n++):t.push(String.fromCodePoint(e[n]));return t.join("")}function z(e,t){return e<<t|e>>>32-t}function T(e){return(G[e>>>24&255]&255)<<24|(G[e>>>16&255]&255)<<16|(G[e>>>8&255]&255)<<8|G[e&255]&255}function N(e){return e^z(e,2)^z(e,10)^z(e,18)^z(e,24)}function U(e){return e^z(e,13)^z(e,23)}function ie(e,t,n){const s=new Array(4),r=new Array(4);for(let o=0;o<4;o++)r[0]=e[4*o]&255,r[1]=e[4*o+1]&255,r[2]=e[4*o+2]&255,r[3]=e[4*o+3]&255,s[o]=r[0]<<24|r[1]<<16|r[2]<<8|r[3];for(let o=0,i;o<32;o+=4)i=s[1]^s[2]^s[3]^n[o+0],s[0]^=N(T(i)),i=s[2]^s[3]^s[0]^n[o+1],s[1]^=N(T(i)),i=s[3]^s[0]^s[1]^n[o+2],s[2]^=N(T(i)),i=s[0]^s[1]^s[2]^n[o+3],s[3]^=N(T(i));for(let o=0;o<16;o+=4)t[o]=s[3-o/4]>>>24&255,t[o+1]=s[3-o/4]>>>16&255,t[o+2]=s[3-o/4]>>>8&255,t[o+3]=s[3-o/4]&255}function xe(e,t,n){const s=new Array(4),r=new Array(4);for(let o=0;o<4;o++)r[0]=e[0+4*o]&255,r[1]=e[1+4*o]&255,r[2]=e[2+4*o]&255,r[3]=e[3+4*o]&255,s[o]=r[0]<<24|r[1]<<16|r[2]<<8|r[3];s[0]^=2746333894,s[1]^=1453994832,s[2]^=1736282519,s[3]^=2993693404;for(let o=0,i;o<32;o+=4)i=s[1]^s[2]^s[3]^K[o+0],t[o+0]=s[0]^=U(T(i)),i=s[2]^s[3]^s[0]^K[o+1],t[o+1]=s[1]^=U(T(i)),i=s[3]^s[0]^s[1]^K[o+2],t[o+2]=s[2]^=U(T(i)),i=s[0]^s[1]^s[2]^K[o+3],t[o+3]=s[3]^=U(T(i));if(n===P)for(let o=0,i;o<16;o++)i=t[o],t[o]=t[31-o],t[31-o]=i}function nt(e,t,n,{padding:s="pkcs#7",mode:r,iv:o=[],output:i="string"}={}){if(r==="cbc"&&(typeof o=="string"&&(o=V(o)),o.length!==128/8))throw new Error("iv is invalid");if(typeof t=="string"&&(t=V(t)),t.length!==128/8)throw new Error("key is invalid");if(typeof e=="string"?n!==P?e=re(e):e=V(e):e=[...e],(s==="pkcs#5"||s==="pkcs#7")&&n!==P){const a=C-e.length%C;for(let g=0;g<a;g++)e.push(a)}const c=new Array(ne);xe(t,c,n);const x=[];let l=o,h=e.length,u=0;for(;h>=C;){const a=e.slice(u,u+16),g=new Array(16);if(r==="cbc")for(let d=0;d<C;d++)n!==P&&(a[d]^=l[d]);ie(a,g,c);for(let d=0;d<C;d++)r==="cbc"&&n===P&&(g[d]^=l[d]),x[u+d]=g[d];r==="cbc"&&(n!==P?l=g:l=a),h-=C,u+=C}if((s==="pkcs#5"||s==="pkcs#7")&&n===P){const a=x.length,g=x[a-1];for(let d=1;d<=g;d++)if(x[a-d]!==g)throw new Error("padding is invalid");x.splice(a-g,g)}return i!=="array"?n!==P?se(x):oe(x):x}var ce={encrypt(e,t,n){return nt(e,t,1,n)},decrypt(e,t,n){return nt(e,t,0,n)}},le={sm2:Wt,sm3:ee,sm4:ce};export{le as s};
