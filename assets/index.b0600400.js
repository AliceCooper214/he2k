import{d as j,r as R,o as L,e as G,c as z,b,g as T,a as O,l as S,$ as U,U as P,x as V,H as F,F as W,f as X,v as J,j as A,_ as K}from"./index.954a2cbc.js";import{L as Q}from"./layout4.ce8da1ed.js";import{I as Y}from"./ImagePicker.0c323f9c.js";import"./getBase64.b1142636.js";if(!M)var M={map:function(l,a){var _={};return a?l.map(function(u,f){return _.index=f,a.call(_,u)}):l.slice()},naturalOrder:function(l,a){return l<a?-1:l>a?1:0},sum:function(l,a){var _={};return l.reduce(a?function(u,f,d){return _.index=d,u+a.call(_,f)}:function(u,f){return u+f},0)},max:function(l,a){return Math.max.apply(null,a?M.map(l,a):l)}};var Z=function(){var l=5,a=8-l,_=1e3;function u(e,t,r){return(e<<2*l)+(t<<l)+r}function f(e){var t=[],r=!1;function s(){t.sort(e),r=!0}return{push:function(n){t.push(n),r=!1},peek:function(n){return r||s(),n===void 0&&(n=t.length-1),t[n]},pop:function(){return r||s(),t.pop()},size:function(){return t.length},map:function(n){return t.map(n)},debug:function(){return r||s(),t}}}function d(e,t,r,s,n,o,c){this.r1=e,this.r2=t,this.g1=r,this.g2=s,this.b1=n,this.b2=o,this.histo=c}function x(){this.vboxes=new f(function(e,t){return M.naturalOrder(e.vbox.count()*e.vbox.volume(),t.vbox.count()*t.vbox.volume())})}function $(e,t){if(t.count()){var r=t.r2-t.r1+1,s=t.g2-t.g1+1,n=M.max([r,s,t.b2-t.b1+1]);if(t.count()==1)return[t.copy()];var o,c,v,h,p=0,g=[],m=[];if(n==r)for(o=t.r1;o<=t.r2;o++){for(h=0,c=t.g1;c<=t.g2;c++)for(v=t.b1;v<=t.b2;v++)h+=e[u(o,c,v)]||0;g[o]=p+=h}else if(n==s)for(o=t.g1;o<=t.g2;o++){for(h=0,c=t.r1;c<=t.r2;c++)for(v=t.b1;v<=t.b2;v++)h+=e[u(c,o,v)]||0;g[o]=p+=h}else for(o=t.b1;o<=t.b2;o++){for(h=0,c=t.r1;c<=t.r2;c++)for(v=t.g1;v<=t.g2;v++)h+=e[u(c,v,o)]||0;g[o]=p+=h}return g.forEach(function(y,w){m[w]=p-y}),function(y){var w,E,k,B,C,q=y+"1",I=y+"2",N=0;for(o=t[q];o<=t[I];o++)if(g[o]>p/2){for(k=t.copy(),B=t.copy(),C=(w=o-t[q])<=(E=t[I]-o)?Math.min(t[I]-1,~~(o+E/2)):Math.max(t[q],~~(o-1-w/2));!g[C];)C++;for(N=m[C];!N&&g[C-1];)N=m[--C];return k[I]=C,B[q]=k[I]+1,[k,B]}}(n==r?"r":n==s?"g":"b")}}return d.prototype={volume:function(e){return this._volume&&!e||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},count:function(e){var t=this.histo;if(!this._count_set||e){var r,s,n,o=0;for(r=this.r1;r<=this.r2;r++)for(s=this.g1;s<=this.g2;s++)for(n=this.b1;n<=this.b2;n++)o+=t[u(r,s,n)]||0;this._count=o,this._count_set=!0}return this._count},copy:function(){return new d(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},avg:function(e){var t=this.histo;if(!this._avg||e){var r,s,n,o,c=0,v=1<<8-l,h=0,p=0,g=0;for(s=this.r1;s<=this.r2;s++)for(n=this.g1;n<=this.g2;n++)for(o=this.b1;o<=this.b2;o++)c+=r=t[u(s,n,o)]||0,h+=r*(s+.5)*v,p+=r*(n+.5)*v,g+=r*(o+.5)*v;this._avg=c?[~~(h/c),~~(p/c),~~(g/c)]:[~~(v*(this.r1+this.r2+1)/2),~~(v*(this.g1+this.g2+1)/2),~~(v*(this.b1+this.b2+1)/2)]}return this._avg},contains:function(e){var t=e[0]>>a;return gval=e[1]>>a,bval=e[2]>>a,t>=this.r1&&t<=this.r2&&gval>=this.g1&&gval<=this.g2&&bval>=this.b1&&bval<=this.b2}},x.prototype={push:function(e){this.vboxes.push({vbox:e,color:e.avg()})},palette:function(){return this.vboxes.map(function(e){return e.color})},size:function(){return this.vboxes.size()},map:function(e){for(var t=this.vboxes,r=0;r<t.size();r++)if(t.peek(r).vbox.contains(e))return t.peek(r).color;return this.nearest(e)},nearest:function(e){for(var t,r,s,n=this.vboxes,o=0;o<n.size();o++)((r=Math.sqrt(Math.pow(e[0]-n.peek(o).color[0],2)+Math.pow(e[1]-n.peek(o).color[1],2)+Math.pow(e[2]-n.peek(o).color[2],2)))<t||t===void 0)&&(t=r,s=n.peek(o).color);return s},forcebw:function(){var e=this.vboxes;e.sort(function(n,o){return M.naturalOrder(M.sum(n.color),M.sum(o.color))});var t=e[0].color;t[0]<5&&t[1]<5&&t[2]<5&&(e[0].color=[0,0,0]);var r=e.length-1,s=e[r].color;s[0]>251&&s[1]>251&&s[2]>251&&(e[r].color=[255,255,255])}},{quantize:function(e,t){if(!e.length||t<2||t>256)return!1;var r=function(h){var p,g=new Array(1<<3*l);return h.forEach(function(m){p=u(m[0]>>a,m[1]>>a,m[2]>>a),g[p]=(g[p]||0)+1}),g}(e);r.forEach(function(){});var s=function(h,p){var g,m,y,w=1e6,E=0,k=1e6,B=0,C=1e6,q=0;return h.forEach(function(I){(g=I[0]>>a)<w?w=g:g>E&&(E=g),(m=I[1]>>a)<k?k=m:m>B&&(B=m),(y=I[2]>>a)<C?C=y:y>q&&(q=y)}),new d(w,E,k,B,C,q,p)}(e,r),n=new f(function(h,p){return M.naturalOrder(h.count(),p.count())});function o(h,p){for(var g,m=h.size(),y=0;y<_;){if(m>=p||y++>_)return;if((g=h.pop()).count()){var w=$(r,g),E=w[0],k=w[1];if(!E)return;h.push(E),k&&(h.push(k),m++)}else h.push(g),y++}}n.push(s),o(n,.75*t);for(var c=new f(function(h,p){return M.naturalOrder(h.count()*h.volume(),p.count()*p.volume())});n.size();)c.push(n.pop());o(c,t);for(var v=new x;c.size();)v.push(c.pop());return v}}}().quantize,H=function(l){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=l.naturalWidth,this.height=this.canvas.height=l.naturalHeight,this.context.drawImage(l,0,0,this.width,this.height)};H.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var D=function(){};D.prototype.getColor=function(l,a){return a===void 0&&(a=10),this.getPalette(l,5,a)[0]},D.prototype.getPalette=function(l,a,_){var u=function($){var e=$.colorCount,t=$.quality;if(e!==void 0&&Number.isInteger(e)){if(e===1)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");e=Math.max(e,2),e=Math.min(e,20)}else e=10;return(t===void 0||!Number.isInteger(t)||t<1)&&(t=10),{colorCount:e,quality:t}}({colorCount:a,quality:_}),f=new H(l),d=function($,e,t){for(var r=$,s=[],n=0,o=void 0,c=void 0,v=void 0,h=void 0,p=void 0;n<e;n+=t)c=r[0+(o=4*n)],v=r[o+1],h=r[o+2],((p=r[o+3])===void 0||p>=125)&&(c>250&&v>250&&h>250||s.push([c,v,h]));return s}(f.getImageData().data,f.width*f.height,u.quality),x=Z(d,u.colorCount);return x?x.palette():null},D.prototype.getColorFromUrl=function(l,a,_){var u=this,f=document.createElement("img");f.addEventListener("load",function(){var d=u.getPalette(f,5,_);a(d[0],l)}),f.src=l},D.prototype.getImageData=function(l,a){var _=new XMLHttpRequest;_.open("GET",l,!0),_.responseType="arraybuffer",_.onload=function(){if(this.status==200){var u=new Uint8Array(this.response);i=u.length;for(var f=new Array(i),d=0;d<u.length;d++)f[d]=String.fromCharCode(u[d]);var x=f.join(""),$=window.btoa(x);a("data:image/png;base64,"+$)}},_.send()},D.prototype.getColorAsync=function(l,a,_){var u=this;this.getImageData(l,function(f){var d=document.createElement("img");d.addEventListener("load",function(){var x=u.getPalette(d,5,_);a(x[0],this)}),d.src=f})};const tt=D,et={class:"color-extraction-wrapper"},ot={key:0,class:"palette-wrap"},rt=P("RGB"),nt=P("RGB"),it=P("RGB"),at=P("RGB"),st=P("RGB"),ut={key:1,class:"palette-wrap"},lt=j({__name:"index",setup(l){const a=async e=>{d.value=!0},_=new tt,u=R(),f=R(),d=R(!1),x=e=>{u.value=_.getColor(e),f.value=_.getPalette(e,8),d.value=!1},$=()=>{u.value=void 0,f.value=void 0,d.value=!1};return(e,t)=>{const r=A("a-card"),s=A("a-typography-text"),n=A("a-spin");return L(),G("div",et,[z(T(Q),null,{one:b(()=>[z(T(Y),{"pick-hook":a,"reset-hook":$,"on-load-hook":x})]),two:b(()=>[z(n,{spinning:d.value},{default:b(()=>[!u.value&&!f.value?(L(),G("div",ot,[z(r,null,{default:b(()=>[rt]),_:1}),z(r,null,{default:b(()=>[nt]),_:1}),z(r,null,{default:b(()=>[it]),_:1}),z(r,null,{default:b(()=>[at]),_:1}),z(r,null,{default:b(()=>[st]),_:1})])):(L(),G("div",ut,[u.value?(L(),O(r,{key:0,hoverable:"",size:"small",title:e.$t("colorExtraction.dominantColor")},{cover:b(()=>[S("div",{style:U({backgroundColor:`rgb(${u.value[0]}, ${u.value[1]}, ${u.value[2]})`,height:"100px"})},null,4)]),default:b(()=>[z(s,{copyable:"",style:{display:"inline-block"}},{default:b(()=>[P(V(`rgb(${u.value[0]}, ${u.value[1]}, ${u.value[2]})`),1)]),_:1})]),_:1},8,["title"])):F("",!0),f.value&&f.value.length>0?(L(),O(r,{key:1,title:e.$t("colorExtraction.palette"),size:"small",class:"palette"},{default:b(()=>[(L(!0),G(W,null,X(f.value,(o,c)=>(L(),O(r,{key:c+T(J.exports.uniqueId)(),size:"small"},{cover:b(()=>[S("div",{style:U({backgroundColor:`rgb(${o[0]}, ${o[1]}, ${o[2]})`,height:"100px"})},null,4)]),default:b(()=>[z(s,{copyable:"",style:{display:"inline-block"}},{default:b(()=>[P(V(`rgb(${o[0]}, ${o[1]}, ${o[2]})`),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["title"])):F("",!0)]))]),_:1},8,["spinning"])]),_:1})])}}});const pt=K(lt,[["__scopeId","data-v-bc37fca1"]]);export{pt as default};
