import{d as q,ck as J,r,a9 as Z,e as R,c as t,b as d,g,o as j,l as h,bR as G,x as z,F as E,f as K,bZ as T,b_ as D,aX as Q,cl as Y,bX as ee,bN as ae,N as te,ao as oe,af as se,j as u,_ as ne}from"./index.954a2cbc.js";import{r as le,C as p}from"./index.99d06a99.js";import"./_commonjs-dynamic-modules.30ae7933.js";var re=le();const P={MD5:p.algo.MD5,SHA1:p.algo.SHA1,SHA224:p.algo.SHA224,SHA256:p.algo.SHA256,SHA384:p.algo.SHA384,SHA512:p.algo.SHA512,SHA3:p.algo.SHA3,RIPEMD160:p.algo.RIPEMD160};let L;onmessage=y=>{switch(y.data.type){case"algorithm":L=P[y.data.value].create();break;case"update":const m=re.create(y.data.value);L.update(m),postMessage({});break;case"finalize":const c=L.finalize().toString();postMessage({value:c});break}};const ue={class:"CheckSum"},ce={class:"ant-upload-drag-icon"},pe={class:"compare-area"},ie={class:"compare-result"},de=q({__name:"index",setup(y){J("#00FF00");let m;const c=r(["MD5","SHA256"]),F=Object.keys(P).map(e=>e),n=r({map:new Map,obj:{}}),b=r(""),C=r(!1),k=r(""),x=r(new Map),A=r(""),H=r(!1),M=r({});function $(){if(b.value==="")return;x.value.clear();let e=b.value.trim();c.value.forEach(a=>{let s=n.value.map.get(a);e===s&&x.value.set(a,!0)}),k.value="error",A.value="",x.value.forEach((a,s)=>{k.value="success",A.value=s}),C.value=!0}async function U(){if(c.value.length!==0&&!(typeof m>"u")){H.value=!0;try{await Promise.all(c.value.map(e=>new Promise(async(a,s)=>{try{if(n.value.map.get(e)){a(!0);return}let l=0,i=N(e),_=m.stream().getReader();for(let v=await _.read();!v.done;v=await _.read())l+=v.value.byteLength,M.value[e]=l*100/m.size,await i.update(v.value);_.releaseLock();let f=await i.finalize();n.value.map.set(e,f),n.value.obj[e]=f,a(!0)}catch(l){s(l)}})))}catch(e){console.error(e)}finally{H.value=!1}}}async function I(e){return m=e,w.map(a=>{a.terminate()}),w=[],n.value.map.clear(),n.value.obj={},U(),!1}let w=[];Z(()=>{w.map(e=>{e.terminate()})});function N(e){let a=new Worker(new URL(""+new URL("checksumWorker.033e31fa.js",import.meta.url).href,self.location),{type:"module"});return w.push(a),a.postMessage({type:"algorithm",value:e}),{update:s=>(a.postMessage({type:"update",value:s}),new Promise((l,i)=>{a.onmessage=l})),finalize:()=>(a.postMessage({type:"finalize"}),new Promise((s,l)=>{a.onmessage=i=>{s(i.data.value)}}))}}function O(e){let a=n.value.map.get(e);typeof a<"u"&&B(a)}function B(e){te.writeTextToClipboard(e),oe.success(se("common.copySuccess"))}return(e,a)=>{const s=u("a-upload-dragger"),l=u("a-checkbox-group"),i=u("a-spin"),_=u("a-progress"),f=u("a-input"),v=u("a-button"),W=u("a-tooltip"),V=u("a-input-group"),X=u("a-alert");return j(),R("div",ue,[t(g(ae),{class:"Checksum","max-width":1280},{one:d(()=>[t(s,{"max-count":1,"before-upload":I},{default:d(()=>[h("p",ce,[t(g(G))]),h("p",null,z(e.$t("checksum.upload")),1)]),_:1}),t(i,{spinning:H.value},{default:d(()=>[t(l,{value:c.value,"onUpdate:value":a[0]||(a[0]=o=>c.value=o),class:"drag-box",options:g(F),onChange:U},null,8,["value","options"])]),_:1},8,["spinning"]),(j(!0),R(E,null,K(c.value,o=>(j(),R(E,{key:o},[T(t(_,{class:"calculate-progress-bar",format:S=>S.toFixed(2)+"%",percent:M.value[o]},null,8,["format","percent"]),[[D,M.value[o]<100]]),t(V,{compact:"",class:"calculate-result"},{default:d(()=>[t(f,{value:n.value.obj[o],"onUpdate:value":S=>n.value.obj[o]=S,"addon-before":o,disabled:!0,style:{width:"calc(100% - 50px)"}},Q({_:2},[A.value===o?{name:"suffix",fn:d(()=>[t(g(Y))]),key:"0"}:void 0]),1032,["value","onUpdate:value","addon-before"]),t(W,null,{default:d(()=>[t(v,{onClick:S=>O(o)},{icon:d(()=>[t(g(ee))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)],64))),128)),h("div",pe,[h("p",null,z(e.$t("checksum.prompt")),1),t(f,{value:b.value,"onUpdate:value":a[1]||(a[1]=o=>b.value=o),onChange:$},null,8,["value"])]),T(h("div",ie,[T(t(X,{message:k.value==="success"?e.$t("checksum.success"):e.$t("checksum.failed"),type:k.value,"show-icon":""},null,8,["message","type"]),[[D,C.value]])],512),[[D,C.value]])]),_:1})])}}});const fe=ne(de,[["__scopeId","data-v-7a67e95f"]]);export{fe as default};
