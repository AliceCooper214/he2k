import{co as a,bb as u,ao as Z}from"./index.954a2cbc.js";import{r as J}from"./buffer-es6.d450e15c.js";var V=J.Buffer,C=function(t){if(t instanceof Uint8Array){if(t.byteOffset===0&&t.byteLength===t.buffer.byteLength)return t.buffer;if(typeof t.buffer.slice=="function")return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}if(V.isBuffer(t)){for(var r=new Uint8Array(t.length),i=t.length,e=0;e<i;e++)r[e]=t[e];return r.buffer}else throw new Error("Argument must be a Buffer")},W=a.exports.BigInteger.prototype.Barrett;function x(t,r){this.x=r,this.q=t}function w(t,r,i,e){this.curve=t,this.x=r,this.y=i,this.z=e==null?a.exports.BigInteger.ONE:e,this.zinv=null}function A(t,r,i){this.q=t,this.a=this.fromBigInteger(r),this.b=this.fromBigInteger(i),this.infinity=new w(this,null,null),this.reducer=new W(this.q)}x.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)},x.prototype.toBigInteger=function(){return this.x},x.prototype.negate=function(){return new x(this.q,this.x.negate().mod(this.q))},x.prototype.add=function(t){return new x(this.q,this.x.add(t.toBigInteger()).mod(this.q))},x.prototype.subtract=function(t){return new x(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))},x.prototype.multiply=function(t){return new x(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))},x.prototype.square=function(){return new x(this.q,this.x.square().mod(this.q))},x.prototype.divide=function(t){return new x(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))},w.prototype.getX=function(){this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q));var t=this.x.toBigInteger().multiply(this.zinv);return this.curve.reduce(t),this.curve.fromBigInteger(t)},w.prototype.getY=function(){this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q));var t=this.y.toBigInteger().multiply(this.zinv);return this.curve.reduce(t),this.curve.fromBigInteger(t)},w.prototype.equals=function(t){return t==this||(this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():!!t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(a.exports.BigInteger.ZERO)&&t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(a.exports.BigInteger.ZERO))},w.prototype.isInfinity=function(){return this.x==null&&this.y==null||this.z.equals(a.exports.BigInteger.ZERO)&&!this.y.toBigInteger().equals(a.exports.BigInteger.ZERO)},w.prototype.negate=function(){return new w(this.curve,this.x,this.y.negate(),this.z)},w.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var r=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),i=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);if(a.exports.BigInteger.ZERO.equals(i))return a.exports.BigInteger.ZERO.equals(r)?this.twice():this.curve.getInfinity();var e=new a.exports.BigInteger("3"),o=this.x.toBigInteger(),s=this.y.toBigInteger(),f=(t.x.toBigInteger(),t.y.toBigInteger(),i.square()),n=f.multiply(i),c=o.multiply(f),g=r.square().multiply(this.z),B=g.subtract(c.shiftLeft(1)).multiply(t.z).subtract(n).multiply(i).mod(this.curve.q),h=c.multiply(e).multiply(r).subtract(s.multiply(n)).subtract(g.multiply(r)).multiply(t.z).add(r.multiply(n)).mod(this.curve.q),v=n.multiply(this.z).multiply(t.z).mod(this.curve.q);return new w(this.curve,this.curve.fromBigInteger(B),this.curve.fromBigInteger(h),v)},w.prototype.twice=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var t=new a.exports.BigInteger("3"),r=this.x.toBigInteger(),i=this.y.toBigInteger(),e=i.multiply(this.z),o=e.multiply(i).mod(this.curve.q),s=this.curve.a.toBigInteger(),f=r.square().multiply(t);a.exports.BigInteger.ZERO.equals(s)||(f=f.add(this.z.square().multiply(s)));var n=(f=f.mod(this.curve.q)).square().subtract(r.shiftLeft(3).multiply(o)).shiftLeft(1).multiply(e).mod(this.curve.q),c=f.multiply(t).multiply(r).subtract(o.shiftLeft(1)).shiftLeft(2).multiply(o).subtract(f.square().multiply(f)).mod(this.curve.q),g=e.square().multiply(e).shiftLeft(3).mod(this.curve.q);return new w(this.curve,this.curve.fromBigInteger(n),this.curve.fromBigInteger(c),g)},w.prototype.multiply=function(t){if(this.isInfinity())return this;if(t.signum()==0)return this.curve.getInfinity();var r,i=t,e=i.multiply(new a.exports.BigInteger("3")),o=this.negate(),s=this;for(r=e.bitLength()-2;r>0;--r){s=s.twice();var f=e.testBit(r);f!=i.testBit(r)&&(s=s.add(f?this:o))}return s},w.prototype.multiplyTwo=function(t,r,i){var e;e=t.bitLength()>i.bitLength()?t.bitLength()-1:i.bitLength()-1;for(var o=this.curve.getInfinity(),s=this.add(r);e>=0;)o=o.twice(),t.testBit(e)?o=i.testBit(e)?o.add(s):o.add(this):i.testBit(e)&&(o=o.add(r)),--e;return o},A.prototype.getQ=function(){return this.q},A.prototype.getA=function(){return this.a},A.prototype.getB=function(){return this.b},A.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)},A.prototype.getInfinity=function(){return this.infinity},A.prototype.fromBigInteger=function(t){return new x(this.q,t)},A.prototype.reduce=function(t){this.reducer.reduce(t)},A.prototype.decodePointHex=function(t){switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var r=(t.length-2)/2,i=t.substr(2,r),e=t.substr(r+2,r);return new w(this,this.fromBigInteger(new a.exports.BigInteger(i,16)),this.fromBigInteger(new a.exports.BigInteger(e,16)));default:return null}},A.prototype.encodePointHex=function(t){if(t.isInfinity())return"00";var r=t.getX().toBigInteger().toString(16),i=t.getY().toBigInteger().toString(16),e=this.getQ().toString(16).length;for(e%2!=0&&e++;r.length<e;)r="0"+r;for(;i.length<e;)i="0"+i;return"04"+r+i};var I=function(t,r){return t<<(r%=32)|t>>>32-r},S=function(t,r){var i=r-t.length;return(i>0?"0".repeat(i):"")+t},tt=function(t){return t<16?2043430169:2055708042},rt=function(t,r,i,e){return e<16?t^r^i:t&r|t&i|r&i},et=function(t,r,i,e){return e<16?t^r^i:t&r|~t&i},it=function(t,r,i){for(var e,o,s,f,n,c=function(z){var b,m=new Array(132);z.forEach(function(j,Q){m[Q]=j});for(var E=16;E<68;E++)m[E]=(b=m[E-16]^m[E-9]^I(m[E-3],15))^I(b,15)^I(b,23)^I(m[E-13],7)^m[E-6];for(var q=0;q<64;q++)m[q+68]=m[q]^m[q+4];return m}(r),g=t[0],B=t[1],h=t[2],v=t[3],p=t[4],l=t[5],F=t[6],d=t[7],y=0;y<64;y++)o=(e=I(I(g,12)+p+I(tt(y),y),7))^I(g,12),s=rt(g,B,h,y)+v+o+c[y+68],f=et(p,l,F,y)+d+e+c[y],v=h,h=I(B,9),B=g,g=s,d=F,F=I(l,19),l=p,p=(n=f)^I(n,9)^I(n,17);return[g^t[0],B^t[1],h^t[2],v^t[3],p^t[4],l^t[5],F^t[6],d^t[7]]},R=function(t,r,i){if(typeof t=="string"?t=u.from(t,r||"utf8"):t instanceof ArrayBuffer&&(t=u.from(t)),!u.isBuffer(t))throw new TypeError('Expected "string" | "Buffer" | "ArrayBuffer" but received "'+Object.prototype.toString.call(t)+'"');var e,o,s,f,n,c;e=t,o=u.alloc(1,128),f=u.alloc(s=(s=e.length%64)>=56?64-s%56-1:56-s-1,0),n=u.alloc(8),c=8*e.length,n.writeUInt32BE(Math.floor(c/Math.pow(2,32)),0),n.writeUInt32BE(c%Math.pow(2,32),4);for(var g=(t=u.concat([e,o,f,n],e.length+1+s+8)).length/64,B=new Array(g),h=0;h<g;h++){B[h]=new Array(16);for(var v=0;v<16;v++)B[h][v]=t.readUInt32BE(64*h+4*v)}var p=new Array(g);p[0]=[1937774191,1226093241,388252375,3666478592,2842636476,372324522,3817729613,2969243214];for(var l=0;l<g;l++)p[l+1]=it(p[l],B[l]);var F=u.alloc(32);return p[g].forEach(function(d,y){return F.writeInt32BE(d,4*y)}),i?F.toString(i):C(F)},X=new a.exports.SecureRandom,U=function(){var t=new A(new a.exports.BigInteger("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF",16),new a.exports.BigInteger("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC",16),new a.exports.BigInteger("28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93",16)),r=t.decodePointHex("0432C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0");return{curve:t,G:r,n:new a.exports.BigInteger("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123",16)}}(),Y=U.curve,H=U.G,O=U.n;function M(t,r){for(var i=[],e=Math.ceil(r/32),o=r%32,s=1;s<=e;s++){var f=u.allocUnsafe(4);f.writeUInt32BE(s);var n=R(u.concat([t,f]));i.push(s===e&&o?u.from(n).slice(0,o):u.from(n))}return u.concat(i,r)}var st={__proto__:null,constants:{C1C2C3:0,C1C3C2:1,PC:"04"},generateKeyPair:function(){var t=new a.exports.BigInteger(O.bitLength(),X).mod(O.subtract(new a.exports.BigInteger("2"))).add(a.exports.BigInteger.ONE),r=S(t.toString(16),64),i=H.multiply(t);return{privateKey:r,publicKey:"04"+S(i.getX().toBigInteger().toString(16),64)+S(i.getY().toBigInteger().toString(16),64)}},encrypt:function(t,r,i){var e=i||{},o=e.mode,s=o===void 0?1:o,f=e.outputEncoding,n=e.pc;if(typeof t=="string"?t=u.from(t,e.inputEncoding||"utf8"):t instanceof ArrayBuffer&&(t=u.from(t)),!u.isBuffer(t))throw new TypeError('Expected "string" | "Buffer" | "ArrayBuffer" but received "'+Object.prototype.toString.call(t)+'"');var c=new a.exports.BigInteger(O.bitLength(),X).mod(O.subtract(a.exports.BigInteger.ONE)).add(a.exports.BigInteger.ONE),g=H.multiply(c),B=S(g.getX().toBigInteger().toString(16),64)+S(g.getY().toBigInteger().toString(16),64),h=Y.decodePointHex(r).multiply(c),v=S(h.getX().toBigInteger().toString(16),64),p=S(h.getY().toBigInteger().toString(16),64),l=M(u.from(v+p,"hex"),t.length),F=S(new a.exports.BigInteger(t.toString("hex"),16).xor(new a.exports.BigInteger(l.toString("hex"),16)).toString(16),2*t.length),d=R(v+t.toString("hex")+p,"hex","hex"),y=u.from((n?"04":"")+(s===0?B+F+d:B+d+F),"hex");return f?y.toString(f):C(y)},decrypt:function(t,r,i){var e=i||{},o=e.mode,s=o===void 0?1:o,f=e.outputEncoding,n=e.pc;if(typeof t=="string"?t=u.from(t,e.inputEncoding):t instanceof ArrayBuffer&&(t=u.from(t)),!u.isBuffer(t))throw new TypeError('Expected "string" | "Buffer" | "ArrayBuffer" but received "'+Object.prototype.toString.call(t)+'"');var c=(t=n?t.slice(1):t).slice(0,32).toString("hex"),g=t.slice(32,64).toString("hex"),B=Y.decodePointHex("04"+c+g).multiply(new a.exports.BigInteger(r,16)),h=S(B.getX().toBigInteger().toString(16),64),v=S(B.getY().toBigInteger().toString(16),64),p=t.slice(64,96),l=t.slice(96);s===0&&(p=t.slice(t.length-32),l=t.slice(64,t.length-32));var F=M(u.from(h+v,"hex"),l.length),d=new a.exports.BigInteger(l.toString("hex"),16).xor(new a.exports.BigInteger(F.toString("hex"),16)).toString(16),y=R(h+d+v,"hex","hex")===p.toString("hex")?u.from(d,"hex"):u.alloc(0);return f?y.toString(f):C(y)}},L=[[214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5],[43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153],[156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98],[228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166],[71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168],[104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53],[30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135],[212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158],[234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161],[224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227],[29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111],[213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81],[141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216],[10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176],[137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132],[24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72]],D=[2746333894,1453994832,1736282519,2993693404],nt=[462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257],T=/^[0-9a-f]{32}$/i,k=function(t){return L[(4026531840&t)>>>28][(251658240&t)>>>24]<<24|L[(15728640&t)>>>20][(983040&t)>>>16]<<16|L[(61440&t)>>>12][(3840&t)>>>8]<<8|L[(240&t)>>>4][(15&t)>>>0]<<0},K=function(t){return(r=k(t))^I(r,2)^I(r,10)^I(r,18)^I(r,24);var r},G=function(t){var r,i=new Array(36);i[0]=t[0]^D[0],i[1]=t[1]^D[1],i[2]=t[2]^D[2],i[3]=t[3]^D[3];for(var e=new Array(32),o=0;o<32;o++)i[o+4]=i[o]^(r=k(i[o+1]^i[o+2]^i[o+3]^nt[o]))^I(r,13)^I(r,23),e[o]=i[o+4];return e},N=function(t,r){for(var i=G(r),e=0;e<32;e++)t[e+4]=t[e]^K(t[e+1]^t[e+2]^t[e+3]^i[e]);return[t[35],t[34],t[33],t[32]]},$=function(t,r){for(var i=G(r).reverse(),e=0;e<32;e++)t[e+4]=t[e]^K(t[e+1]^t[e+2]^t[e+3]^i[e]);return[t[35],t[34],t[33],t[32]]},P=function(t){return[t.readInt32BE(0),t.readInt32BE(4),t.readInt32BE(8),t.readInt32BE(12)]},_=function(t){for(var r=u.alloc(16),i=0;i<4;i++)r.writeInt32BE(t[i],4*i);return r},gt={__proto__:null,constants:{ECB:1,CBC:2},encrypt:function(t,r,i){var e=i||{},o=e.mode,s=e.iv,f=e.outputEncoding;if(typeof t=="string"?t=u.from(t,e.inputEncoding||"utf8"):t instanceof ArrayBuffer&&(t=u.from(t)),!u.isBuffer(t))throw new TypeError('Expected "string" | "Buffer" | "ArrayBuffer" but received "'+Object.prototype.toString.call(t)+'"');if(!T.test(r))throw new TypeError("Invalid value of cipher `key`");if(r=u.from(r,"hex"),o===2&&!T.test(s))throw new TypeError("Invalid value of `iv` option");return function(n,c,g,B){g&&(g=P(g)),c=P(c);for(var h=[],v=(n=function(E){var q=16-E.length%16,j=u.alloc(q,q);return u.concat([E,j],E.length+q)}(n)).length/16,p=0;p<v;p++)if(g){var l=16*p,F=[g[0]^n.readInt32BE(l),g[1]^n.readInt32BE(l+4),g[2]^n.readInt32BE(l+8),g[3]^n.readInt32BE(l+12)],d=N(F,c);h.push(_(d)),g=d.slice(0)}else{var y=16*p,z=[n.readInt32BE(y),n.readInt32BE(y+4),n.readInt32BE(y+8),n.readInt32BE(y+12)],b=N(z,c);h.push(_(b))}var m=u.concat(h,n.length);return B?m.toString(B):C(m)}(t,r,s=o===2?u.from(s,"hex"):null,f)},decrypt:function(t,r,i){var e=i||{},o=e.mode,s=e.iv,f=e.outputEncoding;if(typeof t=="string"?t=u.from(t,e.inputEncoding):t instanceof ArrayBuffer&&(t=u.from(t)),!u.isBuffer(t))throw new TypeError('Expected "string" | "Buffer" | "ArrayBuffer" but received "'+Object.prototype.toString.call(t)+'"');if(!T.test(r))throw new TypeError("Invalid value of cipher `key`");if(r=u.from(r,"hex"),o===2&&!T.test(s))throw new TypeError("Invalid value of `iv` option");return function(n,c,g,B){g&&(g=P(g)),c=P(c);var h=[],v=n.length/16;if(g)for(var p=v-1;p>=0;p--){var l,F=16*p;l=p>0?[n.readInt32BE(F-16),n.readInt32BE(F-16+4),n.readInt32BE(F-16+8),n.readInt32BE(F-16+12)]:g;var d=[n.readInt32BE(F),n.readInt32BE(F+4),n.readInt32BE(F+8),n.readInt32BE(F+12)],y=$(d,c);h.unshift(_([y[0]^l[0],y[1]^l[1],y[2]^l[2],y[3]^l[3]]))}else for(var z=0;z<v;z++){var b=16*z,m=[n.readInt32BE(b),n.readInt32BE(b+4),n.readInt32BE(b+8),n.readInt32BE(b+12)],E=$(m,c);h.push(_(E))}var q=u.concat(h,n.length-h[h.length-1][15]);return B?q.toString(B):C(q)}(t,r,s=o===2?u.from(s,"hex"):null,f)}};const ft=(t,r)=>{if(t.length<=0)return Z.warning("Please enter the plain text"),"";if(r.value.length<=0)return Z.warning("Please enter the key"),""};export{gt as D,st as E,ft as j};
