var te=Object.defineProperty;var se=(d,i,r)=>i in d?te(d,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[i]=r;var T=(d,i,r)=>(se(d,typeof i!="symbol"?i+"":i,r),r);import{d as ae,cm as ie,r as C,as as _,J as ne,a9 as re,a as f,b as n,g as t,cZ as ue,c_ as D,o as v,c as u,cp as w,bY as y,U as m,x as h,c$ as oe,d0 as O,d1 as F,H as g,d2 as le,d3 as de,d4 as me,d5 as he,d6 as ce,d7 as pe,cr as fe,c1 as ve,c4 as I,d8 as _e,ap as ye,bN as ge,p as Te,m as ke,l as Ce,_ as we}from"./index.954a2cbc.js";function Se(d){return{all:d=d||new Map,on:function(i,r){var c=d.get(i);c&&c.push(r)||d.set(i,[r])},off:function(i,r){var c=d.get(i);c&&c.splice(c.indexOf(r)>>>0,1)},emit:function(i,r){(d.get(i)||[]).slice().map(function(c){c(r)}),(d.get("*")||[]).slice().map(function(c){c(i,r)})}}}class $e{constructor({interval:i=1e3,stopwatch:r=!1}={}){this._duration=0,this._endTime=0,this._pauseTime=0,this._status="stopped",this._emitter=Se(),this.tick=()=>{this.status!=="paused"&&(Date.now()>=this._endTime?(this.stop(),this._emitter.emit("tick",this._stopwatch?this._duration:0),this._emitter.emit("done")):this._emitter.emit("tick",this.time))},this._interval=i,this._stopwatch=r}start(i,r){if(this.status==="stopped"){if(i==null)throw new TypeError("Must provide duration parameter");this._duration=i,this._endTime=Date.now()+i,this._changeStatus("running"),this._emitter.emit("tick",this._stopwatch?0:this._duration),this._timeoutID=setInterval(this.tick,r||this._interval)}}stop(){this._timeoutID&&clearInterval(this._timeoutID),this._changeStatus("stopped")}pause(){this.status==="running"&&(this._pauseTime=Date.now(),this._changeStatus("paused"))}resume(){this.status==="paused"&&(this._endTime+=Date.now()-this._pauseTime,this._pauseTime=0,this._changeStatus("running"))}_changeStatus(i){this._status=i,this._emitter.emit("statusChanged",this.status)}get time(){if(this.status==="stopped")return 0;const i=this.status==="paused"?this._pauseTime:Date.now(),r=this._endTime-i;return this._stopwatch?this._duration-r:r}get duration(){return this._duration}get status(){return this._status}on(i,r){this._emitter.on(i,r)}off(i,r){this._emitter.off(i,r)}}const be=d=>(Te("data-v-79ab94e1"),d=d(),ke(),d),Ie=be(()=>Ce("div",null,null,-1)),Ne=m(" : "),Be=m(" : "),De=ae({__name:"index",setup(d){const{t:i}=ie(),r="HH:mm:ss.SSS";class c{constructor(s,a,k){T(this,"hours");T(this,"minutes");T(this,"seconds");this.hours=s,this.minutes=a,this.seconds=k}duration(){return D.duration({hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:0})}toString(){return this.duration().format(r)}}const R=new c(0,0,10);class N{constructor(s){T(this,"name");T(this,"timer");T(this,"userTime");T(this,"status");T(this,"current");T(this,"notify");this.name=s||"Timer",this.userTime=R,this.status="stopped",this.current=this.userTime.duration().format(r)}doneNotify(){const s=i("timer.timerDoneNotifyTitle"),a=i("timer.timerDoneNotifyBody")+this.name;ue.success({message:s,description:a})}start(){this.timer=new $e({interval:10}),this.timer.on("tick",a=>{this.current=D.duration(a).format(r)}),this.timer.on("statusChanged",a=>{this.status=a}),this.timer.on("done",()=>{this.notify&&this.doneNotify()});const s=this.userTime.duration().asMilliseconds();this.timer.start(s)}pause(){var s;(s=this.timer)==null||s.pause()}resume(){var s;(s=this.timer)==null||s.resume()}stop(){var s;(s=this.timer)==null||s.stop()}reset(){var s;(s=this.timer)==null||s.stop(),this.current=this.userTime.duration().format(r)}}const l=C([]);function B(){return`Timer ${l.value.length+1}`}const p=C("manual"),U=_(()=>l.value.length<=1||l.value.some(e=>e.status==="running")),z=function(){l.value.forEach(e=>{e.reset()})},E=_(()=>l.value.length>1),M=_(()=>e=>p.value!=="allControl"&&e.status==="paused"),L=_(()=>e=>p.value!=="allControl"&&e.status==="paused"),V=_(()=>e=>p.value!=="allControl"&&e.status==="running"),H=_(()=>e=>p.value!=="allControl"&&e.status==="stopped");ne(()=>{l.value.push(new N(B()))}),re(()=>{l.value.forEach(e=>{e.stop()})});const P=_(()=>l.value.some(e=>e.status==="running"));function x(){l.value.push(new N(B()))}const A=_(()=>p.value==="allControl"&&!l.value.some(e=>e.status!=="stopped")),Y=_(()=>p.value==="allControl"&&l.value.some(e=>e.status==="running")),j=_(()=>p.value==="allControl"&&l.value.some(e=>e.status==="paused")),q=_(()=>p.value==="allControl"&&l.value.some(e=>e.status==="paused"));function G(){l.value.forEach(e=>{e.start()})}function J(){l.value.forEach(e=>{e.pause()})}function Z(){l.value.forEach(e=>{e.resume()})}function K(){l.value.forEach(e=>{e.reset()})}function Q(e){e.stop(),l.value=l.value.filter(s=>s!==e),l.value.length<=1&&(p.value="manual")}const $=C(!1),b=C(),W=C([{required:!0,message:"Please input timer name",trigger:"blur"}]),o=C({name:"",hours:0,minutes:0,seconds:0,notify:!1,index:-1});function X(e,s){o.value.name=e.name,o.value.hours=e.userTime.hours,o.value.minutes=e.userTime.minutes,o.value.seconds=e.userTime.seconds,o.value.notify=e.notify||!1,o.value.index=s,$.value=!0}function ee(e){var s;(s=b.value)==null||s.validateFields().then(()=>{var k;const a=l.value[o.value.index];a.name=o.value.name,a.userTime=new c(o.value.hours,o.value.minutes,o.value.seconds),a.notify=o.value.notify,$.value=!1,(k=b.value)==null||k.resetFields()})}return(e,s)=>(v(),f(t(ge),{"max-width":700,class:"timer"},{one:n(()=>[u(t(pe),{"data-source":l.value},{header:n(()=>[u(t(w),null,{default:n(()=>[u(t(y),{disabled:t(P),type:"primary",ghost:"",onClick:x},{default:n(()=>[m(h(e.$t("timer.addTimer")),1)]),_:1},8,["disabled"])]),_:1}),u(t(w),{label:e.$t("timer.controlType")},{default:n(()=>[u(t(oe),{value:p.value,"onUpdate:value":s[0]||(s[0]=a=>p.value=a),disabled:t(U),"button-style":"solid",onChange:z},{default:n(()=>[u(t(O),{value:"manual"},{default:n(()=>[m(h(e.$t("timer.manualControl")),1)]),_:1}),u(t(O),{value:"allControl"},{default:n(()=>[m(h(e.$t("timer.allControl")),1)]),_:1})]),_:1},8,["value","disabled"])]),_:1},8,["label"]),p.value==="allControl"?(v(),f(t(w),{key:0},{default:n(()=>[u(t(F),null,{default:n(()=>[t(A)?(v(),f(t(y),{key:0,type:"primary",size:"large",onClick:G},{default:n(()=>[m(h(e.$t("timer.allStart")),1)]),_:1})):g("",!0),t(Y)?(v(),f(t(y),{key:1,type:"primary",size:"large",ghost:"",onClick:J},{default:n(()=>[m(h(e.$t("timer.allPause")),1)]),_:1})):g("",!0),t(j)?(v(),f(t(y),{key:2,type:"primary",size:"large",ghost:"",onClick:Z},{default:n(()=>[m(h(e.$t("timer.allResume")),1)]),_:1})):g("",!0),t(q)?(v(),f(t(y),{key:3,type:"primary",size:"large",ghost:"",danger:"",onClick:K},{default:n(()=>[m(h(e.$t("timer.allReset")),1)]),_:1})):g("",!0)]),_:1})]),_:1})):g("",!0)]),renderItem:n(({item:a,index:k})=>[u(t(le),null,{actions:n(()=>[t(H)(a)?(v(),f(t(y),{key:0,type:"primary",size:"large",onClick:S=>a.start()},{default:n(()=>[m(h(e.$t("timer.start")),1)]),_:2},1032,["onClick"])):g("",!0),t(V)(a)?(v(),f(t(y),{key:1,type:"primary",size:"large",ghost:"",onClick:S=>a.pause()},{default:n(()=>[m(h(e.$t("timer.pause")),1)]),_:2},1032,["onClick"])):g("",!0),t(M)(a)?(v(),f(t(y),{key:2,type:"primary",size:"large",ghost:"",danger:"",onClick:S=>a.reset()},{default:n(()=>[m(h(e.$t("timer.reset")),1)]),_:2},1032,["onClick"])):g("",!0),t(L)(a)?(v(),f(t(y),{key:3,type:"primary",size:"large",ghost:"",onClick:S=>a.resume()},{default:n(()=>[m(h(e.$t("timer.resume")),1)]),_:2},1032,["onClick"])):g("",!0),t(E)?(v(),f(t(y),{key:4,type:"primary",size:"large",danger:"",onClick:S=>Q(a)},{default:n(()=>[m(h(e.$t("timer.remove")),1)]),_:2},1032,["onClick"])):g("",!0)]),default:n(()=>[u(t(de),null,{title:n(()=>[u(t(me),null,{default:n(()=>[m(h(a.current),1)]),_:2},1024)]),description:n(()=>[a.notify?(v(),f(t(he),{key:0})):g("",!0),m(" "+h(`${a.name} (${a.userTime.toString()})`)+" ",1),u(t(y),{type:"text",onClick:S=>X(a,k)},{icon:n(()=>[u(t(ce))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1},8,["data-source"]),Ie,u(t(ye),{visible:$.value,"onUpdate:visible":s[6]||(s[6]=a=>$.value=a),title:e.$t("timer.editTimer"),"ok-text":e.$t("timer.editOk"),"cancel-text":e.$t("timer.editCancel"),onOk:ee},{default:n(()=>[u(t(fe),{ref_key:"editFormRef",ref:b,model:o.value},{default:n(()=>[u(t(w),{label:e.$t("timer.timerName"),name:"name",rules:W.value},{default:n(()=>[u(t(ve),{value:o.value.name,"onUpdate:value":s[1]||(s[1]=a=>o.value.name=a)},null,8,["value"])]),_:1},8,["label","rules"]),u(t(w),{label:e.$t("timer.timerDuration")},{default:n(()=>[u(t(F),null,{default:n(()=>[u(t(I),{value:o.value.hours,"onUpdate:value":s[2]||(s[2]=a=>o.value.hours=a),"addon-after":"Hrs",min:0},null,8,["value"]),Ne,u(t(I),{value:o.value.minutes,"onUpdate:value":s[3]||(s[3]=a=>o.value.minutes=a),"addon-after":"Min",min:0,max:59},null,8,["value"]),Be,u(t(I),{value:o.value.seconds,"onUpdate:value":s[4]||(s[4]=a=>o.value.seconds=a),"addon-after":"Secs",min:0,max:59},null,8,["value"])]),_:1})]),_:1},8,["label"]),u(t(w),{label:e.$t("timer.notifySwitch")},{default:n(()=>[u(t(_e),{checked:o.value.notify,"onUpdate:checked":s[5]||(s[5]=a=>o.value.notify=a)},null,8,["checked"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["visible","title","ok-text","cancel-text"])]),_:1}))}});const Re=we(De,[["__scopeId","data-v-79ab94e1"]]);export{Re as default};
