import{i as T,a as F,b as f,A as h,B as G,R as S}from"./ipv4.c8b8cd44.js";import{cu as o,co as u}from"./index.954a2cbc.js";const p=128,g=8,N={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"},A={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"},v=/([^0-9a-f:/%])/gi,M=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi,y=/\/\d{1,3}(?=%|$)/,E=/%.*$/,L=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/),C=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/);function O(i){return i.replace(/^(0+)/,'<span class="zero">$1</span>')}function b(i,t=0){return i.split(":").map((r,e)=>/group-v4/.test(r)?r:o.sprintf('<span class="hover-group group-%d">%s</span>',e+t,O(r)))}function I(i){return o.sprintf("(%s)",i.join("|"))}function x(i){return i.length<4?o.sprintf("0{0,%d}%s",4-i.length,i):i}const k="[^A-Fa-f0-9:]";function w(i){const t=[];i.forEach((r,e)=>{parseInt(r,16)===0&&t.push(e)});const s=t.map(r=>i.map((e,n)=>{if(n===r){const a=n===0||n===g-1?":":"";return I([x(e),a])}return x(e)}).join(":"));return s.push(i.map(x).join(":")),I(s)}function $(i,t,s){const r=t?"":":",e=s?"":":",n=[];!t&&!s&&n.push("::"),t&&s&&n.push(""),(s&&!t||!s&&t)&&n.push(":"),n.push(o.sprintf("%s(:0{1,4}){1,%d}",r,i-1)),n.push(o.sprintf("(0{1,4}:){1,%d}%s",i-1,e)),n.push(o.sprintf("(0{1,4}:){%d}0{1,4}",i-1));for(let a=1;a<i-1;a++)for(let l=1;l<i-a;l++)n.push(o.sprintf("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",l,i-l-a-1));return I(n)}function B(i){if(!i)throw new Error("Assertion failed.")}function U(i){const t=/(\d+)(\d{3})/;for(;t.test(i);)i=i.replace(t,"$1,$2");return i}function z(i){return i=i.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),i=i.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),i}function H(i,t){const s=[],r=[];let e;for(e=0;e<i.length;e++)e<t[0]?s.push(i[e]):e>t[1]&&r.push(i[e]);return s.concat(["compact"]).concat(r)}function R(i){return o.sprintf("%04x",parseInt(i,16))}function j(i){return i&255}class c{constructor(t,s){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=T,this.isCorrect=F(p),s===void 0?this.groups=g:this.groups=s,this.address=t;const r=y.exec(t);if(r){if(this.parsedSubnet=r[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet=`/${this.subnetMask}`,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>p)throw new f("Invalid subnet mask.");t=t.replace(y,"")}else if(/\//.test(t))throw new f("Invalid subnet mask.");const e=E.exec(t);e&&(this.zone=e[0],t=t.replace(E,"")),this.addressMinusSuffix=t,this.parsedAddress=this.parse(this.addressMinusSuffix)}static isValid(t){try{return new c(t),!0}catch{return!1}}static fromBigInteger(t){const s=t.toString(16).padStart(32,"0"),r=[];let e;for(e=0;e<g;e++)r.push(s.slice(e*4,(e+1)*4));return new c(r.join(":"))}static fromURL(t){let s,r=null,e;if(t.indexOf("[")!==-1&&t.indexOf("]:")!==-1){if(e=C.exec(t),e===null)return{error:"failed to parse address with port",address:null,port:null};s=e[1],r=e[2]}else if(t.indexOf("/")!==-1){if(t=t.replace(/^[a-z0-9]+:\/\//,""),e=L.exec(t),e===null)return{error:"failed to parse address from URL",address:null,port:null};s=e[1]}else s=t;return r?(r=parseInt(r,10),(r<0||r>65536)&&(r=null)):r=null,{address:new c(s),port:r}}static fromAddress4(t){const s=new h(t),r=p-(G-s.subnetMask);return new c(`::ffff:${s.correctForm()}/${r}`)}static fromArpa(t){let s=t.replace(/(\.ip6\.arpa)?\.$/,"");const r=7;if(s.length!==63)throw new f("Invalid 'ip6.arpa' form.");const e=s.split(".").reverse();for(let n=r;n>0;n--){const a=n*4;e.splice(a,0,":")}return s=e.join(""),new c(s)}microsoftTranscription(){return o.sprintf("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))}mask(t=this.subnetMask){return this.getBitsBase2(0,t)}possibleSubnets(t=128){const s=p-this.subnetMask,r=Math.abs(t-p),e=s-r;return e<0?"0":U(new u.exports.BigInteger("2",10).pow(e).toString(10))}_startAddress(){return new u.exports.BigInteger(this.mask()+"0".repeat(p-this.subnetMask),2)}startAddress(){return c.fromBigInteger(this._startAddress())}startAddressExclusive(){const t=new u.exports.BigInteger("1");return c.fromBigInteger(this._startAddress().add(t))}_endAddress(){return new u.exports.BigInteger(this.mask()+"1".repeat(p-this.subnetMask),2)}endAddress(){return c.fromBigInteger(this._endAddress())}endAddressExclusive(){const t=new u.exports.BigInteger("1");return c.fromBigInteger(this._endAddress().subtract(t))}getScope(){let t=N[this.getBits(12,16).intValue()];return this.getType()==="Global unicast"&&t!=="Link local"&&(t="Global"),t||"Unknown"}getType(){for(const t of Object.keys(A))if(this.isInSubnet(new c(t)))return A[t];return"Global unicast"}getBits(t,s){return new u.exports.BigInteger(this.getBitsBase2(t,s),2)}getBitsBase2(t,s){return this.binaryZeroPad().slice(t,s)}getBitsBase16(t,s){const r=s-t;if(r%4!==0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(t,s).toString(16).padStart(r/4,"0")}getBitsPastSubnet(){return this.getBitsBase2(this.subnetMask,p)}reverseForm(t){t||(t={});const s=Math.floor(this.subnetMask/4),r=this.canonicalForm().replace(/:/g,"").split("").slice(0,s).reverse().join(".");return s>0?t.omitSuffix?r:o.sprintf("%s.ip6.arpa.",r):t.omitSuffix?"":"ip6.arpa."}correctForm(){let t,s=[],r=0;const e=[];for(t=0;t<this.parsedAddress.length;t++){const l=parseInt(this.parsedAddress[t],16);l===0&&r++,l!==0&&r>0&&(r>1&&e.push([t-r,t-1]),r=0)}r>1&&e.push([this.parsedAddress.length-r,this.parsedAddress.length-1]);const n=e.map(l=>l[1]-l[0]+1);if(e.length>0){const l=n.indexOf(Math.max(...n));s=H(this.parsedAddress,e[l])}else s=this.parsedAddress;for(t=0;t<s.length;t++)s[t]!=="compact"&&(s[t]=parseInt(s[t],16).toString(16));let a=s.join(":");return a=a.replace(/^compact$/,"::"),a=a.replace(/^compact|compact$/,":"),a=a.replace(/compact/,""),a}binaryZeroPad(){return this.bigInteger().toString(2).padStart(p,"0")}parse4in6(t){const s=t.split(":"),e=s.slice(-1)[0].match(S);if(e){this.parsedAddress4=e[0],this.address4=new h(this.parsedAddress4);for(let n=0;n<this.address4.groups;n++)if(/^0[0-9]+/.test(this.address4.parsedAddress[n]))throw new f("IPv4 addresses can't have leading zeroes.",t.replace(S,this.address4.parsedAddress.map(z).join(".")));this.v4=!0,s[s.length-1]=this.address4.toGroup6(),t=s.join(":")}return t}parse(t){t=this.parse4in6(t);const s=t.match(v);if(s)throw new f(o.sprintf("Bad character%s detected in address: %s",s.length>1?"s":"",s.join("")),t.replace(v,'<span class="parse-error">$1</span>'));const r=t.match(M);if(r)throw new f(o.sprintf("Address failed regex: %s",r.join("")),t.replace(M,'<span class="parse-error">$1</span>'));let e=[];const n=t.split("::");if(n.length===2){let a=n[0].split(":"),l=n[1].split(":");a.length===1&&a[0]===""&&(a=[]),l.length===1&&l[0]===""&&(l=[]);const d=this.groups-(a.length+l.length);if(!d)throw new f("Error parsing groups");this.elidedGroups=d,this.elisionBegin=a.length,this.elisionEnd=a.length+this.elidedGroups,e=e.concat(a);for(let m=0;m<d;m++)e.push("0");e=e.concat(l)}else if(n.length===1)e=t.split(":"),this.elidedGroups=0;else throw new f("Too many :: groups found");if(e=e.map(a=>o.sprintf("%x",parseInt(a,16))),e.length!==this.groups)throw new f("Incorrect number of groups found");return e}canonicalForm(){return this.parsedAddress.map(R).join(":")}decimal(){return this.parsedAddress.map(t=>o.sprintf("%05d",parseInt(t,16))).join(":")}bigInteger(){return new u.exports.BigInteger(this.parsedAddress.map(R).join(""),16)}to4(){const t=this.binaryZeroPad().split("");return h.fromHex(new u.exports.BigInteger(t.slice(96,128).join(""),2).toString(16))}to4in6(){const t=this.to4(),r=new c(this.parsedAddress.slice(0,6).join(":"),6).correctForm();let e="";return/:$/.test(r)||(e=":"),r+e+t.address}inspectTeredo(){const t=this.getBitsBase16(0,32),s=this.getBits(80,96).xor(new u.exports.BigInteger("ffff",16)).toString(),r=h.fromHex(this.getBitsBase16(32,64)),e=h.fromHex(this.getBits(96,128).xor(new u.exports.BigInteger("ffffffff",16)).toString(16)),n=this.getBits(64,80),a=this.getBitsBase2(64,80),l=n.testBit(15),d=n.testBit(14),m=n.testBit(8),D=n.testBit(9),P=new u.exports.BigInteger(a.slice(2,6)+a.slice(8,16),2).toString(10);return{prefix:o.sprintf("%s:%s",t.slice(0,4),t.slice(4,8)),server4:r.address,client4:e.address,flags:a,coneNat:l,microsoft:{reserved:d,universalLocal:D,groupIndividual:m,nonce:P},udpPort:s}}inspect6to4(){const t=this.getBitsBase16(0,16),s=h.fromHex(this.getBitsBase16(16,48));return{prefix:o.sprintf("%s",t.slice(0,4)),gateway:s.address}}to6to4(){if(!this.is4())return null;const t=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new c(t)}toByteArray(){const t=this.bigInteger().toByteArray();return t.length===17&&t[0]===0?t.slice(1):t}toUnsignedByteArray(){return this.toByteArray().map(j)}static fromByteArray(t){return this.fromUnsignedByteArray(t.map(j))}static fromUnsignedByteArray(t){const s=new u.exports.BigInteger("256",10);let r=new u.exports.BigInteger("0",10),e=new u.exports.BigInteger("1",10);for(let n=t.length-1;n>=0;n--)r=r.add(e.multiply(new u.exports.BigInteger(t[n].toString(10),10))),e=e.multiply(s);return c.fromBigInteger(r)}isCanonical(){return this.addressMinusSuffix===this.canonicalForm()}isLinkLocal(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"}isMulticast(){return this.getType()==="Multicast"}is4(){return this.v4}isTeredo(){return this.isInSubnet(new c("2001::/32"))}is6to4(){return this.isInSubnet(new c("2002::/16"))}isLoopback(){return this.getType()==="Loopback"}href(t){return t===void 0?t="":t=o.sprintf(":%s",t),o.sprintf("http://[%s]%s/",this.correctForm(),t)}link(t){t||(t={}),t.className===void 0&&(t.className=""),t.prefix===void 0&&(t.prefix="/#address="),t.v4===void 0&&(t.v4=!1);let s=this.correctForm;return t.v4&&(s=this.to4in6),t.className?o.sprintf('<a href="%1$s%2$s" class="%3$s">%2$s</a>',t.prefix,s.call(this),t.className):o.sprintf('<a href="%1$s%2$s">%2$s</a>',t.prefix,s.call(this))}group(){if(this.elidedGroups===0)return b(this.address).join(":");B(typeof this.elidedGroups=="number"),B(typeof this.elisionBegin=="number");const t=[],[s,r]=this.address.split("::");s.length?t.push(...b(s)):t.push("");const e=["hover-group"];for(let n=this.elisionBegin;n<this.elisionBegin+this.elidedGroups;n++)e.push(o.sprintf("group-%d",n));return t.push(o.sprintf('<span class="%s"></span>',e.join(" "))),r.length?t.push(...b(r,this.elisionEnd)):t.push(""),this.is4()&&(B(this.address4 instanceof h),t.pop(),t.push(this.address4.groupForV6())),t.join(":")}regularExpressionString(t=!1){let s=[];const r=new c(this.correctForm());if(r.elidedGroups===0)s.push(w(r.parsedAddress));else if(r.elidedGroups===g)s.push($(g));else{const e=r.address.split("::");e[0].length&&s.push(w(e[0].split(":"))),B(typeof r.elidedGroups=="number"),s.push($(r.elidedGroups,e[0].length!==0,e[1].length!==0)),e[1].length&&s.push(w(e[1].split(":"))),s=[s.join(":")]}return t||(s=["(?=^|",k,"|[^\\w\\:])(",...s,")(?=[^\\w\\:]|",k,"|$)"]),s.join("")}regularExpression(t=!1){return new RegExp(this.regularExpressionString(t),"i")}}export{c as A};
