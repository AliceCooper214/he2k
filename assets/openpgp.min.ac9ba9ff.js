/*! OpenPGP.js v5.5.0 - 2022-08-31 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */const je=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},sn=Symbol("doneWritingPromise"),z2=Symbol("doneWritingResolve"),q2=Symbol("doneWritingReject"),Dn=Symbol("readingIndex");class Ar extends Array{constructor(){super(),this[sn]=new Promise((t,r)=>{this[z2]=t,this[q2]=r}),this[sn].catch(()=>{})}}function se(e){return e&&e.getReader&&Array.isArray(e)}function zn(e){if(!se(e)){const t=e.getWriter(),r=t.releaseLock;return t.releaseLock=()=>{t.closed.catch(function(){}),r.call(t)},t}this.stream=e}Ar.prototype.getReader=function(){return this[Dn]===void 0&&(this[Dn]=0),{read:async()=>(await this[sn],this[Dn]===this.length?{value:void 0,done:!0}:{value:this[this[Dn]++],done:!1})}},Ar.prototype.readToEnd=async function(e){await this[sn];const t=e(this.slice(this[Dn]));return this.length=0,t},Ar.prototype.clone=function(){const e=new Ar;return e[sn]=this[sn].then(()=>{e.push(...this)}),e},zn.prototype.write=async function(e){this.stream.push(e)},zn.prototype.close=async function(){this.stream[z2]()},zn.prototype.abort=async function(e){return this.stream[q2](e),e},zn.prototype.releaseLock=function(){};const qs=typeof je.process=="object"&&typeof je.process.versions=="object",X0=qs&&void 0;function ze(e){return se(e)?"array":je.ReadableStream&&je.ReadableStream.prototype.isPrototypeOf(e)?"web":$r&&$r.prototype.isPrototypeOf(e)?"ponyfill":X0&&X0.prototype.isPrototypeOf(e)?"node":!(!e||!e.getReader)&&"web-like"}function Fs(e){return Uint8Array.prototype.isPrototypeOf(e)}function F2(e){if(e.length===1)return e[0];let t=0;for(let n=0;n<e.length;n++){if(!Fs(e[n]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");t+=e[n].length}const r=new Uint8Array(t);let i=0;return e.forEach(function(n){r.set(n,i),i+=n.length}),r}const N3=qs&&void 0,Q0=qs&&void 0;let Os,m0;if(Q0){Os=function(t){let r=!1;return new $r({start(i){t.pause(),t.on("data",n=>{r||(N3.isBuffer(n)&&(n=new Uint8Array(n.buffer,n.byteOffset,n.byteLength)),i.enqueue(n),t.pause())}),t.on("end",()=>{r||i.close()}),t.on("error",n=>i.error(n))},pull(){t.resume()},cancel(i){r=!0,t.destroy(i)}})};class e extends Q0{constructor(r,i){super(i),this._reader=Ur(r)}async _read(r){try{for(;;){const{done:i,value:n}=await this._reader.read();if(i){this.push(null);break}if(!this.push(n)||this._cancelling){this._reading=!1;break}}}catch(i){this.emit("error",i)}}_destroy(r){this._reader.cancel(r)}}m0=function(t,r){return new e(t,r)}}const J0=new WeakSet,Jt=Symbol("externalBuffer");function lr(e){if(this.stream=e,e[Jt]&&(this[Jt]=e[Jt].slice()),se(e)){const i=e.getReader();return this._read=i.read.bind(i),this._releaseLock=()=>{},void(this._cancel=()=>{})}let t=ze(e);if(t==="node"&&(e=Os(e)),t){const i=e.getReader();return this._read=i.read.bind(i),this._releaseLock=()=>{i.closed.catch(function(){}),i.releaseLock()},void(this._cancel=i.cancel.bind(i))}let r=!1;this._read=async()=>r||J0.has(e)?{value:void 0,done:!0}:(r=!0,{value:e,done:!1}),this._releaseLock=()=>{if(r)try{J0.add(e)}catch{}}}lr.prototype.read=async function(){return this[Jt]&&this[Jt].length?{done:!1,value:this[Jt].shift()}:this._read()},lr.prototype.releaseLock=function(){this[Jt]&&(this.stream[Jt]=this[Jt]),this._releaseLock()},lr.prototype.cancel=function(e){return this._cancel(e)},lr.prototype.readLine=async function(){let e,t=[];for(;!e;){let{done:r,value:i}=await this.read();if(i+="",r)return t.length?De(t):void 0;const n=i.indexOf(`
`)+1;n&&(e=De(t.concat(i.substr(0,n))),t=[]),n!==i.length&&t.push(i.substr(n))}return this.unshift(...t),e},lr.prototype.readByte=async function(){const{done:e,value:t}=await this.read();if(e)return;const r=t[0];return this.unshift(me(t,1)),r},lr.prototype.readBytes=async function(e){const t=[];let r=0;for(;;){const{done:i,value:n}=await this.read();if(i)return t.length?De(t):void 0;if(t.push(n),r+=n.length,r>=e){const a=De(t);return this.unshift(me(a,e)),me(a,0,e)}}},lr.prototype.peekBytes=async function(e){const t=await this.readBytes(e);return this.unshift(t),t},lr.prototype.unshift=function(...e){this[Jt]||(this[Jt]=[]),e.length===1&&Fs(e[0])&&this[Jt].length&&e[0].length&&this[Jt][0].byteOffset>=e[0].length?this[Jt][0]=new Uint8Array(this[Jt][0].buffer,this[Jt][0].byteOffset-e[0].length,this[Jt][0].byteLength+e[0].length):this[Jt].unshift(...e.filter(t=>t&&t.length))},lr.prototype.readToEnd=async function(e=De){const t=[];for(;;){const{done:r,value:i}=await this.read();if(r)break;t.push(i)}return e(t)};let Fo,O2,{ReadableStream:$r,WritableStream:N2,TransformStream:mn}=je;async function L2(){if(mn)return;const[e,t]=await Promise.all([Promise.resolve().then(function(){return bd}),Promise.resolve().then(function(){return _d})]);({ReadableStream:$r,WritableStream:N2,TransformStream:mn}=e);const{createReadableStreamWrapper:r}=t;je.ReadableStream&&$r!==je.ReadableStream&&(Fo=r($r),O2=r(je.ReadableStream))}const Yn=qs&&void 0;function ma(e){let t=ze(e);return t==="node"?Os(e):t==="web"&&Fo?Fo(e):t?e:new $r({start(r){r.enqueue(e),r.close()}})}function j2(e){if(ze(e))return e;const t=new Ar;return(async()=>{const r=qe(t);await r.write(e),await r.close()})(),t}function De(e){return e.some(t=>ze(t)&&!se(t))?function(t){t=t.map(ma);const r=H2(async function(a){await Promise.all(n.map(s=>Oo(s,a)))});let i=Promise.resolve();const n=t.map((a,s)=>Rr(a,(o,u)=>(i=i.then(()=>Zr(o,r.writable,{preventClose:s!==t.length-1})),i)));return r.readable}(e):e.some(t=>se(t))?function(t){const r=new Ar;let i=Promise.resolve();return t.forEach((n,a)=>(i=i.then(()=>Zr(n,r,{preventClose:a!==t.length-1})),i)),r}(e):typeof e[0]=="string"?e.join(""):Yn&&Yn.isBuffer(e[0])?Yn.concat(e):F2(e)}function Ur(e){return new lr(e)}function qe(e){return new zn(e)}async function Zr(e,t,{preventClose:r=!1,preventAbort:i=!1,preventCancel:n=!1}={}){if(ze(e)&&!se(e)){e=ma(e);try{if(e[Jt]){const o=qe(t);for(let u=0;u<e[Jt].length;u++)await o.ready,await o.write(e[Jt][u]);o.releaseLock()}await e.pipeTo(t,{preventClose:r,preventAbort:i,preventCancel:n})}catch{}return}const a=Ur(e=j2(e)),s=qe(t);try{for(;;){await s.ready;const{done:o,value:u}=await a.read();if(o){r||await s.close();break}await s.write(u)}}catch(o){i||await s.abort(o)}finally{a.releaseLock(),s.releaseLock()}}function W2(e,t){const r=new mn(t);return Zr(e,r.writable),r.readable}function H2(e){let t,r,i=!1;return{readable:new $r({start(n){r=n},pull(){t?t():i=!0},cancel:e},{highWaterMark:0}),writable:new N2({write:async function(n){r.enqueue(n),i?i=!1:(await new Promise(a=>{t=a}),t=null)},close:r.close.bind(r),abort:r.error.bind(r)})}}function ne(e,t=()=>{},r=()=>{}){if(se(e)){const a=new Ar;return(async()=>{const s=qe(a);try{const o=await ae(e),u=t(o),c=r();let h;h=u!==void 0&&c!==void 0?De([u,c]):u!==void 0?u:c,await s.write(h),await s.close()}catch(o){await s.abort(o)}})(),a}if(ze(e))return W2(e,{async transform(a,s){try{const o=await t(a);o!==void 0&&s.enqueue(o)}catch(o){s.error(o)}},async flush(a){try{const s=await r();s!==void 0&&a.enqueue(s)}catch(s){a.error(s)}}});const i=t(e),n=r();return i!==void 0&&n!==void 0?De([i,n]):i!==void 0?i:n}function Rr(e,t){if(ze(e)&&!se(e)){let i;const n=new mn({start(o){i=o}}),a=Zr(e,n.writable),s=H2(async function(o){i.error(o),await a,await new Promise(setTimeout)});return t(n.readable,s.writable),s.readable}e=j2(e);const r=new Ar;return t(e,r),r}function Ns(e,t){let r;const i=Rr(e,(n,a)=>{const s=Ur(n);s.remainder=()=>(s.releaseLock(),Zr(n,a),i),r=t(s)});return r}function Vi(e){if(se(e))return e.clone();if(ze(e)){const t=function(r){if(se(r))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(ze(r)){const i=ma(r).tee();return i[0][Jt]=i[1][Jt]=r[Jt],i}return[me(r),me(r)]}(e);return G2(e,t[0]),t[1]}return me(e)}function fn(e){return se(e)?Vi(e):ze(e)?new $r({start(t){const r=Rr(e,async(i,n)=>{const a=Ur(i),s=qe(n);try{for(;;){await s.ready;const{done:o,value:u}=await a.read();if(o){try{t.close()}catch{}return void await s.close()}try{t.enqueue(u)}catch{}await s.write(u)}}catch(o){t.error(o),await s.abort(o)}});G2(e,r)}}):me(e)}function G2(e,t){Object.entries(Object.getOwnPropertyDescriptors(e.constructor.prototype)).forEach(([r,i])=>{r!=="constructor"&&(i.value?i.value=i.value.bind(t):i.get=i.get.bind(t),Object.defineProperty(e,r,i))})}function me(e,t=0,r=1/0){if(se(e))throw Error("Not implemented");if(ze(e)){if(t>=0&&r>=0){let i=0;return W2(e,{transform(n,a){i<r?(i+n.length>=t&&a.enqueue(me(n,Math.max(t-i,0),r-i)),i+=n.length):a.terminate()}})}if(t<0&&(r<0||r===1/0)){let i=[];return ne(e,n=>{n.length>=-t?i=[n]:i.push(n)},()=>me(De(i),t,r))}if(t===0&&r<0){let i;return ne(e,n=>{const a=i?De([i,n]):n;if(a.length>=-r)return i=me(a,r),me(a,t,r);i=a})}return console.warn(`stream.slice(input, ${t}, ${r}) not implemented efficiently.`),Jr(async()=>me(await ae(e),t,r))}return e[Jt]&&(e=De(e[Jt].concat([e]))),!Fs(e)||Yn&&Yn.isBuffer(e)?e.slice(t,r):(r===1/0&&(r=e.length),e.subarray(t,r))}async function ae(e,t=De){return se(e)?e.readToEnd(t):ze(e)?Ur(e).readToEnd(t):e}async function Oo(e,t){if(ze(e)){if(e.cancel)return e.cancel(t);if(e.destroy)return e.destroy(t),await new Promise(setTimeout),t}}function Jr(e){const t=new Ar;return(async()=>{const r=qe(t);try{await r.write(await e()),await r.close()}catch(i){await r.abort(i)}})(),t}class Ce{constructor(t){if(t===void 0)throw Error("Invalid BigInteger input");if(t instanceof Uint8Array){const r=t,i=Array(r.length);for(let n=0;n<r.length;n++){const a=r[n].toString(16);i[n]=r[n]<=15?"0"+a:a}this.value=BigInt("0x0"+i.join(""))}else this.value=BigInt(t)}clone(){return new Ce(this.value)}iinc(){return this.value++,this}inc(){return this.clone().iinc()}idec(){return this.value--,this}dec(){return this.clone().idec()}iadd(t){return this.value+=t.value,this}add(t){return this.clone().iadd(t)}isub(t){return this.value-=t.value,this}sub(t){return this.clone().isub(t)}imul(t){return this.value*=t.value,this}mul(t){return this.clone().imul(t)}imod(t){return this.value%=t.value,this.isNegative()&&this.iadd(t),this}mod(t){return this.clone().imod(t)}modExp(t,r){if(r.isZero())throw Error("Modulo cannot be zero");if(r.isOne())return new Ce(0);if(t.isNegative())throw Error("Unsopported negative exponent");let i=t.value,n=this.value;n%=r.value;let a=BigInt(1);for(;i>BigInt(0);){const s=i&BigInt(1);i>>=BigInt(1);const o=a*n%r.value;a=s?o:a,n=n*n%r.value}return new Ce(a)}modInv(t){const{gcd:r,x:i}=this._egcd(t);if(!r.isOne())throw Error("Inverse does not exist");return i.add(t).mod(t)}_egcd(t){let r=BigInt(0),i=BigInt(1),n=BigInt(1),a=BigInt(0),s=this.value;for(t=t.value;t!==BigInt(0);){const o=s/t;let u=r;r=n-o*r,n=u,u=i,i=a-o*i,a=u,u=t,t=s%t,s=u}return{x:new Ce(n),y:new Ce(a),gcd:new Ce(s)}}gcd(t){let r=this.value;for(t=t.value;t!==BigInt(0);){const i=t;t=r%t,r=i}return new Ce(r)}ileftShift(t){return this.value<<=t.value,this}leftShift(t){return this.clone().ileftShift(t)}irightShift(t){return this.value>>=t.value,this}rightShift(t){return this.clone().irightShift(t)}equal(t){return this.value===t.value}lt(t){return this.value<t.value}lte(t){return this.value<=t.value}gt(t){return this.value>t.value}gte(t){return this.value>=t.value}isZero(){return this.value===BigInt(0)}isOne(){return this.value===BigInt(1)}isNegative(){return this.value<BigInt(0)}isEven(){return!(this.value&BigInt(1))}abs(){const t=this.clone();return this.isNegative()&&(t.value=-t.value),t}toString(){return this.value.toString()}toNumber(){const t=Number(this.value);if(t>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return t}getBit(t){return(this.value>>BigInt(t)&BigInt(1))===BigInt(0)?0:1}bitLength(){const t=new Ce(0),r=new Ce(1),i=new Ce(-1),n=this.isNegative()?i:t;let a=1;const s=this.clone();for(;!s.irightShift(r).equal(n);)a++;return a}byteLength(){const t=new Ce(0),r=new Ce(-1),i=this.isNegative()?r:t,n=new Ce(8);let a=1;const s=this.clone();for(;!s.irightShift(n).equal(i);)a++;return a}toUint8Array(t="be",r){let i=this.value.toString(16);i.length%2==1&&(i="0"+i);const n=i.length/2,a=new Uint8Array(r||n),s=r?r-n:0;let o=0;for(;o<n;)a[o+s]=parseInt(i.slice(2*o,2*o+2),16),o++;return t!=="be"&&a.reverse(),a}}const t1=(()=>{try{return!1}catch{}return!1})(),x={isString:function(e){return typeof e=="string"||String.prototype.isPrototypeOf(e)},isArray:function(e){return Array.prototype.isPrototypeOf(e)},isUint8Array:Fs,isStream:ze,readNumber:function(e){let t=0;for(let r=0;r<e.length;r++)t+=256**r*e[e.length-1-r];return t},writeNumber:function(e,t){const r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e>>8*(t-i-1)&255;return r},readDate:function(e){const t=x.readNumber(e);return new Date(1e3*t)},writeDate:function(e){const t=Math.floor(e.getTime()/1e3);return x.writeNumber(t,4)},normalizeDate:function(e=Date.now()){return e===null||e===1/0?e:new Date(1e3*Math.floor(+e/1e3))},readMPI:function(e){const t=(e[0]<<8|e[1])+7>>>3;return e.subarray(2,2+t)},leftPad(e,t){const r=new Uint8Array(t),i=t-e.length;return r.set(e,i),r},uint8ArrayToMPI:function(e){const t=x.uint8ArrayBitLength(e);if(t===0)throw Error("Zero MPI");const r=e.subarray(e.length-Math.ceil(t/8)),i=new Uint8Array([(65280&t)>>8,255&t]);return x.concatUint8Array([i,r])},uint8ArrayBitLength:function(e){let t;for(t=0;t<e.length&&e[t]===0;t++);if(t===e.length)return 0;const r=e.subarray(t);return 8*(r.length-1)+x.nbits(r[0])},hexToUint8Array:function(e){const t=new Uint8Array(e.length>>1);for(let r=0;r<e.length>>1;r++)t[r]=parseInt(e.substr(r<<1,2),16);return t},uint8ArrayToHex:function(e){const t=[],r=e.length;let i,n=0;for(;n<r;){for(i=e[n++].toString(16);i.length<2;)i="0"+i;t.push(""+i)}return t.join("")},stringToUint8Array:function(e){return ne(e,t=>{if(!x.isString(t))throw Error("stringToUint8Array: Data must be in the form of a string");const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})},uint8ArrayToString:function(e){const t=[],i=(e=new Uint8Array(e)).length;for(let n=0;n<i;n+=16384)t.push(String.fromCharCode.apply(String,e.subarray(n,n+16384<i?n+16384:i)));return t.join("")},encodeUTF8:function(e){const t=new TextEncoder("utf-8");function r(i,n=!1){return t.encode(i,{stream:!n})}return ne(e,r,()=>r("",!0))},decodeUTF8:function(e){const t=new TextDecoder("utf-8");function r(i,n=!1){return t.decode(i,{stream:!n})}return ne(e,r,()=>r(new Uint8Array,!0))},concat:De,concatUint8Array:F2,equalsUint8Array:function(e,t){if(!x.isUint8Array(e)||!x.isUint8Array(t))throw Error("Data must be in the form of a Uint8Array");if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},writeChecksum:function(e){let t=0;for(let r=0;r<e.length;r++)t=t+e[r]&65535;return x.writeNumber(t,2)},printDebug:function(e){t1&&console.log("[OpenPGP.js debug]",e)},printDebugError:function(e){t1&&console.error("[OpenPGP.js debug]",e)},nbits:function(e){let t=1,r=e>>>16;return r!==0&&(e=r,t+=16),r=e>>8,r!==0&&(e=r,t+=8),r=e>>4,r!==0&&(e=r,t+=4),r=e>>2,r!==0&&(e=r,t+=2),r=e>>1,r!==0&&(e=r,t+=1),t},double:function(e){const t=new Uint8Array(e.length),r=e.length-1;for(let i=0;i<r;i++)t[i]=e[i]<<1^e[i+1]>>7;return t[r]=e[r]<<1^135*(e[0]>>7),t},shiftRight:function(e,t){if(t)for(let r=e.length-1;r>=0;r--)e[r]>>=t,r>0&&(e[r]|=e[r-1]<<8-t);return e},getWebCrypto:function(){return je!==void 0&&je.crypto&&je.crypto.subtle},detectBigInt:()=>typeof BigInt<"u",getBigInteger:async function(){if(x.detectBigInt())return Ce;{const{default:e}=await Promise.resolve().then(function(){return kd});return e}},getNodeCrypto:function(){},getNodeZlib:function(){},getNodeBuffer:function(){return{}.Buffer},getHardwareConcurrency:function(){return typeof navigator<"u"?navigator.hardwareConcurrency||1:(void 0).cpus().length},isEmailAddress:function(e){return x.isString(e)?/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+([a-zA-Z]{2,}|xn--[a-zA-Z\-0-9]+)))$/.test(e):!1},canonicalizeEOL:function(e){let t=!1;return ne(e,r=>{let i;t&&(r=x.concatUint8Array([new Uint8Array([13]),r])),r[r.length-1]===13?(t=!0,r=r.subarray(0,-1)):t=!1;const n=[];for(let o=0;i=r.indexOf(10,o)+1,i;o=i)r[i-2]!==13&&n.push(i);if(!n.length)return r;const a=new Uint8Array(r.length+n.length);let s=0;for(let o=0;o<n.length;o++){const u=r.subarray(n[o-1]||0,n[o]);a.set(u,s),s+=u.length,a[s-1]=13,a[s]=10,s++}return a.set(r.subarray(n[n.length-1]||0),s),a},()=>t?new Uint8Array([13]):void 0)},nativeEOL:function(e){let t=!1;return ne(e,r=>{let i;(r=t&&r[0]!==10?x.concatUint8Array([new Uint8Array([13]),r]):new Uint8Array(r))[r.length-1]===13?(t=!0,r=r.subarray(0,-1)):t=!1;let n=0;for(let a=0;a!==r.length;a=i){i=r.indexOf(13,a)+1,i||(i=r.length);const s=i-(r[i]===10?1:0);a&&r.copyWithin(n,a,s),n+=s-a}return r.subarray(0,n)},()=>t?new Uint8Array([13]):void 0)},removeTrailingSpaces:function(e){return e.split(`
`).map(t=>{let r=t.length-1;for(;r>=0&&(t[r]===" "||t[r]==="	"||t[r]==="\r");r--);return t.substr(0,r+1)}).join(`
`)},wrapError:function(e,t){if(!t)return Error(e);try{t.message=e+": "+t.message}catch{}return t},constructAllowedPackets:function(e){const t={};return e.forEach(r=>{if(!r.tag)throw Error("Invalid input: expected a packet class");t[r.tag]=r}),t},anyPromise:function(e){return new Promise(async(t,r)=>{let i;await Promise.all(e.map(async n=>{try{t(await n)}catch(a){i=a}})),r(i)})},selectUint8Array:function(e,t,r){const i=Math.max(t.length,r.length),n=new Uint8Array(i);let a=0;for(let s=0;s<n.length;s++)n[s]=t[s]&256-e|r[s]&255+e,a+=e&s<t.length|1-e&s<r.length;return n.subarray(0,a)},selectUint8:function(e,t,r){return t&256-e|r&255+e}},ho=x.getNodeBuffer();let rs,is;function Or(e){let t=new Uint8Array;return ne(e,r=>{t=x.concatUint8Array([t,r]);const i=[],n=Math.floor(t.length/45),a=45*n,s=rs(t.subarray(0,a));for(let o=0;o<n;o++)i.push(s.substr(60*o,60)),i.push(`
`);return t=t.subarray(a),i.join("")},()=>t.length?rs(t)+`
`:"")}function V2(e){let t="";return ne(e,r=>{t+=r;let i=0;const n=[" ","	","\r",`
`];for(let o=0;o<n.length;o++){const u=n[o];for(let c=t.indexOf(u);c!==-1;c=t.indexOf(u,c+1))i++}let a=t.length;for(;a>0&&(a-i)%4!=0;a--)n.includes(t[a])&&i--;const s=is(t.substr(0,a));return t=t.substr(a),s},()=>is(t))}function Lr(e){return V2(e.replace(/-/g,"+").replace(/_/g,"/"))}function Ne(e,t){let r=Or(e).replace(/[\r\n]/g,"");return t&&(r=r.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,"")),r}ho?(rs=e=>ho.from(e).toString("base64"),is=e=>{const t=ho.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}):(rs=e=>btoa(x.uint8ArrayToString(e)),is=e=>x.stringToUint8Array(atob(e)));const Kn=Symbol("byValue");var v={curve:{p256:"p256","P-256":"p256",secp256r1:"p256",prime256v1:"p256","1.2.840.10045.3.1.7":"p256","2a8648ce3d030107":"p256","2A8648CE3D030107":"p256",p384:"p384","P-384":"p384",secp384r1:"p384","1.3.132.0.34":"p384","2b81040022":"p384","2B81040022":"p384",p521:"p521","P-521":"p521",secp521r1:"p521","1.3.132.0.35":"p521","2b81040023":"p521","2B81040023":"p521",secp256k1:"secp256k1","1.3.132.0.10":"secp256k1","2b8104000a":"secp256k1","2B8104000A":"secp256k1",ED25519:"ed25519",ed25519:"ed25519",Ed25519:"ed25519","1.3.6.1.4.1.11591.15.1":"ed25519","2b06010401da470f01":"ed25519","2B06010401DA470F01":"ed25519",X25519:"curve25519",cv25519:"curve25519",curve25519:"curve25519",Curve25519:"curve25519","1.3.6.1.4.1.3029.1.5.1":"curve25519","2b060104019755010501":"curve25519","2B060104019755010501":"curve25519",brainpoolP256r1:"brainpoolP256r1","1.3.36.3.3.2.8.1.1.7":"brainpoolP256r1","2b2403030208010107":"brainpoolP256r1","2B2403030208010107":"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1","1.3.36.3.3.2.8.1.1.11":"brainpoolP384r1","2b240303020801010b":"brainpoolP384r1","2B240303020801010B":"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1","1.3.36.3.3.2.8.1.1.13":"brainpoolP512r1","2b240303020801010d":"brainpoolP512r1","2B240303020801010D":"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsa:22,aedh:23,aedsa:24},symmetric:{plaintext:0,idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuer:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4},write:function(e,t){if(typeof t=="number"&&(t=this.read(e,t)),e[t]!==void 0)return e[t];throw Error("Invalid enum value.")},read:function(e,t){if(e[Kn]||(e[Kn]=[],Object.entries(e).forEach(([r,i])=>{e[Kn][i]=r})),e[Kn][t]!==void 0)return e[Kn][t];throw Error("Invalid enum value.")}},vt={preferredHashAlgorithm:v.hash.sha256,preferredSymmetricAlgorithm:v.symmetric.aes256,preferredCompressionAlgorithm:v.compression.uncompressed,deflateLevel:6,aeadProtect:!1,preferredAEADAlgorithm:v.aead.eax,aeadChunkSizeByte:12,v5Keys:!1,s2kIterationCountByte:224,allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,checksumRequired:!1,minRSABits:2047,passwordCollisionCheck:!1,revocationsExpire:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([v.symmetric.aes128,v.symmetric.aes192,v.symmetric.aes256]),minBytesForWebCrypto:1e3,ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,showVersion:!1,showComment:!1,versionString:"OpenPGP.js 5.5.0",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:["preferred-email-encoding@pgp.com","pka-address@gnupg.org"],useIndutnyElliptic:!0,rejectHashAlgorithms:new Set([v.hash.md5,v.hash.ripemd]),rejectMessageHashAlgorithms:new Set([v.hash.md5,v.hash.ripemd,v.hash.sha1]),rejectPublicKeyAlgorithms:new Set([v.publicKey.elgamal,v.publicKey.dsa]),rejectCurves:new Set([v.curve.brainpoolP256r1,v.curve.brainpoolP384r1,v.curve.brainpoolP512r1,v.curve.secp256k1])};function L3(e){const t=e.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!t)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(t[1])?v.armor.multipartSection:/MESSAGE, PART \d+/.test(t[1])?v.armor.multipartLast:/SIGNED MESSAGE/.test(t[1])?v.armor.signed:/MESSAGE/.test(t[1])?v.armor.message:/PUBLIC KEY BLOCK/.test(t[1])?v.armor.publicKey:/PRIVATE KEY BLOCK/.test(t[1])?v.armor.privateKey:/SIGNATURE/.test(t[1])?v.armor.signature:void 0}function Di(e,t){let r="";return t.showVersion&&(r+="Version: "+t.versionString+`
`),t.showComment&&(r+="Comment: "+t.commentString+`
`),e&&(r+="Comment: "+e+`
`),r+=`
`,r}function ci(e){return Or(function(t){let r=13501623;return ne(t,i=>{const n=j3?Math.floor(i.length/4):0,a=new Uint32Array(i.buffer,i.byteOffset,n);for(let s=0;s<n;s++)r^=a[s],r=le[0][r>>24&255]^le[1][r>>16&255]^le[2][r>>8&255]^le[3][r>>0&255];for(let s=4*n;s<i.length;s++)r=r>>8^le[0][255&r^i[s]]},()=>new Uint8Array([r,r>>8,r>>16]))}(e))}const le=[Array(255),Array(255),Array(255),Array(255)];for(let e=0;e<=255;e++){let t=e<<16;for(let r=0;r<8;r++)t=t<<1^((8388608&t)!=0?8801531:0);le[0][e]=(16711680&t)>>16|65280&t|(255&t)<<16}for(let e=0;e<=255;e++)le[1][e]=le[0][e]>>8^le[0][255&le[0][e]];for(let e=0;e<=255;e++)le[2][e]=le[1][e]>>8^le[0][255&le[1][e]];for(let e=0;e<=255;e++)le[3][e]=le[2][e]>>8^le[0][255&le[2][e]];const j3=function(){const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,255,!0),new Int16Array(e)[0]===255}();function e1(e){for(let t=0;t<e.length;t++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(e[t])||x.printDebugError(Error("Improperly formatted armor header: "+e[t])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(e[t])||x.printDebugError(Error("Unknown header: "+e[t]))}function W3(e){let t=e,r="";const i=e.lastIndexOf("=");return i>=0&&i!==e.length-1&&(t=e.slice(0,i),r=e.slice(i+1).substr(0,4)),{body:t,checksum:r}}function ga(e,t=vt){return new Promise(async(r,i)=>{try{const n=/^-----[^-]+-----$/m,a=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/;let s;const o=[];let u,c,h,f=o,m=[],y=V2(Rr(e,async(K,I)=>{const U=Ur(K);try{for(;;){let Z=await U.readLine();if(Z===void 0)throw Error("Misformed armored text");if(Z=x.removeTrailingSpaces(Z.replace(/[\r\n]/g,"")),s)if(u)c||s!==2||(n.test(Z)?(m=m.join(`\r
`),c=!0,e1(f),f=[],u=!1):m.push(Z.replace(/^- /,"")));else if(n.test(Z)&&i(Error("Mandatory blank line missing between armor headers and armor data")),a.test(Z)){if(e1(f),u=!0,c||s!==2){r({text:m,data:y,headers:o,type:s});break}}else f.push(Z);else n.test(Z)&&(s=L3(Z))}}catch(Z){return void i(Z)}const V=qe(I);try{for(;;){await V.ready;const{done:Z,value:$}=await U.read();if(Z)throw Error("Misformed armored text");const R=$+"";if(R.indexOf("=")!==-1||R.indexOf("-")!==-1){let tt=await U.readToEnd();tt.length||(tt=""),tt=R+tt,tt=x.removeTrailingSpaces(tt.replace(/\r/g,""));const X=tt.split(n);if(X.length===1)throw Error("Misformed armored text");const Q=W3(X[0].slice(0,-1));h=Q.checksum,await V.write(Q.body);break}await V.write(R)}await V.ready,await V.close()}catch(Z){await V.abort(Z)}}));y=Rr(y,async(K,I)=>{const U=ae(ci(fn(K)));U.catch(()=>{}),await Zr(K,I,{preventClose:!0});const V=qe(I);try{const Z=(await U).replace(`
`,"");if(h!==Z&&(h||t.checksumRequired))throw Error("Ascii armor integrity check failed");await V.ready,await V.close()}catch(Z){await V.abort(Z)}})}catch(n){i(n)}}).then(async r=>(se(r.data)&&(r.data=await ae(r.data)),r))}function Sn(e,t,r,i,n,a=vt){let s,o;e===v.armor.signed&&(s=t.text,o=t.hash,t=t.data);const u=fn(t),c=[];switch(e){case v.armor.multipartSection:c.push("-----BEGIN PGP MESSAGE, PART "+r+"/"+i+`-----
`),c.push(Di(n,a)),c.push(Or(t)),c.push("=",ci(u)),c.push("-----END PGP MESSAGE, PART "+r+"/"+i+`-----
`);break;case v.armor.multipartLast:c.push("-----BEGIN PGP MESSAGE, PART "+r+`-----
`),c.push(Di(n,a)),c.push(Or(t)),c.push("=",ci(u)),c.push("-----END PGP MESSAGE, PART "+r+`-----
`);break;case v.armor.signed:c.push(`-----BEGIN PGP SIGNED MESSAGE-----
`),c.push("Hash: "+o+`

`),c.push(s.replace(/^-/gm,"- -")),c.push(`
-----BEGIN PGP SIGNATURE-----
`),c.push(Di(n,a)),c.push(Or(t)),c.push("=",ci(u)),c.push(`-----END PGP SIGNATURE-----
`);break;case v.armor.message:c.push(`-----BEGIN PGP MESSAGE-----
`),c.push(Di(n,a)),c.push(Or(t)),c.push("=",ci(u)),c.push(`-----END PGP MESSAGE-----
`);break;case v.armor.publicKey:c.push(`-----BEGIN PGP PUBLIC KEY BLOCK-----
`),c.push(Di(n,a)),c.push(Or(t)),c.push("=",ci(u)),c.push(`-----END PGP PUBLIC KEY BLOCK-----
`);break;case v.armor.privateKey:c.push(`-----BEGIN PGP PRIVATE KEY BLOCK-----
`),c.push(Di(n,a)),c.push(Or(t)),c.push("=",ci(u)),c.push(`-----END PGP PRIVATE KEY BLOCK-----
`);break;case v.armor.signature:c.push(`-----BEGIN PGP SIGNATURE-----
`),c.push(Di(n,a)),c.push(Or(t)),c.push("=",ci(u)),c.push(`-----END PGP SIGNATURE-----
`)}return x.concat(c)}class Ai{constructor(){this.bytes=""}read(t){this.bytes=x.uint8ArrayToString(t.subarray(0,8))}write(){return x.stringToUint8Array(this.bytes)}toHex(){return x.uint8ArrayToHex(x.stringToUint8Array(this.bytes))}equals(t,r=!1){return r&&(t.isWildcard()||this.isWildcard())||this.bytes===t.bytes}isNull(){return this.bytes===""}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(t){return t.toHex()}static fromID(t){const r=new Ai;return r.read(x.hexToUint8Array(t)),r}static wildcard(){const t=new Ai;return t.read(new Uint8Array(8)),t}}var Nt=function(){var e,t,r=!1;function i(f,m){var y=e[(t[f]+t[m])%255];return f!==0&&m!==0||(y=0),y}var n,a,s,o,u=!1;function c(){function f(I){var U,V,Z;for(V=Z=function($){var R=e[255-t[$]];return $===0&&(R=0),R}(I),U=0;U<4;U++)Z^=V=255&(V<<1|V>>>7);return Z^=99}r||function(){e=[],t=[];var I,U,V=1;for(I=0;I<255;I++)e[I]=V,U=128&V,V<<=1,V&=255,U===128&&(V^=27),V^=e[I],t[e[I]]=I;e[255]=e[0],t[0]=0,r=!0}(),n=[],a=[],s=[[],[],[],[]],o=[[],[],[],[]];for(var m=0;m<256;m++){var y=f(m);n[m]=y,a[y]=m,s[0][m]=i(2,y)<<24|y<<16|y<<8|i(3,y),o[0][y]=i(14,m)<<24|i(9,m)<<16|i(13,m)<<8|i(11,m);for(var K=1;K<4;K++)s[K][m]=s[K-1][m]>>>8|s[K-1][m]<<24,o[K][y]=o[K-1][y]>>>8|o[K-1][y]<<24}u=!0}var h=function(f,m){u||c();var y=new Uint32Array(m);y.set(n,512),y.set(a,768);for(var K=0;K<4;K++)y.set(s[K],4096+1024*K>>2),y.set(o[K],8192+1024*K>>2);var I=function(U,V,Z){var $=0,R=0,tt=0,X=0,Q=0,d=0,b=0,_=0,g=0,p=0,S=0,D=0,nt=0,st=0,q=0,rt=0,ct=0,dt=0,ut=0,ft=0,gt=0,mt=new U.Uint32Array(Z),B=new U.Uint8Array(Z);function Y(P,E,bt,ht,Pt,Lt,Dt,Ct){P=P|0,E=E|0,bt=bt|0,ht=ht|0,Pt=Pt|0,Lt=Lt|0,Dt=Dt|0,Ct=Ct|0;var Xt=0,zt=0,Ot=0,oe=0,Mt=0,Rt=0,jt=0,Et=0;for(Xt=bt|1024,zt=bt|2048,Ot=bt|3072,Pt=Pt^mt[(P|0)>>2],Lt=Lt^mt[(P|4)>>2],Dt=Dt^mt[(P|8)>>2],Ct=Ct^mt[(P|12)>>2],Et=16;(Et|0)<=ht<<4;Et=Et+16|0)oe=mt[(bt|Pt>>22&1020)>>2]^mt[(Xt|Lt>>14&1020)>>2]^mt[(zt|Dt>>6&1020)>>2]^mt[(Ot|Ct<<2&1020)>>2]^mt[(P|Et|0)>>2],Mt=mt[(bt|Lt>>22&1020)>>2]^mt[(Xt|Dt>>14&1020)>>2]^mt[(zt|Ct>>6&1020)>>2]^mt[(Ot|Pt<<2&1020)>>2]^mt[(P|Et|4)>>2],Rt=mt[(bt|Dt>>22&1020)>>2]^mt[(Xt|Ct>>14&1020)>>2]^mt[(zt|Pt>>6&1020)>>2]^mt[(Ot|Lt<<2&1020)>>2]^mt[(P|Et|8)>>2],jt=mt[(bt|Ct>>22&1020)>>2]^mt[(Xt|Pt>>14&1020)>>2]^mt[(zt|Lt>>6&1020)>>2]^mt[(Ot|Dt<<2&1020)>>2]^mt[(P|Et|12)>>2],Pt=oe,Lt=Mt,Dt=Rt,Ct=jt;$=mt[(E|Pt>>22&1020)>>2]<<24^mt[(E|Lt>>14&1020)>>2]<<16^mt[(E|Dt>>6&1020)>>2]<<8^mt[(E|Ct<<2&1020)>>2]^mt[(P|Et|0)>>2],R=mt[(E|Lt>>22&1020)>>2]<<24^mt[(E|Dt>>14&1020)>>2]<<16^mt[(E|Ct>>6&1020)>>2]<<8^mt[(E|Pt<<2&1020)>>2]^mt[(P|Et|4)>>2],tt=mt[(E|Dt>>22&1020)>>2]<<24^mt[(E|Ct>>14&1020)>>2]<<16^mt[(E|Pt>>6&1020)>>2]<<8^mt[(E|Lt<<2&1020)>>2]^mt[(P|Et|8)>>2],X=mt[(E|Ct>>22&1020)>>2]<<24^mt[(E|Pt>>14&1020)>>2]<<16^mt[(E|Lt>>6&1020)>>2]<<8^mt[(E|Dt<<2&1020)>>2]^mt[(P|Et|12)>>2]}function M(P,E,bt,ht){P=P|0,E=E|0,bt=bt|0,ht=ht|0,Y(0,2048,4096,gt,P,E,bt,ht)}function l(P,E,bt,ht){P=P|0,E=E|0,bt=bt|0,ht=ht|0;var Pt=0;Y(1024,3072,8192,gt,P,ht,bt,E),Pt=R,R=X,X=Pt}function z(P,E,bt,ht){P=P|0,E=E|0,bt=bt|0,ht=ht|0,Y(0,2048,4096,gt,Q^P,d^E,b^bt,_^ht),Q=$,d=R,b=tt,_=X}function et(P,E,bt,ht){P=P|0,E=E|0,bt=bt|0,ht=ht|0;var Pt=0;Y(1024,3072,8192,gt,P,ht,bt,E),Pt=R,R=X,X=Pt,$=$^Q,R=R^d,tt=tt^b,X=X^_,Q=P,d=E,b=bt,_=ht}function J(P,E,bt,ht){P=P|0,E=E|0,bt=bt|0,ht=ht|0,Y(0,2048,4096,gt,Q,d,b,_),Q=$=$^P,d=R=R^E,b=tt=tt^bt,_=X=X^ht}function it(P,E,bt,ht){P=P|0,E=E|0,bt=bt|0,ht=ht|0,Y(0,2048,4096,gt,Q,d,b,_),$=$^P,R=R^E,tt=tt^bt,X=X^ht,Q=P,d=E,b=bt,_=ht}function k(P,E,bt,ht){P=P|0,E=E|0,bt=bt|0,ht=ht|0,Y(0,2048,4096,gt,Q,d,b,_),Q=$,d=R,b=tt,_=X,$=$^P,R=R^E,tt=tt^bt,X=X^ht}function w(P,E,bt,ht){P=P|0,E=E|0,bt=bt|0,ht=ht|0,Y(0,2048,4096,gt,g,p,S,D),D=~rt&D|rt&D+1,S=~q&S|q&S+((D|0)==0),p=~st&p|st&p+((S|0)==0),g=~nt&g|nt&g+((p|0)==0),$=$^P,R=R^E,tt=tt^bt,X=X^ht}function A(P,E,bt,ht){P=P|0,E=E|0,bt=bt|0,ht=ht|0;var Pt=0,Lt=0,Dt=0,Ct=0,Xt=0,zt=0,Ot=0,oe=0,Mt=0,Rt=0;for(P=P^Q,E=E^d,bt=bt^b,ht=ht^_,Pt=ct|0,Lt=dt|0,Dt=ut|0,Ct=ft|0;(Mt|0)<128;Mt=Mt+1|0)Pt>>>31&&(Xt=Xt^P,zt=zt^E,Ot=Ot^bt,oe=oe^ht),Pt=Pt<<1|Lt>>>31,Lt=Lt<<1|Dt>>>31,Dt=Dt<<1|Ct>>>31,Ct=Ct<<1,Rt=ht&1,ht=ht>>>1|bt<<31,bt=bt>>>1|E<<31,E=E>>>1|P<<31,P=P>>>1,Rt&&(P=P^3774873600);Q=Xt,d=zt,b=Ot,_=oe}function C(P){P=P|0,gt=P}function N(P,E,bt,ht){P=P|0,E=E|0,bt=bt|0,ht=ht|0,$=P,R=E,tt=bt,X=ht}function T(P,E,bt,ht){P=P|0,E=E|0,bt=bt|0,ht=ht|0,Q=P,d=E,b=bt,_=ht}function H(P,E,bt,ht){P=P|0,E=E|0,bt=bt|0,ht=ht|0,g=P,p=E,S=bt,D=ht}function yt(P,E,bt,ht){P=P|0,E=E|0,bt=bt|0,ht=ht|0,nt=P,st=E,q=bt,rt=ht}function lt(P,E,bt,ht){P=P|0,E=E|0,bt=bt|0,ht=ht|0,D=~rt&D|rt&ht,S=~q&S|q&bt,p=~st&p|st&E,g=~nt&g|nt&P}function wt(P){return P=P|0,P&15?-1:(B[P|0]=$>>>24,B[P|1]=$>>>16&255,B[P|2]=$>>>8&255,B[P|3]=$&255,B[P|4]=R>>>24,B[P|5]=R>>>16&255,B[P|6]=R>>>8&255,B[P|7]=R&255,B[P|8]=tt>>>24,B[P|9]=tt>>>16&255,B[P|10]=tt>>>8&255,B[P|11]=tt&255,B[P|12]=X>>>24,B[P|13]=X>>>16&255,B[P|14]=X>>>8&255,B[P|15]=X&255,16)}function O(P){return P=P|0,P&15?-1:(B[P|0]=Q>>>24,B[P|1]=Q>>>16&255,B[P|2]=Q>>>8&255,B[P|3]=Q&255,B[P|4]=d>>>24,B[P|5]=d>>>16&255,B[P|6]=d>>>8&255,B[P|7]=d&255,B[P|8]=b>>>24,B[P|9]=b>>>16&255,B[P|10]=b>>>8&255,B[P|11]=b&255,B[P|12]=_>>>24,B[P|13]=_>>>16&255,B[P|14]=_>>>8&255,B[P|15]=_&255,16)}function F(){M(0,0,0,0),ct=$,dt=R,ut=tt,ft=X}function W(P,E,bt){P=P|0,E=E|0,bt=bt|0;var ht=0;if(E&15)return-1;for(;(bt|0)>=16;)j[P&7](B[E|0]<<24|B[E|1]<<16|B[E|2]<<8|B[E|3],B[E|4]<<24|B[E|5]<<16|B[E|6]<<8|B[E|7],B[E|8]<<24|B[E|9]<<16|B[E|10]<<8|B[E|11],B[E|12]<<24|B[E|13]<<16|B[E|14]<<8|B[E|15]),B[E|0]=$>>>24,B[E|1]=$>>>16&255,B[E|2]=$>>>8&255,B[E|3]=$&255,B[E|4]=R>>>24,B[E|5]=R>>>16&255,B[E|6]=R>>>8&255,B[E|7]=R&255,B[E|8]=tt>>>24,B[E|9]=tt>>>16&255,B[E|10]=tt>>>8&255,B[E|11]=tt&255,B[E|12]=X>>>24,B[E|13]=X>>>16&255,B[E|14]=X>>>8&255,B[E|15]=X&255,ht=ht+16|0,E=E+16|0,bt=bt-16|0;return ht|0}function L(P,E,bt){P=P|0,E=E|0,bt=bt|0;var ht=0;if(E&15)return-1;for(;(bt|0)>=16;)G[P&1](B[E|0]<<24|B[E|1]<<16|B[E|2]<<8|B[E|3],B[E|4]<<24|B[E|5]<<16|B[E|6]<<8|B[E|7],B[E|8]<<24|B[E|9]<<16|B[E|10]<<8|B[E|11],B[E|12]<<24|B[E|13]<<16|B[E|14]<<8|B[E|15]),ht=ht+16|0,E=E+16|0,bt=bt-16|0;return ht|0}var j=[M,l,z,et,J,it,k,w],G=[z,A];return{set_rounds:C,set_state:N,set_iv:T,set_nonce:H,set_mask:yt,set_counter:lt,get_state:wt,get_iv:O,gcm_init:F,cipher:W,mac:L}}({Uint8Array,Uint32Array},f,m);return I.set_key=function(U,V,Z,$,R,tt,X,Q,d){var b=y.subarray(0,60),_=y.subarray(256,316);b.set([V,Z,$,R,tt,X,Q,d]);for(var g=U,p=1;g<4*U+28;g++){var S=b[g-1];(g%U==0||U===8&&g%U==4)&&(S=n[S>>>24]<<24^n[S>>>16&255]<<16^n[S>>>8&255]<<8^n[255&S]),g%U==0&&(S=S<<8^S>>>24^p<<24,p=p<<1^(128&p?27:0)),b[g]=b[g-U]^S}for(var D=0;D<g;D+=4)for(var nt=0;nt<4;nt++)S=b[g-(4+D)+(4-nt)%4],_[D+nt]=D<4||D>=g-4?S:o[0][n[S>>>24]]^o[1][n[S>>>16&255]]^o[2][n[S>>>8&255]]^o[3][n[255&S]];I.set_rounds(U+5)},I};return h.ENC={ECB:0,CBC:2,CFB:4,OFB:6,CTR:7},h.DEC={ECB:1,CBC:3,CFB:5,OFB:6,CTR:7},h.MAC={CBC:0,GCM:1},h.HEAP_DATA=16384,h}();function r1(e){return e instanceof Uint8Array}function g0(e,t){const r=e?e.byteLength:t||65536;if(4095&r||r<=0)throw Error("heap size must be a positive integer and a multiple of 4096");return e=e||new Uint8Array(new ArrayBuffer(r))}function Fi(e,t,r,i,n){const a=e.length-t,s=a<n?a:n;return e.set(r.subarray(i,i+s),t),s}function Si(...e){const t=e.reduce((n,a)=>n+a.length,0),r=new Uint8Array(t);let i=0;for(let n=0;n<e.length;n++)r.set(e[n],i),i+=e[n].length;return r}class No extends Error{constructor(...t){super(...t)}}class Hr extends Error{constructor(...t){super(...t)}}class Lo extends Error{constructor(...t){super(...t)}}const i1=[],n1=[];class wa{constructor(t,r,i=!0,n,a,s){this.pos=0,this.len=0,this.mode=n,this.pos=0,this.len=0,this.key=t,this.iv=r,this.padding=i,this.acquire_asm(a,s)}acquire_asm(t,r){return this.heap!==void 0&&this.asm!==void 0||(this.heap=t||i1.pop()||g0().subarray(Nt.HEAP_DATA),this.asm=r||n1.pop()||new Nt(null,this.heap.buffer),this.reset(this.key,this.iv)),{heap:this.heap,asm:this.asm}}release_asm(){this.heap!==void 0&&this.asm!==void 0&&(i1.push(this.heap),n1.push(this.asm)),this.heap=void 0,this.asm=void 0}reset(t,r){const{asm:i}=this.acquire_asm(),n=t.length;if(n!==16&&n!==24&&n!==32)throw new Hr("illegal key size");const a=new DataView(t.buffer,t.byteOffset,t.byteLength);if(i.set_key(n>>2,a.getUint32(0),a.getUint32(4),a.getUint32(8),a.getUint32(12),n>16?a.getUint32(16):0,n>16?a.getUint32(20):0,n>24?a.getUint32(24):0,n>24?a.getUint32(28):0),r!==void 0){if(r.length!==16)throw new Hr("illegal iv size");let s=new DataView(r.buffer,r.byteOffset,r.byteLength);i.set_iv(s.getUint32(0),s.getUint32(4),s.getUint32(8),s.getUint32(12))}else i.set_iv(0,0,0,0)}AES_Encrypt_process(t){if(!r1(t))throw new TypeError("data isn't of expected type");let{heap:r,asm:i}=this.acquire_asm(),n=Nt.ENC[this.mode],a=Nt.HEAP_DATA,s=this.pos,o=this.len,u=0,c=t.length||0,h=0,f=0,m=new Uint8Array(o+c&-16);for(;c>0;)f=Fi(r,s+o,t,u,c),o+=f,u+=f,c-=f,f=i.cipher(n,a+s,o),f&&m.set(r.subarray(s,s+f),h),h+=f,f<o?(s+=f,o-=f):(s=0,o=0);return this.pos=s,this.len=o,m}AES_Encrypt_finish(){let{heap:t,asm:r}=this.acquire_asm(),i=Nt.ENC[this.mode],n=Nt.HEAP_DATA,a=this.pos,s=this.len,o=16-s%16,u=s;if(this.hasOwnProperty("padding")){if(this.padding){for(let h=0;h<o;++h)t[a+s+h]=o;s+=o,u=s}else if(s%16)throw new Hr("data length must be a multiple of the block size")}else s+=o;const c=new Uint8Array(u);return s&&r.cipher(i,n+a,s),u&&c.set(t.subarray(a,a+u)),this.pos=0,this.len=0,this.release_asm(),c}AES_Decrypt_process(t){if(!r1(t))throw new TypeError("data isn't of expected type");let{heap:r,asm:i}=this.acquire_asm(),n=Nt.DEC[this.mode],a=Nt.HEAP_DATA,s=this.pos,o=this.len,u=0,c=t.length||0,h=0,f=o+c&-16,m=0,y=0;this.padding&&(m=o+c-f||16,f-=m);const K=new Uint8Array(f);for(;c>0;)y=Fi(r,s+o,t,u,c),o+=y,u+=y,c-=y,y=i.cipher(n,a+s,o-(c?0:m)),y&&K.set(r.subarray(s,s+y),h),h+=y,y<o?(s+=y,o-=y):(s=0,o=0);return this.pos=s,this.len=o,K}AES_Decrypt_finish(){let{heap:t,asm:r}=this.acquire_asm(),i=Nt.DEC[this.mode],n=Nt.HEAP_DATA,a=this.pos,s=this.len,o=s;if(s>0){if(s%16){if(this.hasOwnProperty("padding"))throw new Hr("data length must be a multiple of the block size");s+=16-s%16}if(r.cipher(i,n+a,s),this.hasOwnProperty("padding")&&this.padding){let c=t[a+o-1];if(c<1||c>16||c>o)throw new Lo("bad padding");let h=0;for(let f=c;f>1;f--)h|=c^t[a+o-f];if(h)throw new Lo("bad padding");o-=c}}const u=new Uint8Array(o);return o>0&&u.set(t.subarray(a,a+o)),this.pos=0,this.len=0,this.release_asm(),u}}class ns{static encrypt(t,r,i=!1){return new ns(r,i).encrypt(t)}static decrypt(t,r,i=!1){return new ns(r,i).decrypt(t)}constructor(t,r=!1,i){this.aes=i||new wa(t,void 0,r,"ECB")}encrypt(t){return Si(this.aes.AES_Encrypt_process(t),this.aes.AES_Encrypt_finish())}decrypt(t){return Si(this.aes.AES_Decrypt_process(t),this.aes.AES_Decrypt_finish())}}function w0(e){const t=function(r){const i=new ns(r);this.encrypt=function(n){return i.encrypt(n)},this.decrypt=function(n){return i.decrypt(n)}};return t.blockSize=t.prototype.blockSize=16,t.keySize=t.prototype.keySize=e/8,t}function Xn(e,t,r,i,n,a){const s=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],u=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],c=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],h=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],f=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],m=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],y=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];let K,I,U,V,Z,$,R,tt,X,Q,d,b,_,g,p=0,S=t.length;const D=e.length===32?3:9;tt=D===3?r?[0,32,2]:[30,-2,-2]:r?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],r&&(S=(t=function(q,rt){const ct=8-q.length%8;let dt;if(rt===2&&ct<8)dt=32;else if(rt===1)dt=ct;else{if(rt||!(ct<8)){if(ct===8)return q;throw Error("des: invalid padding")}dt=0}const ut=new Uint8Array(q.length+ct);for(let ft=0;ft<q.length;ft++)ut[ft]=q[ft];for(let ft=0;ft<ct;ft++)ut[q.length+ft]=dt;return ut}(t,a)).length);let nt=new Uint8Array(S),st=0;for(i===1&&(X=n[p++]<<24|n[p++]<<16|n[p++]<<8|n[p++],d=n[p++]<<24|n[p++]<<16|n[p++]<<8|n[p++],p=0);p<S;){for($=t[p++]<<24|t[p++]<<16|t[p++]<<8|t[p++],R=t[p++]<<24|t[p++]<<16|t[p++]<<8|t[p++],i===1&&(r?($^=X,R^=d):(Q=X,b=d,X=$,d=R)),U=252645135&($>>>4^R),R^=U,$^=U<<4,U=65535&($>>>16^R),R^=U,$^=U<<16,U=858993459&(R>>>2^$),$^=U,R^=U<<2,U=16711935&(R>>>8^$),$^=U,R^=U<<8,U=1431655765&($>>>1^R),R^=U,$^=U<<1,$=$<<1|$>>>31,R=R<<1|R>>>31,I=0;I<D;I+=3){for(_=tt[I+1],g=tt[I+2],K=tt[I];K!==_;K+=g)V=R^e[K],Z=(R>>>4|R<<28)^e[K+1],U=$,$=R,R=U^(o[V>>>24&63]|c[V>>>16&63]|f[V>>>8&63]|y[63&V]|s[Z>>>24&63]|u[Z>>>16&63]|h[Z>>>8&63]|m[63&Z]);U=$,$=R,R=U}$=$>>>1|$<<31,R=R>>>1|R<<31,U=1431655765&($>>>1^R),R^=U,$^=U<<1,U=16711935&(R>>>8^$),$^=U,R^=U<<8,U=858993459&(R>>>2^$),$^=U,R^=U<<2,U=65535&($>>>16^R),R^=U,$^=U<<16,U=252645135&($>>>4^R),R^=U,$^=U<<4,i===1&&(r?(X=$,d=R):($^=Q,R^=b)),nt[st++]=$>>>24,nt[st++]=$>>>16&255,nt[st++]=$>>>8&255,nt[st++]=255&$,nt[st++]=R>>>24,nt[st++]=R>>>16&255,nt[st++]=R>>>8&255,nt[st++]=255&R}return r||(nt=function(q,rt){let ct,dt=null;if(rt===2)ct=32;else if(rt===1)dt=q[q.length-1];else{if(rt)throw Error("des: invalid padding");ct=0}if(!dt){for(dt=1;q[q.length-dt]===ct;)dt++;dt--}return q.subarray(0,q.length-dt)}(nt,a)),nt}function Qn(e){const t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],m=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],y=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],K=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],I=e.length>8?3:1,U=Array(32*I),V=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];let Z,$,R,tt=0,X=0;for(let Q=0;Q<I;Q++){let d=e[tt++]<<24|e[tt++]<<16|e[tt++]<<8|e[tt++],b=e[tt++]<<24|e[tt++]<<16|e[tt++]<<8|e[tt++];R=252645135&(d>>>4^b),b^=R,d^=R<<4,R=65535&(b>>>-16^d),d^=R,b^=R<<-16,R=858993459&(d>>>2^b),b^=R,d^=R<<2,R=65535&(b>>>-16^d),d^=R,b^=R<<-16,R=1431655765&(d>>>1^b),b^=R,d^=R<<1,R=16711935&(b>>>8^d),d^=R,b^=R<<8,R=1431655765&(d>>>1^b),b^=R,d^=R<<1,R=d<<8|b>>>20&240,d=b<<24|b<<8&16711680|b>>>8&65280|b>>>24&240,b=R;for(let _=0;_<16;_++)V[_]?(d=d<<2|d>>>26,b=b<<2|b>>>26):(d=d<<1|d>>>27,b=b<<1|b>>>27),d&=-15,b&=-15,Z=t[d>>>28]|r[d>>>24&15]|i[d>>>20&15]|n[d>>>16&15]|a[d>>>12&15]|s[d>>>8&15]|o[d>>>4&15],$=u[b>>>28]|c[b>>>24&15]|h[b>>>20&15]|f[b>>>16&15]|m[b>>>12&15]|y[b>>>8&15]|K[b>>>4&15],R=65535&($>>>16^Z),U[X++]=Z^R,U[X++]=$^R<<16}return U}function qn(e){this.key=[];for(let t=0;t<3;t++)this.key.push(new Uint8Array(e.subarray(8*t,8*t+8)));this.encrypt=function(t){return Xn(Qn(this.key[2]),Xn(Qn(this.key[1]),Xn(Qn(this.key[0]),t,!0,0,null,null),!1,0,null,null),!0,0,null,null)}}function H3(){this.BlockSize=8,this.KeySize=16,this.setKey=function(s){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),s.length!==this.KeySize)throw Error("CAST-128: keys must be 16 bytes");return this.keySchedule(s),!0},this.reset=function(){for(let s=0;s<16;s++)this.masking[s]=0,this.rotate[s]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(s){const o=Array(s.length);for(let u=0;u<s.length;u+=8){let c,h=s[u]<<24|s[u+1]<<16|s[u+2]<<8|s[u+3],f=s[u+4]<<24|s[u+5]<<16|s[u+6]<<8|s[u+7];c=f,f=h^r(f,this.masking[0],this.rotate[0]),h=c,c=f,f=h^i(f,this.masking[1],this.rotate[1]),h=c,c=f,f=h^n(f,this.masking[2],this.rotate[2]),h=c,c=f,f=h^r(f,this.masking[3],this.rotate[3]),h=c,c=f,f=h^i(f,this.masking[4],this.rotate[4]),h=c,c=f,f=h^n(f,this.masking[5],this.rotate[5]),h=c,c=f,f=h^r(f,this.masking[6],this.rotate[6]),h=c,c=f,f=h^i(f,this.masking[7],this.rotate[7]),h=c,c=f,f=h^n(f,this.masking[8],this.rotate[8]),h=c,c=f,f=h^r(f,this.masking[9],this.rotate[9]),h=c,c=f,f=h^i(f,this.masking[10],this.rotate[10]),h=c,c=f,f=h^n(f,this.masking[11],this.rotate[11]),h=c,c=f,f=h^r(f,this.masking[12],this.rotate[12]),h=c,c=f,f=h^i(f,this.masking[13],this.rotate[13]),h=c,c=f,f=h^n(f,this.masking[14],this.rotate[14]),h=c,c=f,f=h^r(f,this.masking[15],this.rotate[15]),h=c,o[u]=f>>>24&255,o[u+1]=f>>>16&255,o[u+2]=f>>>8&255,o[u+3]=255&f,o[u+4]=h>>>24&255,o[u+5]=h>>>16&255,o[u+6]=h>>>8&255,o[u+7]=255&h}return o},this.decrypt=function(s){const o=Array(s.length);for(let u=0;u<s.length;u+=8){let c,h=s[u]<<24|s[u+1]<<16|s[u+2]<<8|s[u+3],f=s[u+4]<<24|s[u+5]<<16|s[u+6]<<8|s[u+7];c=f,f=h^r(f,this.masking[15],this.rotate[15]),h=c,c=f,f=h^n(f,this.masking[14],this.rotate[14]),h=c,c=f,f=h^i(f,this.masking[13],this.rotate[13]),h=c,c=f,f=h^r(f,this.masking[12],this.rotate[12]),h=c,c=f,f=h^n(f,this.masking[11],this.rotate[11]),h=c,c=f,f=h^i(f,this.masking[10],this.rotate[10]),h=c,c=f,f=h^r(f,this.masking[9],this.rotate[9]),h=c,c=f,f=h^n(f,this.masking[8],this.rotate[8]),h=c,c=f,f=h^i(f,this.masking[7],this.rotate[7]),h=c,c=f,f=h^r(f,this.masking[6],this.rotate[6]),h=c,c=f,f=h^n(f,this.masking[5],this.rotate[5]),h=c,c=f,f=h^i(f,this.masking[4],this.rotate[4]),h=c,c=f,f=h^r(f,this.masking[3],this.rotate[3]),h=c,c=f,f=h^n(f,this.masking[2],this.rotate[2]),h=c,c=f,f=h^i(f,this.masking[1],this.rotate[1]),h=c,c=f,f=h^r(f,this.masking[0],this.rotate[0]),h=c,o[u]=f>>>24&255,o[u+1]=f>>>16&255,o[u+2]=f>>>8&255,o[u+3]=255&f,o[u+4]=h>>>24&255,o[u+5]=h>>16&255,o[u+6]=h>>8&255,o[u+7]=255&h}return o};const e=[,,,,];e[0]=[,,,,],e[0][0]=[4,0,13,15,12,14,8],e[0][1]=[5,2,16,18,17,19,10],e[0][2]=[6,3,23,22,21,20,9],e[0][3]=[7,1,26,25,27,24,11],e[1]=[,,,,],e[1][0]=[0,6,21,23,20,22,16],e[1][1]=[1,4,0,2,1,3,18],e[1][2]=[2,5,7,6,5,4,17],e[1][3]=[3,7,10,9,11,8,19],e[2]=[,,,,],e[2][0]=[4,0,13,15,12,14,8],e[2][1]=[5,2,16,18,17,19,10],e[2][2]=[6,3,23,22,21,20,9],e[2][3]=[7,1,26,25,27,24,11],e[3]=[,,,,],e[3][0]=[0,6,21,23,20,22,16],e[3][1]=[1,4,0,2,1,3,18],e[3][2]=[2,5,7,6,5,4,17],e[3][3]=[3,7,10,9,11,8,19];const t=[,,,,];function r(s,o,u){const c=o+s,h=c<<u|c>>>32-u;return(a[0][h>>>24]^a[1][h>>>16&255])-a[2][h>>>8&255]+a[3][255&h]}function i(s,o,u){const c=o^s,h=c<<u|c>>>32-u;return a[0][h>>>24]-a[1][h>>>16&255]+a[2][h>>>8&255]^a[3][255&h]}function n(s,o,u){const c=o-s,h=c<<u|c>>>32-u;return(a[0][h>>>24]+a[1][h>>>16&255]^a[2][h>>>8&255])-a[3][255&h]}t[0]=[,,,,],t[0][0]=[24,25,23,22,18],t[0][1]=[26,27,21,20,22],t[0][2]=[28,29,19,18,25],t[0][3]=[30,31,17,16,28],t[1]=[,,,,],t[1][0]=[3,2,12,13,8],t[1][1]=[1,0,14,15,13],t[1][2]=[7,6,8,9,3],t[1][3]=[5,4,10,11,7],t[2]=[,,,,],t[2][0]=[19,18,28,29,25],t[2][1]=[17,16,30,31,28],t[2][2]=[23,22,24,25,18],t[2][3]=[21,20,26,27,22],t[3]=[,,,,],t[3][0]=[8,9,7,6,3],t[3][1]=[10,11,5,4,7],t[3][2]=[12,13,3,2,8],t[3][3]=[14,15,1,0,13],this.keySchedule=function(s){const o=[,,,,,,,,],u=Array(32);let c;for(let y=0;y<4;y++)c=4*y,o[y]=s[c]<<24|s[c+1]<<16|s[c+2]<<8|s[c+3];const h=[6,7,4,5];let f,m=0;for(let y=0;y<2;y++)for(let K=0;K<4;K++){for(c=0;c<4;c++){const I=e[K][c];f=o[I[1]],f^=a[4][o[I[2]>>>2]>>>24-8*(3&I[2])&255],f^=a[5][o[I[3]>>>2]>>>24-8*(3&I[3])&255],f^=a[6][o[I[4]>>>2]>>>24-8*(3&I[4])&255],f^=a[7][o[I[5]>>>2]>>>24-8*(3&I[5])&255],f^=a[h[c]][o[I[6]>>>2]>>>24-8*(3&I[6])&255],o[I[0]]=f}for(c=0;c<4;c++){const I=t[K][c];f=a[4][o[I[0]>>>2]>>>24-8*(3&I[0])&255],f^=a[5][o[I[1]>>>2]>>>24-8*(3&I[1])&255],f^=a[6][o[I[2]>>>2]>>>24-8*(3&I[2])&255],f^=a[7][o[I[3]>>>2]>>>24-8*(3&I[3])&255],f^=a[4+c][o[I[4]>>>2]>>>24-8*(3&I[4])&255],u[m]=f,m++}}for(let y=0;y<16;y++)this.masking[y]=u[y],this.rotate[y]=31&u[16+y]};const a=[,,,,,,,,];a[0]=[821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063],a[1]=[522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321],a[2]=[2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027],a[3]=[2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730],a[4]=[2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860],a[5]=[4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975],a[6]=[2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875],a[7]=[3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926]}function Fn(e){this.cast5=new H3,this.cast5.setKey(e),this.encrypt=function(t){return this.cast5.encrypt(t)}}qn.keySize=qn.prototype.keySize=24,qn.blockSize=qn.prototype.blockSize=8,Fn.blockSize=Fn.prototype.blockSize=8,Fn.keySize=Fn.prototype.keySize=16;const Ge=4294967295;function hr(e,t){return(e<<t|e>>>32-t)&Ge}function qr(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}function si(e,t,r){e.splice(t,4,255&r,r>>>8&255,r>>>16&255,r>>>24&255)}function qt(e,t){return e>>>8*t&255}function On(e){this.tf=function(){let t=null,r=null,i=-1,n=[],a=[[],[],[],[]];function s(h){return a[0][qt(h,0)]^a[1][qt(h,1)]^a[2][qt(h,2)]^a[3][qt(h,3)]}function o(h){return a[0][qt(h,3)]^a[1][qt(h,0)]^a[2][qt(h,1)]^a[3][qt(h,2)]}function u(h,f){let m=s(f[0]),y=o(f[1]);f[2]=hr(f[2]^m+y+n[4*h+8]&Ge,31),f[3]=hr(f[3],1)^m+2*y+n[4*h+9]&Ge,m=s(f[2]),y=o(f[3]),f[0]=hr(f[0]^m+y+n[4*h+10]&Ge,31),f[1]=hr(f[1],1)^m+2*y+n[4*h+11]&Ge}function c(h,f){let m=s(f[0]),y=o(f[1]);f[2]=hr(f[2],1)^m+y+n[4*h+10]&Ge,f[3]=hr(f[3]^m+2*y+n[4*h+11]&Ge,31),m=s(f[2]),y=o(f[3]),f[0]=hr(f[0],1)^m+y+n[4*h+8]&Ge,f[1]=hr(f[1]^m+2*y+n[4*h+9]&Ge,31)}return{name:"twofish",blocksize:16,open:function(h){let f,m,y,K,I;t=h;const U=[],V=[],Z=[];let $;const R=[];let tt,X,Q;const d=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],b=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],_=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],g=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],p=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],S=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],D=[[],[]],nt=[[],[],[],[]];function st(ut){return ut^ut>>2^[0,90,180,238][3&ut]}function q(ut){return ut^ut>>1^ut>>2^[0,238,180,90][3&ut]}function rt(ut,ft){let gt,mt,B;for(gt=0;gt<8;gt++)mt=ft>>>24,ft=ft<<8&Ge|ut>>>24,ut=ut<<8&Ge,B=mt<<1,128&mt&&(B^=333),ft^=mt^B<<16,B^=mt>>>1,1&mt&&(B^=166),ft^=B<<24|B<<8;return ft}function ct(ut,ft){const gt=ft>>4,mt=15&ft,B=d[ut][gt^mt],Y=b[ut][p[mt]^S[gt]];return g[ut][p[Y]^S[B]]<<4|_[ut][B^Y]}function dt(ut,ft){let gt=qt(ut,0),mt=qt(ut,1),B=qt(ut,2),Y=qt(ut,3);switch($){case 4:gt=D[1][gt]^qt(ft[3],0),mt=D[0][mt]^qt(ft[3],1),B=D[0][B]^qt(ft[3],2),Y=D[1][Y]^qt(ft[3],3);case 3:gt=D[1][gt]^qt(ft[2],0),mt=D[1][mt]^qt(ft[2],1),B=D[0][B]^qt(ft[2],2),Y=D[0][Y]^qt(ft[2],3);case 2:gt=D[0][D[0][gt]^qt(ft[1],0)]^qt(ft[0],0),mt=D[0][D[1][mt]^qt(ft[1],1)]^qt(ft[0],1),B=D[1][D[0][B]^qt(ft[1],2)]^qt(ft[0],2),Y=D[1][D[1][Y]^qt(ft[1],3)]^qt(ft[0],3)}return nt[0][gt]^nt[1][mt]^nt[2][B]^nt[3][Y]}for(t=t.slice(0,32),f=t.length;f!==16&&f!==24&&f!==32;)t[f++]=0;for(f=0;f<t.length;f+=4)Z[f>>2]=qr(t,f);for(f=0;f<256;f++)D[0][f]=ct(0,f),D[1][f]=ct(1,f);for(f=0;f<256;f++)tt=D[1][f],X=st(tt),Q=q(tt),nt[0][f]=tt+(X<<8)+(Q<<16)+(Q<<24),nt[2][f]=X+(Q<<8)+(tt<<16)+(Q<<24),tt=D[0][f],X=st(tt),Q=q(tt),nt[1][f]=Q+(Q<<8)+(X<<16)+(tt<<24),nt[3][f]=X+(tt<<8)+(Q<<16)+(X<<24);for($=Z.length/2,f=0;f<$;f++)m=Z[f+f],U[f]=m,y=Z[f+f+1],V[f]=y,R[$-f-1]=rt(m,y);for(f=0;f<40;f+=2)m=16843009*f,y=m+16843009,m=dt(m,U),y=hr(dt(y,V),8),n[f]=m+y&Ge,n[f+1]=hr(m+2*y,9);for(f=0;f<256;f++)switch(m=y=K=I=f,$){case 4:m=D[1][m]^qt(R[3],0),y=D[0][y]^qt(R[3],1),K=D[0][K]^qt(R[3],2),I=D[1][I]^qt(R[3],3);case 3:m=D[1][m]^qt(R[2],0),y=D[1][y]^qt(R[2],1),K=D[0][K]^qt(R[2],2),I=D[0][I]^qt(R[2],3);case 2:a[0][f]=nt[0][D[0][D[0][m]^qt(R[1],0)]^qt(R[0],0)],a[1][f]=nt[1][D[0][D[1][y]^qt(R[1],1)]^qt(R[0],1)],a[2][f]=nt[2][D[1][D[0][K]^qt(R[1],2)]^qt(R[0],2)],a[3][f]=nt[3][D[1][D[1][I]^qt(R[1],3)]^qt(R[0],3)]}},close:function(){n=[],a=[[],[],[],[]]},encrypt:function(h,f){r=h,i=f;const m=[qr(r,i)^n[0],qr(r,i+4)^n[1],qr(r,i+8)^n[2],qr(r,i+12)^n[3]];for(let y=0;y<8;y++)u(y,m);return si(r,i,m[2]^n[4]),si(r,i+4,m[3]^n[5]),si(r,i+8,m[0]^n[6]),si(r,i+12,m[1]^n[7]),i+=16,r},decrypt:function(h,f){r=h,i=f;const m=[qr(r,i)^n[4],qr(r,i+4)^n[5],qr(r,i+8)^n[6],qr(r,i+12)^n[7]];for(let y=7;y>=0;y--)c(y,m);si(r,i,m[2]^n[0]),si(r,i+4,m[3]^n[1]),si(r,i+8,m[0]^n[2]),si(r,i+12,m[1]^n[3]),i+=16},finalize:function(){return r}}}(),this.tf.open(Array.from(e),0),this.encrypt=function(t){return this.tf.encrypt(Array.from(t),0)}}function Ye(){}function Nn(e){this.bf=new Ye,this.bf.init(e),this.encrypt=function(t){return this.bf.encryptBlock(t)}}On.keySize=On.prototype.keySize=32,On.blockSize=On.prototype.blockSize=16,Ye.prototype.BLOCKSIZE=8,Ye.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],Ye.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],Ye.prototype.NN=16,Ye.prototype._clean=function(e){return e<0&&(e=(2147483647&e)+2147483648),e},Ye.prototype._F=function(e){let t;const r=255&e,i=255&(e>>>=8),n=255&(e>>>=8),a=255&(e>>>=8);return t=this.sboxes[0][a]+this.sboxes[1][n],t^=this.sboxes[2][i],t+=this.sboxes[3][r],t},Ye.prototype._encryptBlock=function(e){let t,r=e[0],i=e[1];for(t=0;t<this.NN;++t){r^=this.parray[t],i=this._F(r)^i;const n=r;r=i,i=n}r^=this.parray[this.NN+0],i^=this.parray[this.NN+1],e[0]=this._clean(i),e[1]=this._clean(r)},Ye.prototype.encryptBlock=function(e){let t;const r=[0,0],i=this.BLOCKSIZE/2;for(t=0;t<this.BLOCKSIZE/2;++t)r[0]=r[0]<<8|255&e[t+0],r[1]=r[1]<<8|255&e[t+i];this._encryptBlock(r);const n=[];for(t=0;t<this.BLOCKSIZE/2;++t)n[t+0]=r[0]>>>24-8*t&255,n[t+i]=r[1]>>>24-8*t&255;return n},Ye.prototype._decryptBlock=function(e){let t,r=e[0],i=e[1];for(t=this.NN+1;t>1;--t){r^=this.parray[t],i=this._F(r)^i;const n=r;r=i,i=n}r^=this.parray[1],i^=this.parray[0],e[0]=this._clean(i),e[1]=this._clean(r)},Ye.prototype.init=function(e){let t,r=0;for(this.parray=[],t=0;t<this.NN+2;++t){let n=0;for(let a=0;a<4;++a)n=n<<8|255&e[r],++r>=e.length&&(r=0);this.parray[t]=this.PARRAY[t]^n}for(this.sboxes=[],t=0;t<4;++t)for(this.sboxes[t]=[],r=0;r<256;++r)this.sboxes[t][r]=this.SBOXES[t][r];const i=[0,0];for(t=0;t<this.NN+2;t+=2)this._encryptBlock(i),this.parray[t+0]=i[0],this.parray[t+1]=i[1];for(t=0;t<4;++t)for(r=0;r<256;r+=2)this._encryptBlock(i),this.sboxes[t][r+0]=i[0],this.sboxes[t][r+1]=i[1]},Nn.keySize=Nn.prototype.keySize=16,Nn.blockSize=Nn.prototype.blockSize=8;const G3=w0(128),V3=w0(192),$3=w0(256);var $i=Object.freeze({__proto__:null,aes128:G3,aes192:V3,aes256:$3,des:function(e){this.key=e,this.encrypt=function(t,r){return Xn(Qn(this.key),t,!0,0,null,r)},this.decrypt=function(t,r){return Xn(Qn(this.key),t,!1,0,null,r)}},tripledes:qn,cast5:Fn,twofish:On,blowfish:Nn,idea:function(){throw Error("IDEA symmetric-key algorithm not implemented")}}),$2=function(e,t,r){var i=0,n=0,a=0,s=0,o=0,u=0,c=0,h=0,f=0,m=0,y=0,K=0,I=0,U=0,V=0,Z=0,$=0,R=new e.Uint8Array(r);function tt(q,rt,ct,dt,ut,ft,gt,mt,B,Y,M,l,z,et,J,it){q=q|0,rt=rt|0,ct=ct|0,dt=dt|0,ut=ut|0,ft=ft|0,gt=gt|0,mt=mt|0,B=B|0,Y=Y|0,M=M|0,l=l|0,z=z|0,et=et|0,J=J|0,it=it|0;var k=0,w=0,A=0,C=0,N=0,T=0,H=0,yt=0,lt=0,wt=0,O=0,F=0,W=0,L=0,j=0,G=0,P=0,E=0,bt=0,ht=0,Pt=0,Lt=0,Dt=0,Ct=0,Xt=0,zt=0,Ot=0,oe=0,Mt=0,Rt=0,jt=0,Et=0,Bt=0,$t=0,It=0,at=0,ot=0,pt=0,_t=0,Kt=0,xt=0,St=0,Ht=0,Tt=0,Gt=0,xe=0,Me=0,Ie=0,ir=0,nr=0,ar=0,sr=0,or=0,cr=0,ur=0,Tr=0,zr=0,ti=0,ei=0,ri=0,ii=0,ni=0,ai=0,Ci=0,so=0,oo=0,co=0,uo=0,$0=0,Z0=0,Y0=0;k=i,w=n,A=a,C=s,N=o,H=q+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=rt+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=ct+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=dt+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=ut+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=ft+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=gt+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=mt+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=B+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=Y+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=M+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=l+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=z+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=et+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=J+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,H=it+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=et^B^ct^q,yt=T<<1|T>>>31,H=yt+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=J^Y^dt^rt,lt=T<<1|T>>>31,H=lt+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=it^M^ut^ct,wt=T<<1|T>>>31,H=wt+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=yt^l^ft^dt,O=T<<1|T>>>31,H=O+(k<<5|k>>>27)+N+(w&A|~w&C)+1518500249|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=lt^z^gt^ut,F=T<<1|T>>>31,H=F+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=wt^et^mt^ft,W=T<<1|T>>>31,H=W+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=O^J^B^gt,L=T<<1|T>>>31,H=L+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=F^it^Y^mt,j=T<<1|T>>>31,H=j+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=W^yt^M^B,G=T<<1|T>>>31,H=G+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=L^lt^l^Y,P=T<<1|T>>>31,H=P+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=j^wt^z^M,E=T<<1|T>>>31,H=E+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=G^O^et^l,bt=T<<1|T>>>31,H=bt+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=P^F^J^z,ht=T<<1|T>>>31,H=ht+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=E^W^it^et,Pt=T<<1|T>>>31,H=Pt+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=bt^L^yt^J,Lt=T<<1|T>>>31,H=Lt+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=ht^j^lt^it,Dt=T<<1|T>>>31,H=Dt+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Pt^G^wt^yt,Ct=T<<1|T>>>31,H=Ct+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Lt^P^O^lt,Xt=T<<1|T>>>31,H=Xt+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Dt^E^F^wt,zt=T<<1|T>>>31,H=zt+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Ct^bt^W^O,Ot=T<<1|T>>>31,H=Ot+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Xt^ht^L^F,oe=T<<1|T>>>31,H=oe+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=zt^Pt^j^W,Mt=T<<1|T>>>31,H=Mt+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Ot^Lt^G^L,Rt=T<<1|T>>>31,H=Rt+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=oe^Dt^P^j,jt=T<<1|T>>>31,H=jt+(k<<5|k>>>27)+N+(w^A^C)+1859775393|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Mt^Ct^E^G,Et=T<<1|T>>>31,H=Et+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Rt^Xt^bt^P,Bt=T<<1|T>>>31,H=Bt+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=jt^zt^ht^E,$t=T<<1|T>>>31,H=$t+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Et^Ot^Pt^bt,It=T<<1|T>>>31,H=It+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Bt^oe^Lt^ht,at=T<<1|T>>>31,H=at+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=$t^Mt^Dt^Pt,ot=T<<1|T>>>31,H=ot+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=It^Rt^Ct^Lt,pt=T<<1|T>>>31,H=pt+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=at^jt^Xt^Dt,_t=T<<1|T>>>31,H=_t+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=ot^Et^zt^Ct,Kt=T<<1|T>>>31,H=Kt+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=pt^Bt^Ot^Xt,xt=T<<1|T>>>31,H=xt+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=_t^$t^oe^zt,St=T<<1|T>>>31,H=St+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Kt^It^Mt^Ot,Ht=T<<1|T>>>31,H=Ht+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=xt^at^Rt^oe,Tt=T<<1|T>>>31,H=Tt+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=St^ot^jt^Mt,Gt=T<<1|T>>>31,H=Gt+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Ht^pt^Et^Rt,xe=T<<1|T>>>31,H=xe+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Tt^_t^Bt^jt,Me=T<<1|T>>>31,H=Me+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Gt^Kt^$t^Et,Ie=T<<1|T>>>31,H=Ie+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=xe^xt^It^Bt,ir=T<<1|T>>>31,H=ir+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Me^St^at^$t,nr=T<<1|T>>>31,H=nr+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Ie^Ht^ot^It,ar=T<<1|T>>>31,H=ar+(k<<5|k>>>27)+N+(w&A|w&C|A&C)-1894007588|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=ir^Tt^pt^at,sr=T<<1|T>>>31,H=sr+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=nr^Gt^_t^ot,or=T<<1|T>>>31,H=or+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=ar^xe^Kt^pt,cr=T<<1|T>>>31,H=cr+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=sr^Me^xt^_t,ur=T<<1|T>>>31,H=ur+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=or^Ie^St^Kt,Tr=T<<1|T>>>31,H=Tr+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=cr^ir^Ht^xt,zr=T<<1|T>>>31,H=zr+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=ur^nr^Tt^St,ti=T<<1|T>>>31,H=ti+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Tr^ar^Gt^Ht,ei=T<<1|T>>>31,H=ei+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=zr^sr^xe^Tt,ri=T<<1|T>>>31,H=ri+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=ti^or^Me^Gt,ii=T<<1|T>>>31,H=ii+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=ei^cr^Ie^xe,ni=T<<1|T>>>31,H=ni+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=ri^ur^ir^Me,ai=T<<1|T>>>31,H=ai+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=ii^Tr^nr^Ie,Ci=T<<1|T>>>31,H=Ci+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=ni^zr^ar^ir,so=T<<1|T>>>31,H=so+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=ai^ti^sr^nr,oo=T<<1|T>>>31,H=oo+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=Ci^ei^or^ar,co=T<<1|T>>>31,H=co+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=so^ri^cr^sr,uo=T<<1|T>>>31,H=uo+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=oo^ii^ur^or,$0=T<<1|T>>>31,H=$0+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=co^ni^Tr^cr,Z0=T<<1|T>>>31,H=Z0+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,T=uo^ai^zr^ur,Y0=T<<1|T>>>31,H=Y0+(k<<5|k>>>27)+N+(w^A^C)-899497514|0,N=C,C=A,A=w<<30|w>>>2,w=k,k=H,i=i+k|0,n=n+w|0,a=a+A|0,s=s+C|0,o=o+N|0}function X(q){q=q|0,tt(R[q|0]<<24|R[q|1]<<16|R[q|2]<<8|R[q|3],R[q|4]<<24|R[q|5]<<16|R[q|6]<<8|R[q|7],R[q|8]<<24|R[q|9]<<16|R[q|10]<<8|R[q|11],R[q|12]<<24|R[q|13]<<16|R[q|14]<<8|R[q|15],R[q|16]<<24|R[q|17]<<16|R[q|18]<<8|R[q|19],R[q|20]<<24|R[q|21]<<16|R[q|22]<<8|R[q|23],R[q|24]<<24|R[q|25]<<16|R[q|26]<<8|R[q|27],R[q|28]<<24|R[q|29]<<16|R[q|30]<<8|R[q|31],R[q|32]<<24|R[q|33]<<16|R[q|34]<<8|R[q|35],R[q|36]<<24|R[q|37]<<16|R[q|38]<<8|R[q|39],R[q|40]<<24|R[q|41]<<16|R[q|42]<<8|R[q|43],R[q|44]<<24|R[q|45]<<16|R[q|46]<<8|R[q|47],R[q|48]<<24|R[q|49]<<16|R[q|50]<<8|R[q|51],R[q|52]<<24|R[q|53]<<16|R[q|54]<<8|R[q|55],R[q|56]<<24|R[q|57]<<16|R[q|58]<<8|R[q|59],R[q|60]<<24|R[q|61]<<16|R[q|62]<<8|R[q|63])}function Q(q){q=q|0,R[q|0]=i>>>24,R[q|1]=i>>>16&255,R[q|2]=i>>>8&255,R[q|3]=i&255,R[q|4]=n>>>24,R[q|5]=n>>>16&255,R[q|6]=n>>>8&255,R[q|7]=n&255,R[q|8]=a>>>24,R[q|9]=a>>>16&255,R[q|10]=a>>>8&255,R[q|11]=a&255,R[q|12]=s>>>24,R[q|13]=s>>>16&255,R[q|14]=s>>>8&255,R[q|15]=s&255,R[q|16]=o>>>24,R[q|17]=o>>>16&255,R[q|18]=o>>>8&255,R[q|19]=o&255}function d(){i=1732584193,n=4023233417,a=2562383102,s=271733878,o=3285377520,u=c=0}function b(q,rt,ct,dt,ut,ft,gt){q=q|0,rt=rt|0,ct=ct|0,dt=dt|0,ut=ut|0,ft=ft|0,gt=gt|0,i=q,n=rt,a=ct,s=dt,o=ut,u=ft,c=gt}function _(q,rt){q=q|0,rt=rt|0;var ct=0;if(q&63)return-1;for(;(rt|0)>=64;)X(q),q=q+64|0,rt=rt-64|0,ct=ct+64|0;return u=u+ct|0,u>>>0<ct>>>0&&(c=c+1|0),ct|0}function g(q,rt,ct){q=q|0,rt=rt|0,ct=ct|0;var dt=0,ut=0;if(q&63||~ct&&ct&31)return-1;if((rt|0)>=64){if(dt=_(q,rt)|0,(dt|0)==-1)return-1;q=q+dt|0,rt=rt-dt|0}if(dt=dt+rt|0,u=u+rt|0,u>>>0<rt>>>0&&(c=c+1|0),R[q|rt]=128,(rt|0)>=56){for(ut=rt+1|0;(ut|0)<64;ut=ut+1|0)R[q|ut]=0;X(q),rt=0,R[q|0]=0}for(ut=rt+1|0;(ut|0)<59;ut=ut+1|0)R[q|ut]=0;return R[q|56]=c>>>21&255,R[q|57]=c>>>13&255,R[q|58]=c>>>5&255,R[q|59]=c<<3&255|u>>>29,R[q|60]=u>>>21&255,R[q|61]=u>>>13&255,R[q|62]=u>>>5&255,R[q|63]=u<<3&255,X(q),~ct&&Q(ct),dt|0}function p(){i=h,n=f,a=m,s=y,o=K,u=64,c=0}function S(){i=I,n=U,a=V,s=Z,o=$,u=64,c=0}function D(q,rt,ct,dt,ut,ft,gt,mt,B,Y,M,l,z,et,J,it){q=q|0,rt=rt|0,ct=ct|0,dt=dt|0,ut=ut|0,ft=ft|0,gt=gt|0,mt=mt|0,B=B|0,Y=Y|0,M=M|0,l=l|0,z=z|0,et=et|0,J=J|0,it=it|0,d(),tt(q^1549556828,rt^1549556828,ct^1549556828,dt^1549556828,ut^1549556828,ft^1549556828,gt^1549556828,mt^1549556828,B^1549556828,Y^1549556828,M^1549556828,l^1549556828,z^1549556828,et^1549556828,J^1549556828,it^1549556828),I=i,U=n,V=a,Z=s,$=o,d(),tt(q^909522486,rt^909522486,ct^909522486,dt^909522486,ut^909522486,ft^909522486,gt^909522486,mt^909522486,B^909522486,Y^909522486,M^909522486,l^909522486,z^909522486,et^909522486,J^909522486,it^909522486),h=i,f=n,m=a,y=s,K=o,u=64,c=0}function nt(q,rt,ct){q=q|0,rt=rt|0,ct=ct|0;var dt=0,ut=0,ft=0,gt=0,mt=0,B=0;return q&63||~ct&&ct&31?-1:(B=g(q,rt,-1)|0,dt=i,ut=n,ft=a,gt=s,mt=o,S(),tt(dt,ut,ft,gt,mt,2147483648,0,0,0,0,0,0,0,0,0,672),~ct&&Q(ct),B|0)}function st(q,rt,ct,dt,ut){q=q|0,rt=rt|0,ct=ct|0,dt=dt|0,ut=ut|0;var ft=0,gt=0,mt=0,B=0,Y=0,M=0,l=0,z=0,et=0,J=0;if(q&63||~ut&&ut&31)return-1;for(R[q+rt|0]=ct>>>24,R[q+rt+1|0]=ct>>>16&255,R[q+rt+2|0]=ct>>>8&255,R[q+rt+3|0]=ct&255,nt(q,rt+4|0,-1)|0,ft=M=i,gt=l=n,mt=z=a,B=et=s,Y=J=o,dt=dt-1|0;(dt|0)>0;)p(),tt(M,l,z,et,J,2147483648,0,0,0,0,0,0,0,0,0,672),M=i,l=n,z=a,et=s,J=o,S(),tt(M,l,z,et,J,2147483648,0,0,0,0,0,0,0,0,0,672),M=i,l=n,z=a,et=s,J=o,ft=ft^i,gt=gt^n,mt=mt^a,B=B^s,Y=Y^o,dt=dt-1|0;return i=ft,n=gt,a=mt,s=B,o=Y,~ut&&Q(ut),0}return{reset:d,init:b,process:_,finish:g,hmac_reset:p,hmac_init:D,hmac_finish:nt,pbkdf2_generate_block:st}};class Z2{constructor(){this.pos=0,this.len=0}reset(){const{asm:t}=this.acquire_asm();return this.result=null,this.pos=0,this.len=0,t.reset(),this}process(t){if(this.result!==null)throw new No("state must be reset before processing new data");const{asm:r,heap:i}=this.acquire_asm();let n=this.pos,a=this.len,s=0,o=t.length,u=0;for(;o>0;)u=Fi(i,n+a,t,s,o),a+=u,s+=u,o-=u,u=r.process(n,a),n+=u,a-=u,a||(n=0);return this.pos=n,this.len=a,this}finish(){if(this.result!==null)throw new No("state must be reset before processing new data");const{asm:t,heap:r}=this.acquire_asm();return t.finish(this.pos,this.len,0),this.result=new Uint8Array(this.HASH_SIZE),this.result.set(r.subarray(0,this.HASH_SIZE)),this.pos=0,this.len=0,this.release_asm(),this}}const a1=[],s1=[];class Oi extends Z2{constructor(){super(),this.NAME="sha1",this.BLOCK_SIZE=64,this.HASH_SIZE=20,this.acquire_asm()}acquire_asm(){return this.heap!==void 0&&this.asm!==void 0||(this.heap=a1.pop()||g0(),this.asm=s1.pop()||$2({Uint8Array},null,this.heap.buffer),this.reset()),{heap:this.heap,asm:this.asm}}release_asm(){this.heap!==void 0&&this.asm!==void 0&&(a1.push(this.heap),s1.push(this.asm)),this.heap=void 0,this.asm=void 0}static bytes(t){return new Oi().process(t).finish().result}}Oi.NAME="sha1",Oi.heap_pool=[],Oi.asm_pool=[],Oi.asm_function=$2;const o1=[],c1=[];class Ls extends Z2{constructor(){super(),this.NAME="sha256",this.BLOCK_SIZE=64,this.HASH_SIZE=32,this.acquire_asm()}acquire_asm(){return this.heap!==void 0&&this.asm!==void 0||(this.heap=o1.pop()||g0(),this.asm=c1.pop()||function(t,r,i){var n=0,a=0,s=0,o=0,u=0,c=0,h=0,f=0,m=0,y=0,K=0,I=0,U=0,V=0,Z=0,$=0,R=0,tt=0,X=0,Q=0,d=0,b=0,_=0,g=0,p=0,S=0,D=new t.Uint8Array(i);function nt(M,l,z,et,J,it,k,w,A,C,N,T,H,yt,lt,wt){M=M|0,l=l|0,z=z|0,et=et|0,J=J|0,it=it|0,k=k|0,w=w|0,A=A|0,C=C|0,N=N|0,T=T|0,H=H|0,yt=yt|0,lt=lt|0,wt=wt|0;var O=0,F=0,W=0,L=0,j=0,G=0,P=0,E=0;O=n,F=a,W=s,L=o,j=u,G=c,P=h,E=f,E=M+E+(j>>>6^j>>>11^j>>>25^j<<26^j<<21^j<<7)+(P^j&(G^P))+1116352408|0,L=L+E|0,E=E+(O&F^W&(O^F))+(O>>>2^O>>>13^O>>>22^O<<30^O<<19^O<<10)|0,P=l+P+(L>>>6^L>>>11^L>>>25^L<<26^L<<21^L<<7)+(G^L&(j^G))+1899447441|0,W=W+P|0,P=P+(E&O^F&(E^O))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,G=z+G+(W>>>6^W>>>11^W>>>25^W<<26^W<<21^W<<7)+(j^W&(L^j))+3049323471|0,F=F+G|0,G=G+(P&E^O&(P^E))+(P>>>2^P>>>13^P>>>22^P<<30^P<<19^P<<10)|0,j=et+j+(F>>>6^F>>>11^F>>>25^F<<26^F<<21^F<<7)+(L^F&(W^L))+3921009573|0,O=O+j|0,j=j+(G&P^E&(G^P))+(G>>>2^G>>>13^G>>>22^G<<30^G<<19^G<<10)|0,L=J+L+(O>>>6^O>>>11^O>>>25^O<<26^O<<21^O<<7)+(W^O&(F^W))+961987163|0,E=E+L|0,L=L+(j&G^P&(j^G))+(j>>>2^j>>>13^j>>>22^j<<30^j<<19^j<<10)|0,W=it+W+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(F^E&(O^F))+1508970993|0,P=P+W|0,W=W+(L&j^G&(L^j))+(L>>>2^L>>>13^L>>>22^L<<30^L<<19^L<<10)|0,F=k+F+(P>>>6^P>>>11^P>>>25^P<<26^P<<21^P<<7)+(O^P&(E^O))+2453635748|0,G=G+F|0,F=F+(W&L^j&(W^L))+(W>>>2^W>>>13^W>>>22^W<<30^W<<19^W<<10)|0,O=w+O+(G>>>6^G>>>11^G>>>25^G<<26^G<<21^G<<7)+(E^G&(P^E))+2870763221|0,j=j+O|0,O=O+(F&W^L&(F^W))+(F>>>2^F>>>13^F>>>22^F<<30^F<<19^F<<10)|0,E=A+E+(j>>>6^j>>>11^j>>>25^j<<26^j<<21^j<<7)+(P^j&(G^P))+3624381080|0,L=L+E|0,E=E+(O&F^W&(O^F))+(O>>>2^O>>>13^O>>>22^O<<30^O<<19^O<<10)|0,P=C+P+(L>>>6^L>>>11^L>>>25^L<<26^L<<21^L<<7)+(G^L&(j^G))+310598401|0,W=W+P|0,P=P+(E&O^F&(E^O))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,G=N+G+(W>>>6^W>>>11^W>>>25^W<<26^W<<21^W<<7)+(j^W&(L^j))+607225278|0,F=F+G|0,G=G+(P&E^O&(P^E))+(P>>>2^P>>>13^P>>>22^P<<30^P<<19^P<<10)|0,j=T+j+(F>>>6^F>>>11^F>>>25^F<<26^F<<21^F<<7)+(L^F&(W^L))+1426881987|0,O=O+j|0,j=j+(G&P^E&(G^P))+(G>>>2^G>>>13^G>>>22^G<<30^G<<19^G<<10)|0,L=H+L+(O>>>6^O>>>11^O>>>25^O<<26^O<<21^O<<7)+(W^O&(F^W))+1925078388|0,E=E+L|0,L=L+(j&G^P&(j^G))+(j>>>2^j>>>13^j>>>22^j<<30^j<<19^j<<10)|0,W=yt+W+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(F^E&(O^F))+2162078206|0,P=P+W|0,W=W+(L&j^G&(L^j))+(L>>>2^L>>>13^L>>>22^L<<30^L<<19^L<<10)|0,F=lt+F+(P>>>6^P>>>11^P>>>25^P<<26^P<<21^P<<7)+(O^P&(E^O))+2614888103|0,G=G+F|0,F=F+(W&L^j&(W^L))+(W>>>2^W>>>13^W>>>22^W<<30^W<<19^W<<10)|0,O=wt+O+(G>>>6^G>>>11^G>>>25^G<<26^G<<21^G<<7)+(E^G&(P^E))+3248222580|0,j=j+O|0,O=O+(F&W^L&(F^W))+(F>>>2^F>>>13^F>>>22^F<<30^F<<19^F<<10)|0,M=(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(lt>>>17^lt>>>19^lt>>>10^lt<<15^lt<<13)+M+C|0,E=M+E+(j>>>6^j>>>11^j>>>25^j<<26^j<<21^j<<7)+(P^j&(G^P))+3835390401|0,L=L+E|0,E=E+(O&F^W&(O^F))+(O>>>2^O>>>13^O>>>22^O<<30^O<<19^O<<10)|0,l=(z>>>7^z>>>18^z>>>3^z<<25^z<<14)+(wt>>>17^wt>>>19^wt>>>10^wt<<15^wt<<13)+l+N|0,P=l+P+(L>>>6^L>>>11^L>>>25^L<<26^L<<21^L<<7)+(G^L&(j^G))+4022224774|0,W=W+P|0,P=P+(E&O^F&(E^O))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,z=(et>>>7^et>>>18^et>>>3^et<<25^et<<14)+(M>>>17^M>>>19^M>>>10^M<<15^M<<13)+z+T|0,G=z+G+(W>>>6^W>>>11^W>>>25^W<<26^W<<21^W<<7)+(j^W&(L^j))+264347078|0,F=F+G|0,G=G+(P&E^O&(P^E))+(P>>>2^P>>>13^P>>>22^P<<30^P<<19^P<<10)|0,et=(J>>>7^J>>>18^J>>>3^J<<25^J<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+et+H|0,j=et+j+(F>>>6^F>>>11^F>>>25^F<<26^F<<21^F<<7)+(L^F&(W^L))+604807628|0,O=O+j|0,j=j+(G&P^E&(G^P))+(G>>>2^G>>>13^G>>>22^G<<30^G<<19^G<<10)|0,J=(it>>>7^it>>>18^it>>>3^it<<25^it<<14)+(z>>>17^z>>>19^z>>>10^z<<15^z<<13)+J+yt|0,L=J+L+(O>>>6^O>>>11^O>>>25^O<<26^O<<21^O<<7)+(W^O&(F^W))+770255983|0,E=E+L|0,L=L+(j&G^P&(j^G))+(j>>>2^j>>>13^j>>>22^j<<30^j<<19^j<<10)|0,it=(k>>>7^k>>>18^k>>>3^k<<25^k<<14)+(et>>>17^et>>>19^et>>>10^et<<15^et<<13)+it+lt|0,W=it+W+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(F^E&(O^F))+1249150122|0,P=P+W|0,W=W+(L&j^G&(L^j))+(L>>>2^L>>>13^L>>>22^L<<30^L<<19^L<<10)|0,k=(w>>>7^w>>>18^w>>>3^w<<25^w<<14)+(J>>>17^J>>>19^J>>>10^J<<15^J<<13)+k+wt|0,F=k+F+(P>>>6^P>>>11^P>>>25^P<<26^P<<21^P<<7)+(O^P&(E^O))+1555081692|0,G=G+F|0,F=F+(W&L^j&(W^L))+(W>>>2^W>>>13^W>>>22^W<<30^W<<19^W<<10)|0,w=(A>>>7^A>>>18^A>>>3^A<<25^A<<14)+(it>>>17^it>>>19^it>>>10^it<<15^it<<13)+w+M|0,O=w+O+(G>>>6^G>>>11^G>>>25^G<<26^G<<21^G<<7)+(E^G&(P^E))+1996064986|0,j=j+O|0,O=O+(F&W^L&(F^W))+(F>>>2^F>>>13^F>>>22^F<<30^F<<19^F<<10)|0,A=(C>>>7^C>>>18^C>>>3^C<<25^C<<14)+(k>>>17^k>>>19^k>>>10^k<<15^k<<13)+A+l|0,E=A+E+(j>>>6^j>>>11^j>>>25^j<<26^j<<21^j<<7)+(P^j&(G^P))+2554220882|0,L=L+E|0,E=E+(O&F^W&(O^F))+(O>>>2^O>>>13^O>>>22^O<<30^O<<19^O<<10)|0,C=(N>>>7^N>>>18^N>>>3^N<<25^N<<14)+(w>>>17^w>>>19^w>>>10^w<<15^w<<13)+C+z|0,P=C+P+(L>>>6^L>>>11^L>>>25^L<<26^L<<21^L<<7)+(G^L&(j^G))+2821834349|0,W=W+P|0,P=P+(E&O^F&(E^O))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,N=(T>>>7^T>>>18^T>>>3^T<<25^T<<14)+(A>>>17^A>>>19^A>>>10^A<<15^A<<13)+N+et|0,G=N+G+(W>>>6^W>>>11^W>>>25^W<<26^W<<21^W<<7)+(j^W&(L^j))+2952996808|0,F=F+G|0,G=G+(P&E^O&(P^E))+(P>>>2^P>>>13^P>>>22^P<<30^P<<19^P<<10)|0,T=(H>>>7^H>>>18^H>>>3^H<<25^H<<14)+(C>>>17^C>>>19^C>>>10^C<<15^C<<13)+T+J|0,j=T+j+(F>>>6^F>>>11^F>>>25^F<<26^F<<21^F<<7)+(L^F&(W^L))+3210313671|0,O=O+j|0,j=j+(G&P^E&(G^P))+(G>>>2^G>>>13^G>>>22^G<<30^G<<19^G<<10)|0,H=(yt>>>7^yt>>>18^yt>>>3^yt<<25^yt<<14)+(N>>>17^N>>>19^N>>>10^N<<15^N<<13)+H+it|0,L=H+L+(O>>>6^O>>>11^O>>>25^O<<26^O<<21^O<<7)+(W^O&(F^W))+3336571891|0,E=E+L|0,L=L+(j&G^P&(j^G))+(j>>>2^j>>>13^j>>>22^j<<30^j<<19^j<<10)|0,yt=(lt>>>7^lt>>>18^lt>>>3^lt<<25^lt<<14)+(T>>>17^T>>>19^T>>>10^T<<15^T<<13)+yt+k|0,W=yt+W+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(F^E&(O^F))+3584528711|0,P=P+W|0,W=W+(L&j^G&(L^j))+(L>>>2^L>>>13^L>>>22^L<<30^L<<19^L<<10)|0,lt=(wt>>>7^wt>>>18^wt>>>3^wt<<25^wt<<14)+(H>>>17^H>>>19^H>>>10^H<<15^H<<13)+lt+w|0,F=lt+F+(P>>>6^P>>>11^P>>>25^P<<26^P<<21^P<<7)+(O^P&(E^O))+113926993|0,G=G+F|0,F=F+(W&L^j&(W^L))+(W>>>2^W>>>13^W>>>22^W<<30^W<<19^W<<10)|0,wt=(M>>>7^M>>>18^M>>>3^M<<25^M<<14)+(yt>>>17^yt>>>19^yt>>>10^yt<<15^yt<<13)+wt+A|0,O=wt+O+(G>>>6^G>>>11^G>>>25^G<<26^G<<21^G<<7)+(E^G&(P^E))+338241895|0,j=j+O|0,O=O+(F&W^L&(F^W))+(F>>>2^F>>>13^F>>>22^F<<30^F<<19^F<<10)|0,M=(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(lt>>>17^lt>>>19^lt>>>10^lt<<15^lt<<13)+M+C|0,E=M+E+(j>>>6^j>>>11^j>>>25^j<<26^j<<21^j<<7)+(P^j&(G^P))+666307205|0,L=L+E|0,E=E+(O&F^W&(O^F))+(O>>>2^O>>>13^O>>>22^O<<30^O<<19^O<<10)|0,l=(z>>>7^z>>>18^z>>>3^z<<25^z<<14)+(wt>>>17^wt>>>19^wt>>>10^wt<<15^wt<<13)+l+N|0,P=l+P+(L>>>6^L>>>11^L>>>25^L<<26^L<<21^L<<7)+(G^L&(j^G))+773529912|0,W=W+P|0,P=P+(E&O^F&(E^O))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,z=(et>>>7^et>>>18^et>>>3^et<<25^et<<14)+(M>>>17^M>>>19^M>>>10^M<<15^M<<13)+z+T|0,G=z+G+(W>>>6^W>>>11^W>>>25^W<<26^W<<21^W<<7)+(j^W&(L^j))+1294757372|0,F=F+G|0,G=G+(P&E^O&(P^E))+(P>>>2^P>>>13^P>>>22^P<<30^P<<19^P<<10)|0,et=(J>>>7^J>>>18^J>>>3^J<<25^J<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+et+H|0,j=et+j+(F>>>6^F>>>11^F>>>25^F<<26^F<<21^F<<7)+(L^F&(W^L))+1396182291|0,O=O+j|0,j=j+(G&P^E&(G^P))+(G>>>2^G>>>13^G>>>22^G<<30^G<<19^G<<10)|0,J=(it>>>7^it>>>18^it>>>3^it<<25^it<<14)+(z>>>17^z>>>19^z>>>10^z<<15^z<<13)+J+yt|0,L=J+L+(O>>>6^O>>>11^O>>>25^O<<26^O<<21^O<<7)+(W^O&(F^W))+1695183700|0,E=E+L|0,L=L+(j&G^P&(j^G))+(j>>>2^j>>>13^j>>>22^j<<30^j<<19^j<<10)|0,it=(k>>>7^k>>>18^k>>>3^k<<25^k<<14)+(et>>>17^et>>>19^et>>>10^et<<15^et<<13)+it+lt|0,W=it+W+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(F^E&(O^F))+1986661051|0,P=P+W|0,W=W+(L&j^G&(L^j))+(L>>>2^L>>>13^L>>>22^L<<30^L<<19^L<<10)|0,k=(w>>>7^w>>>18^w>>>3^w<<25^w<<14)+(J>>>17^J>>>19^J>>>10^J<<15^J<<13)+k+wt|0,F=k+F+(P>>>6^P>>>11^P>>>25^P<<26^P<<21^P<<7)+(O^P&(E^O))+2177026350|0,G=G+F|0,F=F+(W&L^j&(W^L))+(W>>>2^W>>>13^W>>>22^W<<30^W<<19^W<<10)|0,w=(A>>>7^A>>>18^A>>>3^A<<25^A<<14)+(it>>>17^it>>>19^it>>>10^it<<15^it<<13)+w+M|0,O=w+O+(G>>>6^G>>>11^G>>>25^G<<26^G<<21^G<<7)+(E^G&(P^E))+2456956037|0,j=j+O|0,O=O+(F&W^L&(F^W))+(F>>>2^F>>>13^F>>>22^F<<30^F<<19^F<<10)|0,A=(C>>>7^C>>>18^C>>>3^C<<25^C<<14)+(k>>>17^k>>>19^k>>>10^k<<15^k<<13)+A+l|0,E=A+E+(j>>>6^j>>>11^j>>>25^j<<26^j<<21^j<<7)+(P^j&(G^P))+2730485921|0,L=L+E|0,E=E+(O&F^W&(O^F))+(O>>>2^O>>>13^O>>>22^O<<30^O<<19^O<<10)|0,C=(N>>>7^N>>>18^N>>>3^N<<25^N<<14)+(w>>>17^w>>>19^w>>>10^w<<15^w<<13)+C+z|0,P=C+P+(L>>>6^L>>>11^L>>>25^L<<26^L<<21^L<<7)+(G^L&(j^G))+2820302411|0,W=W+P|0,P=P+(E&O^F&(E^O))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,N=(T>>>7^T>>>18^T>>>3^T<<25^T<<14)+(A>>>17^A>>>19^A>>>10^A<<15^A<<13)+N+et|0,G=N+G+(W>>>6^W>>>11^W>>>25^W<<26^W<<21^W<<7)+(j^W&(L^j))+3259730800|0,F=F+G|0,G=G+(P&E^O&(P^E))+(P>>>2^P>>>13^P>>>22^P<<30^P<<19^P<<10)|0,T=(H>>>7^H>>>18^H>>>3^H<<25^H<<14)+(C>>>17^C>>>19^C>>>10^C<<15^C<<13)+T+J|0,j=T+j+(F>>>6^F>>>11^F>>>25^F<<26^F<<21^F<<7)+(L^F&(W^L))+3345764771|0,O=O+j|0,j=j+(G&P^E&(G^P))+(G>>>2^G>>>13^G>>>22^G<<30^G<<19^G<<10)|0,H=(yt>>>7^yt>>>18^yt>>>3^yt<<25^yt<<14)+(N>>>17^N>>>19^N>>>10^N<<15^N<<13)+H+it|0,L=H+L+(O>>>6^O>>>11^O>>>25^O<<26^O<<21^O<<7)+(W^O&(F^W))+3516065817|0,E=E+L|0,L=L+(j&G^P&(j^G))+(j>>>2^j>>>13^j>>>22^j<<30^j<<19^j<<10)|0,yt=(lt>>>7^lt>>>18^lt>>>3^lt<<25^lt<<14)+(T>>>17^T>>>19^T>>>10^T<<15^T<<13)+yt+k|0,W=yt+W+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(F^E&(O^F))+3600352804|0,P=P+W|0,W=W+(L&j^G&(L^j))+(L>>>2^L>>>13^L>>>22^L<<30^L<<19^L<<10)|0,lt=(wt>>>7^wt>>>18^wt>>>3^wt<<25^wt<<14)+(H>>>17^H>>>19^H>>>10^H<<15^H<<13)+lt+w|0,F=lt+F+(P>>>6^P>>>11^P>>>25^P<<26^P<<21^P<<7)+(O^P&(E^O))+4094571909|0,G=G+F|0,F=F+(W&L^j&(W^L))+(W>>>2^W>>>13^W>>>22^W<<30^W<<19^W<<10)|0,wt=(M>>>7^M>>>18^M>>>3^M<<25^M<<14)+(yt>>>17^yt>>>19^yt>>>10^yt<<15^yt<<13)+wt+A|0,O=wt+O+(G>>>6^G>>>11^G>>>25^G<<26^G<<21^G<<7)+(E^G&(P^E))+275423344|0,j=j+O|0,O=O+(F&W^L&(F^W))+(F>>>2^F>>>13^F>>>22^F<<30^F<<19^F<<10)|0,M=(l>>>7^l>>>18^l>>>3^l<<25^l<<14)+(lt>>>17^lt>>>19^lt>>>10^lt<<15^lt<<13)+M+C|0,E=M+E+(j>>>6^j>>>11^j>>>25^j<<26^j<<21^j<<7)+(P^j&(G^P))+430227734|0,L=L+E|0,E=E+(O&F^W&(O^F))+(O>>>2^O>>>13^O>>>22^O<<30^O<<19^O<<10)|0,l=(z>>>7^z>>>18^z>>>3^z<<25^z<<14)+(wt>>>17^wt>>>19^wt>>>10^wt<<15^wt<<13)+l+N|0,P=l+P+(L>>>6^L>>>11^L>>>25^L<<26^L<<21^L<<7)+(G^L&(j^G))+506948616|0,W=W+P|0,P=P+(E&O^F&(E^O))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,z=(et>>>7^et>>>18^et>>>3^et<<25^et<<14)+(M>>>17^M>>>19^M>>>10^M<<15^M<<13)+z+T|0,G=z+G+(W>>>6^W>>>11^W>>>25^W<<26^W<<21^W<<7)+(j^W&(L^j))+659060556|0,F=F+G|0,G=G+(P&E^O&(P^E))+(P>>>2^P>>>13^P>>>22^P<<30^P<<19^P<<10)|0,et=(J>>>7^J>>>18^J>>>3^J<<25^J<<14)+(l>>>17^l>>>19^l>>>10^l<<15^l<<13)+et+H|0,j=et+j+(F>>>6^F>>>11^F>>>25^F<<26^F<<21^F<<7)+(L^F&(W^L))+883997877|0,O=O+j|0,j=j+(G&P^E&(G^P))+(G>>>2^G>>>13^G>>>22^G<<30^G<<19^G<<10)|0,J=(it>>>7^it>>>18^it>>>3^it<<25^it<<14)+(z>>>17^z>>>19^z>>>10^z<<15^z<<13)+J+yt|0,L=J+L+(O>>>6^O>>>11^O>>>25^O<<26^O<<21^O<<7)+(W^O&(F^W))+958139571|0,E=E+L|0,L=L+(j&G^P&(j^G))+(j>>>2^j>>>13^j>>>22^j<<30^j<<19^j<<10)|0,it=(k>>>7^k>>>18^k>>>3^k<<25^k<<14)+(et>>>17^et>>>19^et>>>10^et<<15^et<<13)+it+lt|0,W=it+W+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(F^E&(O^F))+1322822218|0,P=P+W|0,W=W+(L&j^G&(L^j))+(L>>>2^L>>>13^L>>>22^L<<30^L<<19^L<<10)|0,k=(w>>>7^w>>>18^w>>>3^w<<25^w<<14)+(J>>>17^J>>>19^J>>>10^J<<15^J<<13)+k+wt|0,F=k+F+(P>>>6^P>>>11^P>>>25^P<<26^P<<21^P<<7)+(O^P&(E^O))+1537002063|0,G=G+F|0,F=F+(W&L^j&(W^L))+(W>>>2^W>>>13^W>>>22^W<<30^W<<19^W<<10)|0,w=(A>>>7^A>>>18^A>>>3^A<<25^A<<14)+(it>>>17^it>>>19^it>>>10^it<<15^it<<13)+w+M|0,O=w+O+(G>>>6^G>>>11^G>>>25^G<<26^G<<21^G<<7)+(E^G&(P^E))+1747873779|0,j=j+O|0,O=O+(F&W^L&(F^W))+(F>>>2^F>>>13^F>>>22^F<<30^F<<19^F<<10)|0,A=(C>>>7^C>>>18^C>>>3^C<<25^C<<14)+(k>>>17^k>>>19^k>>>10^k<<15^k<<13)+A+l|0,E=A+E+(j>>>6^j>>>11^j>>>25^j<<26^j<<21^j<<7)+(P^j&(G^P))+1955562222|0,L=L+E|0,E=E+(O&F^W&(O^F))+(O>>>2^O>>>13^O>>>22^O<<30^O<<19^O<<10)|0,C=(N>>>7^N>>>18^N>>>3^N<<25^N<<14)+(w>>>17^w>>>19^w>>>10^w<<15^w<<13)+C+z|0,P=C+P+(L>>>6^L>>>11^L>>>25^L<<26^L<<21^L<<7)+(G^L&(j^G))+2024104815|0,W=W+P|0,P=P+(E&O^F&(E^O))+(E>>>2^E>>>13^E>>>22^E<<30^E<<19^E<<10)|0,N=(T>>>7^T>>>18^T>>>3^T<<25^T<<14)+(A>>>17^A>>>19^A>>>10^A<<15^A<<13)+N+et|0,G=N+G+(W>>>6^W>>>11^W>>>25^W<<26^W<<21^W<<7)+(j^W&(L^j))+2227730452|0,F=F+G|0,G=G+(P&E^O&(P^E))+(P>>>2^P>>>13^P>>>22^P<<30^P<<19^P<<10)|0,T=(H>>>7^H>>>18^H>>>3^H<<25^H<<14)+(C>>>17^C>>>19^C>>>10^C<<15^C<<13)+T+J|0,j=T+j+(F>>>6^F>>>11^F>>>25^F<<26^F<<21^F<<7)+(L^F&(W^L))+2361852424|0,O=O+j|0,j=j+(G&P^E&(G^P))+(G>>>2^G>>>13^G>>>22^G<<30^G<<19^G<<10)|0,H=(yt>>>7^yt>>>18^yt>>>3^yt<<25^yt<<14)+(N>>>17^N>>>19^N>>>10^N<<15^N<<13)+H+it|0,L=H+L+(O>>>6^O>>>11^O>>>25^O<<26^O<<21^O<<7)+(W^O&(F^W))+2428436474|0,E=E+L|0,L=L+(j&G^P&(j^G))+(j>>>2^j>>>13^j>>>22^j<<30^j<<19^j<<10)|0,yt=(lt>>>7^lt>>>18^lt>>>3^lt<<25^lt<<14)+(T>>>17^T>>>19^T>>>10^T<<15^T<<13)+yt+k|0,W=yt+W+(E>>>6^E>>>11^E>>>25^E<<26^E<<21^E<<7)+(F^E&(O^F))+2756734187|0,P=P+W|0,W=W+(L&j^G&(L^j))+(L>>>2^L>>>13^L>>>22^L<<30^L<<19^L<<10)|0,lt=(wt>>>7^wt>>>18^wt>>>3^wt<<25^wt<<14)+(H>>>17^H>>>19^H>>>10^H<<15^H<<13)+lt+w|0,F=lt+F+(P>>>6^P>>>11^P>>>25^P<<26^P<<21^P<<7)+(O^P&(E^O))+3204031479|0,G=G+F|0,F=F+(W&L^j&(W^L))+(W>>>2^W>>>13^W>>>22^W<<30^W<<19^W<<10)|0,wt=(M>>>7^M>>>18^M>>>3^M<<25^M<<14)+(yt>>>17^yt>>>19^yt>>>10^yt<<15^yt<<13)+wt+A|0,O=wt+O+(G>>>6^G>>>11^G>>>25^G<<26^G<<21^G<<7)+(E^G&(P^E))+3329325298|0,j=j+O|0,O=O+(F&W^L&(F^W))+(F>>>2^F>>>13^F>>>22^F<<30^F<<19^F<<10)|0,n=n+O|0,a=a+F|0,s=s+W|0,o=o+L|0,u=u+j|0,c=c+G|0,h=h+P|0,f=f+E|0}function st(M){M=M|0,nt(D[M|0]<<24|D[M|1]<<16|D[M|2]<<8|D[M|3],D[M|4]<<24|D[M|5]<<16|D[M|6]<<8|D[M|7],D[M|8]<<24|D[M|9]<<16|D[M|10]<<8|D[M|11],D[M|12]<<24|D[M|13]<<16|D[M|14]<<8|D[M|15],D[M|16]<<24|D[M|17]<<16|D[M|18]<<8|D[M|19],D[M|20]<<24|D[M|21]<<16|D[M|22]<<8|D[M|23],D[M|24]<<24|D[M|25]<<16|D[M|26]<<8|D[M|27],D[M|28]<<24|D[M|29]<<16|D[M|30]<<8|D[M|31],D[M|32]<<24|D[M|33]<<16|D[M|34]<<8|D[M|35],D[M|36]<<24|D[M|37]<<16|D[M|38]<<8|D[M|39],D[M|40]<<24|D[M|41]<<16|D[M|42]<<8|D[M|43],D[M|44]<<24|D[M|45]<<16|D[M|46]<<8|D[M|47],D[M|48]<<24|D[M|49]<<16|D[M|50]<<8|D[M|51],D[M|52]<<24|D[M|53]<<16|D[M|54]<<8|D[M|55],D[M|56]<<24|D[M|57]<<16|D[M|58]<<8|D[M|59],D[M|60]<<24|D[M|61]<<16|D[M|62]<<8|D[M|63])}function q(M){M=M|0,D[M|0]=n>>>24,D[M|1]=n>>>16&255,D[M|2]=n>>>8&255,D[M|3]=n&255,D[M|4]=a>>>24,D[M|5]=a>>>16&255,D[M|6]=a>>>8&255,D[M|7]=a&255,D[M|8]=s>>>24,D[M|9]=s>>>16&255,D[M|10]=s>>>8&255,D[M|11]=s&255,D[M|12]=o>>>24,D[M|13]=o>>>16&255,D[M|14]=o>>>8&255,D[M|15]=o&255,D[M|16]=u>>>24,D[M|17]=u>>>16&255,D[M|18]=u>>>8&255,D[M|19]=u&255,D[M|20]=c>>>24,D[M|21]=c>>>16&255,D[M|22]=c>>>8&255,D[M|23]=c&255,D[M|24]=h>>>24,D[M|25]=h>>>16&255,D[M|26]=h>>>8&255,D[M|27]=h&255,D[M|28]=f>>>24,D[M|29]=f>>>16&255,D[M|30]=f>>>8&255,D[M|31]=f&255}function rt(){n=1779033703,a=3144134277,s=1013904242,o=2773480762,u=1359893119,c=2600822924,h=528734635,f=1541459225,m=y=0}function ct(M,l,z,et,J,it,k,w,A,C){M=M|0,l=l|0,z=z|0,et=et|0,J=J|0,it=it|0,k=k|0,w=w|0,A=A|0,C=C|0,n=M,a=l,s=z,o=et,u=J,c=it,h=k,f=w,m=A,y=C}function dt(M,l){M=M|0,l=l|0;var z=0;if(M&63)return-1;for(;(l|0)>=64;)st(M),M=M+64|0,l=l-64|0,z=z+64|0;return m=m+z|0,m>>>0<z>>>0&&(y=y+1|0),z|0}function ut(M,l,z){M=M|0,l=l|0,z=z|0;var et=0,J=0;if(M&63||~z&&z&31)return-1;if((l|0)>=64){if(et=dt(M,l)|0,(et|0)==-1)return-1;M=M+et|0,l=l-et|0}if(et=et+l|0,m=m+l|0,m>>>0<l>>>0&&(y=y+1|0),D[M|l]=128,(l|0)>=56){for(J=l+1|0;(J|0)<64;J=J+1|0)D[M|J]=0;st(M),l=0,D[M|0]=0}for(J=l+1|0;(J|0)<59;J=J+1|0)D[M|J]=0;return D[M|56]=y>>>21&255,D[M|57]=y>>>13&255,D[M|58]=y>>>5&255,D[M|59]=y<<3&255|m>>>29,D[M|60]=m>>>21&255,D[M|61]=m>>>13&255,D[M|62]=m>>>5&255,D[M|63]=m<<3&255,st(M),~z&&q(z),et|0}function ft(){n=K,a=I,s=U,o=V,u=Z,c=$,h=R,f=tt,m=64,y=0}function gt(){n=X,a=Q,s=d,o=b,u=_,c=g,h=p,f=S,m=64,y=0}function mt(M,l,z,et,J,it,k,w,A,C,N,T,H,yt,lt,wt){M=M|0,l=l|0,z=z|0,et=et|0,J=J|0,it=it|0,k=k|0,w=w|0,A=A|0,C=C|0,N=N|0,T=T|0,H=H|0,yt=yt|0,lt=lt|0,wt=wt|0,rt(),nt(M^1549556828,l^1549556828,z^1549556828,et^1549556828,J^1549556828,it^1549556828,k^1549556828,w^1549556828,A^1549556828,C^1549556828,N^1549556828,T^1549556828,H^1549556828,yt^1549556828,lt^1549556828,wt^1549556828),X=n,Q=a,d=s,b=o,_=u,g=c,p=h,S=f,rt(),nt(M^909522486,l^909522486,z^909522486,et^909522486,J^909522486,it^909522486,k^909522486,w^909522486,A^909522486,C^909522486,N^909522486,T^909522486,H^909522486,yt^909522486,lt^909522486,wt^909522486),K=n,I=a,U=s,V=o,Z=u,$=c,R=h,tt=f,m=64,y=0}function B(M,l,z){M=M|0,l=l|0,z=z|0;var et=0,J=0,it=0,k=0,w=0,A=0,C=0,N=0,T=0;return M&63||~z&&z&31?-1:(T=ut(M,l,-1)|0,et=n,J=a,it=s,k=o,w=u,A=c,C=h,N=f,gt(),nt(et,J,it,k,w,A,C,N,2147483648,0,0,0,0,0,0,768),~z&&q(z),T|0)}function Y(M,l,z,et,J){M=M|0,l=l|0,z=z|0,et=et|0,J=J|0;var it=0,k=0,w=0,A=0,C=0,N=0,T=0,H=0,yt=0,lt=0,wt=0,O=0,F=0,W=0,L=0,j=0;if(M&63||~J&&J&31)return-1;for(D[M+l|0]=z>>>24,D[M+l+1|0]=z>>>16&255,D[M+l+2|0]=z>>>8&255,D[M+l+3|0]=z&255,B(M,l+4|0,-1)|0,it=yt=n,k=lt=a,w=wt=s,A=O=o,C=F=u,N=W=c,T=L=h,H=j=f,et=et-1|0;(et|0)>0;)ft(),nt(yt,lt,wt,O,F,W,L,j,2147483648,0,0,0,0,0,0,768),yt=n,lt=a,wt=s,O=o,F=u,W=c,L=h,j=f,gt(),nt(yt,lt,wt,O,F,W,L,j,2147483648,0,0,0,0,0,0,768),yt=n,lt=a,wt=s,O=o,F=u,W=c,L=h,j=f,it=it^n,k=k^a,w=w^s,A=A^o,C=C^u,N=N^c,T=T^h,H=H^f,et=et-1|0;return n=it,a=k,s=w,o=A,u=C,c=N,h=T,f=H,~J&&q(J),0}return{reset:rt,init:ct,process:dt,finish:ut,hmac_reset:ft,hmac_init:mt,hmac_finish:B,pbkdf2_generate_block:Y}}({Uint8Array},null,this.heap.buffer),this.reset()),{heap:this.heap,asm:this.asm}}release_asm(){this.heap!==void 0&&this.asm!==void 0&&(o1.push(this.heap),c1.push(this.asm)),this.heap=void 0,this.asm=void 0}static bytes(t){return new Ls().process(t).finish().result}}Ls.NAME="sha256";var xi=Y2;function Y2(e,t){if(!e)throw Error(t||"Assertion failed")}Y2.equal=function(e,t,r){if(e!=t)throw Error(r||"Assertion failed: "+e+" != "+t)};var Z3=je!==void 0?je:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Br(e,t){return e(t={exports:{}},t.exports),t.exports}var _i=Br(function(e){e.exports=typeof Object.create=="function"?function(t,r){t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,r){t.super_=r;var i=function(){};i.prototype=r.prototype,t.prototype=new i,t.prototype.constructor=t}});function u1(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function h1(e){return e.length===1?"0"+e:e}function d1(e){return e.length===7?"0"+e:e.length===6?"00"+e:e.length===5?"000"+e:e.length===4?"0000"+e:e.length===3?"00000"+e:e.length===2?"000000"+e:e.length===1?"0000000"+e:e}var Ft={inherits:_i,toArray:function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if(typeof e=="string")if(t){if(t==="hex")for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)r.push(parseInt(e[i]+e[i+1],16))}else for(var i=0;i<e.length;i++){var n=e.charCodeAt(i),a=n>>8,s=255&n;a?r.push(a,s):r.push(s)}else for(i=0;i<e.length;i++)r[i]=0|e[i];return r},toHex:function(e){for(var t="",r=0;r<e.length;r++)t+=h1(e[r].toString(16));return t},htonl:u1,toHex32:function(e,t){for(var r="",i=0;i<e.length;i++){var n=e[i];t==="little"&&(n=u1(n)),r+=d1(n.toString(16))}return r},zero2:h1,zero8:d1,join32:function(e,t,r,i){var n=r-t;xi(n%4==0);for(var a=Array(n/4),s=0,o=t;s<a.length;s++,o+=4){var u;u=i==="big"?e[o]<<24|e[o+1]<<16|e[o+2]<<8|e[o+3]:e[o+3]<<24|e[o+2]<<16|e[o+1]<<8|e[o],a[s]=u>>>0}return a},split32:function(e,t){for(var r=Array(4*e.length),i=0,n=0;i<e.length;i++,n+=4){var a=e[i];t==="big"?(r[n]=a>>>24,r[n+1]=a>>>16&255,r[n+2]=a>>>8&255,r[n+3]=255&a):(r[n+3]=a>>>24,r[n+2]=a>>>16&255,r[n+1]=a>>>8&255,r[n]=255&a)}return r},rotr32:function(e,t){return e>>>t|e<<32-t},rotl32:function(e,t){return e<<t|e>>>32-t},sum32:function(e,t){return e+t>>>0},sum32_3:function(e,t,r){return e+t+r>>>0},sum32_4:function(e,t,r,i){return e+t+r+i>>>0},sum32_5:function(e,t,r,i,n){return e+t+r+i+n>>>0},sum64:function(e,t,r,i){var n=e[t],a=i+e[t+1]>>>0,s=(a<i?1:0)+r+n;e[t]=s>>>0,e[t+1]=a},sum64_hi:function(e,t,r,i){return(t+i>>>0<t?1:0)+e+r>>>0},sum64_lo:function(e,t,r,i){return t+i>>>0},sum64_4_hi:function(e,t,r,i,n,a,s,o){var u=0,c=t;return u+=(c=c+i>>>0)<t?1:0,u+=(c=c+a>>>0)<a?1:0,e+r+n+s+(u+=(c=c+o>>>0)<o?1:0)>>>0},sum64_4_lo:function(e,t,r,i,n,a,s,o){return t+i+a+o>>>0},sum64_5_hi:function(e,t,r,i,n,a,s,o,u,c){var h=0,f=t;return h+=(f=f+i>>>0)<t?1:0,h+=(f=f+a>>>0)<a?1:0,h+=(f=f+o>>>0)<o?1:0,e+r+n+s+u+(h+=(f=f+c>>>0)<c?1:0)>>>0},sum64_5_lo:function(e,t,r,i,n,a,s,o,u,c){return t+i+a+o+c>>>0},rotr64_hi:function(e,t,r){return(t<<32-r|e>>>r)>>>0},rotr64_lo:function(e,t,r){return(e<<32-r|t>>>r)>>>0},shr64_hi:function(e,t,r){return e>>>r},shr64_lo:function(e,t,r){return(e<<32-r|t>>>r)>>>0}};function Va(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var Y3=Va;Va.prototype.update=function(e,t){if(e=Ft.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var r=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-r,e.length),this.pending.length===0&&(this.pending=null),e=Ft.join32(e,0,e.length-r,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this},Va.prototype.digest=function(e){return this.update(this._pad()),xi(this.pending===null),this._digest(e)},Va.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,r=t-(e+this.padLength)%t,i=Array(r+this.padLength);i[0]=128;for(var n=1;n<r;n++)i[n]=0;if(e<<=3,this.endian==="big"){for(var a=8;a<this.padLength;a++)i[n++]=0;i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=e>>>24&255,i[n++]=e>>>16&255,i[n++]=e>>>8&255,i[n++]=255&e}else for(i[n++]=255&e,i[n++]=e>>>8&255,i[n++]=e>>>16&255,i[n++]=e>>>24&255,i[n++]=0,i[n++]=0,i[n++]=0,i[n++]=0,a=8;a<this.padLength;a++)i[n++]=0;return i};var va={BlockHash:Y3},dr=Ft.rotr32;function f1(e,t,r){return e&t^~e&r}function l1(e,t,r){return e&t^e&r^t&r}function p1(e,t,r){return e^t^r}var Qi={ft_1:function(e,t,r,i){return e===0?f1(t,r,i):e===1||e===3?p1(t,r,i):e===2?l1(t,r,i):void 0},ch32:f1,maj32:l1,p32:p1,s0_256:function(e){return dr(e,2)^dr(e,13)^dr(e,22)},s1_256:function(e){return dr(e,6)^dr(e,11)^dr(e,25)},g0_256:function(e){return dr(e,7)^dr(e,18)^e>>>3},g1_256:function(e){return dr(e,17)^dr(e,19)^e>>>10}},Ze=Ft.sum32,X3=Ft.sum32_4,Q3=Ft.sum32_5,J3=Qi.ch32,tu=Qi.maj32,eu=Qi.s0_256,ru=Qi.s1_256,iu=Qi.g0_256,nu=Qi.g1_256,X2=va.BlockHash,au=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function mr(){if(!(this instanceof mr))return new mr;X2.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=au,this.W=Array(64)}Ft.inherits(mr,X2);var v0=mr;function jr(){if(!(this instanceof jr))return new jr;v0.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}mr.blockSize=512,mr.outSize=256,mr.hmacStrength=192,mr.padLength=64,mr.prototype._update=function(e,t){for(var r=this.W,i=0;i<16;i++)r[i]=e[t+i];for(;i<r.length;i++)r[i]=X3(nu(r[i-2]),r[i-7],iu(r[i-15]),r[i-16]);var n=this.h[0],a=this.h[1],s=this.h[2],o=this.h[3],u=this.h[4],c=this.h[5],h=this.h[6],f=this.h[7];for(xi(this.k.length===r.length),i=0;i<r.length;i++){var m=Q3(f,ru(u),J3(u,c,h),this.k[i],r[i]),y=Ze(eu(n),tu(n,a,s));f=h,h=c,c=u,u=Ze(o,m),o=s,s=a,a=n,n=Ze(m,y)}this.h[0]=Ze(this.h[0],n),this.h[1]=Ze(this.h[1],a),this.h[2]=Ze(this.h[2],s),this.h[3]=Ze(this.h[3],o),this.h[4]=Ze(this.h[4],u),this.h[5]=Ze(this.h[5],c),this.h[6]=Ze(this.h[6],h),this.h[7]=Ze(this.h[7],f)},mr.prototype._digest=function(e){return e==="hex"?Ft.toHex32(this.h,"big"):Ft.split32(this.h,"big")},Ft.inherits(jr,v0);var Q2=jr;jr.blockSize=512,jr.outSize=224,jr.hmacStrength=192,jr.padLength=64,jr.prototype._digest=function(e){return e==="hex"?Ft.toHex32(this.h.slice(0,7),"big"):Ft.split32(this.h.slice(0,7),"big")};var Pr=Ft.rotr64_hi,xr=Ft.rotr64_lo,J2=Ft.shr64_hi,tc=Ft.shr64_lo,oi=Ft.sum64,fo=Ft.sum64_hi,lo=Ft.sum64_lo,su=Ft.sum64_4_hi,ou=Ft.sum64_4_lo,cu=Ft.sum64_5_hi,uu=Ft.sum64_5_lo,ec=va.BlockHash,hu=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Xe(){if(!(this instanceof Xe))return new Xe;ec.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=hu,this.W=Array(160)}Ft.inherits(Xe,ec);var _a=Xe;function du(e,t,r,i,n){var a=e&r^~e&n;return a<0&&(a+=4294967296),a}function fu(e,t,r,i,n,a){var s=t&i^~t&a;return s<0&&(s+=4294967296),s}function lu(e,t,r,i,n){var a=e&r^e&n^r&n;return a<0&&(a+=4294967296),a}function pu(e,t,r,i,n,a){var s=t&i^t&a^i&a;return s<0&&(s+=4294967296),s}function yu(e,t){var r=Pr(e,t,28)^Pr(t,e,2)^Pr(t,e,7);return r<0&&(r+=4294967296),r}function bu(e,t){var r=xr(e,t,28)^xr(t,e,2)^xr(t,e,7);return r<0&&(r+=4294967296),r}function mu(e,t){var r=Pr(e,t,14)^Pr(e,t,18)^Pr(t,e,9);return r<0&&(r+=4294967296),r}function gu(e,t){var r=xr(e,t,14)^xr(e,t,18)^xr(t,e,9);return r<0&&(r+=4294967296),r}function wu(e,t){var r=Pr(e,t,1)^Pr(e,t,8)^J2(e,t,7);return r<0&&(r+=4294967296),r}function vu(e,t){var r=xr(e,t,1)^xr(e,t,8)^tc(e,t,7);return r<0&&(r+=4294967296),r}function _u(e,t){var r=Pr(e,t,19)^Pr(t,e,29)^J2(e,t,6);return r<0&&(r+=4294967296),r}function ku(e,t){var r=xr(e,t,19)^xr(t,e,29)^tc(e,t,6);return r<0&&(r+=4294967296),r}function Wr(){if(!(this instanceof Wr))return new Wr;_a.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}Xe.blockSize=1024,Xe.outSize=512,Xe.hmacStrength=192,Xe.padLength=128,Xe.prototype._prepareBlock=function(e,t){for(var r=this.W,i=0;i<32;i++)r[i]=e[t+i];for(;i<r.length;i+=2){var n=_u(r[i-4],r[i-3]),a=ku(r[i-4],r[i-3]),s=r[i-14],o=r[i-13],u=wu(r[i-30],r[i-29]),c=vu(r[i-30],r[i-29]),h=r[i-32],f=r[i-31];r[i]=su(n,a,s,o,u,c,h,f),r[i+1]=ou(n,a,s,o,u,c,h,f)}},Xe.prototype._update=function(e,t){this._prepareBlock(e,t);var r=this.W,i=this.h[0],n=this.h[1],a=this.h[2],s=this.h[3],o=this.h[4],u=this.h[5],c=this.h[6],h=this.h[7],f=this.h[8],m=this.h[9],y=this.h[10],K=this.h[11],I=this.h[12],U=this.h[13],V=this.h[14],Z=this.h[15];xi(this.k.length===r.length);for(var $=0;$<r.length;$+=2){var R=V,tt=Z,X=mu(f,m),Q=gu(f,m),d=du(f,m,y,K,I),b=fu(f,m,y,K,I,U),_=this.k[$],g=this.k[$+1],p=r[$],S=r[$+1],D=cu(R,tt,X,Q,d,b,_,g,p,S),nt=uu(R,tt,X,Q,d,b,_,g,p,S);R=yu(i,n),tt=bu(i,n),X=lu(i,n,a,s,o),Q=pu(i,n,a,s,o,u);var st=fo(R,tt,X,Q),q=lo(R,tt,X,Q);V=I,Z=U,I=y,U=K,y=f,K=m,f=fo(c,h,D,nt),m=lo(h,h,D,nt),c=o,h=u,o=a,u=s,a=i,s=n,i=fo(D,nt,st,q),n=lo(D,nt,st,q)}oi(this.h,0,i,n),oi(this.h,2,a,s),oi(this.h,4,o,u),oi(this.h,6,c,h),oi(this.h,8,f,m),oi(this.h,10,y,K),oi(this.h,12,I,U),oi(this.h,14,V,Z)},Xe.prototype._digest=function(e){return e==="hex"?Ft.toHex32(this.h,"big"):Ft.split32(this.h,"big")},Ft.inherits(Wr,_a);var rc=Wr;Wr.blockSize=1024,Wr.outSize=384,Wr.hmacStrength=192,Wr.padLength=128,Wr.prototype._digest=function(e){return e==="hex"?Ft.toHex32(this.h.slice(0,12),"big"):Ft.split32(this.h.slice(0,12),"big")};var Ca=Ft.rotl32,y1=Ft.sum32,Rn=Ft.sum32_3,b1=Ft.sum32_4,ic=va.BlockHash;function gr(){if(!(this instanceof gr))return new gr;ic.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Ft.inherits(gr,ic);var nc=gr;function m1(e,t,r,i){return e<=15?t^r^i:e<=31?t&r|~t&i:e<=47?(t|~r)^i:e<=63?t&i|r&~i:t^(r|~i)}function Au(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function Su(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}gr.blockSize=512,gr.outSize=160,gr.hmacStrength=192,gr.padLength=64,gr.prototype._update=function(e,t){for(var r=this.h[0],i=this.h[1],n=this.h[2],a=this.h[3],s=this.h[4],o=r,u=i,c=n,h=a,f=s,m=0;m<80;m++){var y=y1(Ca(b1(r,m1(m,i,n,a),e[Eu[m]+t],Au(m)),xu[m]),s);r=s,s=a,a=Ca(n,10),n=i,i=y,y=y1(Ca(b1(o,m1(79-m,u,c,h),e[Pu[m]+t],Su(m)),Mu[m]),f),o=f,f=h,h=Ca(c,10),c=u,u=y}y=Rn(this.h[1],n,h),this.h[1]=Rn(this.h[2],a,f),this.h[2]=Rn(this.h[3],s,o),this.h[3]=Rn(this.h[4],r,u),this.h[4]=Rn(this.h[0],i,c),this.h[0]=y},gr.prototype._digest=function(e){return e==="hex"?Ft.toHex32(this.h,"little"):Ft.split32(this.h,"little")};var Eu=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],Pu=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],xu=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],Mu=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],Cu={ripemd160:nc};function po(e,t){let r=e[0],i=e[1],n=e[2],a=e[3];r=we(r,i,n,a,t[0],7,-680876936),a=we(a,r,i,n,t[1],12,-389564586),n=we(n,a,r,i,t[2],17,606105819),i=we(i,n,a,r,t[3],22,-1044525330),r=we(r,i,n,a,t[4],7,-176418897),a=we(a,r,i,n,t[5],12,1200080426),n=we(n,a,r,i,t[6],17,-1473231341),i=we(i,n,a,r,t[7],22,-45705983),r=we(r,i,n,a,t[8],7,1770035416),a=we(a,r,i,n,t[9],12,-1958414417),n=we(n,a,r,i,t[10],17,-42063),i=we(i,n,a,r,t[11],22,-1990404162),r=we(r,i,n,a,t[12],7,1804603682),a=we(a,r,i,n,t[13],12,-40341101),n=we(n,a,r,i,t[14],17,-1502002290),i=we(i,n,a,r,t[15],22,1236535329),r=ve(r,i,n,a,t[1],5,-165796510),a=ve(a,r,i,n,t[6],9,-1069501632),n=ve(n,a,r,i,t[11],14,643717713),i=ve(i,n,a,r,t[0],20,-373897302),r=ve(r,i,n,a,t[5],5,-701558691),a=ve(a,r,i,n,t[10],9,38016083),n=ve(n,a,r,i,t[15],14,-660478335),i=ve(i,n,a,r,t[4],20,-405537848),r=ve(r,i,n,a,t[9],5,568446438),a=ve(a,r,i,n,t[14],9,-1019803690),n=ve(n,a,r,i,t[3],14,-187363961),i=ve(i,n,a,r,t[8],20,1163531501),r=ve(r,i,n,a,t[13],5,-1444681467),a=ve(a,r,i,n,t[2],9,-51403784),n=ve(n,a,r,i,t[7],14,1735328473),i=ve(i,n,a,r,t[12],20,-1926607734),r=_e(r,i,n,a,t[5],4,-378558),a=_e(a,r,i,n,t[8],11,-2022574463),n=_e(n,a,r,i,t[11],16,1839030562),i=_e(i,n,a,r,t[14],23,-35309556),r=_e(r,i,n,a,t[1],4,-1530992060),a=_e(a,r,i,n,t[4],11,1272893353),n=_e(n,a,r,i,t[7],16,-155497632),i=_e(i,n,a,r,t[10],23,-1094730640),r=_e(r,i,n,a,t[13],4,681279174),a=_e(a,r,i,n,t[0],11,-358537222),n=_e(n,a,r,i,t[3],16,-722521979),i=_e(i,n,a,r,t[6],23,76029189),r=_e(r,i,n,a,t[9],4,-640364487),a=_e(a,r,i,n,t[12],11,-421815835),n=_e(n,a,r,i,t[15],16,530742520),i=_e(i,n,a,r,t[2],23,-995338651),r=ke(r,i,n,a,t[0],6,-198630844),a=ke(a,r,i,n,t[7],10,1126891415),n=ke(n,a,r,i,t[14],15,-1416354905),i=ke(i,n,a,r,t[5],21,-57434055),r=ke(r,i,n,a,t[12],6,1700485571),a=ke(a,r,i,n,t[3],10,-1894986606),n=ke(n,a,r,i,t[10],15,-1051523),i=ke(i,n,a,r,t[1],21,-2054922799),r=ke(r,i,n,a,t[8],6,1873313359),a=ke(a,r,i,n,t[15],10,-30611744),n=ke(n,a,r,i,t[6],15,-1560198380),i=ke(i,n,a,r,t[13],21,1309151649),r=ke(r,i,n,a,t[4],6,-145523070),a=ke(a,r,i,n,t[11],10,-1120210379),n=ke(n,a,r,i,t[2],15,718787259),i=ke(i,n,a,r,t[9],21,-343485551),e[0]=mi(r,e[0]),e[1]=mi(i,e[1]),e[2]=mi(n,e[2]),e[3]=mi(a,e[3])}function js(e,t,r,i,n,a){return t=mi(mi(t,e),mi(i,a)),mi(t<<n|t>>>32-n,r)}function we(e,t,r,i,n,a,s){return js(t&r|~t&i,e,t,n,a,s)}function ve(e,t,r,i,n,a,s){return js(t&i|r&~i,e,t,n,a,s)}function _e(e,t,r,i,n,a,s){return js(t^r^i,e,t,n,a,s)}function ke(e,t,r,i,n,a,s){return js(r^(t|~i),e,t,n,a,s)}function Du(e){const t=[];let r;for(r=0;r<64;r+=4)t[r>>2]=e.charCodeAt(r)+(e.charCodeAt(r+1)<<8)+(e.charCodeAt(r+2)<<16)+(e.charCodeAt(r+3)<<24);return t}const g1="0123456789abcdef".split("");function Ku(e){let t="",r=0;for(;r<4;r++)t+=g1[e>>8*r+4&15]+g1[e>>8*r&15];return t}function mi(e,t){return e+t&4294967295}const as=x.getWebCrypto(),ss=x.getNodeCrypto(),Ru=ss&&ss.getHashes();function Ki(e){if(ss&&Ru.includes(e))return async function(t){const r=ss.createHash(e);return ne(t,i=>{r.update(i)},()=>new Uint8Array(r.digest()))}}function Da(e,t){return async function(r,i=vt){if(se(r)&&(r=await ae(r)),!x.isStream(r)&&as&&t&&r.length>=i.minBytesForWebCrypto)return new Uint8Array(await as.digest(t,r));const n=e();return ne(r,a=>{n.update(a)},()=>new Uint8Array(n.digest()))}}function w1(e,t){return async function(r,i=vt){if(se(r)&&(r=await ae(r)),x.isStream(r)){const n=new e;return ne(r,a=>{n.process(a)},()=>n.finish().result)}return as&&t&&r.length>=i.minBytesForWebCrypto?new Uint8Array(await as.digest(t,r)):e.bytes(r)}}const Ri={md5:Ki("md5")||async function(e){const t=function(r){const i=r.length,n=[1732584193,-271733879,-1732584194,271733878];let a;for(a=64;a<=r.length;a+=64)po(n,Du(r.substring(a-64,a)));r=r.substring(a-64);const s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(a=0;a<r.length;a++)s[a>>2]|=r.charCodeAt(a)<<(a%4<<3);if(s[a>>2]|=128<<(a%4<<3),a>55)for(po(n,s),a=0;a<16;a++)s[a]=0;return s[14]=8*i,po(n,s),n}(x.uint8ArrayToString(e));return x.hexToUint8Array(function(r){for(let i=0;i<r.length;i++)r[i]=Ku(r[i]);return r.join("")}(t))},sha1:Ki("sha1")||w1(Oi,"SHA-1"),sha224:Ki("sha224")||Da(Q2),sha256:Ki("sha256")||w1(Ls,"SHA-256"),sha384:Ki("sha384")||Da(rc,"SHA-384"),sha512:Ki("sha512")||Da(_a,"SHA-512"),ripemd:Ki("ripemd160")||Da(nc)};var gn={md5:Ri.md5,sha1:Ri.sha1,sha224:Ri.sha224,sha256:Ri.sha256,sha384:Ri.sha384,sha512:Ri.sha512,ripemd:Ri.ripemd,digest:function(e,t){switch(e){case v.hash.md5:return this.md5(t);case v.hash.sha1:return this.sha1(t);case v.hash.ripemd:return this.ripemd(t);case v.hash.sha256:return this.sha256(t);case v.hash.sha384:return this.sha384(t);case v.hash.sha512:return this.sha512(t);case v.hash.sha224:return this.sha224(t);default:throw Error("Invalid hash function.")}},getHashByteLength:function(e){switch(e){case v.hash.md5:return 16;case v.hash.sha1:case v.hash.ripemd:return 20;case v.hash.sha256:return 32;case v.hash.sha384:return 48;case v.hash.sha512:return 64;case v.hash.sha224:return 28;default:throw Error("Invalid hash algorithm.")}}};class ln{static encrypt(t,r,i){return new ln(r,i).encrypt(t)}static decrypt(t,r,i){return new ln(r,i).decrypt(t)}constructor(t,r,i){this.aes=i||new wa(t,r,!0,"CFB"),delete this.aes.padding}encrypt(t){return Si(this.aes.AES_Encrypt_process(t),this.aes.AES_Encrypt_finish())}decrypt(t){return Si(this.aes.AES_Decrypt_process(t),this.aes.AES_Decrypt_finish())}}var Mr=Br(function(e){(function(t){var r=function(B){var Y,M=new Float64Array(16);if(B)for(Y=0;Y<B.length;Y++)M[Y]=B[Y];return M},i=function(){throw Error("no PRNG")},n=new Uint8Array(32);n[0]=9;var a=r(),s=r([1]),o=r([56129,1]),u=r([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=r([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),h=r([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),f=r([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),m=r([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function y(B,Y,M,l){return function(z,et,J,it,k){var w,A=0;for(w=0;w<k;w++)A|=z[et+w]^J[it+w];return(1&A-1>>>8)-1}(B,Y,M,l,32)}function K(B,Y){var M;for(M=0;M<16;M++)B[M]=0|Y[M]}function I(B){var Y,M,l=1;for(Y=0;Y<16;Y++)M=B[Y]+l+65535,l=Math.floor(M/65536),B[Y]=M-65536*l;B[0]+=l-1+37*(l-1)}function U(B,Y,M){for(var l,z=~(M-1),et=0;et<16;et++)l=z&(B[et]^Y[et]),B[et]^=l,Y[et]^=l}function V(B,Y){var M,l,z,et=r(),J=r();for(M=0;M<16;M++)J[M]=Y[M];for(I(J),I(J),I(J),l=0;l<2;l++){for(et[0]=J[0]-65517,M=1;M<15;M++)et[M]=J[M]-65535-(et[M-1]>>16&1),et[M-1]&=65535;et[15]=J[15]-32767-(et[14]>>16&1),z=et[15]>>16&1,et[14]&=65535,U(J,et,1-z)}for(M=0;M<16;M++)B[2*M]=255&J[M],B[2*M+1]=J[M]>>8}function Z(B,Y){var M=new Uint8Array(32),l=new Uint8Array(32);return V(M,B),V(l,Y),y(M,0,l,0)}function $(B){var Y=new Uint8Array(32);return V(Y,B),1&Y[0]}function R(B,Y){var M;for(M=0;M<16;M++)B[M]=Y[2*M]+(Y[2*M+1]<<8);B[15]&=32767}function tt(B,Y,M){for(var l=0;l<16;l++)B[l]=Y[l]+M[l]}function X(B,Y,M){for(var l=0;l<16;l++)B[l]=Y[l]-M[l]}function Q(B,Y,M){var l,z,et=0,J=0,it=0,k=0,w=0,A=0,C=0,N=0,T=0,H=0,yt=0,lt=0,wt=0,O=0,F=0,W=0,L=0,j=0,G=0,P=0,E=0,bt=0,ht=0,Pt=0,Lt=0,Dt=0,Ct=0,Xt=0,zt=0,Ot=0,oe=0,Mt=M[0],Rt=M[1],jt=M[2],Et=M[3],Bt=M[4],$t=M[5],It=M[6],at=M[7],ot=M[8],pt=M[9],_t=M[10],Kt=M[11],xt=M[12],St=M[13],Ht=M[14],Tt=M[15];et+=(l=Y[0])*Mt,J+=l*Rt,it+=l*jt,k+=l*Et,w+=l*Bt,A+=l*$t,C+=l*It,N+=l*at,T+=l*ot,H+=l*pt,yt+=l*_t,lt+=l*Kt,wt+=l*xt,O+=l*St,F+=l*Ht,W+=l*Tt,J+=(l=Y[1])*Mt,it+=l*Rt,k+=l*jt,w+=l*Et,A+=l*Bt,C+=l*$t,N+=l*It,T+=l*at,H+=l*ot,yt+=l*pt,lt+=l*_t,wt+=l*Kt,O+=l*xt,F+=l*St,W+=l*Ht,L+=l*Tt,it+=(l=Y[2])*Mt,k+=l*Rt,w+=l*jt,A+=l*Et,C+=l*Bt,N+=l*$t,T+=l*It,H+=l*at,yt+=l*ot,lt+=l*pt,wt+=l*_t,O+=l*Kt,F+=l*xt,W+=l*St,L+=l*Ht,j+=l*Tt,k+=(l=Y[3])*Mt,w+=l*Rt,A+=l*jt,C+=l*Et,N+=l*Bt,T+=l*$t,H+=l*It,yt+=l*at,lt+=l*ot,wt+=l*pt,O+=l*_t,F+=l*Kt,W+=l*xt,L+=l*St,j+=l*Ht,G+=l*Tt,w+=(l=Y[4])*Mt,A+=l*Rt,C+=l*jt,N+=l*Et,T+=l*Bt,H+=l*$t,yt+=l*It,lt+=l*at,wt+=l*ot,O+=l*pt,F+=l*_t,W+=l*Kt,L+=l*xt,j+=l*St,G+=l*Ht,P+=l*Tt,A+=(l=Y[5])*Mt,C+=l*Rt,N+=l*jt,T+=l*Et,H+=l*Bt,yt+=l*$t,lt+=l*It,wt+=l*at,O+=l*ot,F+=l*pt,W+=l*_t,L+=l*Kt,j+=l*xt,G+=l*St,P+=l*Ht,E+=l*Tt,C+=(l=Y[6])*Mt,N+=l*Rt,T+=l*jt,H+=l*Et,yt+=l*Bt,lt+=l*$t,wt+=l*It,O+=l*at,F+=l*ot,W+=l*pt,L+=l*_t,j+=l*Kt,G+=l*xt,P+=l*St,E+=l*Ht,bt+=l*Tt,N+=(l=Y[7])*Mt,T+=l*Rt,H+=l*jt,yt+=l*Et,lt+=l*Bt,wt+=l*$t,O+=l*It,F+=l*at,W+=l*ot,L+=l*pt,j+=l*_t,G+=l*Kt,P+=l*xt,E+=l*St,bt+=l*Ht,ht+=l*Tt,T+=(l=Y[8])*Mt,H+=l*Rt,yt+=l*jt,lt+=l*Et,wt+=l*Bt,O+=l*$t,F+=l*It,W+=l*at,L+=l*ot,j+=l*pt,G+=l*_t,P+=l*Kt,E+=l*xt,bt+=l*St,ht+=l*Ht,Pt+=l*Tt,H+=(l=Y[9])*Mt,yt+=l*Rt,lt+=l*jt,wt+=l*Et,O+=l*Bt,F+=l*$t,W+=l*It,L+=l*at,j+=l*ot,G+=l*pt,P+=l*_t,E+=l*Kt,bt+=l*xt,ht+=l*St,Pt+=l*Ht,Lt+=l*Tt,yt+=(l=Y[10])*Mt,lt+=l*Rt,wt+=l*jt,O+=l*Et,F+=l*Bt,W+=l*$t,L+=l*It,j+=l*at,G+=l*ot,P+=l*pt,E+=l*_t,bt+=l*Kt,ht+=l*xt,Pt+=l*St,Lt+=l*Ht,Dt+=l*Tt,lt+=(l=Y[11])*Mt,wt+=l*Rt,O+=l*jt,F+=l*Et,W+=l*Bt,L+=l*$t,j+=l*It,G+=l*at,P+=l*ot,E+=l*pt,bt+=l*_t,ht+=l*Kt,Pt+=l*xt,Lt+=l*St,Dt+=l*Ht,Ct+=l*Tt,wt+=(l=Y[12])*Mt,O+=l*Rt,F+=l*jt,W+=l*Et,L+=l*Bt,j+=l*$t,G+=l*It,P+=l*at,E+=l*ot,bt+=l*pt,ht+=l*_t,Pt+=l*Kt,Lt+=l*xt,Dt+=l*St,Ct+=l*Ht,Xt+=l*Tt,O+=(l=Y[13])*Mt,F+=l*Rt,W+=l*jt,L+=l*Et,j+=l*Bt,G+=l*$t,P+=l*It,E+=l*at,bt+=l*ot,ht+=l*pt,Pt+=l*_t,Lt+=l*Kt,Dt+=l*xt,Ct+=l*St,Xt+=l*Ht,zt+=l*Tt,F+=(l=Y[14])*Mt,W+=l*Rt,L+=l*jt,j+=l*Et,G+=l*Bt,P+=l*$t,E+=l*It,bt+=l*at,ht+=l*ot,Pt+=l*pt,Lt+=l*_t,Dt+=l*Kt,Ct+=l*xt,Xt+=l*St,zt+=l*Ht,Ot+=l*Tt,W+=(l=Y[15])*Mt,J+=38*(j+=l*jt),it+=38*(G+=l*Et),k+=38*(P+=l*Bt),w+=38*(E+=l*$t),A+=38*(bt+=l*It),C+=38*(ht+=l*at),N+=38*(Pt+=l*ot),T+=38*(Lt+=l*pt),H+=38*(Dt+=l*_t),yt+=38*(Ct+=l*Kt),lt+=38*(Xt+=l*xt),wt+=38*(zt+=l*St),O+=38*(Ot+=l*Ht),F+=38*(oe+=l*Tt),et=(l=(et+=38*(L+=l*Rt))+(z=1)+65535)-65536*(z=Math.floor(l/65536)),J=(l=J+z+65535)-65536*(z=Math.floor(l/65536)),it=(l=it+z+65535)-65536*(z=Math.floor(l/65536)),k=(l=k+z+65535)-65536*(z=Math.floor(l/65536)),w=(l=w+z+65535)-65536*(z=Math.floor(l/65536)),A=(l=A+z+65535)-65536*(z=Math.floor(l/65536)),C=(l=C+z+65535)-65536*(z=Math.floor(l/65536)),N=(l=N+z+65535)-65536*(z=Math.floor(l/65536)),T=(l=T+z+65535)-65536*(z=Math.floor(l/65536)),H=(l=H+z+65535)-65536*(z=Math.floor(l/65536)),yt=(l=yt+z+65535)-65536*(z=Math.floor(l/65536)),lt=(l=lt+z+65535)-65536*(z=Math.floor(l/65536)),wt=(l=wt+z+65535)-65536*(z=Math.floor(l/65536)),O=(l=O+z+65535)-65536*(z=Math.floor(l/65536)),F=(l=F+z+65535)-65536*(z=Math.floor(l/65536)),W=(l=W+z+65535)-65536*(z=Math.floor(l/65536)),et=(l=(et+=z-1+37*(z-1))+(z=1)+65535)-65536*(z=Math.floor(l/65536)),J=(l=J+z+65535)-65536*(z=Math.floor(l/65536)),it=(l=it+z+65535)-65536*(z=Math.floor(l/65536)),k=(l=k+z+65535)-65536*(z=Math.floor(l/65536)),w=(l=w+z+65535)-65536*(z=Math.floor(l/65536)),A=(l=A+z+65535)-65536*(z=Math.floor(l/65536)),C=(l=C+z+65535)-65536*(z=Math.floor(l/65536)),N=(l=N+z+65535)-65536*(z=Math.floor(l/65536)),T=(l=T+z+65535)-65536*(z=Math.floor(l/65536)),H=(l=H+z+65535)-65536*(z=Math.floor(l/65536)),yt=(l=yt+z+65535)-65536*(z=Math.floor(l/65536)),lt=(l=lt+z+65535)-65536*(z=Math.floor(l/65536)),wt=(l=wt+z+65535)-65536*(z=Math.floor(l/65536)),O=(l=O+z+65535)-65536*(z=Math.floor(l/65536)),F=(l=F+z+65535)-65536*(z=Math.floor(l/65536)),W=(l=W+z+65535)-65536*(z=Math.floor(l/65536)),et+=z-1+37*(z-1),B[0]=et,B[1]=J,B[2]=it,B[3]=k,B[4]=w,B[5]=A,B[6]=C,B[7]=N,B[8]=T,B[9]=H,B[10]=yt,B[11]=lt,B[12]=wt,B[13]=O,B[14]=F,B[15]=W}function d(B,Y){Q(B,Y,Y)}function b(B,Y){var M,l=r();for(M=0;M<16;M++)l[M]=Y[M];for(M=253;M>=0;M--)d(l,l),M!==2&&M!==4&&Q(l,l,Y);for(M=0;M<16;M++)B[M]=l[M]}function _(B,Y,M){var l,z,et=new Uint8Array(32),J=new Float64Array(80),it=r(),k=r(),w=r(),A=r(),C=r(),N=r();for(z=0;z<31;z++)et[z]=Y[z];for(et[31]=127&Y[31]|64,et[0]&=248,R(J,M),z=0;z<16;z++)k[z]=J[z],A[z]=it[z]=w[z]=0;for(it[0]=A[0]=1,z=254;z>=0;--z)U(it,k,l=et[z>>>3]>>>(7&z)&1),U(w,A,l),tt(C,it,w),X(it,it,w),tt(w,k,A),X(k,k,A),d(A,C),d(N,it),Q(it,w,it),Q(w,k,C),tt(C,it,w),X(it,it,w),d(k,it),X(w,A,N),Q(it,w,o),tt(it,it,A),Q(w,w,it),Q(it,A,N),Q(A,k,J),d(k,C),U(it,k,l),U(w,A,l);for(z=0;z<16;z++)J[z+16]=it[z],J[z+32]=w[z],J[z+48]=k[z],J[z+64]=A[z];var T=J.subarray(32),H=J.subarray(16);return b(T,T),Q(H,H,T),V(B,H),0}function g(B,Y){return _(B,Y,n)}function p(B,Y){var M=r(),l=r(),z=r(),et=r(),J=r(),it=r(),k=r(),w=r(),A=r();X(M,B[1],B[0]),X(A,Y[1],Y[0]),Q(M,M,A),tt(l,B[0],B[1]),tt(A,Y[0],Y[1]),Q(l,l,A),Q(z,B[3],Y[3]),Q(z,z,c),Q(et,B[2],Y[2]),tt(et,et,et),X(J,l,M),X(it,et,z),tt(k,et,z),tt(w,l,M),Q(B[0],J,it),Q(B[1],w,k),Q(B[2],k,it),Q(B[3],J,w)}function S(B,Y,M){var l;for(l=0;l<4;l++)U(B[l],Y[l],M)}function D(B,Y){var M=r(),l=r(),z=r();b(z,Y[2]),Q(M,Y[0],z),Q(l,Y[1],z),V(B,l),B[31]^=$(M)<<7}function nt(B,Y,M){var l,z;for(K(B[0],a),K(B[1],s),K(B[2],s),K(B[3],a),z=255;z>=0;--z)S(B,Y,l=M[z/8|0]>>(7&z)&1),p(Y,B),p(B,B),S(B,Y,l)}function st(B,Y){var M=[r(),r(),r(),r()];K(M[0],h),K(M[1],f),K(M[2],s),Q(M[3],h,f),nt(B,M,Y)}function q(B,Y,M){var l,z,et=[r(),r(),r(),r()];for(M||i(Y,32),(l=t.hash(Y.subarray(0,32)))[0]&=248,l[31]&=127,l[31]|=64,st(et,l),D(B,et),z=0;z<32;z++)Y[z+32]=B[z];return 0}var rt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ct(B,Y){var M,l,z,et;for(l=63;l>=32;--l){for(M=0,z=l-32,et=l-12;z<et;++z)Y[z]+=M-16*Y[l]*rt[z-(l-32)],M=Math.floor((Y[z]+128)/256),Y[z]-=256*M;Y[z]+=M,Y[l]=0}for(M=0,z=0;z<32;z++)Y[z]+=M-(Y[31]>>4)*rt[z],M=Y[z]>>8,Y[z]&=255;for(z=0;z<32;z++)Y[z]-=M*rt[z];for(l=0;l<32;l++)Y[l+1]+=Y[l]>>8,B[l]=255&Y[l]}function dt(B){var Y,M=new Float64Array(64);for(Y=0;Y<64;Y++)M[Y]=B[Y];for(Y=0;Y<64;Y++)B[Y]=0;ct(B,M)}function ut(B,Y){var M=r(),l=r(),z=r(),et=r(),J=r(),it=r(),k=r();return K(B[2],s),R(B[1],Y),d(z,B[1]),Q(et,z,u),X(z,z,B[2]),tt(et,B[2],et),d(J,et),d(it,J),Q(k,it,J),Q(M,k,z),Q(M,M,et),function(w,A){var C,N=r();for(C=0;C<16;C++)N[C]=A[C];for(C=250;C>=0;C--)d(N,N),C!==1&&Q(N,N,A);for(C=0;C<16;C++)w[C]=N[C]}(M,M),Q(M,M,z),Q(M,M,et),Q(M,M,et),Q(B[0],M,et),d(l,B[0]),Q(l,l,et),Z(l,z)&&Q(B[0],B[0],m),d(l,B[0]),Q(l,l,et),Z(l,z)?-1:($(B[0])===Y[31]>>7&&X(B[0],a,B[0]),Q(B[3],B[0],B[1]),0)}var ft=64;function gt(){for(var B=0;B<arguments.length;B++)if(!(arguments[B]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function mt(B){for(var Y=0;Y<B.length;Y++)B[Y]=0}t.scalarMult=function(B,Y){if(gt(B,Y),B.length!==32)throw Error("bad n size");if(Y.length!==32)throw Error("bad p size");var M=new Uint8Array(32);return _(M,B,Y),M},t.box={},t.box.keyPair=function(){var B,Y,M=new Uint8Array(32),l=new Uint8Array(32);return B=M,i(Y=l,32),g(B,Y),{publicKey:M,secretKey:l}},t.box.keyPair.fromSecretKey=function(B){if(gt(B),B.length!==32)throw Error("bad secret key size");var Y=new Uint8Array(32);return g(Y,B),{publicKey:Y,secretKey:new Uint8Array(B)}},t.sign=function(B,Y){if(gt(B,Y),Y.length!==64)throw Error("bad secret key size");var M=new Uint8Array(ft+B.length);return function(l,z,et,J){var it,k,w,A,C,N=new Float64Array(64),T=[r(),r(),r(),r()];(it=t.hash(J.subarray(0,32)))[0]&=248,it[31]&=127,it[31]|=64;var H=et+64;for(A=0;A<et;A++)l[64+A]=z[A];for(A=0;A<32;A++)l[32+A]=it[32+A];for(dt(w=t.hash(l.subarray(32,H))),st(T,w),D(l,T),A=32;A<64;A++)l[A]=J[A];for(dt(k=t.hash(l.subarray(0,H))),A=0;A<64;A++)N[A]=0;for(A=0;A<32;A++)N[A]=w[A];for(A=0;A<32;A++)for(C=0;C<32;C++)N[A+C]+=k[A]*it[C];ct(l.subarray(32),N)}(M,B,B.length,Y),M},t.sign.detached=function(B,Y){for(var M=t.sign(B,Y),l=new Uint8Array(ft),z=0;z<l.length;z++)l[z]=M[z];return l},t.sign.detached.verify=function(B,Y,M){if(gt(B,Y,M),Y.length!==ft)throw Error("bad signature size");if(M.length!==32)throw Error("bad public key size");var l,z=new Uint8Array(ft+B.length),et=new Uint8Array(ft+B.length);for(l=0;l<ft;l++)z[l]=Y[l];for(l=0;l<B.length;l++)z[l+ft]=B[l];return function(J,it,k,w){var A,C,N=new Uint8Array(32),T=[r(),r(),r(),r()],H=[r(),r(),r(),r()];if(k<64||ut(H,w))return-1;for(A=0;A<k;A++)J[A]=it[A];for(A=0;A<32;A++)J[A+32]=w[A];if(dt(C=t.hash(J.subarray(0,k))),nt(T,H,C),st(H,it.subarray(32)),p(T,H),D(N,T),k-=64,y(it,0,N,0)){for(A=0;A<k;A++)J[A]=0;return-1}for(A=0;A<k;A++)J[A]=it[A+64];return k}(et,z,z.length,M)>=0},t.sign.keyPair=function(){var B=new Uint8Array(32),Y=new Uint8Array(64);return q(B,Y),{publicKey:B,secretKey:Y}},t.sign.keyPair.fromSecretKey=function(B){if(gt(B),B.length!==64)throw Error("bad secret key size");for(var Y=new Uint8Array(32),M=0;M<Y.length;M++)Y[M]=B[32+M];return{publicKey:Y,secretKey:new Uint8Array(B)}},t.sign.keyPair.fromSeed=function(B){if(gt(B),B.length!==32)throw Error("bad seed size");for(var Y=new Uint8Array(32),M=new Uint8Array(64),l=0;l<32;l++)M[l]=B[l];return q(Y,M,!0),{publicKey:Y,secretKey:M}},t.setPRNG=function(B){i=B},function(){var B=typeof self<"u"?self.crypto||self.msCrypto:null;B&&B.getRandomValues?t.setPRNG(function(Y,M){var l,z=new Uint8Array(M);for(l=0;l<M;l+=65536)B.getRandomValues(z.subarray(l,l+Math.min(M-l,65536)));for(l=0;l<M;l++)Y[l]=z[l];mt(z)}):(B=void 0)&&B.randomBytes&&t.setPRNG(function(Y,M){var l,z=B.randomBytes(M);for(l=0;l<M;l++)Y[l]=z[l];mt(z)})}()})(e.exports?e.exports:self.nacl=self.nacl||{})});const v1=x.getNodeCrypto();async function Cr(e){const t=new Uint8Array(e);if(typeof crypto<"u"&&crypto.getRandomValues)crypto.getRandomValues(t);else if(v1){const r=v1.randomBytes(t.length);t.set(r)}else{if(!jo.buffer)throw Error("No secure random number generator available.");await jo.get(t)}return t}async function Yr(e,t){const r=await x.getBigInteger();if(t.lt(e))throw Error("Illegal parameter value: max <= min");const i=t.sub(e),n=i.byteLength();return new r(await Cr(n+8)).mod(i).add(e)}const jo=new class{constructor(){this.buffer=null,this.size=null,this.callback=null}init(e,t){this.buffer=new Uint8Array(e),this.size=0,this.callback=t}set(e){if(!this.buffer)throw Error("RandomBuffer is not initialized");if(!(e instanceof Uint8Array))throw Error("Invalid type: buf not an Uint8Array");const t=this.buffer.length-this.size;e.length>t&&(e=e.subarray(0,t)),this.buffer.set(e,this.size),this.size+=e.length}async get(e){if(!this.buffer)throw Error("RandomBuffer is not initialized");if(!(e instanceof Uint8Array))throw Error("Invalid type: buf not an Uint8Array");if(this.size<e.length){if(!this.callback)throw Error("Random number buffer depleted");return await this.callback(),this.get(e)}for(let t=0;t<e.length;t++)e[t]=this.buffer[--this.size],this.buffer[this.size]=0}};var Iu=Object.freeze({__proto__:null,getRandomBytes:Cr,getRandomBigInteger:Yr,randomBuffer:jo});async function _1(e,t,r){const i=await x.getBigInteger(),n=new i(1),a=n.leftShift(new i(e-1)),s=new i(30),o=[1,6,5,4,3,2,1,4,3,2,1,2,1,4,3,2,1,2,1,4,3,2,1,6,5,4,3,2,1,2],u=await Yr(a,a.leftShift(n));let c=u.mod(s).toNumber();do u.iadd(new i(o[c])),c=(c+o[c])%o.length,u.bitLength()>e&&(u.imod(a.leftShift(n)).iadd(a),c=u.mod(s).toNumber());while(!await ac(u,t,r));return u}async function ac(e,t,r){return!(t&&!e.dec().gcd(t).isOne())&&!!await async function(i){const n=await x.getBigInteger();return Uu.every(a=>i.mod(new n(a))!==0)}(e)&&!!await async function(i,n){const a=await x.getBigInteger();return(n=n||new a(2)).modExp(i.dec(),i).isOne()}(e)&&!!await async function(i,n,a){const s=await x.getBigInteger(),o=i.bitLength();n||(n=Math.max(1,o/48|0));const u=i.dec();let c=0;for(;!u.getBit(c);)c++;const h=i.rightShift(new s(c));for(;n>0;n--){let f,m=(a?a():await Yr(new s(2),u)).modExp(h,i);if(!m.isOne()&&!m.equal(u)){for(f=1;f<c;f++){if(m=m.mul(m).mod(i),m.isOne())return!1;if(m.equal(u))break}if(f===c)return!1}}return!0}(e,r)}const Uu=[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999],yr=[];async function _0(e,t){const r=e.length;if(r>t-11)throw Error("Message too long");const i=await async function(a){const s=new Uint8Array(a);let o=0;for(;o<a;){const u=await Cr(a-o);for(let c=0;c<u.length;c++)u[c]!==0&&(s[o++]=u[c])}return s}(t-r-3),n=new Uint8Array(t);return n[1]=2,n.set(i,2),n.set(e,t-r),n}function k0(e,t){let r=2,i=1;for(let o=r;o<e.length;o++)i&=e[o]!==0,r+=i;const n=r-2,a=e.subarray(r+1),s=e[0]===0&e[1]===2&n>=8&!i;if(t)return x.selectUint8Array(s,a,t);if(s)return a;throw Error("Decryption error")}async function Wo(e,t,r){let i;if(t.length!==gn.getHashByteLength(e))throw Error("Invalid hash length");const n=new Uint8Array(yr[e].length);for(i=0;i<yr[e].length;i++)n[i]=yr[e][i];const a=n.length+t.length;if(r<a+11)throw Error("Intended encoded message length too short");const s=new Uint8Array(r-a-3).fill(255),o=new Uint8Array(r);return o[1]=1,o.set(s,2),o.set(n,r-a),o.set(t,r-t.length),o}yr[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],yr[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],yr[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],yr[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],yr[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],yr[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],yr[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];var Bu=Object.freeze({__proto__:null,emeEncode:_0,emeDecode:k0,emsaEncode:Wo});const tn=x.getWebCrypto(),Se=x.getNodeCrypto(),sc=void 0,en=Se?sc.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}):void 0,Ka=Se?sc.define("RSAPubliceKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}):void 0;var Tu=Object.freeze({__proto__:null,sign:async function(e,t,r,i,n,a,s,o,u){if(t&&!x.isStream(t)){if(x.getWebCrypto())try{return await async function(c,h,f,m,y,K,I,U){const V=await async function(R,tt,X,Q,d,b){const _=await x.getBigInteger(),g=new _(Q),p=new _(d),S=new _(X);let D=S.mod(p.dec()),nt=S.mod(g.dec());return nt=nt.toUint8Array(),D=D.toUint8Array(),{kty:"RSA",n:Ne(R,!0),e:Ne(tt,!0),d:Ne(X,!0),p:Ne(d,!0),q:Ne(Q,!0),dp:Ne(D,!0),dq:Ne(nt,!0),qi:Ne(b,!0),ext:!0}}(f,m,y,K,I,U),Z={name:"RSASSA-PKCS1-v1_5",hash:{name:c}},$=await tn.importKey("jwk",V,Z,!1,["sign"]);return new Uint8Array(await tn.sign("RSASSA-PKCS1-v1_5",$,h))}(v.read(v.webHash,e),t,r,i,n,a,s,o)}catch(c){x.printDebugError(c)}else if(x.getNodeCrypto())return async function(c,h,f,m,y,K,I,U){const{default:V}=await Promise.resolve().then(function(){return Zn}),Z=new V(K),$=new V(I),R=new V(y),tt=R.mod($.subn(1)),X=R.mod(Z.subn(1)),Q=Se.createSign(v.read(v.hash,c));Q.write(h),Q.end();const d={version:0,modulus:new V(f),publicExponent:new V(m),privateExponent:new V(y),prime1:new V(I),prime2:new V(K),exponent1:tt,exponent2:X,coefficient:new V(U)};if(Se.createPrivateKey!==void 0){const _=en.encode(d,"der");return new Uint8Array(Q.sign({key:_,format:"der",type:"pkcs1"}))}const b=en.encode(d,"pem",{label:"RSA PRIVATE KEY"});return new Uint8Array(Q.sign(b))}(e,t,r,i,n,a,s,o)}return async function(c,h,f,m){const y=await x.getBigInteger();h=new y(h);const K=new y(await Wo(c,m,h.byteLength()));if(f=new y(f),K.gte(h))throw Error("Message size cannot exceed modulus size");return K.modExp(f,h).toUint8Array("be",h.byteLength())}(e,r,n,u)},verify:async function(e,t,r,i,n,a){if(t&&!x.isStream(t)){if(x.getWebCrypto())try{return await async function(s,o,u,c,h){const f=function(y,K){return{kty:"RSA",n:Ne(y,!0),e:Ne(K,!0),ext:!0}}(c,h),m=await tn.importKey("jwk",f,{name:"RSASSA-PKCS1-v1_5",hash:{name:s}},!1,["verify"]);return tn.verify("RSASSA-PKCS1-v1_5",m,u,o)}(v.read(v.webHash,e),t,r,i,n)}catch(s){x.printDebugError(s)}else if(x.getNodeCrypto())return async function(s,o,u,c,h){const{default:f}=await Promise.resolve().then(function(){return Zn}),m=Se.createVerify(v.read(v.hash,s));m.write(o),m.end();const y={modulus:new f(c),publicExponent:new f(h)};let K;Se.createPrivateKey!==void 0?K={key:Ka.encode(y,"der"),format:"der",type:"pkcs1"}:K=Ka.encode(y,"pem",{label:"RSA PUBLIC KEY"});try{return await m.verify(K,u)}catch{return!1}}(e,t,r,i,n)}return async function(s,o,u,c,h){const f=await x.getBigInteger();if(u=new f(u),o=new f(o),c=new f(c),o.gte(u))throw Error("Signature size cannot exceed modulus size");const m=o.modExp(c,u).toUint8Array("be",u.byteLength()),y=await Wo(s,h,u.byteLength());return x.equalsUint8Array(m,y)}(e,r,i,n,a)},encrypt:async function(e,t,r){return x.getNodeCrypto()?async function(i,n,a){const{default:s}=await Promise.resolve().then(function(){return Zn}),o={modulus:new s(n),publicExponent:new s(a)};let u;return Se.createPrivateKey!==void 0?u={key:Ka.encode(o,"der"),format:"der",type:"pkcs1",padding:Se.constants.RSA_PKCS1_PADDING}:u={key:Ka.encode(o,"pem",{label:"RSA PUBLIC KEY"}),padding:Se.constants.RSA_PKCS1_PADDING},new Uint8Array(Se.publicEncrypt(u,i))}(e,t,r):async function(i,n,a){const s=await x.getBigInteger();if(n=new s(n),i=new s(await _0(i,n.byteLength())),a=new s(a),i.gte(n))throw Error("Message size cannot exceed modulus size");return i.modExp(a,n).toUint8Array("be",n.byteLength())}(e,t,r)},decrypt:async function(e,t,r,i,n,a,s,o){return x.getNodeCrypto()?async function(u,c,h,f,m,y,K,I){const{default:U}=await Promise.resolve().then(function(){return Zn}),V=new U(m),Z=new U(y),$=new U(f),R=$.mod(Z.subn(1)),tt=$.mod(V.subn(1)),X={version:0,modulus:new U(c),publicExponent:new U(h),privateExponent:new U(f),prime1:new U(y),prime2:new U(m),exponent1:R,exponent2:tt,coefficient:new U(K)};let Q;Se.createPrivateKey!==void 0?Q={key:en.encode(X,"der"),format:"der",type:"pkcs1",padding:Se.constants.RSA_PKCS1_PADDING}:Q={key:en.encode(X,"pem",{label:"RSA PRIVATE KEY"}),padding:Se.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(Se.privateDecrypt(Q,u))}catch{if(I)return I;throw Error("Decryption error")}}(e,t,r,i,n,a,s,o):async function(u,c,h,f,m,y,K,I){const U=await x.getBigInteger();if(u=new U(u),c=new U(c),h=new U(h),f=new U(f),m=new U(m),y=new U(y),K=new U(K),u.gte(c))throw Error("Data too large.");const V=f.mod(y.dec()),Z=f.mod(m.dec()),$=(await Yr(new U(2),c)).mod(c),R=$.modInv(c).modExp(h,c),tt=(u=u.mul(R).mod(c)).modExp(Z,m),X=u.modExp(V,y);let Q=K.mul(X.sub(tt)).mod(y).mul(m).add(tt);return Q=Q.mul($).mod(c),k0(Q.toUint8Array("be",c.byteLength()),I)}(e,t,r,i,n,a,s,o)},generate:async function(e,t){if(t=new(await x.getBigInteger())(t),x.getWebCrypto()){const s={name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:t.toUint8Array(),hash:{name:"SHA-1"}},o=await tn.generateKey(s,!0,["sign","verify"]),u=await tn.exportKey("jwk",o.privateKey);return{n:Lr(u.n),e:t.toUint8Array(),d:Lr(u.d),p:Lr(u.q),q:Lr(u.p),u:Lr(u.qi)}}if(x.getNodeCrypto()&&Se.generateKeyPair&&en){const s={modulusLength:e,publicExponent:t.toNumber(),publicKeyEncoding:{type:"pkcs1",format:"der"},privateKeyEncoding:{type:"pkcs1",format:"der"}},o=await new Promise((u,c)=>Se.generateKeyPair("rsa",s,(h,f,m)=>{h?c(h):u(en.decode(m,"der"))}));return{n:o.modulus.toArrayLike(Uint8Array),e:o.publicExponent.toArrayLike(Uint8Array),d:o.privateExponent.toArrayLike(Uint8Array),p:o.prime2.toArrayLike(Uint8Array),q:o.prime1.toArrayLike(Uint8Array),u:o.coefficient.toArrayLike(Uint8Array)}}let r,i,n;do i=await _1(e-(e>>1),t,40),r=await _1(e>>1,t,40),n=r.mul(i);while(n.bitLength()!==e);const a=r.dec().imul(i.dec());return i.lt(r)&&([r,i]=[i,r]),{n:n.toUint8Array(),e:t.toUint8Array(),d:t.modInv(a).toUint8Array(),p:r.toUint8Array(),q:i.toUint8Array(),u:r.modInv(i).toUint8Array()}},validateParams:async function(e,t,r,i,n,a){const s=await x.getBigInteger();if(e=new s(e),i=new s(i),n=new s(n),!i.mul(n).equal(e))return!1;const o=new s(2);if(a=new s(a),!i.mul(a).mod(n).isOne())return!1;t=new s(t),r=new s(r);const u=new s(Math.floor(e.bitLength()/3)),c=await Yr(o,o.leftShift(u)),h=c.mul(r).mul(t);return!(!h.mod(i.dec()).equal(c)||!h.mod(n.dec()).equal(c))}}),zu=Object.freeze({__proto__:null,encrypt:async function(e,t,r,i){const n=await x.getBigInteger();t=new n(t),r=new n(r),i=new n(i);const a=new n(await _0(e,t.byteLength())),s=await Yr(new n(1),t.dec());return{c1:r.modExp(s,t).toUint8Array(),c2:i.modExp(s,t).imul(a).imod(t).toUint8Array()}},decrypt:async function(e,t,r,i,n){const a=await x.getBigInteger();return e=new a(e),t=new a(t),r=new a(r),i=new a(i),k0(e.modExp(i,r).modInv(r).imul(t).imod(r).toUint8Array("be",r.byteLength()),n)},validateParams:async function(e,t,r,i){const n=await x.getBigInteger();e=new n(e),t=new n(t),r=new n(r);const a=new n(1);if(t.lte(a)||t.gte(e))return!1;const s=new n(e.bitLength()),o=new n(1023);if(s.lt(o)||!t.modExp(e.dec(),e).isOne())return!1;let u=t;const c=new n(1),h=new n(2).leftShift(new n(17));for(;c.lt(h);){if(u=u.mul(t).imod(e),u.isOne())return!1;c.iinc()}i=new n(i);const f=new n(2),m=await Yr(f.leftShift(s.dec()),f.leftShift(s)),y=e.dec().imul(m).iadd(i);return!!r.equal(t.modExp(y,e))}});class wr{constructor(t){if(t instanceof wr)this.oid=t.oid;else if(x.isArray(t)||x.isUint8Array(t)){if((t=new Uint8Array(t))[0]===6){if(t[1]!==t.length-2)throw Error("Length mismatch in DER encoded oid");t=t.subarray(2)}this.oid=t}else this.oid=""}read(t){if(t.length>=1){const r=t[0];if(t.length>=1+r)return this.oid=t.subarray(1,1+r),1+this.oid.length}throw Error("Invalid oid")}write(){return x.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return x.uint8ArrayToHex(this.oid)}getName(){const t=this.toHex();if(v.curve[t])return v.write(v.curve,t);throw Error("Unknown curve object identifier.")}}function Ws(e,t){return e.keyPair({priv:t})}function Hs(e,t){const r=e.keyPair({pub:t});if(r.validate().result!==!0)throw Error("Invalid elliptic public key");return r}async function En(e){if(!vt.useIndutnyElliptic)throw Error("This curve is only supported in the full build of OpenPGP.js");const{default:t}=await Promise.resolve().then(function(){return Wd});return new t.ec(e)}function oc(e){let t,r=0;const i=e[0];return i<192?([r]=e,t=1):i<255?(r=(e[0]-192<<8)+e[1]+192,t=2):i===255&&(r=x.readNumber(e.subarray(1,5)),t=5),{len:r,offset:t}}function ka(e){return e<192?new Uint8Array([e]):e>191&&e<8384?new Uint8Array([192+(e-192>>8),e-192&255]):x.concatUint8Array([new Uint8Array([255]),x.writeNumber(e,4)])}function qu(e){if(e<0||e>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+e])}function cc(e){return new Uint8Array([192|e])}function k1(e,t){return x.concatUint8Array([cc(e),ka(t)])}function $a(e){return[v.packet.literalData,v.packet.compressedData,v.packet.symmetricallyEncryptedData,v.packet.symEncryptedIntegrityProtectedData,v.packet.aeadEncryptedData].includes(e)}async function Fu(e,t){const r=Ur(e);let i,n;try{const a=await r.peekBytes(2);if(!a||a.length<2||(128&a[0])==0)throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");const s=await r.readByte();let o,u,c=-1,h=-1;h=0,(64&s)!=0&&(h=1),h?c=63&s:(c=(63&s)>>2,u=3&s);const f=$a(c);let m,y=null;if(f){if(x.isStream(e)==="array"){const I=new Ar;i=qe(I),y=I}else{const I=new mn;i=qe(I.writable),y=I.readable}n=t({tag:c,packet:y})}else y=[];do{if(h){const I=await r.readByte();if(m=!1,I<192)o=I;else if(I>=192&&I<224)o=(I-192<<8)+await r.readByte()+192;else if(I>223&&I<255){if(o=1<<(31&I),m=!0,!f)throw new TypeError("This packet type does not support partial lengths.")}else o=await r.readByte()<<24|await r.readByte()<<16|await r.readByte()<<8|await r.readByte()}else switch(u){case 0:o=await r.readByte();break;case 1:o=await r.readByte()<<8|await r.readByte();break;case 2:o=await r.readByte()<<24|await r.readByte()<<16|await r.readByte()<<8|await r.readByte();break;default:o=1/0}if(o>0){let I=0;for(;;){i&&await i.ready;const{done:U,value:V}=await r.read();if(U){if(o===1/0)break;throw Error("Unexpected end of packet")}const Z=o===1/0?V:V.subarray(0,o-I);if(i?await i.write(Z):y.push(Z),I+=V.length,I>=o){r.unshift(V.subarray(o-I+V.length));break}}}}while(m);const K=await r.peekBytes(f?1/0:2);return i?(await i.ready,await i.close()):(y=x.concatUint8Array(y),await t({tag:c,packet:y})),!K||!K.length}catch(a){if(i)return await i.abort(a),!0;throw a}finally{i&&await n,r.releaseLock()}}class ce extends Error{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,ce),this.name="UnsupportedError"}}class Ho{constructor(t,r){this.tag=t,this.rawContent=r}write(){return this.rawContent}}const yo=x.getWebCrypto(),os=x.getNodeCrypto(),Dr={p256:"P-256",p384:"P-384",p521:"P-521"},Fr=os?os.getCurves():[],ui=os?{secp256k1:Fr.includes("secp256k1")?"secp256k1":void 0,p256:Fr.includes("prime256v1")?"prime256v1":void 0,p384:Fr.includes("secp384r1")?"secp384r1":void 0,p521:Fr.includes("secp521r1")?"secp521r1":void 0,ed25519:Fr.includes("ED25519")?"ED25519":void 0,curve25519:Fr.includes("X25519")?"X25519":void 0,brainpoolP256r1:Fr.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,brainpoolP384r1:Fr.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,brainpoolP512r1:Fr.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},Za={p256:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:v.publicKey.ecdsa,hash:v.hash.sha256,cipher:v.symmetric.aes128,node:ui.p256,web:Dr.p256,payloadSize:32,sharedSize:256},p384:{oid:[6,5,43,129,4,0,34],keyType:v.publicKey.ecdsa,hash:v.hash.sha384,cipher:v.symmetric.aes192,node:ui.p384,web:Dr.p384,payloadSize:48,sharedSize:384},p521:{oid:[6,5,43,129,4,0,35],keyType:v.publicKey.ecdsa,hash:v.hash.sha512,cipher:v.symmetric.aes256,node:ui.p521,web:Dr.p521,payloadSize:66,sharedSize:528},secp256k1:{oid:[6,5,43,129,4,0,10],keyType:v.publicKey.ecdsa,hash:v.hash.sha256,cipher:v.symmetric.aes128,node:ui.secp256k1,payloadSize:32},ed25519:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:v.publicKey.eddsa,hash:v.hash.sha512,node:!1,payloadSize:32},curve25519:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:v.publicKey.ecdh,hash:v.hash.sha256,cipher:v.symmetric.aes128,node:!1,payloadSize:32},brainpoolP256r1:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:v.publicKey.ecdsa,hash:v.hash.sha256,cipher:v.symmetric.aes128,node:ui.brainpoolP256r1,payloadSize:32},brainpoolP384r1:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:v.publicKey.ecdsa,hash:v.hash.sha384,cipher:v.symmetric.aes192,node:ui.brainpoolP384r1,payloadSize:48},brainpoolP512r1:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:v.publicKey.ecdsa,hash:v.hash.sha512,cipher:v.symmetric.aes256,node:ui.brainpoolP512r1,payloadSize:64}};class Xr{constructor(t,r){try{(x.isArray(t)||x.isUint8Array(t))&&(t=new wr(t)),t instanceof wr&&(t=t.getName()),this.name=v.write(v.curve,t)}catch{throw new ce("Unknown curve")}r=r||Za[this.name],this.keyType=r.keyType,this.oid=r.oid,this.hash=r.hash,this.cipher=r.cipher,this.node=r.node&&Za[this.name],this.web=r.web&&Za[this.name],this.payloadSize=r.payloadSize,this.web&&x.getWebCrypto()?this.type="web":this.node&&x.getNodeCrypto()?this.type="node":this.name==="curve25519"?this.type="curve25519":this.name==="ed25519"&&(this.type="ed25519")}async genKeyPair(){let t;switch(this.type){case"web":try{return await async function(i){const n=await yo.generateKey({name:"ECDSA",namedCurve:Dr[i]},!0,["sign","verify"]),a=await yo.exportKey("jwk",n.privateKey);return{publicKey:hc(await yo.exportKey("jwk",n.publicKey)),privateKey:Lr(a.d)}}(this.name)}catch(i){x.printDebugError("Browser did not support generating ec key "+i.message);break}case"node":return async function(i){const n=os.createECDH(ui[i]);return await n.generateKeys(),{publicKey:new Uint8Array(n.getPublicKey()),privateKey:new Uint8Array(n.getPrivateKey())}}(this.name);case"curve25519":{const i=await Cr(32);i[0]=127&i[0]|64,i[31]&=248;const n=i.slice().reverse();return t=Mr.box.keyPair.fromSecretKey(n),{publicKey:x.concatUint8Array([new Uint8Array([64]),t.publicKey]),privateKey:i}}case"ed25519":{const i=await Cr(32),n=Mr.sign.keyPair.fromSeed(i);return{publicKey:x.concatUint8Array([new Uint8Array([64]),n.publicKey]),privateKey:i}}}return t=await(await En(this.name)).genKeyPair({entropy:x.uint8ArrayToString(await Cr(32))}),{publicKey:new Uint8Array(t.getPublic("array",!1)),privateKey:t.getPrivate().toArrayLike(Uint8Array)}}}async function uc(e,t,r,i){const n={p256:!0,p384:!0,p521:!0,secp256k1:!0,curve25519:e===v.publicKey.ecdh,brainpoolP256r1:!0,brainpoolP384r1:!0,brainpoolP512r1:!0},a=t.getName();if(!n[a])return!1;if(a==="curve25519"){i=i.slice().reverse();const{publicKey:o}=Mr.box.keyPair.fromSecretKey(i);r=new Uint8Array(r);const u=new Uint8Array([64,...o]);return!!x.equalsUint8Array(u,r)}const s=await En(a);try{r=Hs(s,r).getPublic()}catch{return!1}return!!Ws(s,i).getPublic().eq(r)}function hc(e){const t=Lr(e.x),r=Lr(e.y),i=new Uint8Array(t.length+r.length+1);return i[0]=4,i.set(t,1),i.set(r,t.length+1),i}function Gs(e,t,r){const i=e,n=r.slice(1,i+1),a=r.slice(i+1,2*i+1);return{kty:"EC",crv:t,x:Ne(n,!0),y:Ne(a,!0),ext:!0}}function dc(e,t,r,i){const n=Gs(e,t,r);return n.d=Ne(i,!0),n}const cs=x.getWebCrypto(),Pn=x.getNodeCrypto();async function A1(e,t,r,i,n,a){const s=new Xr(e);if(r&&!x.isStream(r)){const o={publicKey:i,privateKey:n};switch(s.type){case"web":try{return await async function(u,c,h,f){const m=u.payloadSize,y=dc(u.payloadSize,Dr[u.name],f.publicKey,f.privateKey),K=await cs.importKey("jwk",y,{name:"ECDSA",namedCurve:Dr[u.name],hash:{name:v.read(v.webHash,u.hash)}},!1,["sign"]),I=new Uint8Array(await cs.sign({name:"ECDSA",namedCurve:Dr[u.name],hash:{name:v.read(v.webHash,c)}},K,h));return{r:I.slice(0,m),s:I.slice(m,m<<1)}}(s,t,r,o)}catch(u){if(s.name!=="p521"&&(u.name==="DataError"||u.name==="OperationError"))throw u;x.printDebugError("Browser did not support signing: "+u.message)}break;case"node":{const u=await async function(c,h,f,m){const y=Pn.createSign(v.read(v.hash,h));y.write(f),y.end();const K=Ou.encode({version:1,parameters:c.oid,privateKey:Array.from(m.privateKey),publicKey:{unused:0,data:Array.from(m.publicKey)}},"pem",{label:"EC PRIVATE KEY"});return fc.decode(y.sign(K),"der")}(s,t,r,o);return{r:u.r.toArrayLike(Uint8Array),s:u.s.toArrayLike(Uint8Array)}}}}return async function(o,u,c){const h=await En(o.name),f=Ws(h,c).sign(u);return{r:f.r.toArrayLike(Uint8Array),s:f.s.toArrayLike(Uint8Array)}}(s,a,n)}async function S1(e,t,r,i,n,a){const s=new Xr(e);if(i&&!x.isStream(i))switch(s.type){case"web":try{return await async function(o,u,{r:c,s:h},f,m){const y=Gs(o.payloadSize,Dr[o.name],m),K=await cs.importKey("jwk",y,{name:"ECDSA",namedCurve:Dr[o.name],hash:{name:v.read(v.webHash,o.hash)}},!1,["verify"]),I=x.concatUint8Array([c,h]).buffer;return cs.verify({name:"ECDSA",namedCurve:Dr[o.name],hash:{name:v.read(v.webHash,u)}},K,I,f)}(s,t,r,i,n)}catch(o){if(s.name!=="p521"&&(o.name==="DataError"||o.name==="OperationError"))throw o;x.printDebugError("Browser did not support verifying: "+o.message)}break;case"node":return async function(o,u,{r:c,s:h},f,m){const{default:y}=await Promise.resolve().then(function(){return Zn}),K=Pn.createVerify(v.read(v.hash,u));K.write(f),K.end();const I=Lu.encode({algorithm:{algorithm:[1,2,840,10045,2,1],parameters:o.oid},subjectPublicKey:{unused:0,data:Array.from(m)}},"pem",{label:"PUBLIC KEY"}),U=fc.encode({r:new y(c),s:new y(h)},"der");try{return K.verify(I,U)}catch{return!1}}(s,t,r,i,n)}return async function(o,u,c,h){const f=await En(o.name);return Hs(f,h).verify(c,u)}(s,r,t===void 0?i:a,n)}const Vs=void 0,fc=Pn?Vs.define("ECDSASignature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())}):void 0,Ou=Pn?Vs.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").explicit(0).optional().any(),this.key("publicKey").explicit(1).optional().bitstr())}):void 0,Nu=Pn?Vs.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional().any())}):void 0,Lu=Pn?Vs.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(Nu),this.key("subjectPublicKey").bitstr())}):void 0;var ju=Object.freeze({__proto__:null,sign:A1,verify:S1,validateParams:async function(e,t,r){const i=new Xr(e);if(i.keyType!==v.publicKey.ecdsa)return!1;switch(i.type){case"web":case"node":{const n=await Cr(8),a=v.hash.sha256,s=await gn.digest(a,n);try{const o=await A1(e,a,n,t,r,s);return await S1(e,a,o,n,t,s)}catch{return!1}}default:return uc(v.publicKey.ecdsa,e,t,r)}}});Mr.hash=e=>new Uint8Array(_a().update(e).digest());var Wu=Object.freeze({__proto__:null,sign:async function(e,t,r,i,n,a){if(gn.getHashByteLength(t)<gn.getHashByteLength(v.hash.sha256))throw Error("Hash algorithm too weak: sha256 or stronger is required for EdDSA.");const s=x.concatUint8Array([n,i.subarray(1)]),o=Mr.sign.detached(a,s);return{r:o.subarray(0,32),s:o.subarray(32)}},verify:async function(e,t,{r,s:i},n,a,s){const o=x.concatUint8Array([r,i]);return Mr.sign.detached.verify(s,o,a.subarray(1))},validateParams:async function(e,t,r){if(e.getName()!=="ed25519")return!1;const{publicKey:i}=Mr.sign.keyPair.fromSeed(r),n=new Uint8Array([64,...i]);return x.equalsUint8Array(t,n)}});function lc(e,t){const r=new $i["aes"+8*e.length](e),i=new Uint32Array([2795939494,2795939494]),n=us(t);let a=i;const s=n,o=n.length/2,u=new Uint32Array([0,0]);let c=new Uint32Array(4);for(let h=0;h<=5;++h)for(let f=0;f<o;++f)u[1]=o*h+(1+f),c[0]=a[0],c[1]=a[1],c[2]=s[2*f],c[3]=s[2*f+1],c=us(r.encrypt(hs(c))),a=c.subarray(0,2),a[0]^=u[0],a[1]^=u[1],s[2*f]=c[2],s[2*f+1]=c[3];return hs(a,s)}function pc(e,t){const r=new $i["aes"+8*e.length](e),i=new Uint32Array([2795939494,2795939494]),n=us(t);let a=n.subarray(0,2);const s=n.subarray(2),o=n.length/2-1,u=new Uint32Array([0,0]);let c=new Uint32Array(4);for(let h=5;h>=0;--h)for(let f=o-1;f>=0;--f)u[1]=o*h+(f+1),c[0]=a[0]^u[0],c[1]=a[1]^u[1],c[2]=s[2*f],c[3]=s[2*f+1],c=us(r.decrypt(hs(c))),a=c.subarray(0,2),s[2*f]=c[2],s[2*f+1]=c[3];if(a[0]===i[0]&&a[1]===i[1])return hs(s);throw Error("Key Data Integrity failed")}function us(e){const{length:t}=e,r=function(a){if(x.isString(a)){const{length:s}=a,o=new ArrayBuffer(s),u=new Uint8Array(o);for(let c=0;c<s;++c)u[c]=a.charCodeAt(c);return o}return new Uint8Array(a).buffer}(e),i=new DataView(r),n=new Uint32Array(t/4);for(let a=0;a<t/4;++a)n[a]=i.getUint32(4*a);return n}function hs(){let e=0;for(let n=0;n<arguments.length;++n)e+=4*arguments[n].length;const t=new ArrayBuffer(e),r=new DataView(t);let i=0;for(let n=0;n<arguments.length;++n){for(let a=0;a<arguments[n].length;++a)r.setUint32(i+4*a,arguments[n][a]);i+=4*arguments[n].length}return new Uint8Array(t)}var Hu=Object.freeze({__proto__:null,wrap:lc,unwrap:pc});function yc(e){const t=8-e.length%8,r=new Uint8Array(e.length+t).fill(t);return r.set(e),r}function bc(e){const t=e.length;if(t>0){const r=e[t-1];if(r>=1){const i=e.subarray(t-r),n=new Uint8Array(r).fill(r);if(x.equalsUint8Array(i,n))return e.subarray(0,t-r)}}throw Error("Invalid padding")}var Gu=Object.freeze({__proto__:null,encode:yc,decode:bc});const gi=x.getWebCrypto(),mc=x.getNodeCrypto();function E1(e,t,r,i){return x.concatUint8Array([t.write(),new Uint8Array([e]),r.write(),x.stringToUint8Array("Anonymous Sender    "),i.subarray(0,20)])}async function P1(e,t,r,i,n=!1,a=!1){let s;if(n){for(s=0;s<t.length&&t[s]===0;s++);t=t.subarray(s)}if(a){for(s=t.length-1;s>=0&&t[s]===0;s--);t=t.subarray(0,s+1)}return(await gn.digest(e,x.concatUint8Array([new Uint8Array([0,0,0,1]),t,i]))).subarray(0,r)}async function Vu(e,t){switch(e.type){case"curve25519":{const r=await Cr(32),{secretKey:i,sharedKey:n}=await gc(e,t,null,r);let{publicKey:a}=Mr.box.keyPair.fromSecretKey(i);return a=x.concatUint8Array([new Uint8Array([64]),a]),{publicKey:a,sharedKey:n}}case"web":if(e.web&&x.getWebCrypto())try{return await async function(r,i){const n=Gs(r.payloadSize,r.web.web,i);let a=gi.generateKey({name:"ECDH",namedCurve:r.web.web},!0,["deriveKey","deriveBits"]),s=gi.importKey("jwk",n,{name:"ECDH",namedCurve:r.web.web},!1,[]);[a,s]=await Promise.all([a,s]);let o=gi.deriveBits({name:"ECDH",namedCurve:r.web.web,public:s},a.privateKey,r.web.sharedSize),u=gi.exportKey("jwk",a.publicKey);[o,u]=await Promise.all([o,u]);const c=new Uint8Array(o);return{publicKey:new Uint8Array(hc(u)),sharedKey:c}}(e,t)}catch(r){x.printDebugError(r)}break;case"node":return async function(r,i){const n=mc.createECDH(r.node.node);n.generateKeys();const a=new Uint8Array(n.computeSecret(i));return{publicKey:new Uint8Array(n.getPublicKey()),sharedKey:a}}(e,t)}return async function(r,i){const n=await En(r.name),a=await r.genKeyPair();i=Hs(n,i);const s=Ws(n,a.privateKey),o=a.publicKey,u=s.derive(i.getPublic()),c=n.curve.p.byteLength(),h=u.toArrayLike(Uint8Array,"be",c);return{publicKey:o,sharedKey:h}}(e,t)}async function gc(e,t,r,i){if(i.length!==e.payloadSize){const n=new Uint8Array(e.payloadSize);n.set(i,e.payloadSize-i.length),i=n}switch(e.type){case"curve25519":{const n=i.slice().reverse();return{secretKey:n,sharedKey:Mr.scalarMult(n,t.subarray(1))}}case"web":if(e.web&&x.getWebCrypto())try{return await async function(n,a,s,o){const u=dc(n.payloadSize,n.web.web,s,o);let c=gi.importKey("jwk",u,{name:"ECDH",namedCurve:n.web.web},!0,["deriveKey","deriveBits"]);const h=Gs(n.payloadSize,n.web.web,a);let f=gi.importKey("jwk",h,{name:"ECDH",namedCurve:n.web.web},!0,[]);[c,f]=await Promise.all([c,f]);let m=gi.deriveBits({name:"ECDH",namedCurve:n.web.web,public:f},c,n.web.sharedSize),y=gi.exportKey("jwk",c);[m,y]=await Promise.all([m,y]);const K=new Uint8Array(m);return{secretKey:Lr(y.d),sharedKey:K}}(e,t,r,i)}catch(n){x.printDebugError(n)}break;case"node":return async function(n,a,s){const o=mc.createECDH(n.node.node);o.setPrivateKey(s);const u=new Uint8Array(o.computeSecret(a));return{secretKey:new Uint8Array(o.getPrivateKey()),sharedKey:u}}(e,t,i)}return async function(n,a,s){const o=await En(n.name);a=Hs(o,a),s=Ws(o,s);const u=new Uint8Array(s.getPrivate()),c=s.derive(a.getPublic()),h=o.curve.p.byteLength(),f=c.toArrayLike(Uint8Array,"be",h);return{secretKey:u,sharedKey:f}}(e,t,i)}var $u=Object.freeze({__proto__:null,validateParams:async function(e,t,r){return uc(v.publicKey.ecdh,e,t,r)},encrypt:async function(e,t,r,i,n){const a=yc(r),s=new Xr(e),{publicKey:o,sharedKey:u}=await Vu(s,i),c=E1(v.publicKey.ecdh,e,t,n),{keySize:h}=pn(t.cipher);return{publicKey:o,wrappedKey:lc(await P1(t.hash,u,h,c),a)}},decrypt:async function(e,t,r,i,n,a,s){const o=new Xr(e),{sharedKey:u}=await gc(o,r,n,a),c=E1(v.publicKey.ecdh,e,t,s),{keySize:h}=pn(t.cipher);let f;for(let m=0;m<3;m++)try{return bc(pc(await P1(t.hash,u,h,c,m===1,m===2),i))}catch(y){f=y}throw f}}),ee={rsa:Tu,elgamal:zu,elliptic:Object.freeze({__proto__:null,Curve:Xr,ecdh:$u,ecdsa:ju,eddsa:Wu,generate:async function(e){const t=await x.getBigInteger();e=new Xr(e);const r=await e.genKeyPair(),i=new t(r.publicKey).toUint8Array(),n=new t(r.privateKey).toUint8Array("be",e.payloadSize);return{oid:e.oid,Q:i,secret:n,hash:e.hash,cipher:e.cipher}},getPreferredHashAlgo:function(e){return Za[v.write(v.curve,e.toHex())].hash}}),dsa:Object.freeze({__proto__:null,sign:async function(e,t,r,i,n,a){const s=await x.getBigInteger(),o=new s(1);let u,c,h,f;i=new s(i),n=new s(n),r=new s(r),a=new s(a),r=r.mod(i),a=a.mod(n);const m=new s(t.subarray(0,n.byteLength())).mod(n);for(;;){if(u=await Yr(o,n),c=r.modExp(u,i).imod(n),c.isZero())continue;const y=a.mul(c).imod(n);if(f=m.add(y).imod(n),h=u.modInv(n).imul(f).imod(n),!h.isZero())break}return{r:c.toUint8Array("be",n.byteLength()),s:h.toUint8Array("be",n.byteLength())}},verify:async function(e,t,r,i,n,a,s,o){const u=await x.getBigInteger(),c=new u(0);if(t=new u(t),r=new u(r),a=new u(a),s=new u(s),n=new u(n),o=new u(o),t.lte(c)||t.gte(s)||r.lte(c)||r.gte(s))return x.printDebug("invalid DSA Signature"),!1;const h=new u(i.subarray(0,s.byteLength())).imod(s),f=r.modInv(s);if(f.isZero())return x.printDebug("invalid DSA Signature"),!1;n=n.mod(a),o=o.mod(a);const m=h.mul(f).imod(s),y=t.mul(f).imod(s),K=n.modExp(m,a),I=o.modExp(y,a);return K.mul(I).imod(a).imod(s).equal(t)},validateParams:async function(e,t,r,i,n){const a=await x.getBigInteger();e=new a(e),t=new a(t),r=new a(r),i=new a(i);const s=new a(1);if(r.lte(s)||r.gte(e)||!e.dec().mod(t).isZero()||!r.modExp(t,e).isOne())return!1;const o=new a(t.bitLength()),u=new a(150);if(o.lt(u)||!await ac(t,null,32))return!1;n=new a(n);const c=new a(2),h=await Yr(c.leftShift(o.dec()),c.leftShift(o)),f=t.mul(h).add(n);return!!i.equal(r.modExp(f,e))}}),nacl:Mr};class x1{constructor(t){t=t===void 0?new Uint8Array([]):x.isString(t)?x.stringToUint8Array(t):new Uint8Array(t),this.data=t}read(t){if(t.length>=1){const r=t[0];if(t.length>=1+r)return this.data=t.subarray(1,1+r),1+this.data.length}throw Error("Invalid symmetric key")}write(){return x.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class M1{constructor(t){if(t){const{hash:r,cipher:i}=t;this.hash=r,this.cipher=i}else this.hash=null,this.cipher=null}read(t){if(t.length<4||t[0]!==3||t[1]!==1)throw Error("Cannot read KDFParams");return this.hash=t[2],this.cipher=t[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}function pn(e){const t=v.read(v.symmetric,e);return $i[t]}function bo(e){try{e.getName()}catch{throw new ce("Unknown curve OID")}}var Zu=Object.freeze({__proto__:null,publicKeyEncrypt:async function(e,t,r,i){switch(e){case v.publicKey.rsaEncrypt:case v.publicKey.rsaEncryptSign:{const{n,e:a}=t;return{c:await ee.rsa.encrypt(r,n,a)}}case v.publicKey.elgamal:{const{p:n,g:a,y:s}=t;return ee.elgamal.encrypt(r,n,a,s)}case v.publicKey.ecdh:{const{oid:n,Q:a,kdfParams:s}=t,{publicKey:o,wrappedKey:u}=await ee.elliptic.ecdh.encrypt(n,s,r,a,i);return{V:o,C:new x1(u)}}default:return[]}},publicKeyDecrypt:async function(e,t,r,i,n,a){switch(e){case v.publicKey.rsaEncryptSign:case v.publicKey.rsaEncrypt:{const{c:s}=i,{n:o,e:u}=t,{d:c,p:h,q:f,u:m}=r;return ee.rsa.decrypt(s,o,u,c,h,f,m,a)}case v.publicKey.elgamal:{const{c1:s,c2:o}=i,u=t.p,c=r.x;return ee.elgamal.decrypt(s,o,u,c,a)}case v.publicKey.ecdh:{const{oid:s,Q:o,kdfParams:u}=t,{d:c}=r,{V:h,C:f}=i;return ee.elliptic.ecdh.decrypt(s,u,h,f.data,o,c,n)}default:throw Error("Unknown public key encryption algorithm.")}},parsePublicKeyParams:function(e,t){let r=0;switch(e){case v.publicKey.rsaEncrypt:case v.publicKey.rsaEncryptSign:case v.publicKey.rsaSign:{const i=x.readMPI(t.subarray(r));r+=i.length+2;const n=x.readMPI(t.subarray(r));return r+=n.length+2,{read:r,publicParams:{n:i,e:n}}}case v.publicKey.dsa:{const i=x.readMPI(t.subarray(r));r+=i.length+2;const n=x.readMPI(t.subarray(r));r+=n.length+2;const a=x.readMPI(t.subarray(r));r+=a.length+2;const s=x.readMPI(t.subarray(r));return r+=s.length+2,{read:r,publicParams:{p:i,q:n,g:a,y:s}}}case v.publicKey.elgamal:{const i=x.readMPI(t.subarray(r));r+=i.length+2;const n=x.readMPI(t.subarray(r));r+=n.length+2;const a=x.readMPI(t.subarray(r));return r+=a.length+2,{read:r,publicParams:{p:i,g:n,y:a}}}case v.publicKey.ecdsa:{const i=new wr;r+=i.read(t),bo(i);const n=x.readMPI(t.subarray(r));return r+=n.length+2,{read:r,publicParams:{oid:i,Q:n}}}case v.publicKey.eddsa:{const i=new wr;r+=i.read(t),bo(i);let n=x.readMPI(t.subarray(r));return r+=n.length+2,n=x.leftPad(n,33),{read:r,publicParams:{oid:i,Q:n}}}case v.publicKey.ecdh:{const i=new wr;r+=i.read(t),bo(i);const n=x.readMPI(t.subarray(r));r+=n.length+2;const a=new M1;return r+=a.read(t.subarray(r)),{read:r,publicParams:{oid:i,Q:n,kdfParams:a}}}default:throw new ce("Unknown public key encryption algorithm.")}},parsePrivateKeyParams:function(e,t,r){let i=0;switch(e){case v.publicKey.rsaEncrypt:case v.publicKey.rsaEncryptSign:case v.publicKey.rsaSign:{const n=x.readMPI(t.subarray(i));i+=n.length+2;const a=x.readMPI(t.subarray(i));i+=a.length+2;const s=x.readMPI(t.subarray(i));i+=s.length+2;const o=x.readMPI(t.subarray(i));return i+=o.length+2,{read:i,privateParams:{d:n,p:a,q:s,u:o}}}case v.publicKey.dsa:case v.publicKey.elgamal:{const n=x.readMPI(t.subarray(i));return i+=n.length+2,{read:i,privateParams:{x:n}}}case v.publicKey.ecdsa:case v.publicKey.ecdh:{const n=new Xr(r.oid);let a=x.readMPI(t.subarray(i));return i+=a.length+2,a=x.leftPad(a,n.payloadSize),{read:i,privateParams:{d:a}}}case v.publicKey.eddsa:{const n=new Xr(r.oid);let a=x.readMPI(t.subarray(i));return i+=a.length+2,a=x.leftPad(a,n.payloadSize),{read:i,privateParams:{seed:a}}}default:throw new ce("Unknown public key encryption algorithm.")}},parseEncSessionKeyParams:function(e,t){let r=0;switch(e){case v.publicKey.rsaEncrypt:case v.publicKey.rsaEncryptSign:return{c:x.readMPI(t.subarray(r))};case v.publicKey.elgamal:{const i=x.readMPI(t.subarray(r));return r+=i.length+2,{c1:i,c2:x.readMPI(t.subarray(r))}}case v.publicKey.ecdh:{const i=x.readMPI(t.subarray(r));r+=i.length+2;const n=new x1;return n.read(t.subarray(r)),{V:i,C:n}}default:throw new ce("Unknown public key encryption algorithm.")}},serializeParams:function(e,t){const r=Object.keys(t).map(i=>{const n=t[i];return x.isUint8Array(n)?x.uint8ArrayToMPI(n):n.write()});return x.concatUint8Array(r)},generateParams:function(e,t,r){switch(e){case v.publicKey.rsaEncrypt:case v.publicKey.rsaEncryptSign:case v.publicKey.rsaSign:return ee.rsa.generate(t,65537).then(({n:i,e:n,d:a,p:s,q:o,u})=>({privateParams:{d:a,p:s,q:o,u},publicParams:{n:i,e:n}}));case v.publicKey.ecdsa:return ee.elliptic.generate(r).then(({oid:i,Q:n,secret:a})=>({privateParams:{d:a},publicParams:{oid:new wr(i),Q:n}}));case v.publicKey.eddsa:return ee.elliptic.generate(r).then(({oid:i,Q:n,secret:a})=>({privateParams:{seed:a},publicParams:{oid:new wr(i),Q:n}}));case v.publicKey.ecdh:return ee.elliptic.generate(r).then(({oid:i,Q:n,secret:a,hash:s,cipher:o})=>({privateParams:{d:a},publicParams:{oid:new wr(i),Q:n,kdfParams:new M1({hash:s,cipher:o})}}));case v.publicKey.dsa:case v.publicKey.elgamal:throw Error("Unsupported algorithm for key generation.");default:throw Error("Unknown public key algorithm.")}},validateParams:async function(e,t,r){if(!t||!r)throw Error("Missing key parameters");switch(e){case v.publicKey.rsaEncrypt:case v.publicKey.rsaEncryptSign:case v.publicKey.rsaSign:{const{n:i,e:n}=t,{d:a,p:s,q:o,u}=r;return ee.rsa.validateParams(i,n,a,s,o,u)}case v.publicKey.dsa:{const{p:i,q:n,g:a,y:s}=t,{x:o}=r;return ee.dsa.validateParams(i,n,a,s,o)}case v.publicKey.elgamal:{const{p:i,g:n,y:a}=t,{x:s}=r;return ee.elgamal.validateParams(i,n,a,s)}case v.publicKey.ecdsa:case v.publicKey.ecdh:{const i=ee.elliptic[v.read(v.publicKey,e)],{oid:n,Q:a}=t,{d:s}=r;return i.validateParams(n,a,s)}case v.publicKey.eddsa:{const{oid:i,Q:n}=t,{seed:a}=r;return ee.elliptic.eddsa.validateParams(i,n,a)}default:throw Error("Unknown public key algorithm.")}},getPrefixRandom:async function(e){const{blockSize:t}=pn(e),r=await Cr(t),i=new Uint8Array([r[r.length-2],r[r.length-1]]);return x.concat([r,i])},generateSessionKey:function(e){const{keySize:t}=pn(e);return Cr(t)},getAEADMode:function(e){const t=v.read(v.aead,e);return wc[t]},getCipher:pn});const C1=x.getWebCrypto(),ds=x.getNodeCrypto(),Ii=ds?ds.getCiphers():[],Ra={idea:Ii.includes("idea-cfb")?"idea-cfb":void 0,tripledes:Ii.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:Ii.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:Ii.includes("bf-cfb")?"bf-cfb":void 0,aes128:Ii.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:Ii.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:Ii.includes("aes-256-cfb")?"aes-256-cfb":void 0};var Yu=Object.freeze({__proto__:null,encrypt:async function(e,t,r,i,n){const a=v.read(v.symmetric,e);if(x.getNodeCrypto()&&Ra[a])return function(f,m,y,K){const I=v.read(v.symmetric,f),U=new ds.createCipheriv(Ra[I],m,K);return ne(y,V=>new Uint8Array(U.update(V)))}(e,t,r,i);if(a.substr(0,3)==="aes")return function(f,m,y,K,I){if(x.getWebCrypto()&&m.length!==24&&!x.isStream(y)&&y.length>=3e3*I.minBytesForWebCrypto)return async function(V,Z,$,R){const tt="AES-CBC",X=await C1.importKey("raw",Z,{name:tt},!1,["encrypt"]),{blockSize:Q}=pn(V),d=x.concatUint8Array([new Uint8Array(Q),$]),b=new Uint8Array(await C1.encrypt({name:tt,iv:R},X,d)).subarray(0,$.length);return function(_,g){for(let p=0;p<_.length;p++)_[p]=_[p]^g[p]}(b,$),b}(f,m,y,K);const U=new ln(m,K);return ne(y,V=>U.aes.AES_Encrypt_process(V),()=>U.aes.AES_Encrypt_finish())}(e,t,r,i,n);const s=new $i[a](t),o=s.blockSize,u=i.slice();let c=new Uint8Array;const h=f=>{f&&(c=x.concatUint8Array([c,f]));const m=new Uint8Array(c.length);let y,K=0;for(;f?c.length>=o:c.length;){const I=s.encrypt(u);for(y=0;y<o;y++)u[y]=c[y]^I[y],m[K++]=u[y];c=c.subarray(o)}return m.subarray(0,K)};return ne(r,h,h)},decrypt:async function(e,t,r,i){const n=v.read(v.symmetric,e);if(x.getNodeCrypto()&&Ra[n])return function(h,f,m,y){const K=v.read(v.symmetric,h),I=new ds.createDecipheriv(Ra[K],f,y);return ne(m,U=>new Uint8Array(I.update(U)))}(e,t,r,i);if(n.substr(0,3)==="aes")return function(h,f,m,y){if(x.isStream(m)){const K=new ln(f,y);return ne(m,I=>K.aes.AES_Decrypt_process(I),()=>K.aes.AES_Decrypt_finish())}return ln.decrypt(m,f,y)}(0,t,r,i);const a=new $i[n](t),s=a.blockSize;let o=i,u=new Uint8Array;const c=h=>{h&&(u=x.concatUint8Array([u,h]));const f=new Uint8Array(u.length);let m,y=0;for(;h?u.length>=s:u.length;){const K=a.encrypt(o);for(o=u,m=0;m<s;m++)f[y++]=o[m]^K[m];u=u.subarray(s)}return f.subarray(0,y)};return ne(r,c,c)}});class fs{static encrypt(t,r,i){return new fs(r,i).encrypt(t)}static decrypt(t,r,i){return new fs(r,i).encrypt(t)}constructor(t,r,i){this.aes=i||new wa(t,void 0,!1,"CTR"),delete this.aes.padding,this.AES_CTR_set_options(r)}encrypt(t){return Si(this.aes.AES_Encrypt_process(t),this.aes.AES_Encrypt_finish())}decrypt(t){return Si(this.aes.AES_Encrypt_process(t),this.aes.AES_Encrypt_finish())}AES_CTR_set_options(t,r,i){let{asm:n}=this.aes.acquire_asm();if(i!==void 0){if(i<8||i>48)throw new Hr("illegal counter size");let a=Math.pow(2,i)-1;n.set_mask(0,0,a/4294967296|0,0|a)}else i=48,n.set_mask(0,0,65535,4294967295);if(t===void 0)throw Error("nonce is required");{let a=t.length;if(!a||a>16)throw new Hr("illegal nonce size");let s=new DataView(new ArrayBuffer(16));new Uint8Array(s.buffer).set(t),n.set_nonce(s.getUint32(0),s.getUint32(4),s.getUint32(8),s.getUint32(12))}if(r!==void 0){if(r<0||r>=Math.pow(2,i))throw new Hr("illegal counter value");n.set_counter(0,0,r/4294967296|0,0|r)}}}class ls{static encrypt(t,r,i=!0,n){return new ls(r,n,i).encrypt(t)}static decrypt(t,r,i=!0,n){return new ls(r,n,i).decrypt(t)}constructor(t,r,i=!0,n){this.aes=n||new wa(t,r,i,"CBC")}encrypt(t){return Si(this.aes.AES_Encrypt_process(t),this.aes.AES_Encrypt_finish())}decrypt(t){return Si(this.aes.AES_Decrypt_process(t),this.aes.AES_Decrypt_finish())}}const D1=x.getWebCrypto(),Xu=x.getNodeCrypto();function K1(e,t){const r=e.length-16;for(let i=0;i<16;i++)e[i+r]^=t[i];return e}const Ia=new Uint8Array(16);async function Qu(e){const t=await async function(n){return x.getWebCrypto()&&n.length!==24?(n=await D1.importKey("raw",n,{name:"AES-CBC",length:8*n.length},!1,["encrypt"]),async function(a){const s=await D1.encrypt({name:"AES-CBC",iv:Ia,length:128},n,a);return new Uint8Array(s).subarray(0,s.byteLength-16)}):x.getNodeCrypto()?async function(a){const s=new Xu.createCipheriv("aes-"+8*n.length+"-cbc",n,Ia).update(a);return new Uint8Array(s)}:async function(a){return ls.encrypt(a,n,!1,Ia)}}(e),r=x.double(await t(Ia)),i=x.double(r);return async function(n){return(await t(function(a,s,o){if(a.length&&a.length%16==0)return K1(a,s);const u=new Uint8Array(a.length+(16-a.length%16));return u.set(a),u[a.length]=128,K1(u,o)}(n,r,i))).subarray(-16)}}const R1=x.getWebCrypto(),Ju=x.getNodeCrypto(),th=x.getNodeBuffer(),I1=new Uint8Array(16),Go=new Uint8Array(16);Go[15]=1;const Vo=new Uint8Array(16);async function eh(e){const t=await Qu(e);return function(r,i){return t(x.concatUint8Array([r,i]))}}async function rh(e){return x.getWebCrypto()&&e.length!==24?(e=await R1.importKey("raw",e,{name:"AES-CTR",length:8*e.length},!1,["encrypt"]),async function(t,r){const i=await R1.encrypt({name:"AES-CTR",counter:r,length:128},e,t);return new Uint8Array(i)}):x.getNodeCrypto()?async function(t,r){const i=new Ju.createCipheriv("aes-"+8*e.length+"-ctr",e,r),n=th.concat([i.update(t),i.final()]);return new Uint8Array(n)}:async function(t,r){return fs.encrypt(t,e,r)}}async function Ln(e,t){if(e!==v.symmetric.aes128&&e!==v.symmetric.aes192&&e!==v.symmetric.aes256)throw Error("EAX mode supports only AES cipher");const[r,i]=await Promise.all([eh(t),rh(t)]);return{encrypt:async function(n,a,s){const[o,u]=await Promise.all([r(I1,a),r(Go,s)]),c=await i(n,o),h=await r(Vo,c);for(let f=0;f<16;f++)h[f]^=u[f]^o[f];return x.concatUint8Array([c,h])},decrypt:async function(n,a,s){if(n.length<16)throw Error("Invalid EAX ciphertext");const o=n.subarray(0,-16),u=n.subarray(-16),[c,h,f]=await Promise.all([r(I1,a),r(Go,s),r(Vo,o)]),m=f;for(let y=0;y<16;y++)m[y]^=h[y]^c[y];if(!x.equalsUint8Array(u,m))throw Error("Authentication tag mismatch");return await i(o,c)}}}Vo[15]=2,Ln.getNonce=function(e,t){const r=e.slice();for(let i=0;i<t.length;i++)r[8+i]^=t[i];return r},Ln.blockLength=16,Ln.ivLength=16,Ln.tagLength=16;function U1(e){let t=0;for(let r=1;(e&r)==0;r<<=1)t++;return t}function Ue(e,t){for(let r=0;r<e.length;r++)e[r]^=t[r];return e}function Ua(e,t){return Ue(e.slice(),t)}const mo=new Uint8Array(16),ih=new Uint8Array([1]);async function jn(e,t){let r,i,n,a=0;function s(o,u,c,h){const f=u.length/16|0;(function(X,Q){const d=x.nbits(Math.max(X.length,Q.length)/16|0)-1;for(let b=a+1;b<=d;b++)n[b]=x.double(n[b-1]);a=d})(u,h);const m=x.concatUint8Array([mo.subarray(0,15-c.length),ih,c]),y=63&m[15];m[15]&=192;const K=r(m),I=x.concatUint8Array([K,Ua(K.subarray(0,8),K.subarray(1,9))]),U=x.shiftRight(I.subarray(0+(y>>3),17+(y>>3)),8-(7&y)).subarray(1),V=new Uint8Array(16),Z=new Uint8Array(u.length+16);let $,R=0;for($=0;$<f;$++)Ue(U,n[U1($+1)]),Z.set(Ue(o(Ua(U,u)),U),R),Ue(V,o===r?u:Z.subarray(R)),u=u.subarray(16),R+=16;if(u.length){Ue(U,n.x);const X=r(U);Z.set(Ua(u,X),R);const Q=new Uint8Array(16);Q.set(o===r?u:Z.subarray(R,-16),0),Q[u.length]=128,Ue(V,Q),R+=u.length}const tt=Ue(r(Ue(Ue(V,U),n.$)),function(X){if(!X.length)return mo;const Q=X.length/16|0,d=new Uint8Array(16),b=new Uint8Array(16);for(let _=0;_<Q;_++)Ue(d,n[U1(_+1)]),Ue(b,r(Ua(d,X))),X=X.subarray(16);if(X.length){Ue(d,n.x);const _=new Uint8Array(16);_.set(X,0),_[X.length]=128,Ue(_,d),Ue(b,r(_))}return b}(h));return Z.set(tt,R),Z}return function(o,u){const c=v.read(v.symmetric,o),h=new $i[c](u);r=h.encrypt.bind(h),i=h.decrypt.bind(h);const f=r(mo),m=x.double(f);n=[],n[0]=x.double(m),n.x=f,n.$=m}(e,t),{encrypt:async function(o,u,c){return s(r,o,u,c)},decrypt:async function(o,u,c){if(o.length<16)throw Error("Invalid OCB ciphertext");const h=o.subarray(-16);o=o.subarray(0,-16);const f=s(i,o,u,c);if(x.equalsUint8Array(h,f.subarray(-16)))return f.subarray(0,-16);throw Error("Authentication tag mismatch")}}}jn.getNonce=function(e,t){const r=e.slice();for(let i=0;i<t.length;i++)r[7+i]^=t[i];return r},jn.blockLength=16,jn.ivLength=15,jn.tagLength=16;class Ni{constructor(t,r,i,n=16,a){this.tagSize=n,this.gamma0=0,this.counter=1,this.aes=a||new wa(t,void 0,!1,"CTR");let{asm:s,heap:o}=this.aes.acquire_asm();if(s.gcm_init(),this.tagSize<4||this.tagSize>16)throw new Hr("illegal tagSize value");const u=r.length||0,c=new Uint8Array(16);u!==12?(this._gcm_mac_process(r),o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=0,o[11]=u>>>29,o[12]=u>>>21&255,o[13]=u>>>13&255,o[14]=u>>>5&255,o[15]=u<<3&255,s.mac(Nt.MAC.GCM,Nt.HEAP_DATA,16),s.get_iv(Nt.HEAP_DATA),s.set_iv(0,0,0,0),c.set(o.subarray(0,16))):(c.set(r),c[15]=1);const h=new DataView(c.buffer);if(this.gamma0=h.getUint32(12),s.set_nonce(h.getUint32(0),h.getUint32(4),h.getUint32(8),0),s.set_mask(0,0,0,4294967295),i!==void 0){if(i.length>68719476704)throw new Hr("illegal adata length");i.length?(this.adata=i,this._gcm_mac_process(i)):this.adata=void 0}else this.adata=void 0;if(this.counter<1||this.counter>4294967295)throw new RangeError("counter must be a positive 32-bit integer");s.set_counter(0,0,0,this.gamma0+this.counter|0)}static encrypt(t,r,i,n,a){return new Ni(r,i,n,a).encrypt(t)}static decrypt(t,r,i,n,a){return new Ni(r,i,n,a).decrypt(t)}encrypt(t){return this.AES_GCM_encrypt(t)}decrypt(t){return this.AES_GCM_decrypt(t)}AES_GCM_Encrypt_process(t){let r=0,i=t.length||0,{asm:n,heap:a}=this.aes.acquire_asm(),s=this.counter,o=this.aes.pos,u=this.aes.len,c=0,h=u+i&-16,f=0;if((s-1<<4)+u+i>68719476704)throw new RangeError("counter overflow");const m=new Uint8Array(h);for(;i>0;)f=Fi(a,o+u,t,r,i),u+=f,r+=f,i-=f,f=n.cipher(Nt.ENC.CTR,Nt.HEAP_DATA+o,u),f=n.mac(Nt.MAC.GCM,Nt.HEAP_DATA+o,f),f&&m.set(a.subarray(o,o+f),c),s+=f>>>4,c+=f,f<u?(o+=f,u-=f):(o=0,u=0);return this.counter=s,this.aes.pos=o,this.aes.len=u,m}AES_GCM_Encrypt_finish(){let{asm:t,heap:r}=this.aes.acquire_asm(),i=this.counter,n=this.tagSize,a=this.adata,s=this.aes.pos,o=this.aes.len;const u=new Uint8Array(o+n);t.cipher(Nt.ENC.CTR,Nt.HEAP_DATA+s,o+15&-16),o&&u.set(r.subarray(s,s+o));let c=o;for(;15&c;c++)r[s+c]=0;t.mac(Nt.MAC.GCM,Nt.HEAP_DATA+s,c);const h=a!==void 0?a.length:0,f=(i-1<<4)+o;return r[0]=0,r[1]=0,r[2]=0,r[3]=h>>>29,r[4]=h>>>21,r[5]=h>>>13&255,r[6]=h>>>5&255,r[7]=h<<3&255,r[8]=r[9]=r[10]=0,r[11]=f>>>29,r[12]=f>>>21&255,r[13]=f>>>13&255,r[14]=f>>>5&255,r[15]=f<<3&255,t.mac(Nt.MAC.GCM,Nt.HEAP_DATA,16),t.get_iv(Nt.HEAP_DATA),t.set_counter(0,0,0,this.gamma0),t.cipher(Nt.ENC.CTR,Nt.HEAP_DATA,16),u.set(r.subarray(0,n),o),this.counter=1,this.aes.pos=0,this.aes.len=0,u}AES_GCM_Decrypt_process(t){let r=0,i=t.length||0,{asm:n,heap:a}=this.aes.acquire_asm(),s=this.counter,o=this.tagSize,u=this.aes.pos,c=this.aes.len,h=0,f=c+i>o?c+i-o&-16:0,m=c+i-f,y=0;if((s-1<<4)+c+i>68719476704)throw new RangeError("counter overflow");const K=new Uint8Array(f);for(;i>m;)y=Fi(a,u+c,t,r,i-m),c+=y,r+=y,i-=y,y=n.mac(Nt.MAC.GCM,Nt.HEAP_DATA+u,y),y=n.cipher(Nt.DEC.CTR,Nt.HEAP_DATA+u,y),y&&K.set(a.subarray(u,u+y),h),s+=y>>>4,h+=y,u=0,c=0;return i>0&&(c+=Fi(a,0,t,r,i)),this.counter=s,this.aes.pos=u,this.aes.len=c,K}AES_GCM_Decrypt_finish(){let{asm:t,heap:r}=this.aes.acquire_asm(),i=this.tagSize,n=this.adata,a=this.counter,s=this.aes.pos,o=this.aes.len,u=o-i;if(o<i)throw new No("authentication tag not found");const c=new Uint8Array(u),h=new Uint8Array(r.subarray(s+u,s+o));let f=u;for(;15&f;f++)r[s+f]=0;t.mac(Nt.MAC.GCM,Nt.HEAP_DATA+s,f),t.cipher(Nt.DEC.CTR,Nt.HEAP_DATA+s,f),u&&c.set(r.subarray(s,s+u));const m=n!==void 0?n.length:0,y=(a-1<<4)+o-i;r[0]=0,r[1]=0,r[2]=0,r[3]=m>>>29,r[4]=m>>>21,r[5]=m>>>13&255,r[6]=m>>>5&255,r[7]=m<<3&255,r[8]=r[9]=r[10]=0,r[11]=y>>>29,r[12]=y>>>21&255,r[13]=y>>>13&255,r[14]=y>>>5&255,r[15]=y<<3&255,t.mac(Nt.MAC.GCM,Nt.HEAP_DATA,16),t.get_iv(Nt.HEAP_DATA),t.set_counter(0,0,0,this.gamma0),t.cipher(Nt.ENC.CTR,Nt.HEAP_DATA,16);let K=0;for(let I=0;I<i;++I)K|=h[I]^r[I];if(K)throw new Lo("data integrity check failed");return this.counter=1,this.aes.pos=0,this.aes.len=0,c}AES_GCM_decrypt(t){const r=this.AES_GCM_Decrypt_process(t),i=this.AES_GCM_Decrypt_finish(),n=new Uint8Array(r.length+i.length);return r.length&&n.set(r),i.length&&n.set(i,r.length),n}AES_GCM_encrypt(t){const r=this.AES_GCM_Encrypt_process(t),i=this.AES_GCM_Encrypt_finish(),n=new Uint8Array(r.length+i.length);return r.length&&n.set(r),i.length&&n.set(i,r.length),n}_gcm_mac_process(t){let{asm:r,heap:i}=this.aes.acquire_asm(),n=0,a=t.length||0,s=0;for(;a>0;){for(s=Fi(i,0,t,n,a),n+=s,a-=s;15&s;)i[s++]=0;r.mac(Nt.MAC.GCM,Nt.HEAP_DATA,s)}}}const go=x.getWebCrypto(),B1=x.getNodeCrypto(),T1=x.getNodeBuffer();async function on(e,t){if(e!==v.symmetric.aes128&&e!==v.symmetric.aes192&&e!==v.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(x.getWebCrypto()&&t.length!==24){const r=await go.importKey("raw",t,{name:"AES-GCM"},!1,["encrypt","decrypt"]);return{encrypt:async function(i,n,a=new Uint8Array){if(!i.length)return Ni.encrypt(i,t,n,a);const s=await go.encrypt({name:"AES-GCM",iv:n,additionalData:a,tagLength:128},r,i);return new Uint8Array(s)},decrypt:async function(i,n,a=new Uint8Array){if(i.length===16)return Ni.decrypt(i,t,n,a);const s=await go.decrypt({name:"AES-GCM",iv:n,additionalData:a,tagLength:128},r,i);return new Uint8Array(s)}}}return x.getNodeCrypto()?{encrypt:async function(r,i,n=new Uint8Array){const a=new B1.createCipheriv("aes-"+8*t.length+"-gcm",t,i);a.setAAD(n);const s=T1.concat([a.update(r),a.final(),a.getAuthTag()]);return new Uint8Array(s)},decrypt:async function(r,i,n=new Uint8Array){const a=new B1.createDecipheriv("aes-"+8*t.length+"-gcm",t,i);a.setAAD(n),a.setAuthTag(r.slice(r.length-16,r.length));const s=T1.concat([a.update(r.slice(0,r.length-16)),a.final()]);return new Uint8Array(s)}}:{encrypt:async function(r,i,n){return Ni.encrypt(r,t,i,n)},decrypt:async function(r,i,n){return Ni.decrypt(r,t,i,n)}}}on.getNonce=function(e,t){const r=e.slice();for(let i=0;i<t.length;i++)r[4+i]^=t[i];return r},on.blockLength=16,on.ivLength=12,on.tagLength=16;var wc={cfb:Yu,gcm:on,experimentalGCM:on,eax:Ln,ocb:jn},nh=Object.freeze({__proto__:null,parseSignatureParams:function(e,t){let r=0;switch(e){case v.publicKey.rsaEncryptSign:case v.publicKey.rsaEncrypt:case v.publicKey.rsaSign:return{s:x.readMPI(t.subarray(r))};case v.publicKey.dsa:case v.publicKey.ecdsa:{const i=x.readMPI(t.subarray(r));return r+=i.length+2,{r:i,s:x.readMPI(t.subarray(r))}}case v.publicKey.eddsa:{let i=x.readMPI(t.subarray(r));r+=i.length+2,i=x.leftPad(i,32);let n=x.readMPI(t.subarray(r));return n=x.leftPad(n,32),{r:i,s:n}}default:throw new ce("Unknown signature algorithm.")}},verify:async function(e,t,r,i,n,a){switch(e){case v.publicKey.rsaEncryptSign:case v.publicKey.rsaEncrypt:case v.publicKey.rsaSign:{const{n:s,e:o}=i,u=x.leftPad(r.s,s.length);return ee.rsa.verify(t,n,u,s,o,a)}case v.publicKey.dsa:{const{g:s,p:o,q:u,y:c}=i,{r:h,s:f}=r;return ee.dsa.verify(t,h,f,a,s,o,u,c)}case v.publicKey.ecdsa:{const{oid:s,Q:o}=i,u=new ee.elliptic.Curve(s).payloadSize,c=x.leftPad(r.r,u),h=x.leftPad(r.s,u);return ee.elliptic.ecdsa.verify(s,t,{r:c,s:h},n,o,a)}case v.publicKey.eddsa:{const{oid:s,Q:o}=i;return ee.elliptic.eddsa.verify(s,t,r,n,o,a)}default:throw Error("Unknown signature algorithm.")}},sign:async function(e,t,r,i,n,a){if(!r||!i)throw Error("Missing key parameters");switch(e){case v.publicKey.rsaEncryptSign:case v.publicKey.rsaEncrypt:case v.publicKey.rsaSign:{const{n:s,e:o}=r,{d:u,p:c,q:h,u:f}=i;return{s:await ee.rsa.sign(t,n,s,o,u,c,h,f,a)}}case v.publicKey.dsa:{const{g:s,p:o,q:u}=r,{x:c}=i;return ee.dsa.sign(t,a,s,o,u,c)}case v.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case v.publicKey.ecdsa:{const{oid:s,Q:o}=r,{d:u}=i;return ee.elliptic.ecdsa.sign(s,t,n,o,u,a)}case v.publicKey.eddsa:{const{oid:s,Q:o}=r,{seed:u}=i;return ee.elliptic.eddsa.sign(s,t,n,o,u,a)}default:throw Error("Unknown signature algorithm.")}}});const At={cipher:$i,hash:gn,mode:wc,publicKey:ee,signature:nh,random:Iu,pkcs1:Bu,pkcs5:Gu,aesKW:Hu};Object.assign(At,Zu);var Aa=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function vc(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)}const _c={arraySet:function(e,t,r,i,n){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+i),n);else for(let a=0;a<i;a++)e[n+a]=t[r+a]},flattenChunks:function(e){let t,r,i,n,a;for(i=0,t=0,r=e.length;t<r;t++)i+=e[t].length;const s=new Uint8Array(i);for(n=0,t=0,r=e.length;t<r;t++)a=e[t],s.set(a,n),n+=a.length;return s}},kc={arraySet:function(e,t,r,i,n){for(let a=0;a<i;a++)e[n+a]=t[r+a]},flattenChunks:function(e){return[].concat.apply([],e)}};let Sr=Aa?Uint8Array:Array,$e=Aa?Uint16Array:Array,ps=Aa?Int32Array:Array,Ac=Aa?_c.flattenChunks:kc.flattenChunks,Kr=Aa?_c.arraySet:kc.arraySet;function xn(e){let t=e.length;for(;--t>=0;)e[t]=0}const $o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ya=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ah=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],z1=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Nr=Array(576);xn(Nr);const Jn=Array(60);xn(Jn);const sa=Array(512);xn(sa);const oa=Array(256);xn(oa);const A0=Array(29);xn(A0);const ys=Array(30);function wo(e,t,r,i,n){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=e&&e.length}let q1,F1,O1;function vo(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function Sc(e){return e<256?sa[e]:sa[256+(e>>>7)]}function ca(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function Te(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,ca(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function _r(e,t,r){Te(e,r[2*t],r[2*t+1])}function Ec(e,t){let r=0;do r|=1&e,e>>>=1,r<<=1;while(--t>0);return r>>>1}function Pc(e,t,r){const i=Array(16);let n,a,s=0;for(n=1;n<=15;n++)i[n]=s=s+r[n-1]<<1;for(a=0;a<=t;a++){const o=e[2*a+1];o!==0&&(e[2*a]=Ec(i[o]++,o))}}function xc(e){let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function Mc(e){e.bi_valid>8?ca(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function N1(e,t,r,i){const n=2*t,a=2*r;return e[n]<e[a]||e[n]===e[a]&&i[t]<=i[r]}function _o(e,t,r){const i=e.heap[r];let n=r<<1;for(;n<=e.heap_len&&(n<e.heap_len&&N1(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!N1(t,i,e.heap[n],e.depth));)e.heap[r]=e.heap[n],r=n,n<<=1;e.heap[r]=i}function L1(e,t,r){let i,n,a,s,o=0;if(e.last_lit!==0)do i=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],n=e.pending_buf[e.l_buf+o],o++,i===0?_r(e,n,t):(a=oa[n],_r(e,a+256+1,t),s=$o[a],s!==0&&(n-=A0[a],Te(e,n,s)),i--,a=Sc(i),_r(e,a,r),s=Ya[a],s!==0&&(i-=ys[a],Te(e,i,s)));while(o<e.last_lit);_r(e,256,t)}function ko(e,t){const r=t.dyn_tree,i=t.stat_desc.static_tree,n=t.stat_desc.has_stree,a=t.stat_desc.elems;let s,o,u,c=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<a;s++)r[2*s]!==0?(e.heap[++e.heap_len]=c=s,e.depth[s]=0):r[2*s+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=c<2?++c:0,r[2*u]=1,e.depth[u]=0,e.opt_len--,n&&(e.static_len-=i[2*u+1]);for(t.max_code=c,s=e.heap_len>>1;s>=1;s--)_o(e,r,s);u=a;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],_o(e,r,1),o=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=o,r[2*u]=r[2*s]+r[2*o],e.depth[u]=(e.depth[s]>=e.depth[o]?e.depth[s]:e.depth[o])+1,r[2*s+1]=r[2*o+1]=u,e.heap[1]=u++,_o(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(h,f){const m=f.dyn_tree,y=f.max_code,K=f.stat_desc.static_tree,I=f.stat_desc.has_stree,U=f.stat_desc.extra_bits,V=f.stat_desc.extra_base,Z=f.stat_desc.max_length;let $,R,tt,X,Q,d,b=0;for(X=0;X<=15;X++)h.bl_count[X]=0;for(m[2*h.heap[h.heap_max]+1]=0,$=h.heap_max+1;$<573;$++)R=h.heap[$],X=m[2*m[2*R+1]+1]+1,X>Z&&(X=Z,b++),m[2*R+1]=X,R>y||(h.bl_count[X]++,Q=0,R>=V&&(Q=U[R-V]),d=m[2*R],h.opt_len+=d*(X+Q),I&&(h.static_len+=d*(K[2*R+1]+Q)));if(b!==0){do{for(X=Z-1;h.bl_count[X]===0;)X--;h.bl_count[X]--,h.bl_count[X+1]+=2,h.bl_count[Z]--,b-=2}while(b>0);for(X=Z;X!==0;X--)for(R=h.bl_count[X];R!==0;)tt=h.heap[--$],tt>y||(m[2*tt+1]!==X&&(h.opt_len+=(X-m[2*tt+1])*m[2*tt],m[2*tt+1]=X),R--)}}(e,t),Pc(r,c,e.bl_count)}function j1(e,t,r){let i,n,a=-1,s=t[1],o=0,u=7,c=4;for(s===0&&(u=138,c=3),t[2*(r+1)+1]=65535,i=0;i<=r;i++)n=s,s=t[2*(i+1)+1],++o<u&&n===s||(o<c?e.bl_tree[2*n]+=o:n!==0?(n!==a&&e.bl_tree[2*n]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,a=n,s===0?(u=138,c=3):n===s?(u=6,c=3):(u=7,c=4))}function W1(e,t,r){let i,n,a=-1,s=t[1],o=0,u=7,c=4;for(s===0&&(u=138,c=3),i=0;i<=r;i++)if(n=s,s=t[2*(i+1)+1],!(++o<u&&n===s)){if(o<c)do _r(e,n,e.bl_tree);while(--o!=0);else n!==0?(n!==a&&(_r(e,n,e.bl_tree),o--),_r(e,16,e.bl_tree),Te(e,o-3,2)):o<=10?(_r(e,17,e.bl_tree),Te(e,o-3,3)):(_r(e,18,e.bl_tree),Te(e,o-11,7));o=0,a=n,s===0?(u=138,c=3):n===s?(u=6,c=3):(u=7,c=4)}}xn(ys);let H1=!1;function sh(e){H1||(function(){let t,r,i,n,a;const s=Array(16);for(i=0,n=0;n<28;n++)for(A0[n]=i,t=0;t<1<<$o[n];t++)oa[i++]=n;for(oa[i-1]=n,a=0,n=0;n<16;n++)for(ys[n]=a,t=0;t<1<<Ya[n];t++)sa[a++]=n;for(a>>=7;n<30;n++)for(ys[n]=a<<7,t=0;t<1<<Ya[n]-7;t++)sa[256+a++]=n;for(r=0;r<=15;r++)s[r]=0;for(t=0;t<=143;)Nr[2*t+1]=8,t++,s[8]++;for(;t<=255;)Nr[2*t+1]=9,t++,s[9]++;for(;t<=279;)Nr[2*t+1]=7,t++,s[7]++;for(;t<=287;)Nr[2*t+1]=8,t++,s[8]++;for(Pc(Nr,287,s),t=0;t<30;t++)Jn[2*t+1]=5,Jn[2*t]=Ec(t,5);q1=new wo(Nr,$o,257,286,15),F1=new wo(Jn,Ya,0,30,15),O1=new wo([],ah,0,19,7)}(),H1=!0),e.l_desc=new vo(e.dyn_ltree,q1),e.d_desc=new vo(e.dyn_dtree,F1),e.bl_desc=new vo(e.bl_tree,O1),e.bi_buf=0,e.bi_valid=0,xc(e)}function Cc(e,t,r,i){Te(e,0+(i?1:0),3),function(n,a,s,o){Mc(n),o&&(ca(n,s),ca(n,~s)),Kr(n.pending_buf,n.window,a,s,n.pending),n.pending+=s}(e,t,r,!0)}function oh(e){Te(e,2,3),_r(e,256,Nr),function(t){t.bi_valid===16?(ca(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(e)}function ch(e,t,r,i){let n,a,s=0;e.level>0?(e.strm.data_type===2&&(e.strm.data_type=function(o){let u,c=4093624447;for(u=0;u<=31;u++,c>>>=1)if(1&c&&o.dyn_ltree[2*u]!==0)return 0;if(o.dyn_ltree[18]!==0||o.dyn_ltree[20]!==0||o.dyn_ltree[26]!==0)return 1;for(u=32;u<256;u++)if(o.dyn_ltree[2*u]!==0)return 1;return 0}(e)),ko(e,e.l_desc),ko(e,e.d_desc),s=function(o){let u;for(j1(o,o.dyn_ltree,o.l_desc.max_code),j1(o,o.dyn_dtree,o.d_desc.max_code),ko(o,o.bl_desc),u=18;u>=3&&o.bl_tree[2*z1[u]+1]===0;u--);return o.opt_len+=3*(u+1)+5+5+4,u}(e),n=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=n&&(n=a)):n=a=r+5,r+4<=n&&t!==-1?Cc(e,t,r,i):e.strategy===4||a===n?(Te(e,2+(i?1:0),3),L1(e,Nr,Jn)):(Te(e,4+(i?1:0),3),function(o,u,c,h){let f;for(Te(o,u-257,5),Te(o,c-1,5),Te(o,h-4,4),f=0;f<h;f++)Te(o,o.bl_tree[2*z1[f]+1],3);W1(o,o.dyn_ltree,u-1),W1(o,o.dyn_dtree,c-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),L1(e,e.dyn_ltree,e.dyn_dtree)),xc(e),i&&Mc(e)}function ki(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,t===0?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(oa[r]+256+1)]++,e.dyn_dtree[2*Sc(t)]++),e.last_lit===e.lit_bufsize-1}function ua(e,t,r,i){let n=65535&e|0,a=e>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do n=n+t[i++]|0,a=a+n|0;while(--s);n%=65521,a%=65521}return n|a<<16|0}const uh=function(){let e;const t=[];for(let r=0;r<256;r++){e=r;for(let i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();function fe(e,t,r,i){const n=uh,a=i+r;e^=-1;for(let s=i;s<a;s++)e=e>>>8^n[255&(e^t[s])];return-1^e}var ha={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function wi(e,t){return e.msg=ha[t],t}function G1(e){return(e<<1)-(e>4?9:0)}function yi(e){let t=e.length;for(;--t>=0;)e[t]=0}function hi(e){const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(Kr(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))}function be(e,t){ch(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,hi(e.strm)}function Vt(e,t){e.pending_buf[e.pending++]=t}function In(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function hh(e,t,r,i){let n=e.avail_in;return n>i&&(n=i),n===0?0:(e.avail_in-=n,Kr(t,e.input,e.next_in,n,r),e.state.wrap===1?e.adler=ua(e.adler,t,n,r):e.state.wrap===2&&(e.adler=fe(e.adler,t,n,r)),e.next_in+=n,e.total_in+=n,n)}function Dc(e,t){let r,i,n=e.max_chain_length,a=e.strstart,s=e.prev_length,o=e.nice_match;const u=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,c=e.window,h=e.w_mask,f=e.prev,m=e.strstart+258;let y=c[a+s-1],K=c[a+s];e.prev_length>=e.good_match&&(n>>=2),o>e.lookahead&&(o=e.lookahead);do if(r=t,c[r+s]===K&&c[r+s-1]===y&&c[r]===c[a]&&c[++r]===c[a+1]){a+=2,r++;do;while(c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&c[++a]===c[++r]&&a<m);if(i=258-(m-a),a=m-258,i>s){if(e.match_start=t,s=i,i>=o)break;y=c[a+s-1],K=c[a+s]}}while((t=f[t&h])>u&&--n!=0);return s<=e.lookahead?s:e.lookahead}function Zi(e){const t=e.w_size;let r,i,n,a,s;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-262)){Kr(e.window,e.window,t,t,0),e.match_start-=t,e.strstart-=t,e.block_start-=t,i=e.hash_size,r=i;do n=e.head[--r],e.head[r]=n>=t?n-t:0;while(--i);i=t,r=i;do n=e.prev[--r],e.prev[r]=n>=t?n-t:0;while(--i);a+=t}if(e.strm.avail_in===0)break;if(i=hh(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=i,e.lookahead+e.insert>=3)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+3-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&e.strm.avail_in!==0)}function Ao(e,t){let r,i;for(;;){if(e.lookahead<262){if(Zi(e),e.lookahead<262&&t===0)return 1;if(e.lookahead===0)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-262&&(e.match_length=Dc(e,r)),e.match_length>=3)if(i=ki(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!=0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=ki(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(be(e,!1),e.strm.avail_out===0))return 1}return e.insert=e.strstart<2?e.strstart:2,t===4?(be(e,!0),e.strm.avail_out===0?3:4):e.last_lit&&(be(e,!1),e.strm.avail_out===0)?1:2}function rn(e,t){let r,i,n;for(;;){if(e.lookahead<262){if(Zi(e),e.lookahead<262&&t===0)return 1;if(e.lookahead===0)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-262&&(e.match_length=Dc(e,r),e.match_length<=5&&(e.strategy===1||e.match_length===3&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-3,i=ki(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!=0);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(be(e,!1),e.strm.avail_out===0))return 1}else if(e.match_available){if(i=ki(e,0,e.window[e.strstart-1]),i&&be(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=ki(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===4?(be(e,!0),e.strm.avail_out===0?3:4):e.last_lit&&(be(e,!1),e.strm.avail_out===0)?1:2}class fr{constructor(t,r,i,n,a){this.good_length=t,this.max_lazy=r,this.nice_length=i,this.max_chain=n,this.func=a}}const Wn=[new fr(0,0,0,0,function(e,t){let r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Zi(e),e.lookahead===0&&t===0)return 1;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;const i=e.block_start+r;if((e.strstart===0||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,be(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-262&&(be(e,!1),e.strm.avail_out===0))return 1}return e.insert=0,t===4?(be(e,!0),e.strm.avail_out===0?3:4):(e.strstart>e.block_start&&(be(e,!1),e.strm.avail_out),1)}),new fr(4,4,8,4,Ao),new fr(4,5,16,8,Ao),new fr(4,6,32,32,Ao),new fr(4,4,16,16,rn),new fr(8,16,32,32,rn),new fr(8,16,128,128,rn),new fr(8,32,128,256,rn),new fr(32,128,258,1024,rn),new fr(32,258,258,4096,rn)];class dh{constructor(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new $e(1146),this.dyn_dtree=new $e(122),this.bl_tree=new $e(78),yi(this.dyn_ltree),yi(this.dyn_dtree),yi(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new $e(16),this.heap=new $e(573),yi(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new $e(573),yi(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}}function fh(e){const t=function(r){let i;return r&&r.state?(r.total_in=r.total_out=0,r.data_type=2,i=r.state,i.pending=0,i.pending_out=0,i.wrap<0&&(i.wrap=-i.wrap),i.status=i.wrap?42:113,r.adler=i.wrap===2?0:1,i.last_flush=0,sh(i),0):wi(r,-2)}(e);return t===0&&function(r){r.window_size=2*r.w_size,yi(r.head),r.max_lazy_match=Wn[r.level].max_lazy,r.good_match=Wn[r.level].good_length,r.nice_match=Wn[r.level].nice_length,r.max_chain_length=Wn[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0}(e.state),t}function lh(e,t){let r,i,n,a;if(!e||!e.state||t>5||t<0)return e?wi(e,-2):-2;if(i=e.state,!e.output||!e.input&&e.avail_in!==0||i.status===666&&t!==4)return wi(e,e.avail_out===0?-5:-2);if(i.strm=e,r=i.last_flush,i.last_flush=t,i.status===42)if(i.wrap===2)e.adler=0,Vt(i,31),Vt(i,139),Vt(i,8),i.gzhead?(Vt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Vt(i,255&i.gzhead.time),Vt(i,i.gzhead.time>>8&255),Vt(i,i.gzhead.time>>16&255),Vt(i,i.gzhead.time>>24&255),Vt(i,i.level===9?2:i.strategy>=2||i.level<2?4:0),Vt(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(Vt(i,255&i.gzhead.extra.length),Vt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=fe(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(Vt(i,0),Vt(i,0),Vt(i,0),Vt(i,0),Vt(i,0),Vt(i,i.level===9?2:i.strategy>=2||i.level<2?4:0),Vt(i,3),i.status=113);else{let o=8+(i.w_bits-8<<4)<<8,u=-1;u=i.strategy>=2||i.level<2?0:i.level<6?1:i.level===6?2:3,o|=u<<6,i.strstart!==0&&(o|=32),o+=31-o%31,i.status=113,In(i,o),i.strstart!==0&&(In(i,e.adler>>>16),In(i,65535&e.adler)),e.adler=1}if(i.status===69)if(i.gzhead.extra){for(n=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>n&&(e.adler=fe(e.adler,i.pending_buf,i.pending-n,n)),hi(e),n=i.pending,i.pending!==i.pending_buf_size));)Vt(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>n&&(e.adler=fe(e.adler,i.pending_buf,i.pending-n,n)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(i.status===73)if(i.gzhead.name){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(e.adler=fe(e.adler,i.pending_buf,i.pending-n,n)),hi(e),n=i.pending,i.pending===i.pending_buf_size)){a=1;break}a=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,Vt(i,a)}while(a!==0);i.gzhead.hcrc&&i.pending>n&&(e.adler=fe(e.adler,i.pending_buf,i.pending-n,n)),a===0&&(i.gzindex=0,i.status=91)}else i.status=91;if(i.status===91)if(i.gzhead.comment){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(e.adler=fe(e.adler,i.pending_buf,i.pending-n,n)),hi(e),n=i.pending,i.pending===i.pending_buf_size)){a=1;break}a=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,Vt(i,a)}while(a!==0);i.gzhead.hcrc&&i.pending>n&&(e.adler=fe(e.adler,i.pending_buf,i.pending-n,n)),a===0&&(i.status=103)}else i.status=103;if(i.status===103&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&hi(e),i.pending+2<=i.pending_buf_size&&(Vt(i,255&e.adler),Vt(i,e.adler>>8&255),e.adler=0,i.status=113)):i.status=113),i.pending!==0){if(hi(e),e.avail_out===0)return i.last_flush=-1,0}else if(e.avail_in===0&&G1(t)<=G1(r)&&t!==4)return wi(e,-5);if(i.status===666&&e.avail_in!==0)return wi(e,-5);if(e.avail_in!==0||i.lookahead!==0||t!==0&&i.status!==666){var s=i.strategy===2?function(o,u){let c;for(;;){if(o.lookahead===0&&(Zi(o),o.lookahead===0)){if(u===0)return 1;break}if(o.match_length=0,c=ki(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++,c&&(be(o,!1),o.strm.avail_out===0))return 1}return o.insert=0,u===4?(be(o,!0),o.strm.avail_out===0?3:4):o.last_lit&&(be(o,!1),o.strm.avail_out===0)?1:2}(i,t):i.strategy===3?function(o,u){let c,h,f,m;const y=o.window;for(;;){if(o.lookahead<=258){if(Zi(o),o.lookahead<=258&&u===0)return 1;if(o.lookahead===0)break}if(o.match_length=0,o.lookahead>=3&&o.strstart>0&&(f=o.strstart-1,h=y[f],h===y[++f]&&h===y[++f]&&h===y[++f])){m=o.strstart+258;do;while(h===y[++f]&&h===y[++f]&&h===y[++f]&&h===y[++f]&&h===y[++f]&&h===y[++f]&&h===y[++f]&&h===y[++f]&&f<m);o.match_length=258-(m-f),o.match_length>o.lookahead&&(o.match_length=o.lookahead)}if(o.match_length>=3?(c=ki(o,1,o.match_length-3),o.lookahead-=o.match_length,o.strstart+=o.match_length,o.match_length=0):(c=ki(o,0,o.window[o.strstart]),o.lookahead--,o.strstart++),c&&(be(o,!1),o.strm.avail_out===0))return 1}return o.insert=0,u===4?(be(o,!0),o.strm.avail_out===0?3:4):o.last_lit&&(be(o,!1),o.strm.avail_out===0)?1:2}(i,t):Wn[i.level].func(i,t);if(s!==3&&s!==4||(i.status=666),s===1||s===3)return e.avail_out===0&&(i.last_flush=-1),0;if(s===2&&(t===1?oh(i):t!==5&&(Cc(i,0,0,!1),t===3&&(yi(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),hi(e),e.avail_out===0))return i.last_flush=-1,0}return t!==4?0:i.wrap<=0?1:(i.wrap===2?(Vt(i,255&e.adler),Vt(i,e.adler>>8&255),Vt(i,e.adler>>16&255),Vt(i,e.adler>>24&255),Vt(i,255&e.total_in),Vt(i,e.total_in>>8&255),Vt(i,e.total_in>>16&255),Vt(i,e.total_in>>24&255)):(In(i,e.adler>>>16),In(i,65535&e.adler)),hi(e),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?0:1)}try{String.fromCharCode.call(null,0)}catch{}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{}const Zo=new Sr(256);for(let e=0;e<256;e++)Zo[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;function Yo(e){let t,r,i,n,a=0;const s=e.length;for(i=0;i<s;i++)t=e.charCodeAt(i),(64512&t)==55296&&i+1<s&&(r=e.charCodeAt(i+1),(64512&r)==56320&&(t=65536+(t-55296<<10)+(r-56320),i++)),a+=t<128?1:t<2048?2:t<65536?3:4;const o=new Sr(a);for(n=0,i=0;n<a;i++)t=e.charCodeAt(i),(64512&t)==55296&&i+1<s&&(r=e.charCodeAt(i+1),(64512&r)==56320&&(t=65536+(t-55296<<10)+(r-56320),i++)),t<128?o[n++]=t:t<2048?(o[n++]=192|t>>>6,o[n++]=128|63&t):t<65536?(o[n++]=224|t>>>12,o[n++]=128|t>>>6&63,o[n++]=128|63&t):(o[n++]=240|t>>>18,o[n++]=128|t>>>12&63,o[n++]=128|t>>>6&63,o[n++]=128|63&t);return o}Zo[254]=Zo[254]=1;class Kc{constructor(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}}class Xo{constructor(t){this.options={level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,...t||{}};const r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Kc,this.strm.avail_out=0;var i,n,a=function(s,o,u,c,h,f){if(!s)return-2;let m=1;if(o===-1&&(o=6),c<0?(m=0,c=-c):c>15&&(m=2,c-=16),h<1||h>9||u!==8||c<8||c>15||o<0||o>9||f<0||f>4)return wi(s,-2);c===8&&(c=9);const y=new dh;return s.state=y,y.strm=s,y.wrap=m,y.gzhead=null,y.w_bits=c,y.w_size=1<<y.w_bits,y.w_mask=y.w_size-1,y.hash_bits=h+7,y.hash_size=1<<y.hash_bits,y.hash_mask=y.hash_size-1,y.hash_shift=~~((y.hash_bits+3-1)/3),y.window=new Sr(2*y.w_size),y.head=new $e(y.hash_size),y.prev=new $e(y.w_size),y.lit_bufsize=1<<h+6,y.pending_buf_size=4*y.lit_bufsize,y.pending_buf=new Sr(y.pending_buf_size),y.d_buf=1*y.lit_bufsize,y.l_buf=3*y.lit_bufsize,y.level=o,y.strategy=f,y.method=u,fh(s)}(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(a!==0)throw Error(ha[a]);if(r.header&&(i=this.strm,n=r.header,i&&i.state&&(i.state.wrap!==2||(i.state.gzhead=n))),r.dictionary){let s;if(s=typeof r.dictionary=="string"?Yo(r.dictionary):r.dictionary instanceof ArrayBuffer?new Uint8Array(r.dictionary):r.dictionary,(a=function(o,u){let c,h,f,m,y,K,I,U,V=u.length;if(!o||!o.state||(c=o.state,m=c.wrap,m===2||m===1&&c.status!==42||c.lookahead))return-2;for(m===1&&(o.adler=ua(o.adler,u,V,0)),c.wrap=0,V>=c.w_size&&(m===0&&(yi(c.head),c.strstart=0,c.block_start=0,c.insert=0),U=new Sr(c.w_size),Kr(U,u,V-c.w_size,c.w_size,0),u=U,V=c.w_size),y=o.avail_in,K=o.next_in,I=o.input,o.avail_in=V,o.next_in=0,o.input=u,Zi(c);c.lookahead>=3;){h=c.strstart,f=c.lookahead-2;do c.ins_h=(c.ins_h<<c.hash_shift^c.window[h+3-1])&c.hash_mask,c.prev[h&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=h,h++;while(--f);c.strstart=h,c.lookahead=2,Zi(c)}return c.strstart+=c.lookahead,c.block_start=c.strstart,c.insert=c.lookahead,c.lookahead=0,c.match_length=c.prev_length=2,c.match_available=0,o.next_in=K,o.input=I,o.avail_in=y,c.wrap=m,0}(this.strm,s))!==0)throw Error(ha[a]);this._dict_set=!0}}push(t,r){const{strm:i,options:{chunkSize:n}}=this;var a,s;if(this.ended)return!1;s=r===~~r?r:r===!0?4:0,typeof t=="string"?i.input=Yo(t):t instanceof ArrayBuffer?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;do{if(i.avail_out===0&&(i.output=new Sr(n),i.next_out=0,i.avail_out=n),(a=lh(i,s))!==1&&a!==0)return this.onEnd(a),this.ended=!0,!1;i.avail_out!==0&&(i.avail_in!==0||s!==4&&s!==2)||this.onData(vc(i.output,i.next_out))}while((i.avail_in>0||i.avail_out===0)&&a!==1);return s===4?(a=function(o){let u;return o&&o.state?(u=o.state.status,u!==42&&u!==69&&u!==73&&u!==91&&u!==103&&u!==113&&u!==666?wi(o,-2):(o.state=null,u===113?wi(o,-3):0)):-2}(this.strm),this.onEnd(a),this.ended=!0,a===0):s!==2||(this.onEnd(0),i.avail_out=0,!0)}onData(t){this.chunks.push(t)}onEnd(t){t===0&&(this.result=Ac(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg}}function ph(e,t){let r,i,n,a,s,o,u,c,h,f;const m=e.state;r=e.next_in;const y=e.input,K=r+(e.avail_in-5);i=e.next_out;const I=e.output,U=i-(t-e.avail_out),V=i+(e.avail_out-257),Z=m.dmax,$=m.wsize,R=m.whave,tt=m.wnext,X=m.window;n=m.hold,a=m.bits;const Q=m.lencode,d=m.distcode,b=(1<<m.lenbits)-1,_=(1<<m.distbits)-1;t:do{a<15&&(n+=y[r++]<<a,a+=8,n+=y[r++]<<a,a+=8),s=Q[n&b];e:for(;;){if(o=s>>>24,n>>>=o,a-=o,o=s>>>16&255,o===0)I[i++]=65535&s;else{if(!(16&o)){if((64&o)==0){s=Q[(65535&s)+(n&(1<<o)-1)];continue e}if(32&o){m.mode=12;break t}e.msg="invalid literal/length code",m.mode=30;break t}u=65535&s,o&=15,o&&(a<o&&(n+=y[r++]<<a,a+=8),u+=n&(1<<o)-1,n>>>=o,a-=o),a<15&&(n+=y[r++]<<a,a+=8,n+=y[r++]<<a,a+=8),s=d[n&_];r:for(;;){if(o=s>>>24,n>>>=o,a-=o,o=s>>>16&255,!(16&o)){if((64&o)==0){s=d[(65535&s)+(n&(1<<o)-1)];continue r}e.msg="invalid distance code",m.mode=30;break t}if(c=65535&s,o&=15,a<o&&(n+=y[r++]<<a,a+=8,a<o&&(n+=y[r++]<<a,a+=8)),c+=n&(1<<o)-1,c>Z){e.msg="invalid distance too far back",m.mode=30;break t}if(n>>>=o,a-=o,o=i-U,c>o){if(o=c-o,o>R&&m.sane){e.msg="invalid distance too far back",m.mode=30;break t}if(h=0,f=X,tt===0){if(h+=$-o,o<u){u-=o;do I[i++]=X[h++];while(--o);h=i-c,f=I}}else if(tt<o){if(h+=$+tt-o,o-=tt,o<u){u-=o;do I[i++]=X[h++];while(--o);if(h=0,tt<u){o=tt,u-=o;do I[i++]=X[h++];while(--o);h=i-c,f=I}}}else if(h+=tt-o,o<u){u-=o;do I[i++]=X[h++];while(--o);h=i-c,f=I}for(;u>2;)I[i++]=f[h++],I[i++]=f[h++],I[i++]=f[h++],u-=3;u&&(I[i++]=f[h++],u>1&&(I[i++]=f[h++]))}else{h=i-c;do I[i++]=I[h++],I[i++]=I[h++],I[i++]=I[h++],u-=3;while(u>2);u&&(I[i++]=I[h++],u>1&&(I[i++]=I[h++]))}break}}break}}while(r<K&&i<V);u=a>>3,r-=u,a-=u<<3,n&=(1<<a)-1,e.next_in=r,e.next_out=i,e.avail_in=r<K?K-r+5:5-(r-K),e.avail_out=i<V?V-i+257:257-(i-V),m.hold=n,m.bits=a}const yh=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],bh=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],mh=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],gh=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function ta(e,t,r,i,n,a,s,o){const u=o.bits;let c,h,f,m,y,K=0,I=0,U=0,V=0,Z=0,$=0,R=0,tt=0,X=0,Q=0,d=null,b=0;const _=new $e(16),g=new $e(16);let p,S,D,nt=null,st=0;for(K=0;K<=15;K++)_[K]=0;for(I=0;I<i;I++)_[t[r+I]]++;for(Z=u,V=15;V>=1&&_[V]===0;V--);if(Z>V&&(Z=V),V===0)return n[a++]=20971520,n[a++]=20971520,o.bits=1,0;for(U=1;U<V&&_[U]===0;U++);for(Z<U&&(Z=U),tt=1,K=1;K<=15;K++)if(tt<<=1,tt-=_[K],tt<0)return-1;if(tt>0&&(e===0||V!==1))return-1;for(g[1]=0,K=1;K<15;K++)g[K+1]=g[K]+_[K];for(I=0;I<i;I++)t[r+I]!==0&&(s[g[t[r+I]]++]=I);e===0?(d=nt=s,y=19):e===1?(d=yh,b-=257,nt=bh,st-=257,y=256):(d=mh,nt=gh,y=-1),Q=0,I=0,K=U,m=a,$=Z,R=0,f=-1,X=1<<Z;const q=X-1;if(e===1&&X>852||e===2&&X>592)return 1;for(;;){p=K-R,s[I]<y?(S=0,D=s[I]):s[I]>y?(S=nt[st+s[I]],D=d[b+s[I]]):(S=96,D=0),c=1<<K-R,h=1<<$,U=h;do h-=c,n[m+(Q>>R)+h]=p<<24|S<<16|D|0;while(h!==0);for(c=1<<K-1;Q&c;)c>>=1;if(c!==0?(Q&=c-1,Q+=c):Q=0,I++,--_[K]==0){if(K===V)break;K=t[r+s[I]]}if(K>Z&&(Q&q)!==f){for(R===0&&(R=Z),m+=U,$=K-R,tt=1<<$;$+R<V&&(tt-=_[$+R],!(tt<=0));)$++,tt<<=1;if(X+=1<<$,e===1&&X>852||e===2&&X>592)return 1;f=Q&q,n[f]=Z<<24|$<<16|m-a|0}}return Q!==0&&(n[m+Q]=K-R<<24|64<<16|0),o.bits=Z,0}function V1(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}class wh{constructor(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new $e(320),this.work=new $e(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}}function vh(e){let t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,function(r){let i;return r&&r.state?(i=r.state,r.total_in=r.total_out=i.total=0,r.msg="",i.wrap&&(r.adler=1&i.wrap),i.mode=1,i.last=0,i.havedict=0,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new ps(852),i.distcode=i.distdyn=new ps(592),i.sane=1,i.back=-1,0):-2}(e)):-2}function _h(e,t){let r,i;return e?(i=new wh,e.state=i,i.window=null,r=function(n,a){let s,o;return n&&n.state?(o=n.state,a<0?(s=0,a=-a):(s=1+(a>>4),a<48&&(a&=15)),a&&(a<8||a>15)?-2:(o.window!==null&&o.wbits!==a&&(o.window=null),o.wrap=s,o.wbits=a,vh(n))):-2}(e,t),r!==0&&(e.state=null),r):-2}let So,Eo,$1=!0;function kh(e){if($1){let t;for(So=new ps(512),Eo=new ps(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ta(1,e.lens,0,288,So,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ta(2,e.lens,0,32,Eo,0,e.work,{bits:5}),$1=!1}e.lencode=So,e.lenbits=9,e.distcode=Eo,e.distbits=5}function Rc(e,t,r,i){let n;const a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Sr(a.wsize)),i>=a.wsize?(Kr(a.window,t,r-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(n=a.wsize-a.wnext,n>i&&(n=i),Kr(a.window,t,r-i,n,a.wnext),(i-=n)?(Kr(a.window,t,r-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=n,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=n))),0}function Ah(e,t){let r,i,n,a,s,o,u,c,h,f,m,y,K,I,U,V,Z,$,R,tt,X,Q,d,b,_=0,g=new Sr(4);const p=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return-2;r=e.state,r.mode===12&&(r.mode=13),s=e.next_out,n=e.output,u=e.avail_out,a=e.next_in,i=e.input,o=e.avail_in,c=r.hold,h=r.bits,f=o,m=u,Q=0;t:for(;;)switch(r.mode){case 1:if(r.wrap===0){r.mode=13;break}for(;h<16;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}if(2&r.wrap&&c===35615){r.check=0,g[0]=255&c,g[1]=c>>>8&255,r.check=fe(r.check,g,2,0),c=0,h=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=30;break}if((15&c)!=8){e.msg="unknown compression method",r.mode=30;break}if(c>>>=4,h-=4,X=8+(15&c),r.wbits===0)r.wbits=X;else if(X>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<X,e.adler=r.check=1,r.mode=512&c?10:12,c=0,h=0;break;case 2:for(;h<16;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}if(r.flags=c,(255&r.flags)!=8){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&(g[0]=255&c,g[1]=c>>>8&255,r.check=fe(r.check,g,2,0)),c=0,h=0,r.mode=3;case 3:for(;h<32;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}r.head&&(r.head.time=c),512&r.flags&&(g[0]=255&c,g[1]=c>>>8&255,g[2]=c>>>16&255,g[3]=c>>>24&255,r.check=fe(r.check,g,4,0)),c=0,h=0,r.mode=4;case 4:for(;h<16;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&(g[0]=255&c,g[1]=c>>>8&255,r.check=fe(r.check,g,2,0)),c=0,h=0,r.mode=5;case 5:if(1024&r.flags){for(;h<16;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&(g[0]=255&c,g[1]=c>>>8&255,r.check=fe(r.check,g,2,0)),c=0,h=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(y=r.length,y>o&&(y=o),y&&(r.head&&(X=r.head.extra_len-r.length,r.head.extra||(r.head.extra=Array(r.head.extra_len)),Kr(r.head.extra,i,a,y,X)),512&r.flags&&(r.check=fe(r.check,i,y,a)),o-=y,a+=y,r.length-=y),r.length))break t;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(o===0)break t;y=0;do X=i[a+y++],r.head&&X&&r.length<65536&&(r.head.name+=String.fromCharCode(X));while(X&&y<o);if(512&r.flags&&(r.check=fe(r.check,i,y,a)),o-=y,a+=y,X)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(o===0)break t;y=0;do X=i[a+y++],r.head&&X&&r.length<65536&&(r.head.comment+=String.fromCharCode(X));while(X&&y<o);if(512&r.flags&&(r.check=fe(r.check,i,y,a)),o-=y,a+=y,X)break t}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;h<16;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}if(c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}c=0,h=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;h<32;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}e.adler=r.check=V1(c),c=0,h=0,r.mode=11;case 11:if(r.havedict===0)return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=o,r.hold=c,r.bits=h,2;e.adler=r.check=1,r.mode=12;case 12:if(t===5||t===6)break t;case 13:if(r.last){c>>>=7&h,h-=7&h,r.mode=27;break}for(;h<3;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}switch(r.last=1&c,c>>>=1,h-=1,3&c){case 0:r.mode=14;break;case 1:if(kh(r),r.mode=20,t===6){c>>>=2,h-=2;break t}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}c>>>=2,h-=2;break;case 14:for(c>>>=7&h,h-=7&h;h<32;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&c,c=0,h=0,r.mode=15,t===6)break t;case 15:r.mode=16;case 16:if(y=r.length,y){if(y>o&&(y=o),y>u&&(y=u),y===0)break t;Kr(n,i,a,y,s),o-=y,a+=y,u-=y,s+=y,r.length-=y;break}r.mode=12;break;case 17:for(;h<14;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}if(r.nlen=257+(31&c),c>>>=5,h-=5,r.ndist=1+(31&c),c>>>=5,h-=5,r.ncode=4+(15&c),c>>>=4,h-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;h<3;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}r.lens[p[r.have++]]=7&c,c>>>=3,h-=3}for(;r.have<19;)r.lens[p[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,d={bits:r.lenbits},Q=ta(0,r.lens,0,19,r.lencode,0,r.work,d),r.lenbits=d.bits,Q){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;_=r.lencode[c&(1<<r.lenbits)-1],U=_>>>24,V=_>>>16&255,Z=65535&_,!(U<=h);){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}if(Z<16)c>>>=U,h-=U,r.lens[r.have++]=Z;else{if(Z===16){for(b=U+2;h<b;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}if(c>>>=U,h-=U,r.have===0){e.msg="invalid bit length repeat",r.mode=30;break}X=r.lens[r.have-1],y=3+(3&c),c>>>=2,h-=2}else if(Z===17){for(b=U+3;h<b;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}c>>>=U,h-=U,X=0,y=3+(7&c),c>>>=3,h-=3}else{for(b=U+7;h<b;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}c>>>=U,h-=U,X=0,y=11+(127&c),c>>>=7,h-=7}if(r.have+y>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;y--;)r.lens[r.have++]=X}}if(r.mode===30)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,d={bits:r.lenbits},Q=ta(1,r.lens,0,r.nlen,r.lencode,0,r.work,d),r.lenbits=d.bits,Q){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,d={bits:r.distbits},Q=ta(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,d),r.distbits=d.bits,Q){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,t===6)break t;case 20:r.mode=21;case 21:if(o>=6&&u>=258){e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=o,r.hold=c,r.bits=h,ph(e,m),s=e.next_out,n=e.output,u=e.avail_out,a=e.next_in,i=e.input,o=e.avail_in,c=r.hold,h=r.bits,r.mode===12&&(r.back=-1);break}for(r.back=0;_=r.lencode[c&(1<<r.lenbits)-1],U=_>>>24,V=_>>>16&255,Z=65535&_,!(U<=h);){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}if(V&&(240&V)==0){for($=U,R=V,tt=Z;_=r.lencode[tt+((c&(1<<$+R)-1)>>$)],U=_>>>24,V=_>>>16&255,Z=65535&_,!($+U<=h);){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}c>>>=$,h-=$,r.back+=$}if(c>>>=U,h-=U,r.back+=U,r.length=Z,V===0){r.mode=26;break}if(32&V){r.back=-1,r.mode=12;break}if(64&V){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&V,r.mode=22;case 22:if(r.extra){for(b=r.extra;h<b;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,h-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;_=r.distcode[c&(1<<r.distbits)-1],U=_>>>24,V=_>>>16&255,Z=65535&_,!(U<=h);){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}if((240&V)==0){for($=U,R=V,tt=Z;_=r.distcode[tt+((c&(1<<$+R)-1)>>$)],U=_>>>24,V=_>>>16&255,Z=65535&_,!($+U<=h);){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}c>>>=$,h-=$,r.back+=$}if(c>>>=U,h-=U,r.back+=U,64&V){e.msg="invalid distance code",r.mode=30;break}r.offset=Z,r.extra=15&V,r.mode=24;case 24:if(r.extra){for(b=r.extra;h<b;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,h-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(u===0)break t;if(y=m-u,r.offset>y){if(y=r.offset-y,y>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}y>r.wnext?(y-=r.wnext,K=r.wsize-y):K=r.wnext-y,y>r.length&&(y=r.length),I=r.window}else I=n,K=s-r.offset,y=r.length;y>u&&(y=u),u-=y,r.length-=y;do n[s++]=I[K++];while(--y);r.length===0&&(r.mode=21);break;case 26:if(u===0)break t;n[s++]=r.length,u--,r.mode=21;break;case 27:if(r.wrap){for(;h<32;){if(o===0)break t;o--,c|=i[a++]<<h,h+=8}if(m-=u,e.total_out+=m,r.total+=m,m&&(e.adler=r.check=r.flags?fe(r.check,n,m,s-m):ua(r.check,n,m,s-m)),m=u,(r.flags?c:V1(c))!==r.check){e.msg="incorrect data check",r.mode=30;break}c=0,h=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;h<32;){if(o===0)break t;o--,c+=i[a++]<<h,h+=8}if(c!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}c=0,h=0}r.mode=29;case 29:Q=1;break t;case 30:Q=-3;break t;case 32:default:return-2}return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=o,r.hold=c,r.bits=h,(r.wsize||m!==e.avail_out&&r.mode<30&&(r.mode<27||t!==4))&&Rc(e,e.output,e.next_out,m-e.avail_out),f-=e.avail_in,m-=e.avail_out,e.total_in+=f,e.total_out+=m,r.total+=m,r.wrap&&m&&(e.adler=r.check=r.flags?fe(r.check,n,m,e.next_out-m):ua(r.check,n,m,e.next_out-m)),e.data_type=r.bits+(r.last?64:0)+(r.mode===12?128:0)+(r.mode===20||r.mode===15?256:0),(f===0&&m===0||t===4)&&Q===0&&(Q=-5),Q}function Z1(e,t){const r=t.length;let i,n;return e&&e.state?(i=e.state,i.wrap!==0&&i.mode!==11?-2:i.mode===11&&(n=1,n=ua(n,t,r,0),n!==i.check)?-3:(Rc(e,t,r,r),i.havedict=1,0)):-2}class Sh{constructor(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}}class Y1{constructor(t){this.options={chunkSize:16384,windowBits:0,...t||{}};const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),!(r.windowBits>=0&&r.windowBits<16)||t&&t.windowBits||(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(15&r.windowBits)==0&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Kc,this.strm.avail_out=0;let i=_h(this.strm,r.windowBits);if(i!==0||(this.header=new Sh,function(n,a){let s;n&&n.state&&(s=n.state,(2&s.wrap)==0||(s.head=a,a.done=!1))}(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=Yo(r.dictionary):r.dictionary instanceof ArrayBuffer&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(i=Z1(this.strm,r.dictionary),i!==0))))throw Error(ha[i])}push(t,r){const{strm:i,options:{chunkSize:n,dictionary:a}}=this;let s,o,u=!1;if(this.ended)return!1;o=r===~~r?r:r===!0?4:0,typeof t=="string"?i.input=function(c){const h=new Sr(c.length);for(let f=0,m=h.length;f<m;f++)h[f]=c.charCodeAt(f);return h}(t):t instanceof ArrayBuffer?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;do{if(i.avail_out===0&&(i.output=new Sr(n),i.next_out=0,i.avail_out=n),s=Ah(i,0),s===2&&a&&(s=Z1(this.strm,a)),s===-5&&u===!0&&(s=0,u=!1),s!==1&&s!==0)return this.onEnd(s),this.ended=!0,!1;i.next_out&&(i.avail_out!==0&&s!==1&&(i.avail_in!==0||o!==4&&o!==2)||this.onData(vc(i.output,i.next_out))),i.avail_in===0&&i.avail_out===0&&(u=!0)}while((i.avail_in>0||i.avail_out===0)&&s!==1);return s===1&&(o=4),o===4?(s=function(c){if(!c||!c.state)return-2;const h=c.state;return h.window&&(h.window=null),c.state=null,0}(this.strm),this.onEnd(s),this.ended=!0,s===0):o!==2||(this.onEnd(0),i.avail_out=0,!0)}onData(t){this.chunks.push(t)}onEnd(t){t===0&&(this.result=Ac(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg}}var X1=[0,1,3,7,15,31,63,127,255],Hn=function(e){this.stream=e,this.bitOffset=0,this.curByte=0,this.hasByte=!1};Hn.prototype._ensureByte=function(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)},Hn.prototype.read=function(e){for(var t=0;e>0;){this._ensureByte();var r=8-this.bitOffset;if(e>=r)t<<=r,t|=X1[r]&this.curByte,this.hasByte=!1,this.bitOffset=0,e-=r;else{t<<=e;var i=r-e;t|=(this.curByte&X1[e]<<i)>>i,this.bitOffset+=e,e=0}}return t},Hn.prototype.seek=function(e){var t=e%8,r=(e-t)/8;this.bitOffset=t,this.stream.seek(r),this.hasByte=!1},Hn.prototype.pi=function(){var e,t=new Uint8Array(6);for(e=0;e<t.length;e++)t[e]=this.read(8);return function(r){return Array.prototype.map.call(r,i=>("00"+i.toString(16)).slice(-2)).join("")}(t)};var Eh=Hn,zi=function(){};zi.prototype.readByte=function(){throw Error("abstract method readByte() not implemented")},zi.prototype.read=function(e,t,r){for(var i=0;i<r;){var n=this.readByte();if(n<0)return i===0?-1:i;e[t++]=n,i++}return i},zi.prototype.seek=function(e){throw Error("abstract method seek() not implemented")},zi.prototype.writeByte=function(e){throw Error("abstract method readByte() not implemented")},zi.prototype.write=function(e,t,r){var i;for(i=0;i<r;i++)this.writeByte(e[t++]);return r},zi.prototype.flush=function(){};var Po,Ic=zi,Ph=(Po=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),function(){var e=4294967295;this.getCRC=function(){return~e>>>0},this.updateCRC=function(t){e=e<<8^Po[255&(e>>>24^t)]},this.updateCRCRun=function(t,r){for(;r-- >0;)e=e<<8^Po[255&(e>>>24^t)]}}),Q1=function(e,t){var r,i=e[t];for(r=t;r>0;r--)e[r]=e[r-1];return e[0]=i,i},ie={OK:0,LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7,END_OF_BLOCK:-8},di={};di[ie.LAST_BLOCK]="Bad file checksum",di[ie.NOT_BZIP_DATA]="Not bzip data",di[ie.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",di[ie.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",di[ie.DATA_ERROR]="Data error",di[ie.OUT_OF_MEMORY]="Out of memory",di[ie.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";var ye=function(e,t){var r=di[e]||"unknown error";t&&(r+=": "+t);var i=new TypeError(r);throw i.errorCode=e,i},Gn=function(e,t){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(e,t)};Gn.prototype._init_block=function(){return this._get_next_block()?(this.blockCRC=new Ph,!0):(this.writeCount=-1,!1)},Gn.prototype._start_bunzip=function(e,t){var r=new Uint8Array(4);e.read(r,0,4)===4&&String.fromCharCode(r[0],r[1],r[2])==="BZh"||ye(ie.NOT_BZIP_DATA,"bad magic");var i=r[3]-48;(i<1||i>9)&&ye(ie.NOT_BZIP_DATA,"level out of range"),this.reader=new Eh(e),this.dbufSize=1e5*i,this.nextoutput=0,this.outputStream=t,this.streamCRC=0},Gn.prototype._get_next_block=function(){var e,t,r,i=this.reader,n=i.pi();if(n==="177245385090")return!1;n!=="314159265359"&&ye(ie.NOT_BZIP_DATA),this.targetBlockCRC=i.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,i.read(1)&&ye(ie.OBSOLETE_INPUT);var a=i.read(24);a>this.dbufSize&&ye(ie.DATA_ERROR,"initial position out of bounds");var s=i.read(16),o=new Uint8Array(256),u=0;for(e=0;e<16;e++)if(s&1<<15-e){var c=16*e;for(r=i.read(16),t=0;t<16;t++)r&1<<15-t&&(o[u++]=c+t)}var h=i.read(3);(h<2||h>6)&&ye(ie.DATA_ERROR);var f=i.read(15);f===0&&ye(ie.DATA_ERROR);var m=new Uint8Array(256);for(e=0;e<h;e++)m[e]=e;var y=new Uint8Array(f);for(e=0;e<f;e++){for(t=0;i.read(1);t++)t>=h&&ye(ie.DATA_ERROR);y[e]=Q1(m,t)}var K,I=u+2,U=[];for(t=0;t<h;t++){var V,Z,$=new Uint8Array(I),R=new Uint16Array(21);for(s=i.read(5),e=0;e<I;e++){for(;(s<1||s>20)&&ye(ie.DATA_ERROR),i.read(1);)i.read(1)?s--:s++;$[e]=s}for(V=Z=$[0],e=1;e<I;e++)$[e]>Z?Z=$[e]:$[e]<V&&(V=$[e]);K={},U.push(K),K.permute=new Uint16Array(258),K.limit=new Uint32Array(22),K.base=new Uint32Array(21),K.minLen=V,K.maxLen=Z;var tt=0;for(e=V;e<=Z;e++)for(R[e]=K.limit[e]=0,s=0;s<I;s++)$[s]===e&&(K.permute[tt++]=s);for(e=0;e<I;e++)R[$[e]]++;for(tt=s=0,e=V;e<Z;e++)tt+=R[e],K.limit[e]=tt-1,tt<<=1,s+=R[e],K.base[e+1]=tt-s;K.limit[Z+1]=Number.MAX_VALUE,K.limit[Z]=tt+R[Z]-1,K.base[V]=0}var X=new Uint32Array(256);for(e=0;e<256;e++)m[e]=e;var Q,d=0,b=0,_=0,g=this.dbuf=new Uint32Array(this.dbufSize);for(I=0;;){for(I--||(I=49,_>=f&&ye(ie.DATA_ERROR),K=U[y[_++]]),e=K.minLen,t=i.read(e);e>K.maxLen&&ye(ie.DATA_ERROR),!(t<=K.limit[e]);e++)t=t<<1|i.read(1);((t-=K.base[e])<0||t>=258)&&ye(ie.DATA_ERROR);var p=K.permute[t];if(p!==0&&p!==1){if(d)for(d=0,b+s>this.dbufSize&&ye(ie.DATA_ERROR),X[Q=o[m[0]]]+=s;s--;)g[b++]=Q;if(p>u)break;b>=this.dbufSize&&ye(ie.DATA_ERROR),X[Q=o[Q=Q1(m,e=p-1)]]++,g[b++]=Q}else d||(d=1,s=0),s+=p===0?d:2*d,d<<=1}for((a<0||a>=b)&&ye(ie.DATA_ERROR),t=0,e=0;e<256;e++)r=t+X[e],X[e]=t,t=r;for(e=0;e<b;e++)g[X[Q=255&g[e]]]|=e<<8,X[Q]++;var S=0,D=0,nt=0;return b&&(D=255&(S=g[a]),S>>=8,nt=-1),this.writePos=S,this.writeCurrent=D,this.writeCount=b,this.writeRun=nt,!0},Gn.prototype._read_bunzip=function(e,t){var r,i,n;if(this.writeCount<0)return 0;var a=this.dbuf,s=this.writePos,o=this.writeCurrent,u=this.writeCount;this.outputsize;for(var c=this.writeRun;u;){for(u--,i=o,o=255&(s=a[s]),s>>=8,c++==3?(r=o,n=i,o=-1):(r=1,n=o),this.blockCRC.updateCRCRun(n,r);r--;)this.outputStream.writeByte(n),this.nextoutput++;o!=i&&(c=0)}return this.writeCount=u,this.blockCRC.getCRC()!==this.targetBlockCRC&&ye(ie.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput};var xh=function(e){if("readByte"in e)return e;var t=new Ic;return t.pos=0,t.readByte=function(){return e[this.pos++]},t.seek=function(r){this.pos=r},t.eof=function(){return this.pos>=e.length},t},Mh=function(e){var t=new Ic,r=!0;if(e)if(typeof e=="number")t.buffer=new Uint8Array(e),r=!1;else{if("writeByte"in e)return e;t.buffer=e,r=!1}else t.buffer=new Uint8Array(16384);return t.pos=0,t.writeByte=function(i){if(r&&this.pos>=this.buffer.length){var n=new Uint8Array(2*this.buffer.length);n.set(this.buffer),this.buffer=n}this.buffer[this.pos++]=i},t.getBuffer=function(){if(this.pos!==this.buffer.length){if(!r)throw new TypeError("outputsize does not match decoded input");var i=new Uint8Array(this.pos);i.set(this.buffer.subarray(0,this.pos)),this.buffer=i}return this.buffer},t._coerced=!0,t},J1=function(e,t,r){for(var i=xh(e),n=Mh(t),a=new Gn(i,n);!("eof"in i)||!i.eof();)if(a._init_block())a._read_bunzip();else{var s=a.reader.read(32)>>>0;if(s!==a.streamCRC&&ye(ie.DATA_ERROR,"Bad stream CRC (got "+a.streamCRC.toString(16)+" expected "+s.toString(16)+")"),!r||!("eof"in i)||i.eof())break;a._start_bunzip(i,n)}if("getBuffer"in n)return n.getBuffer()};class Ei{static get tag(){return v.packet.literalData}constructor(t=new Date){this.format=v.literal.utf8,this.date=x.normalizeDate(t),this.text=null,this.data=null,this.filename=""}setText(t,r=v.literal.utf8){this.format=r,this.text=t,this.data=null}getText(t=!1){return(this.text===null||x.isStream(this.text))&&(this.text=x.decodeUTF8(x.nativeEOL(this.getBytes(t)))),this.text}setBytes(t,r){this.format=r,this.data=t,this.text=null}getBytes(t=!1){return this.data===null&&(this.data=x.canonicalizeEOL(x.encodeUTF8(this.text))),t?fn(this.data):this.data}setFilename(t){this.filename=t}getFilename(){return this.filename}async read(t){await Ns(t,async r=>{const i=await r.readByte(),n=await r.readByte();this.filename=x.decodeUTF8(await r.readBytes(n)),this.date=x.readDate(await r.readBytes(4));let a=r.remainder();se(a)&&(a=await ae(a)),this.setBytes(a,i)})}writeHeader(){const t=x.encodeUTF8(this.filename),r=new Uint8Array([t.length]),i=new Uint8Array([this.format]),n=x.writeDate(this.date);return x.concatUint8Array([i,r,t,n])}write(){const t=this.writeHeader(),r=this.getBytes();return x.concat([t,r])}}const Un=Symbol("verified"),Ch=new Set([v.signatureSubpacket.issuer,v.signatureSubpacket.issuerFingerprint,v.signatureSubpacket.embeddedSignature]);class ge{static get tag(){return v.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.signedHashValue=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new Ai,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.revoked=null,this[Un]=null}read(t){let r=0;if(this.version=t[r++],this.version!==4&&this.version!==5)throw new ce(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=t[r++],this.publicKeyAlgorithm=t[r++],this.hashAlgorithm=t[r++],r+=this.readSubPackets(t.subarray(r,t.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");this.signatureData=t.subarray(0,r),r+=this.readSubPackets(t.subarray(r,t.length),!1),this.signedHashValue=t.subarray(r,r+2),r+=2,this.params=At.signature.parseSignatureParams(this.publicKeyAlgorithm,t.subarray(r,t.length))}writeParams(){return this.params instanceof Promise?Jr(async()=>At.serializeParams(this.publicKeyAlgorithm,await this.params)):At.serializeParams(this.publicKeyAlgorithm,this.params)}write(){const t=[];return t.push(this.signatureData),t.push(this.writeUnhashedSubPackets()),t.push(this.signedHashValue),t.push(this.writeParams()),x.concat(t)}async sign(t,r,i=new Date,n=!1){t.version===5?this.version=5:this.version=4;const a=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];this.created=x.normalizeDate(i),this.issuerKeyVersion=t.version,this.issuerFingerprint=t.getFingerprintBytes(),this.issuerKeyID=t.getKeyID(),a.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=x.concat(a);const s=this.toHash(this.signatureType,r,n),o=await this.hash(this.signatureType,r,s,n);this.signedHashValue=me(Vi(o),0,2);const u=async()=>At.signature.sign(this.publicKeyAlgorithm,this.hashAlgorithm,t.publicParams,t.privateParams,s,await ae(o));x.isStream(o)?this.params=u():(this.params=await u(),this[Un]=!0)}writeHashedSubPackets(){const t=v.signatureSubpacket,r=[];let i;if(this.created===null)throw Error("Missing signature creation time");r.push(te(t.signatureCreationTime,x.writeDate(this.created))),this.signatureExpirationTime!==null&&r.push(te(t.signatureExpirationTime,x.writeNumber(this.signatureExpirationTime,4))),this.exportable!==null&&r.push(te(t.exportableCertification,new Uint8Array([this.exportable?1:0]))),this.trustLevel!==null&&(i=new Uint8Array([this.trustLevel,this.trustAmount]),r.push(te(t.trustSignature,i))),this.regularExpression!==null&&r.push(te(t.regularExpression,this.regularExpression)),this.revocable!==null&&r.push(te(t.revocable,new Uint8Array([this.revocable?1:0]))),this.keyExpirationTime!==null&&r.push(te(t.keyExpirationTime,x.writeNumber(this.keyExpirationTime,4))),this.preferredSymmetricAlgorithms!==null&&(i=x.stringToUint8Array(x.uint8ArrayToString(this.preferredSymmetricAlgorithms)),r.push(te(t.preferredSymmetricAlgorithms,i))),this.revocationKeyClass!==null&&(i=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),i=x.concat([i,this.revocationKeyFingerprint]),r.push(te(t.revocationKey,i))),this.issuerKeyID.isNull()||this.issuerKeyVersion===5||r.push(te(t.issuer,this.issuerKeyID.write())),this.rawNotations.forEach(([{name:s,value:o,humanReadable:u}])=>{i=[new Uint8Array([u?128:0,0,0,0])],i.push(x.writeNumber(s.length,2)),i.push(x.writeNumber(o.length,2)),i.push(x.stringToUint8Array(s)),i.push(o),i=x.concat(i),r.push(te(t.notationData,i))}),this.preferredHashAlgorithms!==null&&(i=x.stringToUint8Array(x.uint8ArrayToString(this.preferredHashAlgorithms)),r.push(te(t.preferredHashAlgorithms,i))),this.preferredCompressionAlgorithms!==null&&(i=x.stringToUint8Array(x.uint8ArrayToString(this.preferredCompressionAlgorithms)),r.push(te(t.preferredCompressionAlgorithms,i))),this.keyServerPreferences!==null&&(i=x.stringToUint8Array(x.uint8ArrayToString(this.keyServerPreferences)),r.push(te(t.keyServerPreferences,i))),this.preferredKeyServer!==null&&r.push(te(t.preferredKeyServer,x.stringToUint8Array(this.preferredKeyServer))),this.isPrimaryUserID!==null&&r.push(te(t.primaryUserID,new Uint8Array([this.isPrimaryUserID?1:0]))),this.policyURI!==null&&r.push(te(t.policyURI,x.stringToUint8Array(this.policyURI))),this.keyFlags!==null&&(i=x.stringToUint8Array(x.uint8ArrayToString(this.keyFlags)),r.push(te(t.keyFlags,i))),this.signersUserID!==null&&r.push(te(t.signersUserID,x.stringToUint8Array(this.signersUserID))),this.reasonForRevocationFlag!==null&&(i=x.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),r.push(te(t.reasonForRevocation,i))),this.features!==null&&(i=x.stringToUint8Array(x.uint8ArrayToString(this.features)),r.push(te(t.features,i))),this.signatureTargetPublicKeyAlgorithm!==null&&(i=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],i.push(x.stringToUint8Array(this.signatureTargetHash)),i=x.concat(i),r.push(te(t.signatureTarget,i))),this.embeddedSignature!==null&&r.push(te(t.embeddedSignature,this.embeddedSignature.write())),this.issuerFingerprint!==null&&(i=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],i=x.concat(i),r.push(te(t.issuerFingerprint,i))),this.preferredAEADAlgorithms!==null&&(i=x.stringToUint8Array(x.uint8ArrayToString(this.preferredAEADAlgorithms)),r.push(te(t.preferredAEADAlgorithms,i)));const n=x.concat(r),a=x.writeNumber(n.length,2);return x.concat([a,n])}writeUnhashedSubPackets(){const t=[];this.unhashedSubpackets.forEach(n=>{t.push(ka(n.length)),t.push(n)});const r=x.concat(t),i=x.writeNumber(r.length,2);return x.concat([i,r])}readSubPacket(t,r=!0){let i=0;const n=128&t[i],a=127&t[i];if(r||(this.unhashedSubpackets.push(t.subarray(i,t.length)),Ch.has(a)))switch(i++,a){case v.signatureSubpacket.signatureCreationTime:this.created=x.readDate(t.subarray(i,t.length));break;case v.signatureSubpacket.signatureExpirationTime:{const s=x.readNumber(t.subarray(i,t.length));this.signatureNeverExpires=s===0,this.signatureExpirationTime=s;break}case v.signatureSubpacket.exportableCertification:this.exportable=t[i++]===1;break;case v.signatureSubpacket.trustSignature:this.trustLevel=t[i++],this.trustAmount=t[i++];break;case v.signatureSubpacket.regularExpression:this.regularExpression=t[i];break;case v.signatureSubpacket.revocable:this.revocable=t[i++]===1;break;case v.signatureSubpacket.keyExpirationTime:{const s=x.readNumber(t.subarray(i,t.length));this.keyExpirationTime=s,this.keyNeverExpires=s===0;break}case v.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...t.subarray(i,t.length)];break;case v.signatureSubpacket.revocationKey:this.revocationKeyClass=t[i++],this.revocationKeyAlgorithm=t[i++],this.revocationKeyFingerprint=t.subarray(i,i+20);break;case v.signatureSubpacket.issuer:this.issuerKeyID.read(t.subarray(i,t.length));break;case v.signatureSubpacket.notationData:{const s=!!(128&t[i]);i+=4;const o=x.readNumber(t.subarray(i,i+2));i+=2;const u=x.readNumber(t.subarray(i,i+2));i+=2;const c=x.uint8ArrayToString(t.subarray(i,i+o)),h=t.subarray(i+o,i+o+u);this.rawNotations.push({name:c,humanReadable:s,value:h,critical:n}),s&&(this.notations[c]=x.uint8ArrayToString(h));break}case v.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...t.subarray(i,t.length)];break;case v.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...t.subarray(i,t.length)];break;case v.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...t.subarray(i,t.length)];break;case v.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=x.uint8ArrayToString(t.subarray(i,t.length));break;case v.signatureSubpacket.primaryUserID:this.isPrimaryUserID=t[i++]!==0;break;case v.signatureSubpacket.policyURI:this.policyURI=x.uint8ArrayToString(t.subarray(i,t.length));break;case v.signatureSubpacket.keyFlags:this.keyFlags=[...t.subarray(i,t.length)];break;case v.signatureSubpacket.signersUserID:this.signersUserID=x.uint8ArrayToString(t.subarray(i,t.length));break;case v.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=t[i++],this.reasonForRevocationString=x.uint8ArrayToString(t.subarray(i,t.length));break;case v.signatureSubpacket.features:this.features=[...t.subarray(i,t.length)];break;case v.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=t[i++],this.signatureTargetHashAlgorithm=t[i++];const s=At.getHashByteLength(this.signatureTargetHashAlgorithm);this.signatureTargetHash=x.uint8ArrayToString(t.subarray(i,i+s));break}case v.signatureSubpacket.embeddedSignature:this.embeddedSignature=new ge,this.embeddedSignature.read(t.subarray(i,t.length));break;case v.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=t[i++],this.issuerFingerprint=t.subarray(i,t.length),this.issuerKeyVersion===5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case v.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...t.subarray(i,t.length)];break;default:{const s=Error("Unknown signature subpacket type "+a);if(n)throw s;x.printDebug(s)}}}readSubPackets(t,r=!0,i){const n=x.readNumber(t.subarray(0,2));let a=2;for(;a<2+n;){const s=oc(t.subarray(a,t.length));a+=s.offset,this.readSubPacket(t.subarray(a,a+s.len),r,i),a+=s.len}return a}toSign(t,r){const i=v.signature;switch(t){case i.binary:return r.text!==null?x.encodeUTF8(r.getText(!0)):r.getBytes(!0);case i.text:{const n=r.getBytes(!0);return x.canonicalizeEOL(n)}case i.standalone:return new Uint8Array(0);case i.certGeneric:case i.certPersona:case i.certCasual:case i.certPositive:case i.certRevocation:{let n,a;if(r.userID)a=180,n=r.userID;else{if(!r.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");a=209,n=r.userAttribute}const s=n.write();return x.concat([this.toSign(i.key,r),new Uint8Array([a]),x.writeNumber(s.length,4),s])}case i.subkeyBinding:case i.subkeyRevocation:case i.keyBinding:return x.concat([this.toSign(i.key,r),this.toSign(i.key,{key:r.bind})]);case i.key:if(r.key===void 0)throw Error("Key packet is required for this signature.");return r.key.writeForHash(this.version);case i.keyRevocation:return this.toSign(i.key,r);case i.timestamp:return new Uint8Array(0);case i.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(t,r){let i=0;return ne(Vi(this.signatureData),n=>{i+=n.length},()=>{const n=[];return this.version!==5||this.signatureType!==v.signature.binary&&this.signatureType!==v.signature.text||(r?n.push(new Uint8Array(6)):n.push(t.writeHeader())),n.push(new Uint8Array([this.version,255])),this.version===5&&n.push(new Uint8Array(4)),n.push(x.writeNumber(i,4)),x.concat(n)})}toHash(t,r,i=!1){const n=this.toSign(t,r);return x.concat([n,this.signatureData,this.calculateTrailer(r,i)])}async hash(t,r,i,n=!1){return i||(i=this.toHash(t,r,n)),At.hash.digest(this.hashAlgorithm,i)}async verify(t,r,i,n=new Date,a=!1,s=vt){if(!this.issuerKeyID.equals(t.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==t.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");const o=r===v.signature.binary||r===v.signature.text;if(!(this[Un]&&!o)){let c,h;if(this.hashed?h=await this.hashed:(c=this.toHash(r,i,a),h=await this.hash(r,i,c)),h=await ae(h),this.signedHashValue[0]!==h[0]||this.signedHashValue[1]!==h[1])throw Error("Signed digest did not match");if(this.params=await this.params,this[Un]=await At.signature.verify(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,t.publicParams,c,h),!this[Un])throw Error("Signature verification failed")}const u=x.normalizeDate(n);if(u&&this.created>u)throw Error("Signature creation time is in the future");if(u&&u>=this.getExpirationTime())throw Error("Signature is expired");if(s.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+v.read(v.hash,this.hashAlgorithm).toUpperCase());if(s.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[v.signature.binary,v.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+v.read(v.hash,this.hashAlgorithm).toUpperCase());if(this.rawNotations.forEach(({name:c,critical:h})=>{if(h&&s.knownNotations.indexOf(c)<0)throw Error("Unknown critical notation: "+c)}),this.revocationKeyClass!==null)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")}isExpired(t=new Date){const r=x.normalizeDate(t);return r!==null&&!(this.created<=r&&r<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function te(e,t){const r=[];return r.push(ka(t.length+1)),r.push(new Uint8Array([e])),r.push(t),x.concat(r)}class tr{static get tag(){return v.packet.onePassSignature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.issuerKeyID=null,this.flags=null}read(t){let r=0;if(this.version=t[r++],this.version!==3)throw new ce(`Version ${this.version} of the one-pass signature packet is unsupported.`);return this.signatureType=t[r++],this.hashAlgorithm=t[r++],this.publicKeyAlgorithm=t[r++],this.issuerKeyID=new Ai,this.issuerKeyID.read(t.subarray(r,r+8)),r+=8,this.flags=t[r++],this}write(){const t=new Uint8Array([3,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm]),r=new Uint8Array([this.flags]);return x.concatUint8Array([t,this.issuerKeyID.write(),r])}calculateTrailer(...t){return Jr(async()=>ge.prototype.calculateTrailer.apply(await this.correspondingSig,t))}async verify(){const t=await this.correspondingSig;if(!t||t.constructor.tag!==v.packet.signature)throw Error("Corresponding signature packet missing");if(t.signatureType!==this.signatureType||t.hashAlgorithm!==this.hashAlgorithm||t.publicKeyAlgorithm!==this.publicKeyAlgorithm||!t.issuerKeyID.equals(this.issuerKeyID))throw Error("Corresponding signature packet does not match one-pass signature packet");return t.hashed=this.hashed,t.verify.apply(t,arguments)}}function Dh(e,t){if(!t[e]){let r;try{r=v.read(v.packet,e)}catch{throw new ce("Unknown packet type with tag: "+e)}throw Error("Packet not allowed in this context: "+r)}return new t[e]}tr.prototype.hash=ge.prototype.hash,tr.prototype.toHash=ge.prototype.toHash,tr.prototype.toSign=ge.prototype.toSign;class Zt extends Array{static async fromBinary(t,r,i=vt){const n=new Zt;return await n.read(t,r,i),n}async read(t,r,i=vt){this.stream=Rr(t,async(a,s)=>{const o=qe(s);try{for(;;)if(await o.ready,await Fu(a,async u=>{try{if(u.tag===v.packet.marker||u.tag===v.packet.trust)return;const c=Dh(u.tag,r);c.packets=new Zt,c.fromStream=x.isStream(u.packet),await c.read(u.packet,i),await o.write(c)}catch(c){const h=!i.ignoreUnsupportedPackets&&c instanceof ce,f=!(i.ignoreMalformedPackets||c instanceof ce);if(h||f||$a(u.tag))await o.abort(c);else{const m=new Ho(u.tag,u.packet);await o.write(m)}x.printDebugError(c)}}))return await o.ready,void await o.close()}catch(u){await o.abort(u)}});const n=Ur(this.stream);for(;;){const{done:a,value:s}=await n.read();if(a?this.stream=null:this.push(s),a||$a(s.constructor.tag))break}n.releaseLock()}write(){const t=[];for(let r=0;r<this.length;r++){const i=this[r]instanceof Ho?this[r].tag:this[r].constructor.tag,n=this[r].write();if(x.isStream(n)&&$a(this[r].constructor.tag)){let a=[],s=0;const o=512;t.push(cc(i)),t.push(ne(n,u=>{if(a.push(u),s+=u.length,s>=o){const c=Math.min(Math.log(s)/Math.LN2|0,30),h=2**c,f=x.concat([qu(c)].concat(a));return a=[f.subarray(1+h)],s=a[0].length,f.subarray(0,1+h)}},()=>x.concat([ka(s)].concat(a))))}else{if(x.isStream(n)){let a=0;t.push(ne(Vi(n),s=>{a+=s.length},()=>k1(i,a)))}else t.push(k1(i,n.length));t.push(n)}}return x.concat(t)}filterByTag(...t){const r=new Zt,i=n=>a=>n===a;for(let n=0;n<this.length;n++)t.some(i(this[n].constructor.tag))&&r.push(this[n]);return r}findPacket(t){return this.find(r=>r.constructor.tag===t)}indexOfTag(...t){const r=[],i=this,n=a=>s=>a===s;for(let a=0;a<this.length;a++)t.some(n(i[a].constructor.tag))&&r.push(a);return r}}const Kh=x.constructAllowedPackets([Ei,tr,ge]);class Sa{static get tag(){return v.packet.compressedData}constructor(t=vt){this.packets=null,this.algorithm=t.preferredCompressionAlgorithm,this.compressed=null,this.deflateLevel=t.deflateLevel}async read(t,r=vt){await Ns(t,async i=>{this.algorithm=await i.readByte(),this.compressed=i.remainder(),await this.decompress(r)})}write(){return this.compressed===null&&this.compress(),x.concat([new Uint8Array([this.algorithm]),this.compressed])}async decompress(t=vt){const r=v.read(v.compression,this.algorithm),i=Ih[r];if(!i)throw Error(r+" decompression not supported");this.packets=await Zt.fromBinary(i(this.compressed),Kh,t)}compress(){const t=v.read(v.compression,this.algorithm),r=Rh[t];if(!r)throw Error(t+" compression not supported");this.compressed=r(this.packets.write(),this.deflateLevel)}}const kr=x.getNodeZlib();function t2(e){return e}function bs(e,t,r={}){return function(i){return!x.isStream(i)||se(i)?Jr(()=>ae(i).then(n=>new Promise((a,s)=>{e(n,r,(o,u)=>{if(o)return s(o);a(u)})}))):Os(m0(i).pipe(t(r)))}}function ms(e,t={}){return function(r){const i=new e(t);return ne(r,n=>{if(n.length)return i.push(n,2),i.result},()=>{if(e===Xo)return i.push([],4),i.result})}}function e2(e){return function(t){return Jr(async()=>e(await ae(t)))}}const Rh=kr?{zip:(e,t)=>bs(kr.deflateRaw,kr.createDeflateRaw,{level:t})(e),zlib:(e,t)=>bs(kr.deflate,kr.createDeflate,{level:t})(e)}:{zip:(e,t)=>ms(Xo,{raw:!0,level:t})(e),zlib:(e,t)=>ms(Xo,{level:t})(e)},Ih=kr?{uncompressed:t2,zip:bs(kr.inflateRaw,kr.createInflateRaw),zlib:bs(kr.inflate,kr.createInflate),bzip2:e2(J1)}:{uncompressed:t2,zip:ms(Y1,{raw:!0}),zlib:ms(Y1),bzip2:e2(J1)},Uh=x.constructAllowedPackets([Ei,Sa,tr,ge]);class Uc{static get tag(){return v.packet.symEncryptedIntegrityProtectedData}constructor(){this.version=1,this.encrypted=null,this.packets=null}async read(t){await Ns(t,async r=>{const i=await r.readByte();if(i!==1)throw new ce(`Version ${i} of the SEIP packet is unsupported.`);this.encrypted=r.remainder()})}write(){return x.concat([new Uint8Array([1]),this.encrypted])}async encrypt(t,r,i=vt){const{blockSize:n}=At.getCipher(t);let a=this.packets.write();se(a)&&(a=await ae(a));const s=await At.getPrefixRandom(t),o=new Uint8Array([211,20]),u=x.concat([s,a,o]),c=await At.hash.sha1(fn(u)),h=x.concat([u,c]);return this.encrypted=await At.mode.cfb.encrypt(t,r,h,new Uint8Array(n),i),!0}async decrypt(t,r,i=vt){const{blockSize:n}=At.getCipher(t);let a=Vi(this.encrypted);se(a)&&(a=await ae(a));const s=await At.mode.cfb.decrypt(t,r,a,new Uint8Array(n)),o=me(fn(s),-20),u=me(s,0,-20),c=Promise.all([ae(await At.hash.sha1(fn(u))),ae(o)]).then(([m,y])=>{if(!x.equalsUint8Array(m,y))throw Error("Modification detected.");return new Uint8Array}),h=me(u,n+2);let f=me(h,0,-2);return f=De([f,Jr(()=>c)]),x.isStream(a)&&i.allowUnauthenticatedStream||(f=await ae(f)),this.packets=await Zt.fromBinary(f,Uh,i),!0}}const Bh=x.constructAllowedPackets([Ei,Sa,tr,ge]);class $s{static get tag(){return v.packet.aeadEncryptedData}constructor(){this.version=1,this.cipherAlgorithm=null,this.aeadAlgorithm=v.aead.eax,this.chunkSizeByte=null,this.iv=null,this.encrypted=null,this.packets=null}async read(t){await Ns(t,async r=>{const i=await r.readByte();if(i!==1)throw new ce(`Version ${i} of the AEAD-encrypted data packet is not supported.`);this.cipherAlgorithm=await r.readByte(),this.aeadAlgorithm=await r.readByte(),this.chunkSizeByte=await r.readByte();const n=At.getAEADMode(this.aeadAlgorithm);this.iv=await r.readBytes(n.ivLength),this.encrypted=r.remainder()})}write(){return x.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.iv,this.encrypted])}async decrypt(t,r,i=vt){this.packets=await Zt.fromBinary(await this.crypt("decrypt",r,Vi(this.encrypted)),Bh,i)}async encrypt(t,r,i=vt){this.cipherAlgorithm=t;const{ivLength:n}=At.getAEADMode(this.aeadAlgorithm);this.iv=await At.random.getRandomBytes(n),this.chunkSizeByte=i.aeadChunkSizeByte;const a=this.packets.write();this.encrypted=await this.crypt("encrypt",r,a)}async crypt(t,r,i){const n=At.getAEADMode(this.aeadAlgorithm),a=await n(this.cipherAlgorithm,r),s=t==="decrypt"?n.tagLength:0,o=t==="encrypt"?n.tagLength:0,u=2**(this.chunkSizeByte+6)+s,c=new ArrayBuffer(21),h=new Uint8Array(c,0,13),f=new Uint8Array(c),m=new DataView(c),y=new Uint8Array(c,5,8);h.set([192|$s.tag,this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte],0);let K=0,I=Promise.resolve(),U=0,V=0;const Z=this.iv;return Rr(i,async($,R)=>{if(x.isStream($)!=="array"){const Q=new mn({},{highWaterMark:x.getHardwareConcurrency()*2**(this.chunkSizeByte+6),size:d=>d.length});Zr(Q.readable,R),R=Q.writable}const tt=Ur($),X=qe(R);try{for(;;){let Q=await tt.readBytes(u+s)||new Uint8Array;const d=Q.subarray(Q.length-s);let b,_;if(Q=Q.subarray(0,Q.length-s),!K||Q.length?(tt.unshift(d),b=a[t](Q,n.getNonce(Z,y),h),V+=Q.length-s+o):(m.setInt32(17,U),b=a[t](d,n.getNonce(Z,y),f),V+=o,_=!0),U+=Q.length-s,I=I.then(()=>b).then(async g=>{await X.ready,await X.write(g),V-=g.length}).catch(g=>X.abort(g)),(_||V>X.desiredSize)&&await I,_){await X.close();break}m.setInt32(9,++K)}}catch(Q){await X.abort(Q)}})}}class Qo{static get tag(){return v.packet.publicKeyEncryptedSessionKey}constructor(){this.version=3,this.publicKeyID=new Ai,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}read(t){if(this.version=t[0],this.version!==3)throw new ce(`Version ${this.version} of the PKESK packet is unsupported.`);this.publicKeyID.read(t.subarray(1,t.length)),this.publicKeyAlgorithm=t[9],this.encrypted=At.parseEncSessionKeyParams(this.publicKeyAlgorithm,t.subarray(10))}write(){const t=[new Uint8Array([this.version]),this.publicKeyID.write(),new Uint8Array([this.publicKeyAlgorithm]),At.serializeParams(this.publicKeyAlgorithm,this.encrypted)];return x.concatUint8Array(t)}async encrypt(t){const r=x.concatUint8Array([new Uint8Array([v.write(v.symmetric,this.sessionKeyAlgorithm)]),this.sessionKey,x.writeChecksum(this.sessionKey)]),i=v.write(v.publicKey,this.publicKeyAlgorithm);this.encrypted=await At.publicKeyEncrypt(i,t.publicParams,r,t.getFingerprintBytes())}async decrypt(t,r){if(this.publicKeyAlgorithm!==t.algorithm)throw Error("Decryption error");const i=r?x.concatUint8Array([new Uint8Array([r.sessionKeyAlgorithm]),r.sessionKey,x.writeChecksum(r.sessionKey)]):null,n=await At.publicKeyDecrypt(this.publicKeyAlgorithm,t.publicParams,t.privateParams,this.encrypted,t.getFingerprintBytes(),i),a=n[0],s=n.subarray(1,n.length-2),o=n.subarray(n.length-2),u=x.writeChecksum(s),c=u[0]===o[0]&u[1]===o[1];if(r){const h=c&a===r.sessionKeyAlgorithm&s.length===r.sessionKey.length;this.sessionKeyAlgorithm=x.selectUint8(h,a,r.sessionKeyAlgorithm),this.sessionKey=x.selectUint8Array(h,s,r.sessionKey)}else{if(!(c&&v.read(v.symmetric,a)))throw Error("Decryption error");this.sessionKey=s,this.sessionKeyAlgorithm=a}}}class ea{constructor(t=vt){this.algorithm=v.hash.sha256,this.type="iterated",this.c=t.s2kIterationCountByte,this.salt=null}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(t){let r=0;switch(this.type=v.read(v.s2k,t[r++]),this.algorithm=t[r++],this.type){case"simple":break;case"salted":this.salt=t.subarray(r,r+8),r+=8;break;case"iterated":this.salt=t.subarray(r,r+8),r+=8,this.c=t[r++];break;case"gnu":if(x.uint8ArrayToString(t.subarray(r,r+3))!=="GNU")throw Error("Unknown s2k type.");if(r+=3,1e3+t[r++]!==1001)throw Error("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw Error("Unknown s2k type.")}return r}write(){if(this.type==="gnu-dummy")return new Uint8Array([101,0,...x.stringToUint8Array("GNU"),1]);const t=[new Uint8Array([v.write(v.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":t.push(this.salt);break;case"iterated":t.push(this.salt),t.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return x.concatUint8Array(t)}async produceKey(t,r){t=x.encodeUTF8(t);const i=[];let n=0,a=0;for(;n<r;){let s;switch(this.type){case"simple":s=x.concatUint8Array([new Uint8Array(a),t]);break;case"salted":s=x.concatUint8Array([new Uint8Array(a),this.salt,t]);break;case"iterated":{const u=x.concatUint8Array([this.salt,t]);let c=u.length;const h=Math.max(this.getCount(),c);s=new Uint8Array(a+h),s.set(u,a);for(let f=a+c;f<h;f+=c,c*=2)s.copyWithin(f,a,f);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}const o=await At.hash.digest(this.algorithm,s);i.push(o),n+=o.length,a++}return x.concatUint8Array(i).subarray(0,r)}}class wn{static get tag(){return v.packet.symEncryptedSessionKey}constructor(t=vt){this.version=t.aeadProtect?5:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=v.symmetric.aes256,this.aeadAlgorithm=v.write(v.aead,t.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(t){let r=0;if(this.version=t[r++],this.version!==4&&this.version!==5)throw new ce(`Version ${this.version} of the SKESK packet is unsupported.`);const i=t[r++];if(this.version===5&&(this.aeadAlgorithm=t[r++]),this.s2k=new ea,r+=this.s2k.read(t.subarray(r,t.length)),this.version===5){const n=At.getAEADMode(this.aeadAlgorithm);this.iv=t.subarray(r,r+=n.ivLength)}this.version===5||r<t.length?(this.encrypted=t.subarray(r,t.length),this.sessionKeyEncryptionAlgorithm=i):this.sessionKeyAlgorithm=i}write(){const t=this.encrypted===null?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm;let r;return this.version===5?r=x.concatUint8Array([new Uint8Array([this.version,t,this.aeadAlgorithm]),this.s2k.write(),this.iv,this.encrypted]):(r=x.concatUint8Array([new Uint8Array([this.version,t]),this.s2k.write()]),this.encrypted!==null&&(r=x.concatUint8Array([r,this.encrypted]))),r}async decrypt(t){const r=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm,{blockSize:i,keySize:n}=At.getCipher(r),a=await this.s2k.produceKey(t,n);if(this.version===5){const s=At.getAEADMode(this.aeadAlgorithm),o=new Uint8Array([192|wn.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),u=await s(r,a);this.sessionKey=await u.decrypt(this.encrypted,this.iv,o)}else if(this.encrypted!==null){const s=await At.mode.cfb.decrypt(r,a,this.encrypted,new Uint8Array(i));this.sessionKeyAlgorithm=v.write(v.symmetric,s[0]),this.sessionKey=s.subarray(1,s.length)}else this.sessionKey=a}async encrypt(t,r=vt){const i=this.sessionKeyEncryptionAlgorithm!==null?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm;this.sessionKeyEncryptionAlgorithm=i,this.s2k=new ea(r),this.s2k.salt=await At.random.getRandomBytes(8);const{blockSize:n,keySize:a}=At.getCipher(i),s=await this.s2k.produceKey(t,a);if(this.sessionKey===null&&(this.sessionKey=await At.generateSessionKey(this.sessionKeyAlgorithm)),this.version===5){const o=At.getAEADMode(this.aeadAlgorithm);this.iv=await At.random.getRandomBytes(o.ivLength);const u=new Uint8Array([192|wn.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),c=await o(i,s);this.encrypted=await c.encrypt(this.sessionKey,this.iv,u)}else{const o=x.concatUint8Array([new Uint8Array([this.sessionKeyAlgorithm]),this.sessionKey]);this.encrypted=await At.mode.cfb.encrypt(i,s,o,new Uint8Array(n),r)}}}class Qe{static get tag(){return v.packet.publicKey}constructor(t=new Date,r=vt){this.version=r.v5Keys?5:4,this.created=x.normalizeDate(t),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(t){const r=new Qe,{version:i,created:n,algorithm:a,publicParams:s,keyID:o,fingerprint:u}=t;return r.version=i,r.created=n,r.algorithm=a,r.publicParams=s,r.keyID=o,r.fingerprint=u,r}async read(t){let r=0;if(this.version=t[r++],this.version===4||this.version===5){this.created=x.readDate(t.subarray(r,r+4)),r+=4,this.algorithm=t[r++],this.version===5&&(r+=4);const{read:i,publicParams:n}=At.parsePublicKeyParams(this.algorithm,t.subarray(r));return this.publicParams=n,r+=i,await this.computeFingerprintAndKeyID(),r}throw new ce(`Version ${this.version} of the key packet is unsupported.`)}write(){const t=[];t.push(new Uint8Array([this.version])),t.push(x.writeDate(this.created)),t.push(new Uint8Array([this.algorithm]));const r=At.serializeParams(this.algorithm,this.publicParams);return this.version===5&&t.push(x.writeNumber(r.length,4)),t.push(r),x.concatUint8Array(t)}writeForHash(t){const r=this.writePublicKey();return t===5?x.concatUint8Array([new Uint8Array([154]),x.writeNumber(r.length,4),r]):x.concatUint8Array([new Uint8Array([153]),x.writeNumber(r.length,2),r])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}async computeFingerprintAndKeyID(){if(await this.computeFingerprint(),this.keyID=new Ai,this.version===5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(this.version!==4)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}}async computeFingerprint(){const t=this.writeForHash(this.version);if(this.version===5)this.fingerprint=await At.hash.sha256(t);else{if(this.version!==4)throw Error("Unsupported key version");this.fingerprint=await At.hash.sha1(t)}}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return x.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(t){return this.version===t.version&&x.equalsUint8Array(this.writePublicKey(),t.writePublicKey())}getAlgorithmInfo(){const t={};t.algorithm=v.read(v.publicKey,this.algorithm);const r=this.publicParams.n||this.publicParams.p;return r?t.bits=x.uint8ArrayBitLength(r):t.curve=this.publicParams.oid.getName(),t}}Qe.prototype.readPublicKey=Qe.prototype.read,Qe.prototype.writePublicKey=Qe.prototype.write;const Th=x.constructAllowedPackets([Ei,Sa,tr,ge]);class zh{static get tag(){return v.packet.symmetricallyEncryptedData}constructor(){this.encrypted=null,this.packets=null}read(t){this.encrypted=t}write(){return this.encrypted}async decrypt(t,r,i=vt){if(!i.allowUnauthenticatedMessages)throw Error("Message is not authenticated.");const{blockSize:n}=At.getCipher(t),a=await ae(Vi(this.encrypted)),s=await At.mode.cfb.decrypt(t,r,a.subarray(n+2),a.subarray(2,n+2));this.packets=await Zt.fromBinary(s,Th,i)}async encrypt(t,r,i=vt){const n=this.packets.write(),{blockSize:a}=At.getCipher(t),s=await At.getPrefixRandom(t),o=await At.mode.cfb.encrypt(t,r,s,new Uint8Array(a),i),u=await At.mode.cfb.encrypt(t,r,n,o.subarray(2),i);this.encrypted=x.concat([o,u])}}class Ea extends Qe{static get tag(){return v.packet.publicSubkey}constructor(t,r){super(t,r)}static fromSecretSubkeyPacket(t){const r=new Ea,{version:i,created:n,algorithm:a,publicParams:s,keyID:o,fingerprint:u}=t;return r.version=i,r.created=n,r.algorithm=a,r.publicParams=s,r.keyID=o,r.fingerprint=u,r}}class S0{static get tag(){return v.packet.userAttribute}constructor(){this.attributes=[]}read(t){let r=0;for(;r<t.length;){const i=oc(t.subarray(r,t.length));r+=i.offset,this.attributes.push(x.uint8ArrayToString(t.subarray(r,r+i.len))),r+=i.len}}write(){const t=[];for(let r=0;r<this.attributes.length;r++)t.push(ka(this.attributes[r].length)),t.push(x.stringToUint8Array(this.attributes[r]));return x.concatUint8Array(t)}equals(t){return!!(t&&t instanceof S0)&&this.attributes.every(function(r,i){return r===t.attributes[i]})}}class Zs extends Qe{static get tag(){return v.packet.secretKey}constructor(t=new Date,r=vt){super(t,r),this.keyMaterial=null,this.isEncrypted=null,this.s2kUsage=0,this.s2k=null,this.symmetric=null,this.aead=null,this.privateParams=null}async read(t){let r=await this.readPublicKey(t);if(this.s2kUsage=t[r++],this.version===5&&r++,this.s2kUsage===255||this.s2kUsage===254||this.s2kUsage===253){if(this.symmetric=t[r++],this.s2kUsage===253&&(this.aead=t[r++]),this.s2k=new ea,r+=this.s2k.read(t.subarray(r,t.length)),this.s2k.type==="gnu-dummy")return}else this.s2kUsage&&(this.symmetric=this.s2kUsage);if(this.s2kUsage&&(this.iv=t.subarray(r,r+At.getCipher(this.symmetric).blockSize),r+=this.iv.length),this.version===5&&(r+=4),this.keyMaterial=t.subarray(r),this.isEncrypted=!!this.s2kUsage,!this.isEncrypted){const i=this.keyMaterial.subarray(0,-2);if(!x.equalsUint8Array(x.writeChecksum(i),this.keyMaterial.subarray(-2)))throw Error("Key checksum mismatch");try{const{privateParams:n}=At.parsePrivateKeyParams(this.algorithm,i,this.publicParams);this.privateParams=n}catch(n){throw n instanceof ce?n:Error("Error reading MPIs")}}}write(){const t=[this.writePublicKey()];t.push(new Uint8Array([this.s2kUsage]));const r=[];return this.s2kUsage!==255&&this.s2kUsage!==254&&this.s2kUsage!==253||(r.push(this.symmetric),this.s2kUsage===253&&r.push(this.aead),r.push(...this.s2k.write())),this.s2kUsage&&this.s2k.type!=="gnu-dummy"&&r.push(...this.iv),this.version===5&&t.push(new Uint8Array([r.length])),t.push(new Uint8Array(r)),this.isDummy()||(this.s2kUsage||(this.keyMaterial=At.serializeParams(this.algorithm,this.privateParams)),this.version===5&&t.push(x.writeNumber(this.keyMaterial.length,4)),t.push(this.keyMaterial),this.s2kUsage||t.push(x.writeChecksum(this.keyMaterial))),x.concatUint8Array(t)}isDecrypted(){return this.isEncrypted===!1}isDummy(){return!(!this.s2k||this.s2k.type!=="gnu-dummy")}makeDummy(t=vt){this.isDummy()||(this.isDecrypted()&&this.clearPrivateParams(),this.isEncrypted=null,this.keyMaterial=null,this.s2k=new ea(t),this.s2k.algorithm=0,this.s2k.c=0,this.s2k.type="gnu-dummy",this.s2kUsage=254,this.symmetric=v.symmetric.aes256)}async encrypt(t,r=vt){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key packet is already encrypted");if(!t)throw Error("A non-empty passphrase is required for key encryption.");this.s2k=new ea(r),this.s2k.salt=await At.random.getRandomBytes(8);const i=At.serializeParams(this.algorithm,this.privateParams);this.symmetric=v.symmetric.aes256;const n=await r2(this.s2k,t,this.symmetric),{blockSize:a}=At.getCipher(this.symmetric);if(this.iv=await At.random.getRandomBytes(a),r.aeadProtect){this.s2kUsage=253,this.aead=v.aead.eax;const s=At.getAEADMode(this.aead),o=await s(this.symmetric,n);this.keyMaterial=await o.encrypt(i,this.iv.subarray(0,s.ivLength),new Uint8Array)}else this.s2kUsage=254,this.keyMaterial=await At.mode.cfb.encrypt(this.symmetric,n,x.concatUint8Array([i,await At.hash.sha1(i,r)]),this.iv,r)}async decrypt(t){if(this.isDummy())return!1;if(this.isDecrypted())throw Error("Key packet is already decrypted.");let r,i;if(this.s2kUsage!==254&&this.s2kUsage!==253)throw this.s2kUsage===255?Error("Encrypted private key is authenticated using an insecure two-byte hash"):Error("Private key is encrypted using an insecure S2K function: unsalted MD5");if(r=await r2(this.s2k,t,this.symmetric),this.s2kUsage===253){const n=At.getAEADMode(this.aead),a=await n(this.symmetric,r);try{i=await a.decrypt(this.keyMaterial,this.iv.subarray(0,n.ivLength),new Uint8Array)}catch(s){throw s.message==="Authentication tag mismatch"?Error("Incorrect key passphrase: "+s.message):s}}else{const n=await At.mode.cfb.decrypt(this.symmetric,r,this.keyMaterial,this.iv);i=n.subarray(0,-20);const a=await At.hash.sha1(i);if(!x.equalsUint8Array(a,n.subarray(-20)))throw Error("Incorrect key passphrase")}try{const{privateParams:n}=At.parsePrivateKeyParams(this.algorithm,i,this.publicParams);this.privateParams=n}catch{throw Error("Error reading MPIs")}this.isEncrypted=!1,this.keyMaterial=null,this.s2kUsage=0}async validate(){if(this.isDummy())return;if(!this.isDecrypted())throw Error("Key is not decrypted");let t;try{t=await At.validateParams(this.algorithm,this.publicParams,this.privateParams)}catch{t=!1}if(!t)throw Error("Key is invalid")}async generate(t,r){const{privateParams:i,publicParams:n}=await At.generateParams(this.algorithm,t,r);this.privateParams=i,this.publicParams=n,this.isEncrypted=!1}clearPrivateParams(){this.isDummy()||(Object.keys(this.privateParams).forEach(t=>{this.privateParams[t].fill(0),delete this.privateParams[t]}),this.privateParams=null,this.isEncrypted=!0)}}async function r2(e,t,r){const{keySize:i}=At.getCipher(r);return e.produceKey(t,i)}var qh=Br(function(e){(function(t){function r(n){function a(){return Et<Bt}function s(){return Et}function o(at){Et=at}function u(){Et=0,Bt=jt.length}function c(at,ot){return{name:at,tokens:ot||"",semantic:ot||"",children:[]}}function h(at,ot){var pt;return ot===null?null:((pt=c(at)).tokens=ot.tokens,pt.semantic=ot.semantic,pt.children.push(ot),pt)}function f(at,ot){return ot!==null&&(at.tokens+=ot.tokens,at.semantic+=ot.semantic),at.children.push(ot),at}function m(at){var ot;return a()&&at(ot=jt[Et])?(Et+=1,c("token",ot)):null}function y(at){return function(){return h("literal",m(function(ot){return ot===at}))}}function K(){var at=arguments;return function(){var ot,pt,_t,Kt;for(Kt=s(),pt=c("and"),ot=0;ot<at.length;ot+=1){if((_t=at[ot]())===null)return o(Kt),null;f(pt,_t)}return pt}}function I(){var at=arguments;return function(){var ot,pt,_t;for(_t=s(),ot=0;ot<at.length;ot+=1){if((pt=at[ot]())!==null)return pt;o(_t)}return null}}function U(at){return function(){var ot,pt;return pt=s(),(ot=at())!==null?ot:(o(pt),c("opt"))}}function V(at){return function(){var ot=at();return ot!==null&&(ot.semantic=""),ot}}function Z(at){return function(){var ot=at();return ot!==null&&ot.semantic.length>0&&(ot.semantic=" "),ot}}function $(at,ot){return function(){var pt,_t,Kt,xt,St;for(xt=s(),pt=c("star"),Kt=0,St=ot===void 0?0:ot;(_t=at())!==null;)Kt+=1,f(pt,_t);return Kt>=St?pt:(o(xt),null)}}function R(at){return at.charCodeAt(0)>=128}function tt(){return h("cr",y("\r")())}function X(){return h("crlf",K(tt,b)())}function Q(){return h("dquote",y('"')())}function d(){return h("htab",y("	")())}function b(){return h("lf",y(`
`)())}function _(){return h("sp",y(" ")())}function g(){return h("vchar",m(function(at){var ot=at.charCodeAt(0),pt=33<=ot&&ot<=126;return n.rfc6532&&(pt=pt||R(at)),pt}))}function p(){return h("wsp",I(_,d)())}function S(){var at=h("quoted-pair",I(K(y("\\"),I(g,p)),F)());return at===null?null:(at.semantic=at.semantic[1],at)}function D(){return h("fws",I(L,K(U(K($(p),V(X))),$(p,1)))())}function nt(){return h("ctext",I(function(){return m(function(at){var ot=at.charCodeAt(0),pt=33<=ot&&ot<=39||42<=ot&&ot<=91||93<=ot&&ot<=126;return n.rfc6532&&(pt=pt||R(at)),pt})},wt)())}function st(){return h("ccontent",I(nt,S,q)())}function q(){return h("comment",K(y("("),$(K(U(D),st)),U(D),y(")"))())}function rt(){return h("cfws",I(K($(K(U(D),q),1),U(D)),D)())}function ct(){return h("atext",m(function(at){var ot="a"<=at&&at<="z"||"A"<=at&&at<="Z"||"0"<=at&&at<="9"||["!","#","$","%","&","'","*","+","-","/","=","?","^","_","`","{","|","}","~"].indexOf(at)>=0;return n.rfc6532&&(ot=ot||R(at)),ot}))}function dt(){return h("atom",K(Z(U(rt)),$(ct,1),Z(U(rt)))())}function ut(){var at,ot;return(at=h("dot-atom-text",$(ct,1)()))===null||(ot=$(K(y("."),$(ct,1)))())!==null&&f(at,ot),at}function ft(){return h("dot-atom",K(V(U(rt)),ut,V(U(rt)))())}function gt(){return h("qtext",I(function(){return m(function(at){var ot=at.charCodeAt(0),pt=ot===33||35<=ot&&ot<=91||93<=ot&&ot<=126;return n.rfc6532&&(pt=pt||R(at)),pt})},O)())}function mt(){return h("qcontent",I(gt,S)())}function B(){return h("quoted-string",K(V(U(rt)),V(Q),$(K(U(Z(D)),mt)),U(V(D)),V(Q),V(U(rt)))())}function Y(){return h("word",I(dt,B)())}function M(){return h("address",I(l,J)())}function l(){return h("mailbox",I(z,yt)())}function z(){return h("name-addr",K(U(it),et)())}function et(){return h("angle-addr",I(K(V(U(rt)),y("<"),yt,y(">"),V(U(rt))),j)())}function J(){return h("group",K(it,y(":"),U(A),y(";"),V(U(rt)))())}function it(){return h("display-name",((at=h("phrase",I(W,$(Y,1))()))!==null&&(at.semantic=function(ot){return ot.replace(/([ \t]|\r\n)+/g," ").replace(/^\s*/,"").replace(/\s*$/,"")}(at.semantic)),at));var at}function k(){return h("mailbox-list",I(K(l,$(K(y(","),l))),E)())}function w(){return h("address-list",I(K(M,$(K(y(","),M))),bt)())}function A(){return h("group-list",I(k,V(rt),ht)())}function C(){return h("local-part",I(Pt,ft,B)())}function N(){return h("dtext",I(function(){return m(function(at){var ot=at.charCodeAt(0),pt=33<=ot&&ot<=90||94<=ot&&ot<=126;return n.rfc6532&&(pt=pt||R(at)),pt})},Dt)())}function T(){return h("domain-literal",K(V(U(rt)),y("["),$(K(U(D),N)),U(D),y("]"),V(U(rt)))())}function H(){return h("domain",(at=I(Lt,ft,T)(),n.rejectTLD&&at&&at.semantic&&at.semantic.indexOf(".")<0?null:(at&&(at.semantic=at.semantic.replace(/\s+/g,"")),at)));var at}function yt(){return h("addr-spec",K(C,y("@"),H)())}function lt(){return n.strict?null:h("obs-NO-WS-CTL",m(function(at){var ot=at.charCodeAt(0);return 1<=ot&&ot<=8||ot===11||ot===12||14<=ot&&ot<=31||ot===127}))}function wt(){return n.strict?null:h("obs-ctext",lt())}function O(){return n.strict?null:h("obs-qtext",lt())}function F(){return n.strict?null:h("obs-qp",K(y("\\"),I(y("\0"),lt,b,tt))())}function W(){return n.strict?null:n.atInDisplayName?h("obs-phrase",K(Y,$(I(Y,y("."),y("@"),Z(rt))))()):h("obs-phrase",K(Y,$(I(Y,y("."),Z(rt))))())}function L(){return n.strict?null:h("obs-FWS",$(K(V(U(X)),p),1)())}function j(){return n.strict?null:h("obs-angle-addr",K(V(U(rt)),y("<"),G,yt,y(">"),V(U(rt)))())}function G(){return n.strict?null:h("obs-route",K(P,y(":"))())}function P(){return n.strict?null:h("obs-domain-list",K($(I(V(rt),y(","))),y("@"),H,$(K(y(","),V(U(rt)),U(K(y("@"),H)))))())}function E(){return n.strict?null:h("obs-mbox-list",K($(K(V(U(rt)),y(","))),l,$(K(y(","),U(K(l,V(rt))))))())}function bt(){return n.strict?null:h("obs-addr-list",K($(K(V(U(rt)),y(","))),M,$(K(y(","),U(K(M,V(rt))))))())}function ht(){return n.strict?null:h("obs-group-list",K($(K(V(U(rt)),y(",")),1),V(U(rt)))())}function Pt(){return n.strict?null:h("obs-local-part",K(Y,$(K(y("."),Y)))())}function Lt(){return n.strict?null:h("obs-domain",K(dt,$(K(y("."),dt)))())}function Dt(){return n.strict?null:h("obs-dtext",I(lt,S)())}function Ct(at,ot){var pt,_t,Kt;if(ot==null)return null;for(_t=[ot];_t.length>0;){if((Kt=_t.pop()).name===at)return Kt;for(pt=Kt.children.length-1;pt>=0;pt-=1)_t.push(Kt.children[pt])}return null}function Xt(at,ot){var pt,_t,Kt,xt,St;if(ot==null)return null;for(_t=[ot],xt=[],St={},pt=0;pt<at.length;pt+=1)St[at[pt]]=!0;for(;_t.length>0;)if((Kt=_t.pop()).name in St)xt.push(Kt);else for(pt=Kt.children.length-1;pt>=0;pt-=1)_t.push(Kt.children[pt]);return xt}function zt(at){var ot,pt,_t,Kt,xt;if(at===null)return null;for(ot=[],pt=Xt(["group","mailbox"],at),_t=0;_t<pt.length;_t+=1)(Kt=pt[_t]).name==="group"?ot.push(Ot(Kt)):Kt.name==="mailbox"&&ot.push(oe(Kt));return xt={ast:at,addresses:ot},n.simple&&(xt=function(St){var Ht;if(St&&St.addresses)for(Ht=0;Ht<St.addresses.length;Ht+=1)delete St.addresses[Ht].node;return St}(xt)),n.oneResult?function(St){return!St||!n.partial&&St.addresses.length>1?null:St.addresses&&St.addresses[0]}(xt):n.simple?xt&&xt.addresses:xt}function Ot(at){var ot,pt=Ct("display-name",at),_t=[],Kt=Xt(["mailbox"],at);for(ot=0;ot<Kt.length;ot+=1)_t.push(oe(Kt[ot]));return{node:at,parts:{name:pt},type:at.name,name:Mt(pt),addresses:_t}}function oe(at){var ot=Ct("display-name",at),pt=Ct("addr-spec",at),_t=function(Ht,Tt){var Gt,xe,Me,Ie;if(Tt==null)return null;for(xe=[Tt],Ie=[];xe.length>0;)for((Me=xe.pop()).name===Ht&&Ie.push(Me),Gt=Me.children.length-1;Gt>=0;Gt-=1)xe.push(Me.children[Gt]);return Ie}("cfws",at),Kt=Xt(["comment"],at),xt=Ct("local-part",pt),St=Ct("domain",pt);return{node:at,parts:{name:ot,address:pt,local:xt,domain:St,comments:_t},type:at.name,name:Mt(ot),address:Mt(pt),local:Mt(xt),domain:Mt(St),comments:Rt(Kt),groupName:Mt(at.groupName)}}function Mt(at){return at!=null?at.semantic:null}function Rt(at){var ot="";if(at)for(var pt=0;pt<at.length;pt+=1)ot+=Mt(at[pt]);return ot}var jt,Et,Bt,$t,It;if((n=i(n,{}))===null)return null;if(jt=n.input,It={address:M,"address-list":w,"angle-addr":et,from:function(){return h("from",I(k,w)())},group:J,mailbox:l,"mailbox-list":k,"reply-to":function(){return h("reply-to",w())},sender:function(){return h("sender",I(l,M)())}}[n.startAt]||w,!n.strict){if(u(),n.strict=!0,$t=It(jt),n.partial||!a())return zt($t);n.strict=!1}return u(),$t=It(jt),!n.partial&&a()?null:zt($t)}function i(n,a){function s(h){return Object.prototype.toString.call(h)==="[object String]"}function o(h){return h==null}var u,c;if(s(n))n={input:n};else if(!function(h){return h===Object(h)}(n))return null;if(!s(n.input)||!a)return null;for(c in u={oneResult:!1,partial:!1,rejectTLD:!1,rfc6532:!1,simple:!1,startAt:"address-list",strict:!1,atInDisplayName:!1})o(n[c])&&(n[c]=o(a[c])?u[c]:a[c]);return n}r.parseOneAddress=function(n){return r(i(n,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"address-list"}))},r.parseAddressList=function(n){return r(i(n,{rfc6532:!0,simple:!0,startAt:"address-list"}))},r.parseFrom=function(n){return r(i(n,{rfc6532:!0,simple:!0,startAt:"from"}))},r.parseSender=function(n){return r(i(n,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"sender"}))},r.parseReplyTo=function(n){return r(i(n,{rfc6532:!0,simple:!0,startAt:"reply-to"}))},e.exports=r})()});class Ys{static get tag(){return v.packet.userID}constructor(){this.userID="",this.name="",this.email="",this.comment=""}static fromObject(t){if(x.isString(t)||t.name&&!x.isString(t.name)||t.email&&!x.isEmailAddress(t.email)||t.comment&&!x.isString(t.comment))throw Error("Invalid user ID format");const r=new Ys;Object.assign(r,t);const i=[];return r.name&&i.push(r.name),r.comment&&i.push(`(${r.comment})`),r.email&&i.push(`<${r.email}>`),r.userID=i.join(" "),r}read(t,r=vt){const i=x.decodeUTF8(t);if(i.length>r.maxUserIDLength)throw Error("User ID string is too long");try{const{name:n,address:a,comments:s}=qh.parseOneAddress({input:i,atInDisplayName:!0});this.comment=s.replace(/^\(|\)$/g,""),this.name=n,this.email=a}catch{}this.userID=i}write(){return x.encodeUTF8(this.userID)}equals(t){return t&&t.userID===this.userID}}class E0 extends Zs{static get tag(){return v.packet.secretSubkey}constructor(t=new Date,r=vt){super(t,r)}}class ra{constructor(t){this.packets=t||new Zt}write(){return this.packets.write()}armor(t=vt){return Sn(v.armor.signature,this.write(),void 0,void 0,void 0,t)}getSigningKeyIDs(){return this.packets.map(t=>t.issuerKeyID)}}async function Bc(e,t){const r=new E0(e.date,t);return r.packets=null,r.algorithm=v.write(v.publicKey,e.algorithm),await r.generate(e.rsaBits,e.curve),await r.computeFingerprintAndKeyID(),r}async function Fh(e,t){const r=new Zs(e.date,t);return r.packets=null,r.algorithm=v.write(v.publicKey,e.algorithm),await r.generate(e.rsaBits,e.curve,e.config),await r.computeFingerprintAndKeyID(),r}async function br(e,t,r,i,n=new Date,a){let s,o;for(let u=e.length-1;u>=0;u--)try{(!s||e[u].created>=s.created)&&(await e[u].verify(t,r,i,n,void 0,a),s=e[u])}catch(c){o=c}if(!s)throw x.wrapError(`Could not find valid ${v.read(v.signature,r)} signature in key ${t.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,(u,c,h)=>c+" "+h.toLowerCase()),o);return s}function Jo(e,t,r=new Date){const i=x.normalizeDate(r);if(i!==null){const n=gs(e,t);return!(e.created<=i&&i<n)}return!1}async function Tc(e,t,r,i){const n={};n.key=t,n.bind=e;const a=new ge;return a.signatureType=v.signature.subkeyBinding,a.publicKeyAlgorithm=t.algorithm,a.hashAlgorithm=await Xs(null,e,void 0,void 0,i),r.sign?(a.keyFlags=[v.keyFlags.signData],a.embeddedSignature=await Mn(n,null,e,{signatureType:v.signature.keyBinding},r.date,void 0,void 0,i)):a.keyFlags=[v.keyFlags.encryptCommunication|v.keyFlags.encryptStorage],r.keyExpirationTime>0&&(a.keyExpirationTime=r.keyExpirationTime,a.keyNeverExpires=!1),await a.sign(t,n,r.date),a}async function Xs(e,t,r=new Date,i={},n){let a=n.preferredHashAlgorithm,s=a;if(e){const o=await e.getPrimaryUser(r,i,n);o.selfCertification.preferredHashAlgorithms&&([s]=o.selfCertification.preferredHashAlgorithms,a=At.hash.getHashByteLength(a)<=At.hash.getHashByteLength(s)?s:a)}switch(Object.getPrototypeOf(t)){case Zs.prototype:case Qe.prototype:case E0.prototype:case Ea.prototype:switch(t.algorithm){case v.publicKey.ecdh:case v.publicKey.ecdsa:case v.publicKey.eddsa:s=At.publicKey.elliptic.getPreferredHashAlgo(t.publicParams.oid)}}return At.hash.getHashByteLength(a)<=At.hash.getHashByteLength(s)?s:a}async function t0(e,t=[],r=new Date,i=[],n=vt){const a={symmetric:v.symmetric.aes128,aead:v.aead.eax,compression:v.compression.uncompressed}[e],s={symmetric:n.preferredSymmetricAlgorithm,aead:n.preferredAEADAlgorithm,compression:n.preferredCompressionAlgorithm}[e],o={symmetric:"preferredSymmetricAlgorithms",aead:"preferredAEADAlgorithms",compression:"preferredCompressionAlgorithms"}[e];return(await Promise.all(t.map(async function(u,c){const h=(await u.getPrimaryUser(r,i[c],n)).selfCertification[o];return!!h&&h.indexOf(s)>=0}))).every(Boolean)?s:a}async function Mn(e,t,r,i,n,a,s=!1,o){if(r.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!r.isDecrypted())throw Error("Signing key is not decrypted.");const u=new ge;return Object.assign(u,i),u.publicKeyAlgorithm=r.algorithm,u.hashAlgorithm=await Xs(t,r,n,a,o),await u.sign(r,e,n,s),u}async function Wi(e,t,r,i=new Date,n){(e=e[r])&&(t[r].length?await Promise.all(e.map(async function(a){a.isExpired(i)||n&&!await n(a)||t[r].some(function(s){return x.equalsUint8Array(s.writeParams(),a.writeParams())})||t[r].push(a)})):t[r]=e)}async function vn(e,t,r,i,n,a,s=new Date,o){a=a||e;const u=[];return await Promise.all(i.map(async function(c){try{n&&!c.issuerKeyID.equals(n.issuerKeyID)||(await c.verify(a,t,r,o.revocationsExpire?s:null,!1,o),u.push(c.issuerKeyID))}catch{}})),n?(n.revoked=!!u.some(c=>c.equals(n.issuerKeyID))||n.revoked||!1,n.revoked):u.length>0}function gs(e,t){let r;return t.keyNeverExpires===!1&&(r=e.created.getTime()+1e3*t.keyExpirationTime),r?new Date(r):1/0}function e0(e,t={}){switch(e.type=e.type||t.type,e.curve=e.curve||t.curve,e.rsaBits=e.rsaBits||t.rsaBits,e.keyExpirationTime=e.keyExpirationTime!==void 0?e.keyExpirationTime:t.keyExpirationTime,e.passphrase=x.isString(e.passphrase)?e.passphrase:t.passphrase,e.date=e.date||t.date,e.sign=e.sign||!1,e.type){case"ecc":try{e.curve=v.write(v.curve,e.curve)}catch{throw Error("Unknown curve")}e.curve!==v.curve.ed25519&&e.curve!==v.curve.curve25519||(e.curve=e.sign?v.curve.ed25519:v.curve.curve25519),e.sign?e.algorithm=e.curve===v.curve.ed25519?v.publicKey.eddsa:v.publicKey.ecdsa:e.algorithm=v.publicKey.ecdh;break;case"rsa":e.algorithm=v.publicKey.rsaEncryptSign;break;default:throw Error("Unsupported key type "+e.type)}return e}function i2(e,t){const r=e.algorithm;return r!==v.publicKey.rsaEncrypt&&r!==v.publicKey.elgamal&&r!==v.publicKey.ecdh&&(!t.keyFlags||(t.keyFlags[0]&v.keyFlags.signData)!=0)}function n2(e,t){const r=e.algorithm;return r!==v.publicKey.dsa&&r!==v.publicKey.rsaSign&&r!==v.publicKey.ecdsa&&r!==v.publicKey.eddsa&&(!t.keyFlags||(t.keyFlags[0]&v.keyFlags.encryptCommunication)!=0||(t.keyFlags[0]&v.keyFlags.encryptStorage)!=0)}function a2(e,t){return!!t.allowInsecureDecryptionWithSigningKeys||!e.keyFlags||(e.keyFlags[0]&v.keyFlags.encryptCommunication)!=0||(e.keyFlags[0]&v.keyFlags.encryptStorage)!=0}function cn(e,t){const r=v.write(v.publicKey,e.algorithm),i=e.getAlgorithmInfo();if(t.rejectPublicKeyAlgorithms.has(r))throw Error(i.algorithm+" keys are considered too weak.");switch(r){case v.publicKey.rsaEncryptSign:case v.publicKey.rsaSign:case v.publicKey.rsaEncrypt:if(i.bits<t.minRSABits)throw Error(`RSA keys shorter than ${t.minRSABits} bits are considered too weak.`);break;case v.publicKey.ecdsa:case v.publicKey.eddsa:case v.publicKey.ecdh:if(t.rejectCurves.has(i.curve))throw Error(`Support for ${i.algorithm} keys using curve ${i.curve} is disabled.`)}}class ws{constructor(t,r){this.userID=t.constructor.tag===v.packet.userID?t:null,this.userAttribute=t.constructor.tag===v.packet.userAttribute?t:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=r}toPacketList(){const t=new Zt;return t.push(this.userID||this.userAttribute),t.push(...this.revocationSignatures),t.push(...this.selfCertifications),t.push(...this.otherCertifications),t}clone(){const t=new ws(this.userID||this.userAttribute,this.mainKey);return t.selfCertifications=[...this.selfCertifications],t.otherCertifications=[...this.otherCertifications],t.revocationSignatures=[...this.revocationSignatures],t}async certify(t,r,i){const n=this.mainKey.keyPacket,a={userID:this.userID,userAttribute:this.userAttribute,key:n},s=new ws(a.userID||a.userAttribute,this.mainKey);return s.otherCertifications=await Promise.all(t.map(async function(o){if(!o.isPrivate())throw Error("Need private key for signing");if(o.hasSameFingerprintAs(n))throw Error("The user's own key can only be used for self-certifications");const u=await o.getSigningKey(void 0,r,void 0,i);return Mn(a,o,u.keyPacket,{signatureType:v.signature.certGeneric,keyFlags:[v.keyFlags.certifyKeys|v.keyFlags.signData]},r,void 0,void 0,i)})),await s.update(this,r,i),s}async isRevoked(t,r,i=new Date,n){const a=this.mainKey.keyPacket;return vn(a,v.signature.certRevocation,{key:a,userID:this.userID,userAttribute:this.userAttribute},this.revocationSignatures,t,r,i,n)}async verifyCertificate(t,r,i=new Date,n){const a=this,s=this.mainKey.keyPacket,o={userID:this.userID,userAttribute:this.userAttribute,key:s},{issuerKeyID:u}=t,c=r.filter(h=>h.getKeys(u).length>0);return c.length===0?null:(await Promise.all(c.map(async h=>{const f=await h.getSigningKey(u,t.created,void 0,n);if(t.revoked||await a.isRevoked(t,f.keyPacket,i,n))throw Error("User certificate is revoked");try{await t.verify(f.keyPacket,v.signature.certGeneric,o,i,void 0,n)}catch(m){throw x.wrapError("User certificate is invalid",m)}})),!0)}async verifyAllCertifications(t,r=new Date,i){const n=this,a=this.selfCertifications.concat(this.otherCertifications);return Promise.all(a.map(async s=>({keyID:s.issuerKeyID,valid:await n.verifyCertificate(s,t,r,i).catch(()=>!1)})))}async verify(t=new Date,r){if(!this.selfCertifications.length)throw Error("No self-certifications found");const i=this,n=this.mainKey.keyPacket,a={userID:this.userID,userAttribute:this.userAttribute,key:n};let s;for(let o=this.selfCertifications.length-1;o>=0;o--)try{const u=this.selfCertifications[o];if(u.revoked||await i.isRevoked(u,void 0,t,r))throw Error("Self-certification is revoked");try{await u.verify(n,v.signature.certGeneric,a,t,void 0,r)}catch(c){throw x.wrapError("Self-certification is invalid",c)}return!0}catch(u){s=u}throw s}async update(t,r,i){const n=this.mainKey.keyPacket,a={userID:this.userID,userAttribute:this.userAttribute,key:n};await Wi(t,this,"selfCertifications",r,async function(s){try{return await s.verify(n,v.signature.certGeneric,a,r,!1,i),!0}catch{return!1}}),await Wi(t,this,"otherCertifications",r),await Wi(t,this,"revocationSignatures",r,function(s){return vn(n,v.signature.certRevocation,a,[s],void 0,void 0,r,i)})}}class _n{constructor(t,r){this.keyPacket=t,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=r}toPacketList(){const t=new Zt;return t.push(this.keyPacket),t.push(...this.revocationSignatures),t.push(...this.bindingSignatures),t}clone(){const t=new _n(this.keyPacket,this.mainKey);return t.bindingSignatures=[...this.bindingSignatures],t.revocationSignatures=[...this.revocationSignatures],t}async isRevoked(t,r,i=new Date,n=vt){const a=this.mainKey.keyPacket;return vn(a,v.signature.subkeyRevocation,{key:a,bind:this.keyPacket},this.revocationSignatures,t,r,i,n)}async verify(t=new Date,r=vt){const i=this.mainKey.keyPacket,n={key:i,bind:this.keyPacket},a=await br(this.bindingSignatures,i,v.signature.subkeyBinding,n,t,r);if(a.revoked||await this.isRevoked(a,null,t,r))throw Error("Subkey is revoked");if(Jo(this.keyPacket,a,t))throw Error("Subkey is expired");return a}async getExpirationTime(t=new Date,r=vt){const i=this.mainKey.keyPacket,n={key:i,bind:this.keyPacket};let a;try{a=await br(this.bindingSignatures,i,v.signature.subkeyBinding,n,t,r)}catch{return null}const s=gs(this.keyPacket,a),o=a.getExpirationTime();return s<o?s:o}async update(t,r=new Date,i=vt){const n=this.mainKey.keyPacket;if(!this.hasSameFingerprintAs(t))throw Error("Subkey update method: fingerprints of subkeys not equal");this.keyPacket.constructor.tag===v.packet.publicSubkey&&t.keyPacket.constructor.tag===v.packet.secretSubkey&&(this.keyPacket=t.keyPacket);const a=this,s={key:n,bind:a.keyPacket};await Wi(t,this,"bindingSignatures",r,async function(o){for(let u=0;u<a.bindingSignatures.length;u++)if(a.bindingSignatures[u].issuerKeyID.equals(o.issuerKeyID))return o.created>a.bindingSignatures[u].created&&(a.bindingSignatures[u]=o),!1;try{return await o.verify(n,v.signature.subkeyBinding,s,r,void 0,i),!0}catch{return!1}}),await Wi(t,this,"revocationSignatures",r,function(o){return vn(n,v.signature.subkeyRevocation,s,[o],void 0,void 0,r,i)})}async revoke(t,{flag:r=v.reasonForRevocation.noReason,string:i=""}={},n=new Date,a=vt){const s={key:t,bind:this.keyPacket},o=new _n(this.keyPacket,this.mainKey);return o.revocationSignatures.push(await Mn(s,null,t,{signatureType:v.signature.subkeyRevocation,reasonForRevocationFlag:v.write(v.reasonForRevocation,r),reasonForRevocationString:i},n,void 0,!1,a)),await o.update(this),o}hasSameFingerprintAs(t){return this.keyPacket.hasSameFingerprintAs(t.keyPacket||t)}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach(e=>{_n.prototype[e]=function(){return this.keyPacket[e]()}});const Oh=x.constructAllowedPackets([ge]),s2=new Set([v.packet.publicKey,v.packet.privateKey]),o2=new Set([v.packet.publicKey,v.packet.privateKey,v.packet.publicSubkey,v.packet.privateSubkey]);class zc{packetListToStructure(t,r=new Set){let i,n,a,s;for(const o of t){if(o instanceof Ho){o2.has(o.tag)&&!s&&(s=s2.has(o.tag)?s2:o2);continue}const u=o.constructor.tag;if(s){if(!s.has(u))continue;s=null}if(r.has(u))throw Error("Unexpected packet type: "+u);switch(u){case v.packet.publicKey:case v.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=o,n=this.getKeyID(),!n)throw Error("Missing Key ID");break;case v.packet.userID:case v.packet.userAttribute:i=new ws(o,this),this.users.push(i);break;case v.packet.publicSubkey:case v.packet.secretSubkey:i=null,a=new _n(o,this),this.subkeys.push(a);break;case v.packet.signature:switch(o.signatureType){case v.signature.certGeneric:case v.signature.certPersona:case v.signature.certCasual:case v.signature.certPositive:if(!i){x.printDebug("Dropping certification signatures without preceding user packet");continue}o.issuerKeyID.equals(n)?i.selfCertifications.push(o):i.otherCertifications.push(o);break;case v.signature.certRevocation:i?i.revocationSignatures.push(o):this.directSignatures.push(o);break;case v.signature.key:this.directSignatures.push(o);break;case v.signature.subkeyBinding:if(!a){x.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}a.bindingSignatures.push(o);break;case v.signature.keyRevocation:this.revocationSignatures.push(o);break;case v.signature.subkeyRevocation:if(!a){x.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}a.revocationSignatures.push(o)}}}}toPacketList(){const t=new Zt;return t.push(this.keyPacket),t.push(...this.revocationSignatures),t.push(...this.directSignatures),this.users.map(r=>t.push(...r.toPacketList())),this.subkeys.map(r=>t.push(...r.toPacketList())),t}clone(t=!1){const r=new this.constructor(this.toPacketList());return t&&r.getKeys().forEach(i=>{if(i.keyPacket=Object.create(Object.getPrototypeOf(i.keyPacket),Object.getOwnPropertyDescriptors(i.keyPacket)),!i.keyPacket.isDecrypted())return;const n={};Object.keys(i.keyPacket.privateParams).forEach(a=>{n[a]=new Uint8Array(i.keyPacket.privateParams[a])}),i.keyPacket.privateParams=n}),r}getSubkeys(t=null){return this.subkeys.filter(r=>!t||r.getKeyID().equals(t,!0))}getKeys(t=null){const r=[];return t&&!this.getKeyID().equals(t,!0)||r.push(this),r.concat(this.getSubkeys(t))}getKeyIDs(){return this.getKeys().map(t=>t.getKeyID())}getUserIDs(){return this.users.map(t=>t.userID?t.userID.userID:null).filter(t=>t!==null)}write(){return this.toPacketList().write()}async getSigningKey(t=null,r=new Date,i={},n=vt){await this.verifyPrimaryKey(r,i,n);const a=this.keyPacket,s=this.subkeys.slice().sort((u,c)=>c.keyPacket.created-u.keyPacket.created);let o;for(const u of s)if(!t||u.getKeyID().equals(t))try{await u.verify(r,n);const c={key:a,bind:u.keyPacket},h=await br(u.bindingSignatures,a,v.signature.subkeyBinding,c,r,n);if(!i2(u.keyPacket,h))continue;if(!h.embeddedSignature)throw Error("Missing embedded signature");return await br([h.embeddedSignature],u.keyPacket,v.signature.keyBinding,c,r,n),cn(u.keyPacket,n),u}catch(c){o=c}try{const u=await this.getPrimaryUser(r,i,n);if((!t||a.getKeyID().equals(t))&&i2(a,u.selfCertification))return cn(a,n),this}catch(u){o=u}throw x.wrapError("Could not find valid signing key packet in key "+this.getKeyID().toHex(),o)}async getEncryptionKey(t,r=new Date,i={},n=vt){await this.verifyPrimaryKey(r,i,n);const a=this.keyPacket,s=this.subkeys.slice().sort((u,c)=>c.keyPacket.created-u.keyPacket.created);let o;for(const u of s)if(!t||u.getKeyID().equals(t))try{await u.verify(r,n);const c={key:a,bind:u.keyPacket},h=await br(u.bindingSignatures,a,v.signature.subkeyBinding,c,r,n);if(n2(u.keyPacket,h))return cn(u.keyPacket,n),u}catch(c){o=c}try{const u=await this.getPrimaryUser(r,i,n);if((!t||a.getKeyID().equals(t))&&n2(a,u.selfCertification))return cn(a,n),this}catch(u){o=u}throw x.wrapError("Could not find valid encryption key packet in key "+this.getKeyID().toHex(),o)}async isRevoked(t,r,i=new Date,n=vt){return vn(this.keyPacket,v.signature.keyRevocation,{key:this.keyPacket},this.revocationSignatures,t,r,i,n)}async verifyPrimaryKey(t=new Date,r={},i=vt){const n=this.keyPacket;if(await this.isRevoked(null,null,t,i))throw Error("Primary key is revoked");const{selfCertification:a}=await this.getPrimaryUser(t,r,i);if(Jo(n,a,t))throw Error("Primary key is expired");const s=await br(this.directSignatures,n,v.signature.key,{key:n},t,i).catch(()=>{});if(s&&Jo(n,s,t))throw Error("Primary key is expired")}async getExpirationTime(t,r=vt){let i;try{const{selfCertification:n}=await this.getPrimaryUser(null,t,r),a=gs(this.keyPacket,n),s=n.getExpirationTime(),o=await br(this.directSignatures,this.keyPacket,v.signature.key,{key:this.keyPacket},null,r).catch(()=>{});if(o){const u=gs(this.keyPacket,o);i=Math.min(a,s,u)}else i=a<s?a:s}catch{i=null}return x.normalizeDate(i)}async getPrimaryUser(t=new Date,r={},i=vt){const n=this.keyPacket,a=[];let s;for(let h=0;h<this.users.length;h++)try{const f=this.users[h];if(!f.userID)continue;if(r.name!==void 0&&f.userID.name!==r.name||r.email!==void 0&&f.userID.email!==r.email||r.comment!==void 0&&f.userID.comment!==r.comment)throw Error("Could not find user that matches that user ID");const m={userID:f.userID,key:n},y=await br(f.selfCertifications,n,v.signature.certGeneric,m,t,i);a.push({index:h,user:f,selfCertification:y})}catch(f){s=f}if(!a.length)throw s||Error("Could not find primary user");await Promise.all(a.map(async function(h){return h.user.revoked||h.user.isRevoked(h.selfCertification,null,t,i)}));const o=a.sort(function(h,f){const m=h.selfCertification,y=f.selfCertification;return y.revoked-m.revoked||m.isPrimaryUserID-y.isPrimaryUserID||m.created-y.created}).pop(),{user:u,selfCertification:c}=o;if(c.revoked||await u.isRevoked(c,null,t,i))throw Error("Primary user is revoked");return o}async update(t,r=new Date,i=vt){if(!this.hasSameFingerprintAs(t))throw Error("Primary key fingerprints must be equal to update the key");if(!this.isPrivate()&&t.isPrivate()){if(!(this.subkeys.length===t.subkeys.length&&this.subkeys.every(a=>t.subkeys.some(s=>a.hasSameFingerprintAs(s)))))throw Error("Cannot update public key with private key if subkeys mismatch");return t.update(this,i)}const n=this.clone();return await Wi(t,n,"revocationSignatures",r,a=>vn(n.keyPacket,v.signature.keyRevocation,n,[a],null,t.keyPacket,r,i)),await Wi(t,n,"directSignatures",r),await Promise.all(t.users.map(async a=>{const s=n.users.filter(o=>a.userID&&a.userID.equals(o.userID)||a.userAttribute&&a.userAttribute.equals(o.userAttribute));if(s.length>0)await Promise.all(s.map(o=>o.update(a,r,i)));else{const o=a.clone();o.mainKey=n,n.users.push(o)}})),await Promise.all(t.subkeys.map(async a=>{const s=n.subkeys.filter(o=>o.hasSameFingerprintAs(a));if(s.length>0)await Promise.all(s.map(o=>o.update(a,r,i)));else{const o=a.clone();o.mainKey=n,n.subkeys.push(o)}})),n}async getRevocationCertificate(t=new Date,r=vt){const i={key:this.keyPacket},n=await br(this.revocationSignatures,this.keyPacket,v.signature.keyRevocation,i,t,r),a=new Zt;return a.push(n),Sn(v.armor.publicKey,a.write(),null,null,"This is a revocation certificate")}async applyRevocationCertificate(t,r=new Date,i=vt){const n=await ga(t,i),a=(await Zt.fromBinary(n.data,Oh,i)).findPacket(v.packet.signature);if(!a||a.signatureType!==v.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!a.issuerKeyID.equals(this.getKeyID()))throw Error("Revocation signature does not match key");try{await a.verify(this.keyPacket,v.signature.keyRevocation,{key:this.keyPacket},r,void 0,i)}catch(o){throw x.wrapError("Could not verify revocation signature",o)}const s=this.clone();return s.revocationSignatures.push(a),s}async signPrimaryUser(t,r,i,n=vt){const{index:a,user:s}=await this.getPrimaryUser(r,i,n),o=await s.certify(t,r,n),u=this.clone();return u.users[a]=o,u}async signAllUsers(t,r=new Date,i=vt){const n=this.clone();return n.users=await Promise.all(this.users.map(function(a){return a.certify(t,r,i)})),n}async verifyPrimaryUser(t,r=new Date,i,n=vt){const a=this.keyPacket,{user:s}=await this.getPrimaryUser(r,i,n);return t?await s.verifyAllCertifications(t,r,n):[{keyID:a.getKeyID(),valid:await s.verify(r,n).catch(()=>!1)}]}async verifyAllUsers(t,r=new Date,i=vt){const n=this.keyPacket,a=[];return await Promise.all(this.users.map(async s=>{const o=t?await s.verifyAllCertifications(t,r,i):[{keyID:n.getKeyID(),valid:await s.verify(r,i).catch(()=>!1)}];a.push(...o.map(u=>({userID:s.userID.userID,keyID:u.keyID,valid:u.valid})))})),a}}function Nh(e){for(const t of e)switch(t.constructor.tag){case v.packet.secretKey:return new Pa(e);case v.packet.publicKey:return new r0(e)}throw Error("No key packet found")}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach(e=>{zc.prototype[e]=_n.prototype[e]});class r0 extends zc{constructor(t){if(super(),this.keyPacket=null,this.revocationSignatures=[],this.directSignatures=[],this.users=[],this.subkeys=[],t&&(this.packetListToStructure(t,new Set([v.packet.secretKey,v.packet.secretSubkey])),!this.keyPacket))throw Error("Invalid key: missing public-key packet")}isPrivate(){return!1}toPublic(){return this}armor(t=vt){return Sn(v.armor.publicKey,this.toPacketList().write(),void 0,void 0,void 0,t)}}class Pa extends r0{constructor(t){if(super(),this.packetListToStructure(t,new Set([v.packet.publicKey,v.packet.publicSubkey])),!this.keyPacket)throw Error("Invalid key: missing private-key packet")}isPrivate(){return!0}toPublic(){const t=new Zt,r=this.toPacketList();for(const i of r)switch(i.constructor.tag){case v.packet.secretKey:{const n=Qe.fromSecretKeyPacket(i);t.push(n);break}case v.packet.secretSubkey:{const n=Ea.fromSecretSubkeyPacket(i);t.push(n);break}default:t.push(i)}return new r0(t)}armor(t=vt){return Sn(v.armor.privateKey,this.toPacketList().write(),void 0,void 0,void 0,t)}async getDecryptionKeys(t,r=new Date,i={},n=vt){const a=this.keyPacket,s=[];for(let u=0;u<this.subkeys.length;u++)if(!t||this.subkeys[u].getKeyID().equals(t,!0))try{const c={key:a,bind:this.subkeys[u].keyPacket};a2(await br(this.subkeys[u].bindingSignatures,a,v.signature.subkeyBinding,c,r,n),n)&&s.push(this.subkeys[u])}catch{}const o=await this.getPrimaryUser(r,i,n);return t&&!a.getKeyID().equals(t,!0)||!a2(o.selfCertification,n)||s.push(this),s}isDecrypted(){return this.getKeys().some(({keyPacket:t})=>t.isDecrypted())}async validate(t=vt){if(!this.isPrivate())throw Error("Cannot validate a public key");let r;if(this.keyPacket.isDummy()){const i=await this.getSigningKey(null,null,void 0,{...t,rejectPublicKeyAlgorithms:new Set,minRSABits:0});i&&!i.keyPacket.isDummy()&&(r=i.keyPacket)}else r=this.keyPacket;if(r)return r.validate();{const i=this.getKeys();if(i.map(n=>n.keyPacket.isDummy()).every(Boolean))throw Error("Cannot validate an all-gnu-dummy key");return Promise.all(i.map(async n=>n.keyPacket.validate()))}}clearPrivateParams(){this.getKeys().forEach(({keyPacket:t})=>{t.isDecrypted()&&t.clearPrivateParams()})}async revoke({flag:t=v.reasonForRevocation.noReason,string:r=""}={},i=new Date,n=vt){if(!this.isPrivate())throw Error("Need private key for revoking");const a={key:this.keyPacket},s=this.clone();return s.revocationSignatures.push(await Mn(a,null,this.keyPacket,{signatureType:v.signature.keyRevocation,reasonForRevocationFlag:v.write(v.reasonForRevocation,t),reasonForRevocationString:r},i,void 0,void 0,n)),s}async addSubkey(t={}){const r={...vt,...t.config};if(t.passphrase)throw Error("Subkey could not be encrypted here, please encrypt whole key");if(t.rsaBits<r.minRSABits)throw Error(`rsaBits should be at least ${r.minRSABits}, got: ${t.rsaBits}`);const i=this.keyPacket;if(i.isDummy())throw Error("Cannot add subkey to gnu-dummy primary key");if(!i.isDecrypted())throw Error("Key is not decrypted");const n=i.getAlgorithmInfo();n.type=n.curve?"ecc":"rsa",n.rsaBits=n.bits||4096,n.curve=n.curve||"curve25519",t=e0(t,n);const a=await Bc(t);cn(a,r);const s=await Tc(a,i,t,r),o=this.toPacketList();return o.push(a,s),new Pa(o)}}const qc=x.constructAllowedPackets([Qe,Ea,Zs,E0,Ys,S0,ge]);async function Lh(e,t,r,i){r.passphrase&&await e.encrypt(r.passphrase,i),await Promise.all(t.map(async function(s,o){const u=r.subkeys[o].passphrase;u&&await s.encrypt(u,i)}));const n=new Zt;n.push(e),await Promise.all(r.userIDs.map(async function(s,o){function u(m,y){return[y,...m.filter(K=>K!==y)]}const c=Ys.fromObject(s),h={};h.userID=c,h.key=e;const f=new ge;return f.signatureType=v.signature.certGeneric,f.publicKeyAlgorithm=e.algorithm,f.hashAlgorithm=await Xs(null,e,void 0,void 0,i),f.keyFlags=[v.keyFlags.certifyKeys|v.keyFlags.signData],f.preferredSymmetricAlgorithms=u([v.symmetric.aes256,v.symmetric.aes128,v.symmetric.aes192],i.preferredSymmetricAlgorithm),i.aeadProtect&&(f.preferredAEADAlgorithms=u([v.aead.eax,v.aead.ocb],i.preferredAEADAlgorithm)),f.preferredHashAlgorithms=u([v.hash.sha256,v.hash.sha512],i.preferredHashAlgorithm),f.preferredCompressionAlgorithms=u([v.compression.zlib,v.compression.zip,v.compression.uncompressed],i.preferredCompressionAlgorithm),o===0&&(f.isPrimaryUserID=!0),f.features=[0],f.features[0]|=v.features.modificationDetection,i.aeadProtect&&(f.features[0]|=v.features.aead),i.v5Keys&&(f.features[0]|=v.features.v5Keys),r.keyExpirationTime>0&&(f.keyExpirationTime=r.keyExpirationTime,f.keyNeverExpires=!1),await f.sign(e,h,r.date),{userIDPacket:c,signaturePacket:f}})).then(s=>{s.forEach(({userIDPacket:o,signaturePacket:u})=>{n.push(o),n.push(u)})}),await Promise.all(t.map(async function(s,o){const u=r.subkeys[o];return{secretSubkeyPacket:s,subkeySignaturePacket:await Tc(s,e,u,i)}})).then(s=>{s.forEach(({secretSubkeyPacket:o,subkeySignaturePacket:u})=>{n.push(o),n.push(u)})});const a={key:e};return n.push(await Mn(a,null,e,{signatureType:v.signature.keyRevocation,reasonForRevocationFlag:v.reasonForRevocation.noReason,reasonForRevocationString:""},r.date,void 0,void 0,i)),r.passphrase&&e.clearPrivateParams(),await Promise.all(t.map(async function(s,o){r.subkeys[o].passphrase&&s.clearPrivateParams()})),new Pa(n)}async function Hd({armoredKey:e,binaryKey:t,config:r,...i}){if(r={...vt,...r},!e&&!t)throw Error("readKey: must pass options object containing `armoredKey` or `binaryKey`");if(e&&!x.isString(e))throw Error("readKey: options.armoredKey must be a string");if(t&&!x.isUint8Array(t))throw Error("readKey: options.binaryKey must be a Uint8Array");const n=Object.keys(i);if(n.length>0)throw Error("Unknown option: "+n.join(", "));let a;if(e){const{type:s,data:o}=await ga(e,r);if(s!==v.armor.publicKey&&s!==v.armor.privateKey)throw Error("Armored text not of type key");a=o}else a=t;return Nh(await Zt.fromBinary(a,qc,r))}async function Gd({armoredKey:e,binaryKey:t,config:r,...i}){if(r={...vt,...r},!e&&!t)throw Error("readPrivateKey: must pass options object containing `armoredKey` or `binaryKey`");if(e&&!x.isString(e))throw Error("readPrivateKey: options.armoredKey must be a string");if(t&&!x.isUint8Array(t))throw Error("readPrivateKey: options.binaryKey must be a Uint8Array");const n=Object.keys(i);if(n.length>0)throw Error("Unknown option: "+n.join(", "));let a;if(e){const{type:o,data:u}=await ga(e,r);if(o!==v.armor.privateKey)throw Error("Armored text not of type private key");a=u}else a=t;const s=await Zt.fromBinary(a,qc,r);return new Pa(s)}const jh=x.constructAllowedPackets([Ei,Sa,$s,Uc,zh,Qo,wn,tr,ge]),Wh=x.constructAllowedPackets([wn]),Hh=x.constructAllowedPackets([ge]);class Le{constructor(t){this.packets=t||new Zt}getEncryptionKeyIDs(){const t=[];return this.packets.filterByTag(v.packet.publicKeyEncryptedSessionKey).forEach(function(r){t.push(r.publicKeyID)}),t}getSigningKeyIDs(){const t=this.unwrapCompressed(),r=t.packets.filterByTag(v.packet.onePassSignature);return r.length>0?r.map(i=>i.issuerKeyID):t.packets.filterByTag(v.packet.signature).map(i=>i.issuerKeyID)}async decrypt(t,r,i,n=new Date,a=vt){const s=i||await this.decryptSessionKeys(t,r,n,a),o=this.packets.filterByTag(v.packet.symmetricallyEncryptedData,v.packet.symEncryptedIntegrityProtectedData,v.packet.aeadEncryptedData);if(o.length===0)throw Error("No encrypted data found");const u=o[0];let c=null;const h=Promise.all(s.map(async({algorithm:m,data:y})=>{if(!x.isUint8Array(y)||!x.isString(m))throw Error("Invalid session key for decryption.");try{const K=v.write(v.symmetric,m);await u.decrypt(K,y,a)}catch(K){x.printDebugError(K),c=K}}));if(Oo(u.encrypted),u.encrypted=null,await h,!u.packets||!u.packets.length)throw c||Error("Decryption failed.");const f=new Le(u.packets);return u.packets=new Zt,f}async decryptSessionKeys(t,r,i=new Date,n=vt){let a,s=[];if(r){const o=this.packets.filterByTag(v.packet.symEncryptedSessionKey);if(o.length===0)throw Error("No symmetrically encrypted session key packet found.");await Promise.all(r.map(async function(u,c){let h;h=c?await Zt.fromBinary(o.write(),Wh,n):o,await Promise.all(h.map(async function(f){try{await f.decrypt(u),s.push(f)}catch(m){x.printDebugError(m)}}))}))}else{if(!t)throw Error("No key or password specified.");{const o=this.packets.filterByTag(v.packet.publicKeyEncryptedSessionKey);if(o.length===0)throw Error("No public key encrypted session key packet found.");await Promise.all(o.map(async function(u){await Promise.all(t.map(async function(c){let h=[v.symmetric.aes256,v.symmetric.aes128,v.symmetric.tripledes,v.symmetric.cast5];try{const m=await c.getPrimaryUser(i,void 0,n);m.selfCertification.preferredSymmetricAlgorithms&&(h=h.concat(m.selfCertification.preferredSymmetricAlgorithms))}catch{}const f=(await c.getDecryptionKeys(u.publicKeyID,null,void 0,n)).map(m=>m.keyPacket);await Promise.all(f.map(async function(m){if(!(!m||m.isDummy())){if(!m.isDecrypted())throw Error("Decryption key is not decrypted.");if(n.constantTimePKCS1Decryption&&(u.publicKeyAlgorithm===v.publicKey.rsaEncrypt||u.publicKeyAlgorithm===v.publicKey.rsaEncryptSign||u.publicKeyAlgorithm===v.publicKey.rsaSign||u.publicKeyAlgorithm===v.publicKey.elgamal)){const y=u.write();await Promise.all(Array.from(n.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms).map(async K=>{const I=new Qo;I.read(y);const U={sessionKeyAlgorithm:K,sessionKey:await At.generateSessionKey(K)};try{await I.decrypt(m,U),s.push(I)}catch(V){x.printDebugError(V),a=V}}))}else try{if(await u.decrypt(m),!h.includes(v.write(v.symmetric,u.sessionKeyAlgorithm)))throw Error("A non-preferred symmetric algorithm was used.");s.push(u)}catch(y){x.printDebugError(y),a=y}}}))})),Oo(u.encrypted),u.encrypted=null}))}}if(s.length>0){if(s.length>1){const o=new Set;s=s.filter(u=>{const c=u.sessionKeyAlgorithm+x.uint8ArrayToString(u.sessionKey);return!o.has(c)&&(o.add(c),!0)})}return s.map(o=>({data:o.sessionKey,algorithm:v.read(v.symmetric,o.sessionKeyAlgorithm)}))}throw a||Error("Session key decryption failed.")}getLiteralData(){const t=this.unwrapCompressed().packets.findPacket(v.packet.literalData);return t&&t.getBytes()||null}getFilename(){const t=this.unwrapCompressed().packets.findPacket(v.packet.literalData);return t&&t.getFilename()||null}getText(){const t=this.unwrapCompressed().packets.findPacket(v.packet.literalData);return t?t.getText():null}static async generateSessionKey(t=[],r=new Date,i=[],n=vt){const a=await t0("symmetric",t,r,i,n),s=v.read(v.symmetric,a),o=n.aeadProtect&&await async function(u,c=new Date,h=[],f=vt){let m=!0;return await Promise.all(u.map(async function(y,K){const I=await y.getPrimaryUser(c,h[K],f);I.selfCertification.features&&I.selfCertification.features[0]&v.features.aead||(m=!1)})),m}(t,r,i,n)?v.read(v.aead,await t0("aead",t,r,i,n)):void 0;return{data:await At.generateSessionKey(a),algorithm:s,aeadAlgorithm:o}}async encrypt(t,r,i,n=!1,a=[],s=new Date,o=[],u=vt){if(i){if(!x.isUint8Array(i.data)||!x.isString(i.algorithm))throw Error("Invalid session key for encryption.")}else if(t&&t.length)i=await Le.generateSessionKey(t,s,o,u);else{if(!r||!r.length)throw Error("No keys, passwords, or session key provided.");i=await Le.generateSessionKey(void 0,void 0,void 0,u)}const{data:c,algorithm:h,aeadAlgorithm:f}=i,m=await Le.encryptSessionKey(c,h,f,t,r,n,a,s,o,u);let y;f?(y=new $s,y.aeadAlgorithm=v.write(v.aead,f)):y=new Uc,y.packets=this.packets;const K=v.write(v.symmetric,h);return await y.encrypt(K,c,u),m.packets.push(y),y.packets=new Zt,m}static async encryptSessionKey(t,r,i,n,a,s=!1,o=[],u=new Date,c=[],h=vt){const f=new Zt,m=v.write(v.symmetric,r),y=i&&v.write(v.aead,i);if(n){const K=await Promise.all(n.map(async function(I,U){const V=await I.getEncryptionKey(o[U],u,c,h),Z=new Qo;return Z.publicKeyID=s?Ai.wildcard():V.getKeyID(),Z.publicKeyAlgorithm=V.keyPacket.algorithm,Z.sessionKey=t,Z.sessionKeyAlgorithm=m,await Z.encrypt(V.keyPacket),delete Z.sessionKey,Z}));f.push(...K)}if(a){const K=async function(Z,$){try{return await Z.decrypt($),1}catch{return 0}},I=(Z,$)=>Z+$,U=async function(Z,$,R,tt){const X=new wn(h);return X.sessionKey=Z,X.sessionKeyAlgorithm=$,R&&(X.aeadAlgorithm=R),await X.encrypt(tt,h),h.passwordCollisionCheck&&(await Promise.all(a.map(Q=>K(X,Q)))).reduce(I)!==1?U(Z,$,tt):(delete X.sessionKey,X)},V=await Promise.all(a.map(Z=>U(t,m,y,Z)));f.push(...V)}return new Le(f)}async sign(t=[],r=null,i=[],n=new Date,a=[],s=vt){const o=new Zt,u=this.packets.findPacket(v.packet.literalData);if(!u)throw Error("No literal data packet to sign.");let c,h;const f=u.text===null?v.signature.binary:v.signature.text;if(r)for(h=r.packets.filterByTag(v.packet.signature),c=h.length-1;c>=0;c--){const m=h[c],y=new tr;y.signatureType=m.signatureType,y.hashAlgorithm=m.hashAlgorithm,y.publicKeyAlgorithm=m.publicKeyAlgorithm,y.issuerKeyID=m.issuerKeyID,t.length||c!==0||(y.flags=1),o.push(y)}return await Promise.all(Array.from(t).reverse().map(async function(m,y){if(!m.isPrivate())throw Error("Need private key for signing");const K=i[t.length-1-y],I=await m.getSigningKey(K,n,a,s),U=new tr;return U.signatureType=f,U.hashAlgorithm=await Xs(m,I.keyPacket,n,a,s),U.publicKeyAlgorithm=I.keyPacket.algorithm,U.issuerKeyID=I.getKeyID(),y===t.length-1&&(U.flags=1),U})).then(m=>{m.forEach(y=>o.push(y))}),o.push(u),o.push(...await i0(u,t,r,i,n,a,!1,s)),new Le(o)}compress(t,r=vt){if(t===v.compression.uncompressed)return this;const i=new Sa(r);i.algorithm=t,i.packets=this.packets;const n=new Zt;return n.push(i),new Le(n)}async signDetached(t=[],r=null,i=[],n=new Date,a=[],s=vt){const o=this.packets.findPacket(v.packet.literalData);if(!o)throw Error("No literal data packet to sign.");return new ra(await i0(o,t,r,i,n,a,!0,s))}async verify(t,r=new Date,i=vt){const n=this.unwrapCompressed(),a=n.packets.filterByTag(v.packet.literalData);if(a.length!==1)throw Error("Can only verify message with one literal data packet.");se(n.packets.stream)&&n.packets.push(...await ae(n.packets.stream,u=>u||[]));const s=n.packets.filterByTag(v.packet.onePassSignature).reverse(),o=n.packets.filterByTag(v.packet.signature);return s.length&&!o.length&&x.isStream(n.packets.stream)&&!se(n.packets.stream)?(await Promise.all(s.map(async u=>{u.correspondingSig=new Promise((c,h)=>{u.correspondingSigResolve=c,u.correspondingSigReject=h}),u.signatureData=Jr(async()=>(await u.correspondingSig).signatureData),u.hashed=ae(await u.hash(u.signatureType,a[0],void 0,!1)),u.hashed.catch(()=>{})})),n.packets.stream=Rr(n.packets.stream,async(u,c)=>{const h=Ur(u),f=qe(c);try{for(let m=0;m<s.length;m++){const{value:y}=await h.read();s[m].correspondingSigResolve(y)}await h.readToEnd(),await f.ready,await f.close()}catch(m){s.forEach(y=>{y.correspondingSigReject(m)}),await f.abort(m)}}),Xa(s,a,t,r,!1,i)):Xa(o,a,t,r,!1,i)}verifyDetached(t,r,i=new Date,n=vt){const a=this.unwrapCompressed().packets.filterByTag(v.packet.literalData);if(a.length!==1)throw Error("Can only verify message with one literal data packet.");return Xa(t.packets,a,r,i,!0,n)}unwrapCompressed(){const t=this.packets.filterByTag(v.packet.compressedData);return t.length?new Le(t[0].packets):this}async appendSignature(t,r=vt){await this.packets.read(x.isUint8Array(t)?t:(await ga(t)).data,Hh,r)}write(){return this.packets.write()}armor(t=vt){return Sn(v.armor.message,this.write(),null,null,null,t)}}async function i0(e,t,r=null,i=[],n=new Date,a=[],s=!1,o=vt){const u=new Zt,c=e.text===null?v.signature.binary:v.signature.text;if(await Promise.all(t.map(async(h,f)=>{const m=a[f];if(!h.isPrivate())throw Error("Need private key for signing");const y=await h.getSigningKey(i[f],n,m,o);return Mn(e,h,y.keyPacket,{signatureType:c},n,m,s,o)})).then(h=>{u.push(...h)}),r){const h=r.packets.filterByTag(v.packet.signature);u.push(...h)}return u}async function Xa(e,t,r,i=new Date,n=!1,a=vt){return Promise.all(e.filter(function(s){return["text","binary"].includes(v.read(v.signature,s.signatureType))}).map(async function(s){return async function(o,u,c,h=new Date,f=!1,m=vt){let y,K;for(const V of c){const Z=V.getKeys(o.issuerKeyID);if(Z.length>0){y=V,K=Z[0];break}}const I=o instanceof tr?o.correspondingSig:o,U={keyID:o.issuerKeyID,verified:(async()=>{if(!K)throw Error("Could not find signing key with key ID "+o.issuerKeyID.toHex());await o.verify(K.keyPacket,o.signatureType,u[0],h,f,m);const V=await I;if(K.getCreationTime()>V.created)throw Error("Key is newer than the signature");try{await y.getSigningKey(K.getKeyID(),V.created,void 0,m)}catch(Z){if(!m.allowInsecureVerificationWithReformattedKeys||!Z.message.match(/Signature creation time is in the future/))throw Z;await y.getSigningKey(K.getKeyID(),h,void 0,m)}return!0})(),signature:(async()=>{const V=await I,Z=new Zt;return V&&Z.push(V),new ra(Z)})()};return U.signature.catch(()=>{}),U.verified.catch(()=>{}),U}(s,t,r,i,n,a)}))}async function Vd({armoredMessage:e,binaryMessage:t,config:r,...i}){r={...vt,...r};let n=e||t;if(!n)throw Error("readMessage: must pass options object containing `armoredMessage` or `binaryMessage`");if(e&&!x.isString(e)&&!x.isStream(e))throw Error("readMessage: options.armoredMessage must be a string or stream");if(t&&!x.isUint8Array(t)&&!x.isStream(t))throw Error("readMessage: options.binaryMessage must be a Uint8Array or stream");const a=Object.keys(i);if(a.length>0)throw Error("Unknown option: "+a.join(", "));const s=x.isStream(n);if(s&&(await L2(),n=ma(n)),e){const{type:c,data:h}=await ga(n,r);if(c!==v.armor.message)throw Error("Armored text not of type message");n=h}const o=await Zt.fromBinary(n,jh,r),u=new Le(o);return u.fromStream=s,u}async function $d({text:e,binary:t,filename:r,date:i=new Date,format:n=e!==void 0?"utf8":"binary",...a}){let s=e!==void 0?e:t;if(s===void 0)throw Error("createMessage: must pass options object containing `text` or `binary`");if(e&&!x.isString(e)&&!x.isStream(e))throw Error("createMessage: options.text must be a string or stream");if(t&&!x.isUint8Array(t)&&!x.isStream(t))throw Error("createMessage: options.binary must be a Uint8Array or stream");const o=Object.keys(a);if(o.length>0)throw Error("Unknown option: "+o.join(", "));const u=x.isStream(s);u&&(await L2(),s=ma(s));const c=new Ei(i);e!==void 0?c.setText(s,v.write(v.literal,n)):c.setBytes(s,v.write(v.literal,n)),r!==void 0&&c.setFilename(r);const h=new Zt;h.push(c);const f=new Le(h);return f.fromStream=u,f}class Yi{constructor(t,r){if(this.text=x.removeTrailingSpaces(t).replace(/\r?\n/g,`\r
`),r&&!(r instanceof ra))throw Error("Invalid signature input");this.signature=r||new ra(new Zt)}getSigningKeyIDs(){const t=[];return this.signature.packets.forEach(function(r){t.push(r.issuerKeyID)}),t}async sign(t,r=null,i=[],n=new Date,a=[],s=vt){const o=new Ei;o.setText(this.text);const u=new ra(await i0(o,t,r,i,n,a,!0,s));return new Yi(this.text,u)}verify(t,r=new Date,i=vt){const n=this.signature.packets,a=new Ei;return a.setText(this.text),Xa(n,[a],t,r,!0,i)}getText(){return this.text.replace(/\r\n/g,`
`)}armor(t=vt){let r=this.signature.packets.map(function(n){return v.read(v.hash,n.hashAlgorithm).toUpperCase()});r=r.filter(function(n,a,s){return s.indexOf(n)===a});const i={hash:r.join(),text:this.text,data:this.signature.packets.write()};return Sn(v.armor.signed,i,void 0,void 0,void 0,t)}}async function Zd({userIDs:e=[],passphrase:t,type:r="ecc",rsaBits:i=4096,curve:n="curve25519",keyExpirationTime:a=0,date:s=new Date,subkeys:o=[{}],format:u="armored",config:c,...h}){Cn(c={...vt,...c}),e=Pe(e);const f=Object.keys(h);if(f.length>0)throw Error("Unknown option: "+f.join(", "));if(e.length===0)throw Error("UserIDs are required for key generation");if(r==="rsa"&&i<c.minRSABits)throw Error(`rsaBits should be at least ${c.minRSABits}, got: ${i}`);const m={userIDs:e,passphrase:t,type:r,rsaBits:i,curve:n,keyExpirationTime:a,date:s,subkeys:o};try{const{key:y,revocationCertificate:K}=await async function(I,U){I.sign=!0,(I=e0(I)).subkeys=I.subkeys.map((tt,X)=>e0(I.subkeys[X],I));let V=[Fh(I,U)];V=V.concat(I.subkeys.map(tt=>Bc(tt,U)));const Z=await Promise.all(V),$=await Lh(Z[0],Z.slice(1),I,U),R=await $.getRevocationCertificate(I.date,U);return $.revocationSignatures=[],{key:$,revocationCertificate:R}}(m,c);return y.getKeys().forEach(({keyPacket:I})=>cn(I,c)),{privateKey:c2(y,u,c),publicKey:c2(y.toPublic(),u,c),revocationCertificate:K}}catch(y){throw x.wrapError("Error generating keypair",y)}}async function Yd({privateKey:e,passphrase:t,config:r,...i}){Cn(r={...vt,...r});const n=Object.keys(i);if(n.length>0)throw Error("Unknown option: "+n.join(", "));if(!e.isPrivate())throw Error("Cannot decrypt a public key");const a=e.clone(!0),s=x.isArray(t)?t:[t];try{return await Promise.all(a.getKeys().map(o=>x.anyPromise(s.map(u=>o.keyPacket.decrypt(u))))),await a.validate(r),a}catch(o){throw a.clearPrivateParams(),x.wrapError("Error decrypting private key",o)}}async function Xd({message:e,encryptionKeys:t,signingKeys:r,passwords:i,sessionKey:n,format:a="armored",signature:s=null,wildcard:o=!1,signingKeyIDs:u=[],encryptionKeyIDs:c=[],date:h=new Date,signingUserIDs:f=[],encryptionUserIDs:m=[],config:y,...K}){if(Cn(y={...vt,...y}),Fc(e),Nc(a),t=Pe(t),r=Pe(r),i=Pe(i),u=Pe(u),c=Pe(c),f=Pe(f),m=Pe(m),K.detached)throw Error("The `detached` option has been removed from openpgp.encrypt, separately call openpgp.sign instead. Don't forget to remove the `privateKeys` option as well.");if(K.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encrypt, pass `encryptionKeys` instead");if(K.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.encrypt, pass `signingKeys` instead");if(K.armor!==void 0)throw Error("The `armor` option has been removed from openpgp.encrypt, pass `format` instead.");const I=Object.keys(K);if(I.length>0)throw Error("Unknown option: "+I.join(", "));r||(r=[]);const U=e.fromStream;try{if((r.length||s)&&(e=await e.sign(r,s,u,h,f,y)),e=e.compress(await t0("compression",t,h,m,y),y),e=await e.encrypt(t,i,n,o,c,h,m,y),a==="object")return e;const V=a==="armored";return Qs(V?e.armor(y):e.write(),U,V?"utf8":"binary")}catch(V){throw x.wrapError("Error encrypting message",V)}}async function Qd({message:e,decryptionKeys:t,passwords:r,sessionKeys:i,verificationKeys:n,expectSigned:a=!1,format:s="utf8",signature:o=null,date:u=new Date,config:c,...h}){if(Cn(c={...vt,...c}),Fc(e),n=Pe(n),t=Pe(t),r=Pe(r),i=Pe(i),h.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decrypt, pass `decryptionKeys` instead");if(h.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.decrypt, pass `verificationKeys` instead");const f=Object.keys(h);if(f.length>0)throw Error("Unknown option: "+f.join(", "));try{const m=await e.decrypt(t,r,i,u,c);n||(n=[]);const y={};if(y.signatures=o?await m.verifyDetached(o,n,u,c):await m.verify(n,u,c),y.data=s==="binary"?m.getLiteralData():m.getText(),y.filename=m.getFilename(),Lc(y,e),a){if(n.length===0)throw Error("Verification keys are required to verify message signatures");if(y.signatures.length===0)throw Error("Message is not signed");y.data=De([y.data,Jr(async()=>{await x.anyPromise(y.signatures.map(K=>K.verified))})])}return y.data=await Qs(y.data,e.fromStream,s),y}catch(m){throw x.wrapError("Error decrypting message",m)}}async function Jd({message:e,signingKeys:t,format:r="armored",detached:i=!1,signingKeyIDs:n=[],date:a=new Date,signingUserIDs:s=[],config:o,...u}){if(Cn(o={...vt,...o}),Oc(e),Nc(r),t=Pe(t),n=Pe(n),s=Pe(s),u.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.sign, pass `signingKeys` instead");if(u.armor!==void 0)throw Error("The `armor` option has been removed from openpgp.sign, pass `format` instead.");const c=Object.keys(u);if(c.length>0)throw Error("Unknown option: "+c.join(", "));if(e instanceof Yi&&r==="binary")throw Error("Cannot return signed cleartext message in binary format");if(e instanceof Yi&&i)throw Error("Cannot detach-sign a cleartext message");if(!t||t.length===0)throw Error("No signing keys provided");try{let h;if(h=i?await e.signDetached(t,void 0,n,a,s,o):await e.sign(t,void 0,n,a,s,o),r==="object")return h;const f=r==="armored";return h=f?h.armor(o):h.write(),i&&(h=Rr(e.packets.write(),async(m,y)=>{await Promise.all([Zr(h,y),ae(m).catch(()=>{})])})),Qs(h,e.fromStream,f?"utf8":"binary")}catch(h){throw x.wrapError("Error signing message",h)}}async function tf({message:e,verificationKeys:t,expectSigned:r=!1,format:i="utf8",signature:n=null,date:a=new Date,config:s,...o}){if(Cn(s={...vt,...s}),Oc(e),t=Pe(t),o.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.verify, pass `verificationKeys` instead");const u=Object.keys(o);if(u.length>0)throw Error("Unknown option: "+u.join(", "));if(e instanceof Yi&&i==="binary")throw Error("Can't return cleartext message data as binary");if(e instanceof Yi&&n)throw Error("Can't verify detached cleartext signature");try{const c={};if(c.signatures=n?await e.verifyDetached(n,t,a,s):await e.verify(t,a,s),c.data=i==="binary"?e.getLiteralData():e.getText(),e.fromStream&&Lc(c,e),r){if(c.signatures.length===0)throw Error("Message is not signed");c.data=De([c.data,Jr(async()=>{await x.anyPromise(c.signatures.map(h=>h.verified))})])}return c.data=await Qs(c.data,e.fromStream,i),c}catch(c){throw x.wrapError("Error verifying signed message",c)}}function Fc(e){if(!(e instanceof Le))throw Error("Parameter [message] needs to be of type Message")}function Oc(e){if(!(e instanceof Yi||e instanceof Le))throw Error("Parameter [message] needs to be of type Message or CleartextMessage")}function Nc(e){if(e!=="armored"&&e!=="binary"&&e!=="object")throw Error("Unsupported format "+e)}const Gh=Object.keys(vt).length;function Cn(e){const t=Object.keys(e);if(t.length!==Gh){for(const r of t)if(vt[r]===void 0)throw Error("Unknown config property: "+r)}}function Pe(e){return e&&!x.isArray(e)&&(e=[e]),e}async function Qs(e,t,r="utf8"){const i=x.isStream(e);return i==="array"?ae(e):t==="node"?(e=m0(e),r!=="binary"&&e.setEncoding(r),e):t==="web"&&i==="ponyfill"?O2(e):e}function Lc(e,t){e.data=Rr(t.packets.stream,async(r,i)=>{await Zr(e.data,i,{preventClose:!0});const n=qe(i);try{await ae(r,a=>a),await n.close()}catch(a){await n.abort(a)}})}function c2(e,t,r){switch(t){case"object":return e;case"armored":return e.armor(r);case"binary":return e.write();default:throw Error("Unsupported format "+t)}}const Wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function P0(){}const u2=typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:void 0;function Fe(e){return typeof e=="object"&&e!==null||typeof e=="function"}const jc=P0,x0=Promise,Vh=Promise.prototype.then,$h=Promise.resolve.bind(x0),Zh=Promise.reject.bind(x0);function Ke(e){return new x0(e)}function re(e){return $h(e)}function Ut(e){return Zh(e)}function Gr(e,t,r){return Vh.call(e,t,r)}function er(e,t,r){Gr(Gr(e,t,r),void 0,jc)}function xo(e,t){er(e,t)}function Wc(e,t){er(e,void 0,t)}function Hi(e,t,r){return Gr(e,t,r)}function xa(e){Gr(e,void 0,jc)}const Hc=(()=>{const e=u2&&u2.queueMicrotask;if(typeof e=="function")return e;const t=re(void 0);return r=>Gr(t,r)})();function Js(e,t,r){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function Ji(e,t,r){try{return re(Js(e,t,r))}catch(i){return Ut(i)}}class Ir{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(t){const r=this._back;let i=r;r._elements.length===16383&&(i={_elements:[],_next:void 0}),r._elements.push(t),i!==r&&(this._back=i,r._next=i),++this._size}shift(){const t=this._front;let r=t;const i=this._cursor;let n=i+1;const a=t._elements,s=a[i];return n===16384&&(r=t._next,n=0),--this._size,this._cursor=n,t!==r&&(this._front=r),a[i]=void 0,s}forEach(t){let r=this._cursor,i=this._front,n=i._elements;for(;!(r===n.length&&i._next===void 0||r===n.length&&(i=i._next,n=i._elements,r=0,n.length===0));)t(n[r]),++r}peek(){const t=this._front,r=this._cursor;return t._elements[r]}}function Gc(e,t){e._ownerReadableStream=t,t._reader=e,t._state==="readable"?n0(e):t._state==="closed"?function(r){n0(r),$c(r)}(e):Vc(e,t._storedError)}function M0(e,t){return Gi(e._ownerReadableStream,t)}function Li(e){e._ownerReadableStream._state==="readable"?C0(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):function(t,r){Vc(t,r)}(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function kn(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function n0(e){e._closedPromise=Ke((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r})}function Vc(e,t){n0(e),C0(e,t)}function C0(e,t){e._closedPromise_reject!==void 0&&(xa(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function $c(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}const Zc=Wt("[[AbortSteps]]"),Yc=Wt("[[ErrorSteps]]"),D0=Wt("[[CancelSteps]]"),K0=Wt("[[PullSteps]]"),h2=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},Yh=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function Vr(e,t){if(e!==void 0&&typeof(r=e)!="object"&&typeof r!="function")throw new TypeError(t+" is not an object.");var r}function rr(e,t){if(typeof e!="function")throw new TypeError(t+" is not a function.")}function Xc(e,t){if(!function(r){return typeof r=="object"&&r!==null||typeof r=="function"}(e))throw new TypeError(t+" is not an object.")}function Qr(e,t,r){if(e===void 0)throw new TypeError(`Parameter ${t} is required in '${r}'.`)}function a0(e,t,r){if(e===void 0)throw new TypeError(`${t} is required in '${r}'.`)}function R0(e){return Number(e)}function d2(e){return e===0?0:e}function Qc(e,t){const r=Number.MAX_SAFE_INTEGER;let i=Number(e);if(i=d2(i),!h2(i))throw new TypeError(t+" is not a finite number");if(i=function(n){return d2(Yh(n))}(i),i<0||i>r)throw new TypeError(`${t} is outside the accepted range of 0 to ${r}, inclusive`);return h2(i)&&i!==0?i:0}function I0(e,t){if(!fi(e))throw new TypeError(t+" is not a ReadableStream.")}function Qa(e){return new vs(e)}function Jc(e,t){e._reader._readRequests.push(t)}function U0(e,t,r){const i=e._reader._readRequests.shift();r?i._closeSteps():i._chunkSteps(t)}function to(e){return e._reader._readRequests.length}function t3(e){const t=e._reader;return t!==void 0&&!!ji(t)}class vs{constructor(t){if(Qr(t,1,"ReadableStreamDefaultReader"),I0(t,"First parameter"),vi(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");Gc(this,t),this._readRequests=new Ir}get closed(){return ji(this)?this._closedPromise:Ut(Ba("closed"))}cancel(t){return ji(this)?this._ownerReadableStream===void 0?Ut(kn("cancel")):M0(this,t):Ut(Ba("cancel"))}read(){if(!ji(this))return Ut(Ba("read"));if(this._ownerReadableStream===void 0)return Ut(kn("read from"));let t,r;const i=Ke((n,a)=>{t=n,r=a});return eo(this,{_chunkSteps:n=>t({value:n,done:!1}),_closeSteps:()=>t({value:void 0,done:!0}),_errorSteps:n=>r(n)}),i}releaseLock(){if(!ji(this))throw Ba("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");Li(this)}}}function ji(e){return!!Fe(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")}function eo(e,t){const r=e._ownerReadableStream;r._disturbed=!0,r._state==="closed"?t._closeSteps():r._state==="errored"?t._errorSteps(r._storedError):r._readableStreamController[K0](t)}function Ba(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let _s;Object.defineProperties(vs.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof Wt.toStringTag=="symbol"&&Object.defineProperty(vs.prototype,Wt.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0}),typeof Wt.asyncIterator=="symbol"&&(_s={[Wt.asyncIterator](){return this}},Object.defineProperty(_s,Wt.asyncIterator,{enumerable:!1}));class Xh{constructor(t,r){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=t,this._preventCancel=r}next(){const t=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?Hi(this._ongoingPromise,t,t):t(),this._ongoingPromise}return(t){const r=()=>this._returnSteps(t);return this._ongoingPromise?Hi(this._ongoingPromise,r,r):r()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});const t=this._reader;if(t._ownerReadableStream===void 0)return Ut(kn("iterate"));let r,i;const n=Ke((a,s)=>{r=a,i=s});return eo(t,{_chunkSteps:a=>{this._ongoingPromise=void 0,Hc(()=>r({value:a,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,Li(t),r({value:void 0,done:!0})},_errorSteps:a=>{this._ongoingPromise=void 0,this._isFinished=!0,Li(t),i(a)}}),n}_returnSteps(t){if(this._isFinished)return Promise.resolve({value:t,done:!0});this._isFinished=!0;const r=this._reader;if(r._ownerReadableStream===void 0)return Ut(kn("finish iterating"));if(!this._preventCancel){const i=M0(r,t);return Li(r),Hi(i,()=>({value:t,done:!0}))}return Li(r),re({value:t,done:!0})}}const e3={next(){return f2(this)?this._asyncIteratorImpl.next():Ut(l2("next"))},return(e){return f2(this)?this._asyncIteratorImpl.return(e):Ut(l2("return"))}};function f2(e){return!!Fe(e)&&!!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl")}function l2(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}_s!==void 0&&Object.setPrototypeOf(e3,_s);const r3=Number.isNaN||function(e){return e!=e};function i3(e){return!!function(t){return!(typeof t!="number"||r3(t)||t<0)}(e)&&e!==1/0}function s0(e){const t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function B0(e,t,r){if(!i3(r=Number(r)))throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function Mi(e){e._queue=new Ir,e._queueTotalSize=0}function Mo(e){return e.slice()}class ks{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Co(this))throw Do("view");return this._view}respond(t){if(!Co(this))throw Do("respond");if(Qr(t,1,"respond"),t=Qc(t,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");this._view.buffer,function(r,i){if(!i3(i=Number(i)))throw new RangeError("bytesWritten must be a finite");p2(r,i)}(this._associatedReadableByteStreamController,t)}respondWithNewView(t){if(!Co(this))throw Do("respondWithNewView");if(Qr(t,1,"respondWithNewView"),!ArrayBuffer.isView(t))throw new TypeError("You can only respond with array buffer views");if(t.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(t.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");(function(r,i){const n=r._pendingPullIntos.peek();if(n.byteOffset+n.bytesFilled!==i.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(n.byteLength!==i.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");n.buffer=i.buffer,p2(r,i.byteLength)})(this._associatedReadableByteStreamController,t)}}Object.defineProperties(ks.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof Wt.toStringTag=="symbol"&&Object.defineProperty(ks.prototype,Wt.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class As{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!an(this))throw Bn("byobRequest");if(this._byobRequest===null&&this._pendingPullIntos.length>0){const t=this._pendingPullIntos.peek(),r=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),i=Object.create(ks.prototype);(function(n,a,s){n._associatedReadableByteStreamController=a,n._view=s})(i,this,r),this._byobRequest=i}return this._byobRequest}get desiredSize(){if(!an(this))throw Bn("desiredSize");return u3(this)}close(){if(!an(this))throw Bn("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");const t=this._controlledReadableByteStream._state;if(t!=="readable")throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be closed`);(function(r){const i=r._controlledReadableByteStream;if(!(r._closeRequested||i._state!=="readable")){if(r._queueTotalSize>0)return void(r._closeRequested=!0);if(r._pendingPullIntos.length>0&&r._pendingPullIntos.peek().bytesFilled>0){const n=new TypeError("Insufficient bytes to fill elements in the given buffer");throw da(r,n),n}Ss(r),Ma(i)}})(this)}enqueue(t){if(!an(this))throw Bn("enqueue");if(Qr(t,1,"enqueue"),!ArrayBuffer.isView(t))throw new TypeError("chunk must be an array buffer view");if(t.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(t.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");const r=this._controlledReadableByteStream._state;if(r!=="readable")throw new TypeError(`The stream (in ${r} state) is not in the readable state and cannot be enqueued to`);(function(i,n){const a=i._controlledReadableByteStream;if(i._closeRequested||a._state!=="readable")return;const s=n.buffer,o=n.byteOffset,u=n.byteLength,c=s;t3(a)?to(a)===0?Ja(i,c,o,u):U0(a,new Uint8Array(c,o,u),!1):z0(a)?(Ja(i,c,o,u),c3(i)):Ja(i,c,o,u),Xi(i)})(this,t)}error(t){if(!an(this))throw Bn("error");da(this,t)}[D0](t){this._pendingPullIntos.length>0&&(this._pendingPullIntos.peek().bytesFilled=0),Mi(this);const r=this._cancelAlgorithm(t);return Ss(this),r}[K0](t){const r=this._controlledReadableByteStream;if(this._queueTotalSize>0){const n=this._queue.shift();this._queueTotalSize-=n.byteLength,o3(this);const a=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);return void t._chunkSteps(a)}const i=this._autoAllocateChunkSize;if(i!==void 0){let n;try{n=new ArrayBuffer(i)}catch(s){return void t._errorSteps(s)}const a={buffer:n,byteOffset:0,byteLength:i,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(a)}Jc(r,t),Xi(this)}}function an(e){return!!Fe(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")}function Co(e){return!!Fe(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")}function Xi(e){if(!!function(t){const r=t._controlledReadableByteStream;return r._state!=="readable"||t._closeRequested||!t._started?!1:!!(t3(r)&&to(r)>0||z0(r)&&h3(r)>0||u3(t)>0)}(e)){if(e._pulling)return void(e._pullAgain=!0);e._pulling=!0,er(e._pullAlgorithm(),()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Xi(e))},t=>{da(e,t)})}}function o0(e,t){let r=!1;e._state==="closed"&&(r=!0);const i=n3(t);t.readerType==="default"?U0(e,i,r):function(n,a,s){const o=n._reader._readIntoRequests.shift();s?o._closeSteps(a):o._chunkSteps(a)}(e,i,r)}function n3(e){const t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function Ja(e,t,r,i){e._queue.push({buffer:t,byteOffset:r,byteLength:i}),e._queueTotalSize+=i}function a3(e,t){const r=t.elementSize,i=t.bytesFilled-t.bytesFilled%r,n=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),a=t.bytesFilled+n,s=a-a%r;let o=n,u=!1;s>i&&(o=s-t.bytesFilled,u=!0);const c=e._queue;for(;o>0;){const I=c.peek(),U=Math.min(o,I.byteLength),V=t.byteOffset+t.bytesFilled;h=t.buffer,f=V,m=I.buffer,y=I.byteOffset,K=U,new Uint8Array(h).set(new Uint8Array(m,y,K),f),I.byteLength===U?c.shift():(I.byteOffset+=U,I.byteLength-=U),e._queueTotalSize-=U,s3(e,U,t),o-=U}var h,f,m,y,K;return u}function s3(e,t,r){T0(e),r.bytesFilled+=t}function o3(e){e._queueTotalSize===0&&e._closeRequested?(Ss(e),Ma(e._controlledReadableByteStream)):Xi(e)}function T0(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function c3(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;const t=e._pendingPullIntos.peek();a3(e,t)&&(c0(e),o0(e._controlledReadableByteStream,t))}}function p2(e,t){const r=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream");(function(i,n){n.buffer=n.buffer;const a=i._controlledReadableByteStream;if(z0(a))for(;h3(a)>0;)o0(a,c0(i))})(e,r)}else(function(i,n,a){if(a.bytesFilled+n>a.byteLength)throw new RangeError("bytesWritten out of range");if(s3(i,n,a),a.bytesFilled<a.elementSize)return;c0(i);const s=a.bytesFilled%a.elementSize;if(s>0){const o=a.byteOffset+a.bytesFilled,u=a.buffer.slice(o-s,o);Ja(i,u,0,u.byteLength)}a.buffer=a.buffer,a.bytesFilled-=s,o0(i._controlledReadableByteStream,a),c3(i)})(e,t,r);Xi(e)}function c0(e){const t=e._pendingPullIntos.shift();return T0(e),t}function Ss(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function da(e,t){const r=e._controlledReadableByteStream;r._state==="readable"&&(function(i){T0(i),i._pendingPullIntos=new Ir}(e),Mi(e),Ss(e),C3(r,t))}function u3(e){const t=e._controlledReadableByteStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function Qh(e,t,r){const i=Object.create(As.prototype);let n=()=>{},a=()=>re(void 0),s=()=>re(void 0);t.start!==void 0&&(n=()=>t.start(i)),t.pull!==void 0&&(a=()=>t.pull(i)),t.cancel!==void 0&&(s=u=>t.cancel(u));const o=t.autoAllocateChunkSize;if(o===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");(function(u,c,h,f,m,y,K){c._controlledReadableByteStream=u,c._pullAgain=!1,c._pulling=!1,c._byobRequest=null,c._queue=c._queueTotalSize=void 0,Mi(c),c._closeRequested=!1,c._started=!1,c._strategyHWM=y,c._pullAlgorithm=f,c._cancelAlgorithm=m,c._autoAllocateChunkSize=K,c._pendingPullIntos=new Ir,u._readableStreamController=c,er(re(h()),()=>{c._started=!0,Xi(c)},I=>{da(c,I)})})(e,i,n,a,s,r,o)}function Do(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function Bn(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function y2(e,t){e._reader._readIntoRequests.push(t)}function h3(e){return e._reader._readIntoRequests.length}function z0(e){const t=e._reader;return t!==void 0&&!!Vn(t)}Object.defineProperties(As.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof Wt.toStringTag=="symbol"&&Object.defineProperty(As.prototype,Wt.toStringTag,{value:"ReadableByteStreamController",configurable:!0});class Es{constructor(t){if(Qr(t,1,"ReadableStreamBYOBReader"),I0(t,"First parameter"),vi(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!an(t._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");Gc(this,t),this._readIntoRequests=new Ir}get closed(){return Vn(this)?this._closedPromise:Ut(Ta("closed"))}cancel(t){return Vn(this)?this._ownerReadableStream===void 0?Ut(kn("cancel")):M0(this,t):Ut(Ta("cancel"))}read(t){if(!Vn(this))return Ut(Ta("read"));if(!ArrayBuffer.isView(t))return Ut(new TypeError("view must be an array buffer view"));if(t.byteLength===0)return Ut(new TypeError("view must have non-zero byteLength"));if(t.buffer.byteLength===0)return Ut(new TypeError("view's buffer must have non-zero byteLength"));if(this._ownerReadableStream===void 0)return Ut(kn("read from"));let r,i;const n=Ke((a,s)=>{r=a,i=s});return function(a,s,o){const u=a._ownerReadableStream;u._disturbed=!0,u._state==="errored"?o._errorSteps(u._storedError):function(c,h,f){const m=c._controlledReadableByteStream;let y=1;h.constructor!==DataView&&(y=h.constructor.BYTES_PER_ELEMENT);const K=h.constructor,I={buffer:h.buffer,byteOffset:h.byteOffset,byteLength:h.byteLength,bytesFilled:0,elementSize:y,viewConstructor:K,readerType:"byob"};if(c._pendingPullIntos.length>0)return c._pendingPullIntos.push(I),void y2(m,f);if(m._state!=="closed"){if(c._queueTotalSize>0){if(a3(c,I)){const U=n3(I);return o3(c),void f._chunkSteps(U)}if(c._closeRequested){const U=new TypeError("Insufficient bytes to fill elements in the given buffer");return da(c,U),void f._errorSteps(U)}}c._pendingPullIntos.push(I),y2(m,f),Xi(c)}else{const U=new K(I.buffer,I.byteOffset,0);f._closeSteps(U)}}(u._readableStreamController,s,o)}(this,t,{_chunkSteps:a=>r({value:a,done:!1}),_closeSteps:a=>r({value:a,done:!0}),_errorSteps:a=>i(a)}),n}releaseLock(){if(!Vn(this))throw Ta("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");Li(this)}}}function Vn(e){return!!Fe(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")}function Ta(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function fa(e,t){const{highWaterMark:r}=e;if(r===void 0)return t;if(r3(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function Ps(e){const{size:t}=e;return t||(()=>1)}function xs(e,t){Vr(e,t);const r=e==null?void 0:e.highWaterMark,i=e==null?void 0:e.size;return{highWaterMark:r===void 0?void 0:R0(r),size:i===void 0?void 0:Jh(i,t+" has member 'size' that")}}function Jh(e,t){return rr(e,t),r=>R0(e(r))}function td(e,t,r){return rr(e,r),i=>Ji(e,t,[i])}function ed(e,t,r){return rr(e,r),()=>Ji(e,t,[])}function rd(e,t,r){return rr(e,r),i=>Js(e,t,[i])}function id(e,t,r){return rr(e,r),(i,n)=>Ji(e,t,[i,n])}function d3(e,t){if(!un(e))throw new TypeError(t+" is not a WritableStream.")}Object.defineProperties(Es.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof Wt.toStringTag=="symbol"&&Object.defineProperty(Es.prototype,Wt.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});class Ms{constructor(t={},r={}){t===void 0?t=null:Xc(t,"First parameter");const i=xs(r,"Second parameter"),n=function(s,o){Vr(s,o);const u=s==null?void 0:s.abort,c=s==null?void 0:s.close,h=s==null?void 0:s.start,f=s==null?void 0:s.type,m=s==null?void 0:s.write;return{abort:u===void 0?void 0:td(u,s,o+" has member 'abort' that"),close:c===void 0?void 0:ed(c,s,o+" has member 'close' that"),start:h===void 0?void 0:rd(h,s,o+" has member 'start' that"),write:m===void 0?void 0:id(m,s,o+" has member 'write' that"),type:f}}(t,"First parameter");if(l3(this),n.type!==void 0)throw new RangeError("Invalid type is specified");const a=Ps(i);(function(s,o,u,c){const h=Object.create(la.prototype);let f=()=>{},m=()=>re(void 0),y=()=>re(void 0),K=()=>re(void 0);o.start!==void 0&&(f=()=>o.start(h)),o.write!==void 0&&(m=I=>o.write(I,h)),o.close!==void 0&&(y=()=>o.close()),o.abort!==void 0&&(K=I=>o.abort(I)),v3(s,h,f,m,y,K,u,c)})(this,n,fa(i,1),a)}get locked(){if(!un(this))throw qa("locked");return yn(this)}abort(t){return un(this)?yn(this)?Ut(new TypeError("Cannot abort a stream that already has a writer")):Cs(this,t):Ut(qa("abort"))}close(){return un(this)?yn(this)?Ut(new TypeError("Cannot close a stream that already has a writer")):Er(this)?Ut(new TypeError("Cannot close an already-closing stream")):p3(this):Ut(qa("close"))}getWriter(){if(!un(this))throw qa("getWriter");return f3(this)}}function f3(e){return new Ds(e)}function l3(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new Ir,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function un(e){return!!Fe(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")}function yn(e){return e._writer!==void 0}function Cs(e,t){const r=e._state;if(r==="closed"||r==="errored")return re(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let i=!1;r==="erroring"&&(i=!0,t=void 0);const n=Ke((a,s)=>{e._pendingAbortRequest={_promise:void 0,_resolve:a,_reject:s,_reason:t,_wasAlreadyErroring:i}});return e._pendingAbortRequest._promise=n,i||q0(e,t),n}function p3(e){const t=e._state;if(t==="closed"||t==="errored")return Ut(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));const r=Ke((a,s)=>{const o={_resolve:a,_reject:s};e._closeRequest=o}),i=e._writer;var n;return i!==void 0&&e._backpressure&&t==="writable"&&j0(i),B0(n=e._writableStreamController,w3,0),ro(n),r}function u0(e,t){e._state!=="writable"?F0(e):q0(e,t)}function q0(e,t){const r=e._writableStreamController;e._state="erroring",e._storedError=t;const i=e._writer;i!==void 0&&b3(i,t),!function(n){return!(n._inFlightWriteRequest===void 0&&n._inFlightCloseRequest===void 0)}(e)&&r._started&&F0(e)}function F0(e){e._state="errored",e._writableStreamController[Yc]();const t=e._storedError;if(e._writeRequests.forEach(i=>{i._reject(t)}),e._writeRequests=new Ir,e._pendingAbortRequest===void 0)return void za(e);const r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring)return r._reject(t),void za(e);er(e._writableStreamController[Zc](r._reason),()=>{r._resolve(),za(e)},i=>{r._reject(i),za(e)})}function Er(e){return e._closeRequest!==void 0||e._inFlightCloseRequest!==void 0}function za(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);const t=e._writer;t!==void 0&&L0(t,e._storedError)}function O0(e,t){const r=e._writer;r!==void 0&&t!==e._backpressure&&(t?function(i){io(i)}(r):j0(r)),e._backpressure=t}Object.defineProperties(Ms.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof Wt.toStringTag=="symbol"&&Object.defineProperty(Ms.prototype,Wt.toStringTag,{value:"WritableStream",configurable:!0});class Ds{constructor(t){if(Qr(t,1,"WritableStreamDefaultWriter"),d3(t,"First parameter"),yn(t))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;const r=t._state;if(r==="writable")!Er(t)&&t._backpressure?io(this):b2(this),ts(this);else if(r==="erroring")d0(this,t._storedError),ts(this);else if(r==="closed")b2(this),ts(i=this),S3(i);else{const n=t._storedError;d0(this,n),A3(this,n)}var i}get closed(){return Ui(this)?this._closedPromise:Ut(Bi("closed"))}get desiredSize(){if(!Ui(this))throw Bi("desiredSize");if(this._ownerWritableStream===void 0)throw $n("desiredSize");return function(t){const r=t._ownerWritableStream,i=r._state;return i==="errored"||i==="erroring"?null:i==="closed"?0:_3(r._writableStreamController)}(this)}get ready(){return Ui(this)?this._readyPromise:Ut(Bi("ready"))}abort(t){return Ui(this)?this._ownerWritableStream===void 0?Ut($n("abort")):function(r,i){return Cs(r._ownerWritableStream,i)}(this,t):Ut(Bi("abort"))}close(){if(!Ui(this))return Ut(Bi("close"));const t=this._ownerWritableStream;return t===void 0?Ut($n("close")):Er(t)?Ut(new TypeError("Cannot close an already-closing stream")):y3(this)}releaseLock(){if(!Ui(this))throw Bi("releaseLock");this._ownerWritableStream!==void 0&&m3(this)}write(t){return Ui(this)?this._ownerWritableStream===void 0?Ut($n("write to")):g3(this,t):Ut(Bi("write"))}}function Ui(e){return!!Fe(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")}function y3(e){return p3(e._ownerWritableStream)}function nd(e,t){e._closedPromiseState==="pending"?L0(e,t):function(r,i){A3(r,i)}(e,t)}function b3(e,t){e._readyPromiseState==="pending"?E3(e,t):function(r,i){d0(r,i)}(e,t)}function m3(e){const t=e._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");b3(e,r),nd(e,r),t._writer=void 0,e._ownerWritableStream=void 0}function g3(e,t){const r=e._ownerWritableStream,i=r._writableStreamController,n=function(o,u){try{return o._strategySizeAlgorithm(u)}catch(c){return h0(o,c),1}}(i,t);if(r!==e._ownerWritableStream)return Ut($n("write to"));const a=r._state;if(a==="errored")return Ut(r._storedError);if(Er(r)||a==="closed")return Ut(new TypeError("The stream is closing or closed and cannot be written to"));if(a==="erroring")return Ut(r._storedError);const s=function(o){return Ke((u,c)=>{const h={_resolve:u,_reject:c};o._writeRequests.push(h)})}(r);return function(o,u,c){try{B0(o,u,c)}catch(f){return void h0(o,f)}const h=o._controlledWritableStream;!Er(h)&&h._state==="writable"&&O0(h,N0(o)),ro(o)}(i,t,n),s}Object.defineProperties(Ds.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof Wt.toStringTag=="symbol"&&Object.defineProperty(Ds.prototype,Wt.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});const w3={};class la{constructor(){throw new TypeError("Illegal constructor")}error(t){if(!function(r){return!(!Fe(r)||!Object.prototype.hasOwnProperty.call(r,"_controlledWritableStream"))}(this))throw new TypeError("WritableStreamDefaultController.prototype.error can only be used on a WritableStreamDefaultController");this._controlledWritableStream._state==="writable"&&k3(this,t)}[Zc](t){const r=this._abortAlgorithm(t);return Ks(this),r}[Yc](){Mi(this)}}function v3(e,t,r,i,n,a,s,o){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,Mi(t),t._started=!1,t._strategySizeAlgorithm=o,t._strategyHWM=s,t._writeAlgorithm=i,t._closeAlgorithm=n,t._abortAlgorithm=a;const u=N0(t);O0(e,u),er(re(r()),()=>{t._started=!0,ro(t)},c=>{t._started=!0,u0(e,c)})}function Ks(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function _3(e){return e._strategyHWM-e._queueTotalSize}function ro(e){const t=e._controlledWritableStream;if(!e._started||t._inFlightWriteRequest!==void 0)return;if(t._state==="erroring")return void F0(t);if(e._queue.length===0)return;const r=e._queue.peek().value;r===w3?function(i){const n=i._controlledWritableStream;(function(s){s._inFlightCloseRequest=s._closeRequest,s._closeRequest=void 0})(n),s0(i);const a=i._closeAlgorithm();Ks(i),er(a,()=>{(function(s){s._inFlightCloseRequest._resolve(void 0),s._inFlightCloseRequest=void 0,s._state==="erroring"&&(s._storedError=void 0,s._pendingAbortRequest!==void 0&&(s._pendingAbortRequest._resolve(),s._pendingAbortRequest=void 0)),s._state="closed";const o=s._writer;o!==void 0&&S3(o)})(n)},s=>{(function(o,u){o._inFlightCloseRequest._reject(u),o._inFlightCloseRequest=void 0,o._pendingAbortRequest!==void 0&&(o._pendingAbortRequest._reject(u),o._pendingAbortRequest=void 0),u0(o,u)})(n,s)})}(e):function(i,n){const a=i._controlledWritableStream;(function(s){s._inFlightWriteRequest=s._writeRequests.shift()})(a),er(i._writeAlgorithm(n),()=>{(function(o){o._inFlightWriteRequest._resolve(void 0),o._inFlightWriteRequest=void 0})(a);const s=a._state;if(s0(i),!Er(a)&&s==="writable"){const o=N0(i);O0(a,o)}ro(i)},s=>{a._state==="writable"&&Ks(i),function(o,u){o._inFlightWriteRequest._reject(u),o._inFlightWriteRequest=void 0,u0(o,u)}(a,s)})}(e,r)}function h0(e,t){e._controlledWritableStream._state==="writable"&&k3(e,t)}function N0(e){return _3(e)<=0}function k3(e,t){const r=e._controlledWritableStream;Ks(e),q0(r,t)}function qa(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function Bi(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function $n(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function ts(e){e._closedPromise=Ke((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"})}function A3(e,t){ts(e),L0(e,t)}function L0(e,t){e._closedPromise_reject!==void 0&&(xa(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function S3(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function io(e){e._readyPromise=Ke((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r}),e._readyPromiseState="pending"}function d0(e,t){io(e),E3(e,t)}function b2(e){io(e),j0(e)}function E3(e,t){e._readyPromise_reject!==void 0&&(xa(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function j0(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}Object.defineProperties(la.prototype,{error:{enumerable:!0}}),typeof Wt.toStringTag=="symbol"&&Object.defineProperty(la.prototype,Wt.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});const m2=typeof DOMException<"u"?DOMException:void 0,ad=function(e){if(typeof e!="function"&&typeof e!="object")return!1;try{return new e,!0}catch{return!1}}(m2)?m2:function(){const e=function(t,r){this.message=t||"",this.name=r||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return Object.defineProperty(e.prototype=Object.create(Error.prototype),"constructor",{value:e,writable:!0,configurable:!0}),e}();function g2(e,t,r,i,n,a){const s=Qa(e),o=f3(t);e._disturbed=!0;let u=!1,c=re(void 0);return Ke((h,f)=>{let m;if(a!==void 0){if(m=()=>{const Z=new ad("Aborted","AbortError"),$=[];i||$.push(()=>t._state==="writable"?Cs(t,Z):re(void 0)),n||$.push(()=>e._state==="readable"?Gi(e,Z):re(void 0)),I(()=>Promise.all($.map(R=>R())),!0,Z)},a.aborted)return void m();a.addEventListener("abort",m)}if(K(e,s._closedPromise,Z=>{i?U(!0,Z):I(()=>Cs(t,Z),!0,Z)}),K(t,o._closedPromise,Z=>{n?U(!0,Z):I(()=>Gi(e,Z),!0,Z)}),function(Z,$,R){Z._state==="closed"?R():xo($,R)}(e,s._closedPromise,()=>{r?U():I(()=>function(Z){const $=Z._ownerWritableStream,R=$._state;return Er($)||R==="closed"?re(void 0):R==="errored"?Ut($._storedError):y3(Z)}(o))}),Er(t)||t._state==="closed"){const Z=new TypeError("the destination writable stream closed before all data could be piped to it");n?U(!0,Z):I(()=>Gi(e,Z),!0,Z)}function y(){const Z=c;return Gr(c,()=>Z!==c?y():void 0)}function K(Z,$,R){Z._state==="errored"?R(Z._storedError):Wc($,R)}function I(Z,$,R){function tt(){er(Z(),()=>V($,R),X=>V(!0,X))}u||(u=!0,t._state!=="writable"||Er(t)?tt():xo(y(),tt))}function U(Z,$){u||(u=!0,t._state!=="writable"||Er(t)?V(Z,$):xo(y(),()=>V(Z,$)))}function V(Z,$){m3(o),Li(s),a!==void 0&&a.removeEventListener("abort",m),Z?f($):h(void 0)}xa(Ke((Z,$)=>{(function R(tt){tt?Z():Gr(u?re(!0):Gr(o._readyPromise,()=>Ke((X,Q)=>{eo(s,{_chunkSteps:d=>{c=Gr(g3(o,d),void 0,P0),X(!1)},_closeSteps:()=>X(!0),_errorSteps:Q})})),R,$)})(!1)}))})}class pa{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Fa(this))throw Oa("desiredSize");return W0(this)}close(){if(!Fa(this))throw Oa("close");if(!An(this))throw new TypeError("The stream is not in a state that permits close");ba(this)}enqueue(t){if(!Fa(this))throw Oa("enqueue");if(!An(this))throw new TypeError("The stream is not in a state that permits enqueue");return Is(this,t)}error(t){if(!Fa(this))throw Oa("error");Pi(this,t)}[D0](t){Mi(this);const r=this._cancelAlgorithm(t);return Rs(this),r}[K0](t){const r=this._controlledReadableStream;if(this._queue.length>0){const i=s0(this);this._closeRequested&&this._queue.length===0?(Rs(this),Ma(r)):ya(this),t._chunkSteps(i)}else Jc(r,t),ya(this)}}function Fa(e){return!!Fe(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")}function ya(e){if(!!P3(e)){if(e._pulling)return void(e._pullAgain=!0);e._pulling=!0,er(e._pullAlgorithm(),()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,ya(e))},t=>{Pi(e,t)})}}function P3(e){const t=e._controlledReadableStream;return!An(e)||!e._started?!1:vi(t)&&to(t)>0?!0:W0(e)>0}function Rs(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function ba(e){if(!An(e))return;const t=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(Rs(e),Ma(t))}function Is(e,t){if(!An(e))return;const r=e._controlledReadableStream;if(vi(r)&&to(r)>0)U0(r,t,!1);else{let i;try{i=e._strategySizeAlgorithm(t)}catch(n){throw Pi(e,n),n}try{B0(e,t,i)}catch(n){throw Pi(e,n),n}}ya(e)}function Pi(e,t){const r=e._controlledReadableStream;r._state==="readable"&&(Mi(e),Rs(e),C3(r,t))}function W0(e){const t=e._controlledReadableStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function An(e){const t=e._controlledReadableStream._state;return!e._closeRequested&&t==="readable"}function x3(e,t,r,i,n,a,s){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,Mi(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=s,t._strategyHWM=a,t._pullAlgorithm=i,t._cancelAlgorithm=n,e._readableStreamController=t,er(re(r()),()=>{t._started=!0,ya(t)},o=>{Pi(t,o)})}function Oa(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function sd(e,t,r){return rr(e,r),i=>Ji(e,t,[i])}function od(e,t,r){return rr(e,r),i=>Ji(e,t,[i])}function cd(e,t,r){return rr(e,r),i=>Js(e,t,[i])}function ud(e,t){if((e=""+e)!="bytes")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function hd(e,t){if((e=""+e)!="byob")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function w2(e,t){Vr(e,t);const r=e==null?void 0:e.preventAbort,i=e==null?void 0:e.preventCancel,n=e==null?void 0:e.preventClose,a=e==null?void 0:e.signal;return a!==void 0&&function(s,o){if(!function(u){if(typeof u!="object"||u===null)return!1;try{return typeof u.aborted=="boolean"}catch{return!1}}(s))throw new TypeError(o+" is not an AbortSignal.")}(a,t+" has member 'signal' that"),{preventAbort:!!r,preventCancel:!!i,preventClose:!!n,signal:a}}Object.defineProperties(pa.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof Wt.toStringTag=="symbol"&&Object.defineProperty(pa.prototype,Wt.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});class hn{constructor(t={},r={}){t===void 0?t=null:Xc(t,"First parameter");const i=xs(r,"Second parameter"),n=function(a,s){Vr(a,s);const o=a,u=o==null?void 0:o.autoAllocateChunkSize,c=o==null?void 0:o.cancel,h=o==null?void 0:o.pull,f=o==null?void 0:o.start,m=o==null?void 0:o.type;return{autoAllocateChunkSize:u===void 0?void 0:Qc(u,s+" has member 'autoAllocateChunkSize' that"),cancel:c===void 0?void 0:sd(c,o,s+" has member 'cancel' that"),pull:h===void 0?void 0:od(h,o,s+" has member 'pull' that"),start:f===void 0?void 0:cd(f,o,s+" has member 'start' that"),type:m===void 0?void 0:ud(m,s+" has member 'type' that")}}(t,"First parameter");if(M3(this),n.type==="bytes"){if(i.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");Qh(this,n,fa(i,0))}else{const a=Ps(i);(function(s,o,u,c){const h=Object.create(pa.prototype);let f=()=>{},m=()=>re(void 0),y=()=>re(void 0);o.start!==void 0&&(f=()=>o.start(h)),o.pull!==void 0&&(m=()=>o.pull(h)),o.cancel!==void 0&&(y=K=>o.cancel(K)),x3(s,h,f,m,y,u,c)})(this,n,fa(i,1),a)}}get locked(){if(!fi(this))throw Ti("locked");return vi(this)}cancel(t){return fi(this)?vi(this)?Ut(new TypeError("Cannot cancel a stream that already has a reader")):Gi(this,t):Ut(Ti("cancel"))}getReader(t){if(!fi(this))throw Ti("getReader");return function(r,i){Vr(r,i);const n=r==null?void 0:r.mode;return{mode:n===void 0?void 0:hd(n,i+" has member 'mode' that")}}(t,"First parameter").mode===void 0?Qa(this):function(r){return new Es(r)}(this)}pipeThrough(t,r={}){if(!fi(this))throw Ti("pipeThrough");Qr(t,1,"pipeThrough");const i=function(a,s){Vr(a,s);const o=a==null?void 0:a.readable;a0(o,"readable","ReadableWritablePair"),I0(o,s+" has member 'readable' that");const u=a==null?void 0:a.writable;return a0(u,"writable","ReadableWritablePair"),d3(u,s+" has member 'writable' that"),{readable:o,writable:u}}(t,"First parameter"),n=w2(r,"Second parameter");if(vi(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(yn(i.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return xa(g2(this,i.writable,n.preventClose,n.preventAbort,n.preventCancel,n.signal)),i.readable}pipeTo(t,r={}){if(!fi(this))return Ut(Ti("pipeTo"));if(t===void 0)return Ut("Parameter 1 is required in 'pipeTo'.");if(!un(t))return Ut(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let i;try{i=w2(r,"Second parameter")}catch(n){return Ut(n)}return vi(this)?Ut(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):yn(t)?Ut(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):g2(this,t,i.preventClose,i.preventAbort,i.preventCancel,i.signal)}tee(){if(!fi(this))throw Ti("tee");const t=function(r,i){const n=Qa(r);let a,s,o,u,c,h=!1,f=!1,m=!1;const y=Ke(U=>{c=U});function K(){return h||(h=!0,eo(n,{_chunkSteps:U=>{Hc(()=>{h=!1;const V=U,Z=U;f||Is(o._readableStreamController,V),m||Is(u._readableStreamController,Z)})},_closeSteps:()=>{h=!1,f||ba(o._readableStreamController),m||ba(u._readableStreamController),f&&m||c(void 0)},_errorSteps:()=>{h=!1}})),re(void 0)}function I(){}return o=f0(I,K,function(U){if(f=!0,a=U,m){const V=Mo([a,s]),Z=Gi(r,V);c(Z)}return y}),u=f0(I,K,function(U){if(m=!0,s=U,f){const V=Mo([a,s]),Z=Gi(r,V);c(Z)}return y}),Wc(n._closedPromise,U=>{Pi(o._readableStreamController,U),Pi(u._readableStreamController,U),f&&m||c(void 0)}),[o,u]}(this);return Mo(t)}values(t){if(!fi(this))throw Ti("values");return function(r,i){const n=Qa(r),a=new Xh(n,i),s=Object.create(e3);return s._asyncIteratorImpl=a,s}(this,function(r,i){return Vr(r,i),{preventCancel:!!(r!=null&&r.preventCancel)}}(t,"First parameter").preventCancel)}}function f0(e,t,r,i=1,n=()=>1){const a=Object.create(hn.prototype);return M3(a),x3(a,Object.create(pa.prototype),e,t,r,i,n),a}function M3(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function fi(e){return!!Fe(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")}function vi(e){return e._reader!==void 0}function Gi(e,t){return e._disturbed=!0,e._state==="closed"?re(void 0):e._state==="errored"?Ut(e._storedError):(Ma(e),Hi(e._readableStreamController[D0](t),P0))}function Ma(e){e._state="closed";const t=e._reader;t!==void 0&&($c(t),ji(t)&&(t._readRequests.forEach(r=>{r._closeSteps()}),t._readRequests=new Ir))}function C3(e,t){e._state="errored",e._storedError=t;const r=e._reader;r!==void 0&&(C0(r,t),ji(r)?(r._readRequests.forEach(i=>{i._errorSteps(t)}),r._readRequests=new Ir):(r._readIntoRequests.forEach(i=>{i._errorSteps(t)}),r._readIntoRequests=new Ir))}function Ti(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function D3(e,t){Vr(e,t);const r=e==null?void 0:e.highWaterMark;return a0(r,"highWaterMark","QueuingStrategyInit"),{highWaterMark:R0(r)}}Object.defineProperties(hn.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof Wt.toStringTag=="symbol"&&Object.defineProperty(hn.prototype,Wt.toStringTag,{value:"ReadableStream",configurable:!0}),typeof Wt.asyncIterator=="symbol"&&Object.defineProperty(hn.prototype,Wt.asyncIterator,{value:hn.prototype.values,writable:!0,configurable:!0});const dd=function(e){return e.byteLength};class l0{constructor(t){Qr(t,1,"ByteLengthQueuingStrategy"),t=D3(t,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!_2(this))throw v2("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!_2(this))throw v2("size");return dd}}function v2(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function _2(e){return!!Fe(e)&&!!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")}Object.defineProperties(l0.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof Wt.toStringTag=="symbol"&&Object.defineProperty(l0.prototype,Wt.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});const fd=function(){return 1};class p0{constructor(t){Qr(t,1,"CountQueuingStrategy"),t=D3(t,"First parameter"),this._countQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!A2(this))throw k2("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!A2(this))throw k2("size");return fd}}function k2(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function A2(e){return!!Fe(e)&&!!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")}function ld(e,t,r){return rr(e,r),i=>Ji(e,t,[i])}function pd(e,t,r){return rr(e,r),i=>Js(e,t,[i])}function yd(e,t,r){return rr(e,r),(i,n)=>Ji(e,t,[i,n])}Object.defineProperties(p0.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof Wt.toStringTag=="symbol"&&Object.defineProperty(p0.prototype,Wt.toStringTag,{value:"CountQueuingStrategy",configurable:!0});class y0{constructor(t={},r={},i={}){t===void 0&&(t=null);const n=xs(r,"Second parameter"),a=xs(i,"Third parameter"),s=function(m,y){Vr(m,y);const K=m==null?void 0:m.flush,I=m==null?void 0:m.readableType,U=m==null?void 0:m.start,V=m==null?void 0:m.transform,Z=m==null?void 0:m.writableType;return{flush:K===void 0?void 0:ld(K,m,y+" has member 'flush' that"),readableType:I,start:U===void 0?void 0:pd(U,m,y+" has member 'start' that"),transform:V===void 0?void 0:yd(V,m,y+" has member 'transform' that"),writableType:Z}}(t,"First parameter");if(s.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(s.writableType!==void 0)throw new RangeError("Invalid writableType specified");const o=fa(a,0),u=Ps(a),c=fa(n,1),h=Ps(n);let f;(function(m,y,K,I,U,V){function Z(){return y}function $(d){return function(b,_){const g=b._transformStreamController;return b._backpressure?Hi(b._backpressureChangePromise,()=>{const p=b._writable;if(p._state==="erroring")throw p._storedError;return E2(g,_)}):E2(g,_)}(m,d)}function R(d){return function(b,_){return Us(b,_),re(void 0)}(m,d)}function tt(){return function(d){const b=d._readable,_=d._transformStreamController,g=_._flushAlgorithm();return K3(_),Hi(g,()=>{if(b._state==="errored")throw b._storedError;ba(b._readableStreamController)},p=>{throw Us(d,p),b._storedError})}(m)}function X(){return function(d){return Bs(d,!1),d._backpressureChangePromise}(m)}function Q(d){return no(m,d),re(void 0)}m._writable=function(d,b,_,g,p=1,S=()=>1){const D=Object.create(Ms.prototype);return l3(D),v3(D,Object.create(la.prototype),d,b,_,g,p,S),D}(Z,$,tt,R,K,I),m._readable=f0(Z,X,Q,U,V),m._backpressure=void 0,m._backpressureChangePromise=void 0,m._backpressureChangePromise_resolve=void 0,Bs(m,!0),m._transformStreamController=void 0})(this,Ke(m=>{f=m}),c,h,o,u),function(m,y){const K=Object.create(Ts.prototype);let I=V=>{try{return R3(K,V),re(void 0)}catch(Z){return Ut(Z)}},U=()=>re(void 0);y.transform!==void 0&&(I=V=>y.transform(V,K)),y.flush!==void 0&&(U=()=>y.flush(K)),function(V,Z,$,R){Z._controlledTransformStream=V,V._transformStreamController=Z,Z._transformAlgorithm=$,Z._flushAlgorithm=R}(m,K,I,U)}(this,s),s.start!==void 0?f(s.start(this._transformStreamController)):f(void 0)}get readable(){if(!S2(this))throw P2("readable");return this._readable}get writable(){if(!S2(this))throw P2("writable");return this._writable}}function S2(e){return!!Fe(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")}function Us(e,t){Pi(e._readable._readableStreamController,t),no(e,t)}function no(e,t){K3(e._transformStreamController),h0(e._writable._writableStreamController,t),e._backpressure&&Bs(e,!1)}function Bs(e,t){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=Ke(r=>{e._backpressureChangePromise_resolve=r}),e._backpressure=t}Object.defineProperties(y0.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof Wt.toStringTag=="symbol"&&Object.defineProperty(y0.prototype,Wt.toStringTag,{value:"TransformStream",configurable:!0});class Ts{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Na(this))throw La("desiredSize");return W0(this._controlledTransformStream._readable._readableStreamController)}enqueue(t){if(!Na(this))throw La("enqueue");R3(this,t)}error(t){if(!Na(this))throw La("error");var r;r=t,Us(this._controlledTransformStream,r)}terminate(){if(!Na(this))throw La("terminate");(function(t){const r=t._controlledTransformStream;ba(r._readable._readableStreamController),no(r,new TypeError("TransformStream terminated"))})(this)}}function Na(e){return!!Fe(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")}function K3(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function R3(e,t){const r=e._controlledTransformStream,i=r._readable._readableStreamController;if(!An(i))throw new TypeError("Readable side is not in a state that permits enqueue");try{Is(i,t)}catch(n){throw no(r,n),r._readable._storedError}(function(n){return!P3(n)})(i)!==r._backpressure&&Bs(r,!0)}function E2(e,t){return Hi(e._transformAlgorithm(t),void 0,r=>{throw Us(e._controlledTransformStream,r),r})}function La(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function P2(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}Object.defineProperties(Ts.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof Wt.toStringTag=="symbol"&&Object.defineProperty(Ts.prototype,Wt.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});var bd=Object.freeze({__proto__:null,ByteLengthQueuingStrategy:l0,CountQueuingStrategy:p0,ReadableByteStreamController:As,ReadableStream:hn,ReadableStreamBYOBReader:Es,ReadableStreamBYOBRequest:ks,ReadableStreamDefaultController:pa,ReadableStreamDefaultReader:vs,TransformStream:y0,TransformStreamDefaultController:Ts,WritableStream:Ms,WritableStreamDefaultController:la,WritableStreamDefaultWriter:Ds}),I3=function(e,t){return(I3=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])})(e,t)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function U3(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+t+" is not a constructor or null");function r(){this.constructor=e}I3(e,t),e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function We(e){if(!e)throw new TypeError("Assertion failed")}function ia(){}function H0(e){return typeof e=="object"&&e!==null||typeof e=="function"}function Ko(e){if(typeof e!="function")return!1;var t=!1;try{new e({start:function(){t=!0}})}catch{}return t}function G0(e){return!!H0(e)&&typeof e.getReader=="function"}function V0(e){return!!H0(e)&&typeof e.getWriter=="function"}function B3(e){return!!H0(e)&&!!G0(e.readable)&&!!V0(e.writable)}function T3(e){try{return e.getReader({mode:"byob"}).releaseLock(),!0}catch{return!1}}function Ro(e,t){var r=(t===void 0?{}:t).type;return We(G0(e)),We(e.locked===!1),(r=z3(r))==="bytes"?new gd(e):new md(e)}function z3(e){var t=e+"";if(t==="bytes")return t;if(e===void 0)return e;throw new RangeError("Invalid type is specified")}var q3=function(){function e(t){this._underlyingReader=void 0,this._readerMode=void 0,this._readableStreamController=void 0,this._pendingRead=void 0,this._underlyingStream=t,this._attachDefaultReader()}return e.prototype.start=function(t){this._readableStreamController=t},e.prototype.cancel=function(t){return We(this._underlyingReader!==void 0),this._underlyingReader.cancel(t)},e.prototype._attachDefaultReader=function(){if(this._readerMode!=="default"){this._detachReader();var t=this._underlyingStream.getReader();this._readerMode="default",this._attachReader(t)}},e.prototype._attachReader=function(t){var r=this;We(this._underlyingReader===void 0),this._underlyingReader=t;var i=this._underlyingReader.closed;i&&i.then(function(){return r._finishPendingRead()}).then(function(){t===r._underlyingReader&&r._readableStreamController.close()},function(n){t===r._underlyingReader&&r._readableStreamController.error(n)}).catch(ia)},e.prototype._detachReader=function(){this._underlyingReader!==void 0&&(this._underlyingReader.releaseLock(),this._underlyingReader=void 0,this._readerMode=void 0)},e.prototype._pullWithDefaultReader=function(){var t=this;this._attachDefaultReader();var r=this._underlyingReader.read().then(function(i){var n=t._readableStreamController;i.done?t._tryClose():n.enqueue(i.value)});return this._setPendingRead(r),r},e.prototype._tryClose=function(){try{this._readableStreamController.close()}catch{}},e.prototype._setPendingRead=function(t){var r,i=this,n=function(){i._pendingRead===r&&(i._pendingRead=void 0)};this._pendingRead=r=t.then(n,n)},e.prototype._finishPendingRead=function(){var t=this;if(this._pendingRead){var r=function(){return t._finishPendingRead()};return this._pendingRead.then(r,r)}},e}(),md=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return U3(t,e),t.prototype.pull=function(){return this._pullWithDefaultReader()},t}(q3);function x2(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}var gd=function(e){function t(r){var i=this,n=T3(r);return(i=e.call(this,r)||this)._supportsByob=n,i}return U3(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return"bytes"},enumerable:!1,configurable:!0}),t.prototype._attachByobReader=function(){if(this._readerMode!=="byob"){We(this._supportsByob),this._detachReader();var r=this._underlyingStream.getReader({mode:"byob"});this._readerMode="byob",this._attachReader(r)}},t.prototype.pull=function(){if(this._supportsByob){var r=this._readableStreamController.byobRequest;if(r)return this._pullWithByobRequest(r)}return this._pullWithDefaultReader()},t.prototype._pullWithByobRequest=function(r){var i=this;this._attachByobReader();var n=new Uint8Array(r.view.byteLength),a=this._underlyingReader.read(n).then(function(s){var o,u,c;i._readableStreamController,s.done?(i._tryClose(),r.respond(0)):(o=s.value,u=r.view,c=x2(o),x2(u).set(c,0),r.respond(s.value.byteLength))});return this._setPendingRead(a),a},t}(q3);function M2(e){We(V0(e)),We(e.locked===!1);var t=e.getWriter();return new wd(t)}var wd=function(){function e(t){var r=this;this._writableStreamController=void 0,this._pendingWrite=void 0,this._state="writable",this._storedError=void 0,this._underlyingWriter=t,this._errorPromise=new Promise(function(i,n){r._errorPromiseReject=n}),this._errorPromise.catch(ia)}return e.prototype.start=function(t){var r=this;this._writableStreamController=t,this._underlyingWriter.closed.then(function(){r._state="closed"}).catch(function(i){return r._finishErroring(i)})},e.prototype.write=function(t){var r=this,i=this._underlyingWriter;if(i.desiredSize===null)return i.ready;var n=i.write(t);n.catch(function(s){return r._finishErroring(s)}),i.ready.catch(function(s){return r._startErroring(s)});var a=Promise.race([n,this._errorPromise]);return this._setPendingWrite(a),a},e.prototype.close=function(){var t=this;return this._pendingWrite===void 0?this._underlyingWriter.close():this._finishPendingWrite().then(function(){return t.close()})},e.prototype.abort=function(t){if(this._state!=="errored")return this._underlyingWriter.abort(t)},e.prototype._setPendingWrite=function(t){var r,i=this,n=function(){i._pendingWrite===r&&(i._pendingWrite=void 0)};this._pendingWrite=r=t.then(n,n)},e.prototype._finishPendingWrite=function(){var t=this;if(this._pendingWrite===void 0)return Promise.resolve();var r=function(){return t._finishPendingWrite()};return this._pendingWrite.then(r,r)},e.prototype._startErroring=function(t){var r=this;if(this._state==="writable"){this._state="erroring",this._storedError=t;var i=function(){return r._finishErroring(t)};this._pendingWrite===void 0?i():this._finishPendingWrite().then(i,i),this._writableStreamController.error(t)}},e.prototype._finishErroring=function(t){this._state==="writable"&&this._startErroring(t),this._state==="erroring"&&(this._state="errored",this._errorPromiseReject(this._storedError))},e}();function C2(e){We(B3(e));var t=e.readable,r=e.writable;We(t.locked===!1),We(r.locked===!1);var i,n=t.getReader();try{i=r.getWriter()}catch(a){throw n.releaseLock(),a}return new vd(n,i)}var vd=function(){function e(t,r){var i=this;this._transformStreamController=void 0,this._onRead=function(n){if(!n.done)return i._transformStreamController.enqueue(n.value),i._reader.read().then(i._onRead)},this._onError=function(n){i._flushReject(n),i._transformStreamController.error(n),i._reader.cancel(n).catch(ia),i._writer.abort(n).catch(ia)},this._onTerminate=function(){i._flushResolve(),i._transformStreamController.terminate();var n=new TypeError("TransformStream terminated");i._writer.abort(n).catch(ia)},this._reader=t,this._writer=r,this._flushPromise=new Promise(function(n,a){i._flushResolve=n,i._flushReject=a})}return e.prototype.start=function(t){this._transformStreamController=t,this._reader.read().then(this._onRead).then(this._onTerminate,this._onError);var r=this._reader.closed;r&&r.then(this._onTerminate,this._onError)},e.prototype.transform=function(t){return this._writer.write(t)},e.prototype.flush=function(){var t=this;return this._writer.close().then(function(){return t._flushPromise})},e}(),_d=Object.freeze({__proto__:null,createReadableStreamWrapper:function(e){We(function(r){return!!Ko(r)&&!!G0(new r)}(e));var t=function(r){try{return new r({type:"bytes"}),!0}catch{return!1}}(e);return function(r,i){var n=(i===void 0?{}:i).type;if((n=z3(n))!=="bytes"||t||(n=void 0),r.constructor===e&&(n!=="bytes"||T3(r)))return r;if(n==="bytes"){var a=Ro(r,{type:n});return new e(a)}return a=Ro(r),new e(a)}},createTransformStreamWrapper:function(e){return We(function(t){return!!Ko(t)&&!!B3(new t)}(e)),function(t){if(t.constructor===e)return t;var r=C2(t);return new e(r)}},createWrappingReadableSource:Ro,createWrappingTransformer:C2,createWrappingWritableSink:M2,createWritableStreamWrapper:function(e){return We(function(t){return!!Ko(t)&&!!V0(new t)}(e)),function(t){if(t.constructor===e)return t;var r=M2(t);return new e(r)}}}),kt=Br(function(e){(function(t,r){function i(d,b){if(!d)throw Error(b||"Assertion failed")}function n(d,b){d.super_=b;var _=function(){};_.prototype=b.prototype,d.prototype=new _,d.prototype.constructor=d}function a(d,b,_){if(a.isBN(d))return d;this.negative=0,this.words=null,this.length=0,this.red=null,d!==null&&(b!=="le"&&b!=="be"||(_=b,b=10),this._init(d||0,b||10,_||"be"))}var s;typeof t=="object"?t.exports=a:r.BN=a,a.BN=a,a.wordSize=26;try{s=void 0}catch{}function o(d,b,_){for(var g=0,p=Math.min(d.length,_),S=b;S<p;S++){var D=d.charCodeAt(S)-48;g<<=4,g|=D>=49&&D<=54?D-49+10:D>=17&&D<=22?D-17+10:15&D}return g}function u(d,b,_,g){for(var p=0,S=Math.min(d.length,_),D=b;D<S;D++){var nt=d.charCodeAt(D)-48;p*=g,p+=nt>=49?nt-49+10:nt>=17?nt-17+10:nt}return p}a.isBN=function(d){return d instanceof a||d!==null&&typeof d=="object"&&d.constructor.wordSize===a.wordSize&&Array.isArray(d.words)},a.max=function(d,b){return d.cmp(b)>0?d:b},a.min=function(d,b){return d.cmp(b)<0?d:b},a.prototype._init=function(d,b,_){if(typeof d=="number")return this._initNumber(d,b,_);if(typeof d=="object")return this._initArray(d,b,_);b==="hex"&&(b=16),i(b===(0|b)&&b>=2&&b<=36);var g=0;(d=d.toString().replace(/\s+/g,""))[0]==="-"&&g++,b===16?this._parseHex(d,g):this._parseBase(d,b,g),d[0]==="-"&&(this.negative=1),this.strip(),_==="le"&&this._initArray(this.toArray(),b,_)},a.prototype._initNumber=function(d,b,_){d<0&&(this.negative=1,d=-d),d<67108864?(this.words=[67108863&d],this.length=1):d<4503599627370496?(this.words=[67108863&d,d/67108864&67108863],this.length=2):(i(d<9007199254740992),this.words=[67108863&d,d/67108864&67108863,1],this.length=3),_==="le"&&this._initArray(this.toArray(),b,_)},a.prototype._initArray=function(d,b,_){if(i(typeof d.length=="number"),d.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(d.length/3),this.words=Array(this.length);for(var g=0;g<this.length;g++)this.words[g]=0;var p,S,D=0;if(_==="be")for(g=d.length-1,p=0;g>=0;g-=3)S=d[g]|d[g-1]<<8|d[g-2]<<16,this.words[p]|=S<<D&67108863,this.words[p+1]=S>>>26-D&67108863,(D+=24)>=26&&(D-=26,p++);else if(_==="le")for(g=0,p=0;g<d.length;g+=3)S=d[g]|d[g+1]<<8|d[g+2]<<16,this.words[p]|=S<<D&67108863,this.words[p+1]=S>>>26-D&67108863,(D+=24)>=26&&(D-=26,p++);return this.strip()},a.prototype._parseHex=function(d,b){this.length=Math.ceil((d.length-b)/6),this.words=Array(this.length);for(var _=0;_<this.length;_++)this.words[_]=0;var g,p,S=0;for(_=d.length-6,g=0;_>=b;_-=6)p=o(d,_,_+6),this.words[g]|=p<<S&67108863,this.words[g+1]|=p>>>26-S&4194303,(S+=24)>=26&&(S-=26,g++);_+6!==b&&(p=o(d,b,_+6),this.words[g]|=p<<S&67108863,this.words[g+1]|=p>>>26-S&4194303),this.strip()},a.prototype._parseBase=function(d,b,_){this.words=[0],this.length=1;for(var g=0,p=1;p<=67108863;p*=b)g++;g--,p=p/b|0;for(var S=d.length-_,D=S%g,nt=Math.min(S,S-D)+_,st=0,q=_;q<nt;q+=g)st=u(d,q,q+g,b),this.imuln(p),this.words[0]+st<67108864?this.words[0]+=st:this._iaddn(st);if(D!==0){var rt=1;for(st=u(d,q,d.length,b),q=0;q<D;q++)rt*=b;this.imuln(rt),this.words[0]+st<67108864?this.words[0]+=st:this._iaddn(st)}},a.prototype.copy=function(d){d.words=Array(this.length);for(var b=0;b<this.length;b++)d.words[b]=this.words[b];d.length=this.length,d.negative=this.negative,d.red=this.red},a.prototype.clone=function(){var d=new a(null);return this.copy(d),d},a.prototype._expand=function(d){for(;this.length<d;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var c=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function m(d,b,_){_.negative=b.negative^d.negative;var g=d.length+b.length|0;_.length=g,g=g-1|0;var p=0|d.words[0],S=0|b.words[0],D=p*S,nt=67108863&D,st=D/67108864|0;_.words[0]=nt;for(var q=1;q<g;q++){for(var rt=st>>>26,ct=67108863&st,dt=Math.min(q,b.length-1),ut=Math.max(0,q-d.length+1);ut<=dt;ut++){var ft=q-ut|0;rt+=(D=(p=0|d.words[ft])*(S=0|b.words[ut])+ct)/67108864|0,ct=67108863&D}_.words[q]=0|ct,st=0|rt}return st!==0?_.words[q]=0|st:_.length--,_.strip()}a.prototype.toString=function(d,b){var _;if(b=0|b||1,(d=d||10)===16||d==="hex"){_="";for(var g=0,p=0,S=0;S<this.length;S++){var D=this.words[S],nt=(16777215&(D<<g|p)).toString(16);_=(p=D>>>24-g&16777215)!==0||S!==this.length-1?c[6-nt.length]+nt+_:nt+_,(g+=2)>=26&&(g-=26,S--)}for(p!==0&&(_=p.toString(16)+_);_.length%b!=0;)_="0"+_;return this.negative!==0&&(_="-"+_),_}if(d===(0|d)&&d>=2&&d<=36){var st=h[d],q=f[d];_="";var rt=this.clone();for(rt.negative=0;!rt.isZero();){var ct=rt.modn(q).toString(d);_=(rt=rt.idivn(q)).isZero()?ct+_:c[st-ct.length]+ct+_}for(this.isZero()&&(_="0"+_);_.length%b!=0;)_="0"+_;return this.negative!==0&&(_="-"+_),_}i(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var d=this.words[0];return this.length===2?d+=67108864*this.words[1]:this.length===3&&this.words[2]===1?d+=4503599627370496+67108864*this.words[1]:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-d:d},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(d,b){return i(s!==void 0),this.toArrayLike(s,d,b)},a.prototype.toArray=function(d,b){return this.toArrayLike(Array,d,b)},a.prototype.toArrayLike=function(d,b,_){var g=this.byteLength(),p=_||Math.max(1,g);i(g<=p,"byte array longer than desired length"),i(p>0,"Requested array length <= 0"),this.strip();var S,D,nt=b==="le",st=new d(p),q=this.clone();if(nt){for(D=0;!q.isZero();D++)S=q.andln(255),q.iushrn(8),st[D]=S;for(;D<p;D++)st[D]=0}else{for(D=0;D<p-g;D++)st[D]=0;for(D=0;!q.isZero();D++)S=q.andln(255),q.iushrn(8),st[p-D-1]=S}return st},a.prototype._countBits=Math.clz32?function(d){return 32-Math.clz32(d)}:function(d){var b=d,_=0;return b>=4096&&(_+=13,b>>>=13),b>=64&&(_+=7,b>>>=7),b>=8&&(_+=4,b>>>=4),b>=2&&(_+=2,b>>>=2),_+b},a.prototype._zeroBits=function(d){if(d===0)return 26;var b=d,_=0;return(8191&b)==0&&(_+=13,b>>>=13),(127&b)==0&&(_+=7,b>>>=7),(15&b)==0&&(_+=4,b>>>=4),(3&b)==0&&(_+=2,b>>>=2),(1&b)==0&&_++,_},a.prototype.bitLength=function(){var d=this.words[this.length-1],b=this._countBits(d);return 26*(this.length-1)+b},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var d=0,b=0;b<this.length;b++){var _=this._zeroBits(this.words[b]);if(d+=_,_!==26)break}return d},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(d){return this.negative!==0?this.abs().inotn(d).iaddn(1):this.clone()},a.prototype.fromTwos=function(d){return this.testn(d-1)?this.notn(d).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(d){for(;this.length<d.length;)this.words[this.length++]=0;for(var b=0;b<d.length;b++)this.words[b]=this.words[b]|d.words[b];return this.strip()},a.prototype.ior=function(d){return i((this.negative|d.negative)==0),this.iuor(d)},a.prototype.or=function(d){return this.length>d.length?this.clone().ior(d):d.clone().ior(this)},a.prototype.uor=function(d){return this.length>d.length?this.clone().iuor(d):d.clone().iuor(this)},a.prototype.iuand=function(d){var b;b=this.length>d.length?d:this;for(var _=0;_<b.length;_++)this.words[_]=this.words[_]&d.words[_];return this.length=b.length,this.strip()},a.prototype.iand=function(d){return i((this.negative|d.negative)==0),this.iuand(d)},a.prototype.and=function(d){return this.length>d.length?this.clone().iand(d):d.clone().iand(this)},a.prototype.uand=function(d){return this.length>d.length?this.clone().iuand(d):d.clone().iuand(this)},a.prototype.iuxor=function(d){var b,_;this.length>d.length?(b=this,_=d):(b=d,_=this);for(var g=0;g<_.length;g++)this.words[g]=b.words[g]^_.words[g];if(this!==b)for(;g<b.length;g++)this.words[g]=b.words[g];return this.length=b.length,this.strip()},a.prototype.ixor=function(d){return i((this.negative|d.negative)==0),this.iuxor(d)},a.prototype.xor=function(d){return this.length>d.length?this.clone().ixor(d):d.clone().ixor(this)},a.prototype.uxor=function(d){return this.length>d.length?this.clone().iuxor(d):d.clone().iuxor(this)},a.prototype.inotn=function(d){i(typeof d=="number"&&d>=0);var b=0|Math.ceil(d/26),_=d%26;this._expand(b),_>0&&b--;for(var g=0;g<b;g++)this.words[g]=67108863&~this.words[g];return _>0&&(this.words[g]=~this.words[g]&67108863>>26-_),this.strip()},a.prototype.notn=function(d){return this.clone().inotn(d)},a.prototype.setn=function(d,b){i(typeof d=="number"&&d>=0);var _=d/26|0,g=d%26;return this._expand(_+1),this.words[_]=b?this.words[_]|1<<g:this.words[_]&~(1<<g),this.strip()},a.prototype.iadd=function(d){var b,_,g;if(this.negative!==0&&d.negative===0)return this.negative=0,b=this.isub(d),this.negative^=1,this._normSign();if(this.negative===0&&d.negative!==0)return d.negative=0,b=this.isub(d),d.negative=1,b._normSign();this.length>d.length?(_=this,g=d):(_=d,g=this);for(var p=0,S=0;S<g.length;S++)b=(0|_.words[S])+(0|g.words[S])+p,this.words[S]=67108863&b,p=b>>>26;for(;p!==0&&S<_.length;S++)b=(0|_.words[S])+p,this.words[S]=67108863&b,p=b>>>26;if(this.length=_.length,p!==0)this.words[this.length]=p,this.length++;else if(_!==this)for(;S<_.length;S++)this.words[S]=_.words[S];return this},a.prototype.add=function(d){var b;return d.negative!==0&&this.negative===0?(d.negative=0,b=this.sub(d),d.negative^=1,b):d.negative===0&&this.negative!==0?(this.negative=0,b=d.sub(this),this.negative=1,b):this.length>d.length?this.clone().iadd(d):d.clone().iadd(this)},a.prototype.isub=function(d){if(d.negative!==0){d.negative=0;var b=this.iadd(d);return d.negative=1,b._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(d),this.negative=1,this._normSign();var _,g,p=this.cmp(d);if(p===0)return this.negative=0,this.length=1,this.words[0]=0,this;p>0?(_=this,g=d):(_=d,g=this);for(var S=0,D=0;D<g.length;D++)S=(b=(0|_.words[D])-(0|g.words[D])+S)>>26,this.words[D]=67108863&b;for(;S!==0&&D<_.length;D++)S=(b=(0|_.words[D])+S)>>26,this.words[D]=67108863&b;if(S===0&&D<_.length&&_!==this)for(;D<_.length;D++)this.words[D]=_.words[D];return this.length=Math.max(this.length,D),_!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(d){return this.clone().isub(d)};var y=function(d,b,_){var g,p,S,D=d.words,nt=b.words,st=_.words,q=0,rt=0|D[0],ct=8191&rt,dt=rt>>>13,ut=0|D[1],ft=8191&ut,gt=ut>>>13,mt=0|D[2],B=8191&mt,Y=mt>>>13,M=0|D[3],l=8191&M,z=M>>>13,et=0|D[4],J=8191&et,it=et>>>13,k=0|D[5],w=8191&k,A=k>>>13,C=0|D[6],N=8191&C,T=C>>>13,H=0|D[7],yt=8191&H,lt=H>>>13,wt=0|D[8],O=8191&wt,F=wt>>>13,W=0|D[9],L=8191&W,j=W>>>13,G=0|nt[0],P=8191&G,E=G>>>13,bt=0|nt[1],ht=8191&bt,Pt=bt>>>13,Lt=0|nt[2],Dt=8191&Lt,Ct=Lt>>>13,Xt=0|nt[3],zt=8191&Xt,Ot=Xt>>>13,oe=0|nt[4],Mt=8191&oe,Rt=oe>>>13,jt=0|nt[5],Et=8191&jt,Bt=jt>>>13,$t=0|nt[6],It=8191&$t,at=$t>>>13,ot=0|nt[7],pt=8191&ot,_t=ot>>>13,Kt=0|nt[8],xt=8191&Kt,St=Kt>>>13,Ht=0|nt[9],Tt=8191&Ht,Gt=Ht>>>13;_.negative=d.negative^b.negative,_.length=19;var xe=(q+(g=Math.imul(ct,P))|0)+((8191&(p=(p=Math.imul(ct,E))+Math.imul(dt,P)|0))<<13)|0;q=((S=Math.imul(dt,E))+(p>>>13)|0)+(xe>>>26)|0,xe&=67108863,g=Math.imul(ft,P),p=(p=Math.imul(ft,E))+Math.imul(gt,P)|0,S=Math.imul(gt,E);var Me=(q+(g=g+Math.imul(ct,ht)|0)|0)+((8191&(p=(p=p+Math.imul(ct,Pt)|0)+Math.imul(dt,ht)|0))<<13)|0;q=((S=S+Math.imul(dt,Pt)|0)+(p>>>13)|0)+(Me>>>26)|0,Me&=67108863,g=Math.imul(B,P),p=(p=Math.imul(B,E))+Math.imul(Y,P)|0,S=Math.imul(Y,E),g=g+Math.imul(ft,ht)|0,p=(p=p+Math.imul(ft,Pt)|0)+Math.imul(gt,ht)|0,S=S+Math.imul(gt,Pt)|0;var Ie=(q+(g=g+Math.imul(ct,Dt)|0)|0)+((8191&(p=(p=p+Math.imul(ct,Ct)|0)+Math.imul(dt,Dt)|0))<<13)|0;q=((S=S+Math.imul(dt,Ct)|0)+(p>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,g=Math.imul(l,P),p=(p=Math.imul(l,E))+Math.imul(z,P)|0,S=Math.imul(z,E),g=g+Math.imul(B,ht)|0,p=(p=p+Math.imul(B,Pt)|0)+Math.imul(Y,ht)|0,S=S+Math.imul(Y,Pt)|0,g=g+Math.imul(ft,Dt)|0,p=(p=p+Math.imul(ft,Ct)|0)+Math.imul(gt,Dt)|0,S=S+Math.imul(gt,Ct)|0;var ir=(q+(g=g+Math.imul(ct,zt)|0)|0)+((8191&(p=(p=p+Math.imul(ct,Ot)|0)+Math.imul(dt,zt)|0))<<13)|0;q=((S=S+Math.imul(dt,Ot)|0)+(p>>>13)|0)+(ir>>>26)|0,ir&=67108863,g=Math.imul(J,P),p=(p=Math.imul(J,E))+Math.imul(it,P)|0,S=Math.imul(it,E),g=g+Math.imul(l,ht)|0,p=(p=p+Math.imul(l,Pt)|0)+Math.imul(z,ht)|0,S=S+Math.imul(z,Pt)|0,g=g+Math.imul(B,Dt)|0,p=(p=p+Math.imul(B,Ct)|0)+Math.imul(Y,Dt)|0,S=S+Math.imul(Y,Ct)|0,g=g+Math.imul(ft,zt)|0,p=(p=p+Math.imul(ft,Ot)|0)+Math.imul(gt,zt)|0,S=S+Math.imul(gt,Ot)|0;var nr=(q+(g=g+Math.imul(ct,Mt)|0)|0)+((8191&(p=(p=p+Math.imul(ct,Rt)|0)+Math.imul(dt,Mt)|0))<<13)|0;q=((S=S+Math.imul(dt,Rt)|0)+(p>>>13)|0)+(nr>>>26)|0,nr&=67108863,g=Math.imul(w,P),p=(p=Math.imul(w,E))+Math.imul(A,P)|0,S=Math.imul(A,E),g=g+Math.imul(J,ht)|0,p=(p=p+Math.imul(J,Pt)|0)+Math.imul(it,ht)|0,S=S+Math.imul(it,Pt)|0,g=g+Math.imul(l,Dt)|0,p=(p=p+Math.imul(l,Ct)|0)+Math.imul(z,Dt)|0,S=S+Math.imul(z,Ct)|0,g=g+Math.imul(B,zt)|0,p=(p=p+Math.imul(B,Ot)|0)+Math.imul(Y,zt)|0,S=S+Math.imul(Y,Ot)|0,g=g+Math.imul(ft,Mt)|0,p=(p=p+Math.imul(ft,Rt)|0)+Math.imul(gt,Mt)|0,S=S+Math.imul(gt,Rt)|0;var ar=(q+(g=g+Math.imul(ct,Et)|0)|0)+((8191&(p=(p=p+Math.imul(ct,Bt)|0)+Math.imul(dt,Et)|0))<<13)|0;q=((S=S+Math.imul(dt,Bt)|0)+(p>>>13)|0)+(ar>>>26)|0,ar&=67108863,g=Math.imul(N,P),p=(p=Math.imul(N,E))+Math.imul(T,P)|0,S=Math.imul(T,E),g=g+Math.imul(w,ht)|0,p=(p=p+Math.imul(w,Pt)|0)+Math.imul(A,ht)|0,S=S+Math.imul(A,Pt)|0,g=g+Math.imul(J,Dt)|0,p=(p=p+Math.imul(J,Ct)|0)+Math.imul(it,Dt)|0,S=S+Math.imul(it,Ct)|0,g=g+Math.imul(l,zt)|0,p=(p=p+Math.imul(l,Ot)|0)+Math.imul(z,zt)|0,S=S+Math.imul(z,Ot)|0,g=g+Math.imul(B,Mt)|0,p=(p=p+Math.imul(B,Rt)|0)+Math.imul(Y,Mt)|0,S=S+Math.imul(Y,Rt)|0,g=g+Math.imul(ft,Et)|0,p=(p=p+Math.imul(ft,Bt)|0)+Math.imul(gt,Et)|0,S=S+Math.imul(gt,Bt)|0;var sr=(q+(g=g+Math.imul(ct,It)|0)|0)+((8191&(p=(p=p+Math.imul(ct,at)|0)+Math.imul(dt,It)|0))<<13)|0;q=((S=S+Math.imul(dt,at)|0)+(p>>>13)|0)+(sr>>>26)|0,sr&=67108863,g=Math.imul(yt,P),p=(p=Math.imul(yt,E))+Math.imul(lt,P)|0,S=Math.imul(lt,E),g=g+Math.imul(N,ht)|0,p=(p=p+Math.imul(N,Pt)|0)+Math.imul(T,ht)|0,S=S+Math.imul(T,Pt)|0,g=g+Math.imul(w,Dt)|0,p=(p=p+Math.imul(w,Ct)|0)+Math.imul(A,Dt)|0,S=S+Math.imul(A,Ct)|0,g=g+Math.imul(J,zt)|0,p=(p=p+Math.imul(J,Ot)|0)+Math.imul(it,zt)|0,S=S+Math.imul(it,Ot)|0,g=g+Math.imul(l,Mt)|0,p=(p=p+Math.imul(l,Rt)|0)+Math.imul(z,Mt)|0,S=S+Math.imul(z,Rt)|0,g=g+Math.imul(B,Et)|0,p=(p=p+Math.imul(B,Bt)|0)+Math.imul(Y,Et)|0,S=S+Math.imul(Y,Bt)|0,g=g+Math.imul(ft,It)|0,p=(p=p+Math.imul(ft,at)|0)+Math.imul(gt,It)|0,S=S+Math.imul(gt,at)|0;var or=(q+(g=g+Math.imul(ct,pt)|0)|0)+((8191&(p=(p=p+Math.imul(ct,_t)|0)+Math.imul(dt,pt)|0))<<13)|0;q=((S=S+Math.imul(dt,_t)|0)+(p>>>13)|0)+(or>>>26)|0,or&=67108863,g=Math.imul(O,P),p=(p=Math.imul(O,E))+Math.imul(F,P)|0,S=Math.imul(F,E),g=g+Math.imul(yt,ht)|0,p=(p=p+Math.imul(yt,Pt)|0)+Math.imul(lt,ht)|0,S=S+Math.imul(lt,Pt)|0,g=g+Math.imul(N,Dt)|0,p=(p=p+Math.imul(N,Ct)|0)+Math.imul(T,Dt)|0,S=S+Math.imul(T,Ct)|0,g=g+Math.imul(w,zt)|0,p=(p=p+Math.imul(w,Ot)|0)+Math.imul(A,zt)|0,S=S+Math.imul(A,Ot)|0,g=g+Math.imul(J,Mt)|0,p=(p=p+Math.imul(J,Rt)|0)+Math.imul(it,Mt)|0,S=S+Math.imul(it,Rt)|0,g=g+Math.imul(l,Et)|0,p=(p=p+Math.imul(l,Bt)|0)+Math.imul(z,Et)|0,S=S+Math.imul(z,Bt)|0,g=g+Math.imul(B,It)|0,p=(p=p+Math.imul(B,at)|0)+Math.imul(Y,It)|0,S=S+Math.imul(Y,at)|0,g=g+Math.imul(ft,pt)|0,p=(p=p+Math.imul(ft,_t)|0)+Math.imul(gt,pt)|0,S=S+Math.imul(gt,_t)|0;var cr=(q+(g=g+Math.imul(ct,xt)|0)|0)+((8191&(p=(p=p+Math.imul(ct,St)|0)+Math.imul(dt,xt)|0))<<13)|0;q=((S=S+Math.imul(dt,St)|0)+(p>>>13)|0)+(cr>>>26)|0,cr&=67108863,g=Math.imul(L,P),p=(p=Math.imul(L,E))+Math.imul(j,P)|0,S=Math.imul(j,E),g=g+Math.imul(O,ht)|0,p=(p=p+Math.imul(O,Pt)|0)+Math.imul(F,ht)|0,S=S+Math.imul(F,Pt)|0,g=g+Math.imul(yt,Dt)|0,p=(p=p+Math.imul(yt,Ct)|0)+Math.imul(lt,Dt)|0,S=S+Math.imul(lt,Ct)|0,g=g+Math.imul(N,zt)|0,p=(p=p+Math.imul(N,Ot)|0)+Math.imul(T,zt)|0,S=S+Math.imul(T,Ot)|0,g=g+Math.imul(w,Mt)|0,p=(p=p+Math.imul(w,Rt)|0)+Math.imul(A,Mt)|0,S=S+Math.imul(A,Rt)|0,g=g+Math.imul(J,Et)|0,p=(p=p+Math.imul(J,Bt)|0)+Math.imul(it,Et)|0,S=S+Math.imul(it,Bt)|0,g=g+Math.imul(l,It)|0,p=(p=p+Math.imul(l,at)|0)+Math.imul(z,It)|0,S=S+Math.imul(z,at)|0,g=g+Math.imul(B,pt)|0,p=(p=p+Math.imul(B,_t)|0)+Math.imul(Y,pt)|0,S=S+Math.imul(Y,_t)|0,g=g+Math.imul(ft,xt)|0,p=(p=p+Math.imul(ft,St)|0)+Math.imul(gt,xt)|0,S=S+Math.imul(gt,St)|0;var ur=(q+(g=g+Math.imul(ct,Tt)|0)|0)+((8191&(p=(p=p+Math.imul(ct,Gt)|0)+Math.imul(dt,Tt)|0))<<13)|0;q=((S=S+Math.imul(dt,Gt)|0)+(p>>>13)|0)+(ur>>>26)|0,ur&=67108863,g=Math.imul(L,ht),p=(p=Math.imul(L,Pt))+Math.imul(j,ht)|0,S=Math.imul(j,Pt),g=g+Math.imul(O,Dt)|0,p=(p=p+Math.imul(O,Ct)|0)+Math.imul(F,Dt)|0,S=S+Math.imul(F,Ct)|0,g=g+Math.imul(yt,zt)|0,p=(p=p+Math.imul(yt,Ot)|0)+Math.imul(lt,zt)|0,S=S+Math.imul(lt,Ot)|0,g=g+Math.imul(N,Mt)|0,p=(p=p+Math.imul(N,Rt)|0)+Math.imul(T,Mt)|0,S=S+Math.imul(T,Rt)|0,g=g+Math.imul(w,Et)|0,p=(p=p+Math.imul(w,Bt)|0)+Math.imul(A,Et)|0,S=S+Math.imul(A,Bt)|0,g=g+Math.imul(J,It)|0,p=(p=p+Math.imul(J,at)|0)+Math.imul(it,It)|0,S=S+Math.imul(it,at)|0,g=g+Math.imul(l,pt)|0,p=(p=p+Math.imul(l,_t)|0)+Math.imul(z,pt)|0,S=S+Math.imul(z,_t)|0,g=g+Math.imul(B,xt)|0,p=(p=p+Math.imul(B,St)|0)+Math.imul(Y,xt)|0,S=S+Math.imul(Y,St)|0;var Tr=(q+(g=g+Math.imul(ft,Tt)|0)|0)+((8191&(p=(p=p+Math.imul(ft,Gt)|0)+Math.imul(gt,Tt)|0))<<13)|0;q=((S=S+Math.imul(gt,Gt)|0)+(p>>>13)|0)+(Tr>>>26)|0,Tr&=67108863,g=Math.imul(L,Dt),p=(p=Math.imul(L,Ct))+Math.imul(j,Dt)|0,S=Math.imul(j,Ct),g=g+Math.imul(O,zt)|0,p=(p=p+Math.imul(O,Ot)|0)+Math.imul(F,zt)|0,S=S+Math.imul(F,Ot)|0,g=g+Math.imul(yt,Mt)|0,p=(p=p+Math.imul(yt,Rt)|0)+Math.imul(lt,Mt)|0,S=S+Math.imul(lt,Rt)|0,g=g+Math.imul(N,Et)|0,p=(p=p+Math.imul(N,Bt)|0)+Math.imul(T,Et)|0,S=S+Math.imul(T,Bt)|0,g=g+Math.imul(w,It)|0,p=(p=p+Math.imul(w,at)|0)+Math.imul(A,It)|0,S=S+Math.imul(A,at)|0,g=g+Math.imul(J,pt)|0,p=(p=p+Math.imul(J,_t)|0)+Math.imul(it,pt)|0,S=S+Math.imul(it,_t)|0,g=g+Math.imul(l,xt)|0,p=(p=p+Math.imul(l,St)|0)+Math.imul(z,xt)|0,S=S+Math.imul(z,St)|0;var zr=(q+(g=g+Math.imul(B,Tt)|0)|0)+((8191&(p=(p=p+Math.imul(B,Gt)|0)+Math.imul(Y,Tt)|0))<<13)|0;q=((S=S+Math.imul(Y,Gt)|0)+(p>>>13)|0)+(zr>>>26)|0,zr&=67108863,g=Math.imul(L,zt),p=(p=Math.imul(L,Ot))+Math.imul(j,zt)|0,S=Math.imul(j,Ot),g=g+Math.imul(O,Mt)|0,p=(p=p+Math.imul(O,Rt)|0)+Math.imul(F,Mt)|0,S=S+Math.imul(F,Rt)|0,g=g+Math.imul(yt,Et)|0,p=(p=p+Math.imul(yt,Bt)|0)+Math.imul(lt,Et)|0,S=S+Math.imul(lt,Bt)|0,g=g+Math.imul(N,It)|0,p=(p=p+Math.imul(N,at)|0)+Math.imul(T,It)|0,S=S+Math.imul(T,at)|0,g=g+Math.imul(w,pt)|0,p=(p=p+Math.imul(w,_t)|0)+Math.imul(A,pt)|0,S=S+Math.imul(A,_t)|0,g=g+Math.imul(J,xt)|0,p=(p=p+Math.imul(J,St)|0)+Math.imul(it,xt)|0,S=S+Math.imul(it,St)|0;var ti=(q+(g=g+Math.imul(l,Tt)|0)|0)+((8191&(p=(p=p+Math.imul(l,Gt)|0)+Math.imul(z,Tt)|0))<<13)|0;q=((S=S+Math.imul(z,Gt)|0)+(p>>>13)|0)+(ti>>>26)|0,ti&=67108863,g=Math.imul(L,Mt),p=(p=Math.imul(L,Rt))+Math.imul(j,Mt)|0,S=Math.imul(j,Rt),g=g+Math.imul(O,Et)|0,p=(p=p+Math.imul(O,Bt)|0)+Math.imul(F,Et)|0,S=S+Math.imul(F,Bt)|0,g=g+Math.imul(yt,It)|0,p=(p=p+Math.imul(yt,at)|0)+Math.imul(lt,It)|0,S=S+Math.imul(lt,at)|0,g=g+Math.imul(N,pt)|0,p=(p=p+Math.imul(N,_t)|0)+Math.imul(T,pt)|0,S=S+Math.imul(T,_t)|0,g=g+Math.imul(w,xt)|0,p=(p=p+Math.imul(w,St)|0)+Math.imul(A,xt)|0,S=S+Math.imul(A,St)|0;var ei=(q+(g=g+Math.imul(J,Tt)|0)|0)+((8191&(p=(p=p+Math.imul(J,Gt)|0)+Math.imul(it,Tt)|0))<<13)|0;q=((S=S+Math.imul(it,Gt)|0)+(p>>>13)|0)+(ei>>>26)|0,ei&=67108863,g=Math.imul(L,Et),p=(p=Math.imul(L,Bt))+Math.imul(j,Et)|0,S=Math.imul(j,Bt),g=g+Math.imul(O,It)|0,p=(p=p+Math.imul(O,at)|0)+Math.imul(F,It)|0,S=S+Math.imul(F,at)|0,g=g+Math.imul(yt,pt)|0,p=(p=p+Math.imul(yt,_t)|0)+Math.imul(lt,pt)|0,S=S+Math.imul(lt,_t)|0,g=g+Math.imul(N,xt)|0,p=(p=p+Math.imul(N,St)|0)+Math.imul(T,xt)|0,S=S+Math.imul(T,St)|0;var ri=(q+(g=g+Math.imul(w,Tt)|0)|0)+((8191&(p=(p=p+Math.imul(w,Gt)|0)+Math.imul(A,Tt)|0))<<13)|0;q=((S=S+Math.imul(A,Gt)|0)+(p>>>13)|0)+(ri>>>26)|0,ri&=67108863,g=Math.imul(L,It),p=(p=Math.imul(L,at))+Math.imul(j,It)|0,S=Math.imul(j,at),g=g+Math.imul(O,pt)|0,p=(p=p+Math.imul(O,_t)|0)+Math.imul(F,pt)|0,S=S+Math.imul(F,_t)|0,g=g+Math.imul(yt,xt)|0,p=(p=p+Math.imul(yt,St)|0)+Math.imul(lt,xt)|0,S=S+Math.imul(lt,St)|0;var ii=(q+(g=g+Math.imul(N,Tt)|0)|0)+((8191&(p=(p=p+Math.imul(N,Gt)|0)+Math.imul(T,Tt)|0))<<13)|0;q=((S=S+Math.imul(T,Gt)|0)+(p>>>13)|0)+(ii>>>26)|0,ii&=67108863,g=Math.imul(L,pt),p=(p=Math.imul(L,_t))+Math.imul(j,pt)|0,S=Math.imul(j,_t),g=g+Math.imul(O,xt)|0,p=(p=p+Math.imul(O,St)|0)+Math.imul(F,xt)|0,S=S+Math.imul(F,St)|0;var ni=(q+(g=g+Math.imul(yt,Tt)|0)|0)+((8191&(p=(p=p+Math.imul(yt,Gt)|0)+Math.imul(lt,Tt)|0))<<13)|0;q=((S=S+Math.imul(lt,Gt)|0)+(p>>>13)|0)+(ni>>>26)|0,ni&=67108863,g=Math.imul(L,xt),p=(p=Math.imul(L,St))+Math.imul(j,xt)|0,S=Math.imul(j,St);var ai=(q+(g=g+Math.imul(O,Tt)|0)|0)+((8191&(p=(p=p+Math.imul(O,Gt)|0)+Math.imul(F,Tt)|0))<<13)|0;q=((S=S+Math.imul(F,Gt)|0)+(p>>>13)|0)+(ai>>>26)|0,ai&=67108863;var Ci=(q+(g=Math.imul(L,Tt))|0)+((8191&(p=(p=Math.imul(L,Gt))+Math.imul(j,Tt)|0))<<13)|0;return q=((S=Math.imul(j,Gt))+(p>>>13)|0)+(Ci>>>26)|0,Ci&=67108863,st[0]=xe,st[1]=Me,st[2]=Ie,st[3]=ir,st[4]=nr,st[5]=ar,st[6]=sr,st[7]=or,st[8]=cr,st[9]=ur,st[10]=Tr,st[11]=zr,st[12]=ti,st[13]=ei,st[14]=ri,st[15]=ii,st[16]=ni,st[17]=ai,st[18]=Ci,q!==0&&(st[19]=q,_.length++),_};function K(d,b,_){return new I().mulp(d,b,_)}function I(d,b){this.x=d,this.y=b}Math.imul||(y=m),a.prototype.mulTo=function(d,b){var _=this.length+d.length;return this.length===10&&d.length===10?y(this,d,b):_<63?m(this,d,b):_<1024?function(g,p,S){S.negative=p.negative^g.negative,S.length=g.length+p.length;for(var D=0,nt=0,st=0;st<S.length-1;st++){var q=nt;nt=0;for(var rt=67108863&D,ct=Math.min(st,p.length-1),dt=Math.max(0,st-g.length+1);dt<=ct;dt++){var ut=st-dt,ft=(0|g.words[ut])*(0|p.words[dt]),gt=67108863&ft;rt=67108863&(gt=gt+rt|0),nt+=(q=(q=q+(ft/67108864|0)|0)+(gt>>>26)|0)>>>26,q&=67108863}S.words[st]=rt,D=q,q=nt}return D!==0?S.words[st]=D:S.length--,S.strip()}(this,d,b):K(this,d,b)},I.prototype.makeRBT=function(d){for(var b=Array(d),_=a.prototype._countBits(d)-1,g=0;g<d;g++)b[g]=this.revBin(g,_,d);return b},I.prototype.revBin=function(d,b,_){if(d===0||d===_-1)return d;for(var g=0,p=0;p<b;p++)g|=(1&d)<<b-p-1,d>>=1;return g},I.prototype.permute=function(d,b,_,g,p,S){for(var D=0;D<S;D++)g[D]=b[d[D]],p[D]=_[d[D]]},I.prototype.transform=function(d,b,_,g,p,S){this.permute(S,d,b,_,g,p);for(var D=1;D<p;D<<=1)for(var nt=D<<1,st=Math.cos(2*Math.PI/nt),q=Math.sin(2*Math.PI/nt),rt=0;rt<p;rt+=nt)for(var ct=st,dt=q,ut=0;ut<D;ut++){var ft=_[rt+ut],gt=g[rt+ut],mt=_[rt+ut+D],B=g[rt+ut+D],Y=ct*mt-dt*B;B=ct*B+dt*mt,mt=Y,_[rt+ut]=ft+mt,g[rt+ut]=gt+B,_[rt+ut+D]=ft-mt,g[rt+ut+D]=gt-B,ut!==nt&&(Y=st*ct-q*dt,dt=st*dt+q*ct,ct=Y)}},I.prototype.guessLen13b=function(d,b){var _=1|Math.max(b,d),g=1&_,p=0;for(_=_/2|0;_;_>>>=1)p++;return 1<<p+1+g},I.prototype.conjugate=function(d,b,_){if(!(_<=1))for(var g=0;g<_/2;g++){var p=d[g];d[g]=d[_-g-1],d[_-g-1]=p,p=b[g],b[g]=-b[_-g-1],b[_-g-1]=-p}},I.prototype.normalize13b=function(d,b){for(var _=0,g=0;g<b/2;g++){var p=8192*Math.round(d[2*g+1]/b)+Math.round(d[2*g]/b)+_;d[g]=67108863&p,_=p<67108864?0:p/67108864|0}return d},I.prototype.convert13b=function(d,b,_,g){for(var p=0,S=0;S<b;S++)p+=0|d[S],_[2*S]=8191&p,p>>>=13,_[2*S+1]=8191&p,p>>>=13;for(S=2*b;S<g;++S)_[S]=0;i(p===0),i((-8192&p)==0)},I.prototype.stub=function(d){for(var b=Array(d),_=0;_<d;_++)b[_]=0;return b},I.prototype.mulp=function(d,b,_){var g=2*this.guessLen13b(d.length,b.length),p=this.makeRBT(g),S=this.stub(g),D=Array(g),nt=Array(g),st=Array(g),q=Array(g),rt=Array(g),ct=Array(g),dt=_.words;dt.length=g,this.convert13b(d.words,d.length,D,g),this.convert13b(b.words,b.length,q,g),this.transform(D,S,nt,st,g,p),this.transform(q,S,rt,ct,g,p);for(var ut=0;ut<g;ut++){var ft=nt[ut]*rt[ut]-st[ut]*ct[ut];st[ut]=nt[ut]*ct[ut]+st[ut]*rt[ut],nt[ut]=ft}return this.conjugate(nt,st,g),this.transform(nt,st,dt,S,g,p),this.conjugate(dt,S,g),this.normalize13b(dt,g),_.negative=d.negative^b.negative,_.length=d.length+b.length,_.strip()},a.prototype.mul=function(d){var b=new a(null);return b.words=Array(this.length+d.length),this.mulTo(d,b)},a.prototype.mulf=function(d){var b=new a(null);return b.words=Array(this.length+d.length),K(this,d,b)},a.prototype.imul=function(d){return this.clone().mulTo(d,this)},a.prototype.imuln=function(d){i(typeof d=="number"),i(d<67108864);for(var b=0,_=0;_<this.length;_++){var g=(0|this.words[_])*d,p=(67108863&g)+(67108863&b);b>>=26,b+=g/67108864|0,b+=p>>>26,this.words[_]=67108863&p}return b!==0&&(this.words[_]=b,this.length++),this},a.prototype.muln=function(d){return this.clone().imuln(d)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(d){var b=function(S){for(var D=Array(S.bitLength()),nt=0;nt<D.length;nt++){var st=nt/26|0,q=nt%26;D[nt]=(S.words[st]&1<<q)>>>q}return D}(d);if(b.length===0)return new a(1);for(var _=this,g=0;g<b.length&&b[g]===0;g++,_=_.sqr());if(++g<b.length)for(var p=_.sqr();g<b.length;g++,p=p.sqr())b[g]!==0&&(_=_.mul(p));return _},a.prototype.iushln=function(d){i(typeof d=="number"&&d>=0);var b,_=d%26,g=(d-_)/26,p=67108863>>>26-_<<26-_;if(_!==0){var S=0;for(b=0;b<this.length;b++){var D=this.words[b]&p,nt=(0|this.words[b])-D<<_;this.words[b]=nt|S,S=D>>>26-_}S&&(this.words[b]=S,this.length++)}if(g!==0){for(b=this.length-1;b>=0;b--)this.words[b+g]=this.words[b];for(b=0;b<g;b++)this.words[b]=0;this.length+=g}return this.strip()},a.prototype.ishln=function(d){return i(this.negative===0),this.iushln(d)},a.prototype.iushrn=function(d,b,_){var g;i(typeof d=="number"&&d>=0),g=b?(b-b%26)/26:0;var p=d%26,S=Math.min((d-p)/26,this.length),D=67108863^67108863>>>p<<p,nt=_;if(g=Math.max(0,g-=S),nt){for(var st=0;st<S;st++)nt.words[st]=this.words[st];nt.length=S}if(S!==0)if(this.length>S)for(this.length-=S,st=0;st<this.length;st++)this.words[st]=this.words[st+S];else this.words[0]=0,this.length=1;var q=0;for(st=this.length-1;st>=0&&(q!==0||st>=g);st--){var rt=0|this.words[st];this.words[st]=q<<26-p|rt>>>p,q=rt&D}return nt&&q!==0&&(nt.words[nt.length++]=q),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(d,b,_){return i(this.negative===0),this.iushrn(d,b,_)},a.prototype.shln=function(d){return this.clone().ishln(d)},a.prototype.ushln=function(d){return this.clone().iushln(d)},a.prototype.shrn=function(d){return this.clone().ishrn(d)},a.prototype.ushrn=function(d){return this.clone().iushrn(d)},a.prototype.testn=function(d){i(typeof d=="number"&&d>=0);var b=d%26,_=(d-b)/26,g=1<<b;return!(this.length<=_)&&!!(this.words[_]&g)},a.prototype.imaskn=function(d){i(typeof d=="number"&&d>=0);var b=d%26,_=(d-b)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=_)return this;if(b!==0&&_++,this.length=Math.min(_,this.length),b!==0){var g=67108863^67108863>>>b<<b;this.words[this.length-1]&=g}return this.strip()},a.prototype.maskn=function(d){return this.clone().imaskn(d)},a.prototype.iaddn=function(d){return i(typeof d=="number"),i(d<67108864),d<0?this.isubn(-d):this.negative!==0?this.length===1&&(0|this.words[0])<d?(this.words[0]=d-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(d),this.negative=1,this):this._iaddn(d)},a.prototype._iaddn=function(d){this.words[0]+=d;for(var b=0;b<this.length&&this.words[b]>=67108864;b++)this.words[b]-=67108864,b===this.length-1?this.words[b+1]=1:this.words[b+1]++;return this.length=Math.max(this.length,b+1),this},a.prototype.isubn=function(d){if(i(typeof d=="number"),i(d<67108864),d<0)return this.iaddn(-d);if(this.negative!==0)return this.negative=0,this.iaddn(d),this.negative=1,this;if(this.words[0]-=d,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var b=0;b<this.length&&this.words[b]<0;b++)this.words[b]+=67108864,this.words[b+1]-=1;return this.strip()},a.prototype.addn=function(d){return this.clone().iaddn(d)},a.prototype.subn=function(d){return this.clone().isubn(d)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(d,b,_){var g,p,S=d.length+_;this._expand(S);var D=0;for(g=0;g<d.length;g++){p=(0|this.words[g+_])+D;var nt=(0|d.words[g])*b;D=((p-=67108863&nt)>>26)-(nt/67108864|0),this.words[g+_]=67108863&p}for(;g<this.length-_;g++)D=(p=(0|this.words[g+_])+D)>>26,this.words[g+_]=67108863&p;if(D===0)return this.strip();for(i(D===-1),D=0,g=0;g<this.length;g++)D=(p=-(0|this.words[g])+D)>>26,this.words[g]=67108863&p;return this.negative=1,this.strip()},a.prototype._wordDiv=function(d,b){var _=(this.length,d.length),g=this.clone(),p=d,S=0|p.words[p.length-1];(_=26-this._countBits(S))!==0&&(p=p.ushln(_),g.iushln(_),S=0|p.words[p.length-1]);var D,nt=g.length-p.length;if(b!=="mod"){(D=new a(null)).length=nt+1,D.words=Array(D.length);for(var st=0;st<D.length;st++)D.words[st]=0}var q=g.clone()._ishlnsubmul(p,1,nt);q.negative===0&&(g=q,D&&(D.words[nt]=1));for(var rt=nt-1;rt>=0;rt--){var ct=67108864*(0|g.words[p.length+rt])+(0|g.words[p.length+rt-1]);for(ct=Math.min(ct/S|0,67108863),g._ishlnsubmul(p,ct,rt);g.negative!==0;)ct--,g.negative=0,g._ishlnsubmul(p,1,rt),g.isZero()||(g.negative^=1);D&&(D.words[rt]=ct)}return D&&D.strip(),g.strip(),b!=="div"&&_!==0&&g.iushrn(_),{div:D||null,mod:g}},a.prototype.divmod=function(d,b,_){return i(!d.isZero()),this.isZero()?{div:new a(0),mod:new a(0)}:this.negative!==0&&d.negative===0?(S=this.neg().divmod(d,b),b!=="mod"&&(g=S.div.neg()),b!=="div"&&(p=S.mod.neg(),_&&p.negative!==0&&p.iadd(d)),{div:g,mod:p}):this.negative===0&&d.negative!==0?(S=this.divmod(d.neg(),b),b!=="mod"&&(g=S.div.neg()),{div:g,mod:S.mod}):(this.negative&d.negative)!=0?(S=this.neg().divmod(d.neg(),b),b!=="div"&&(p=S.mod.neg(),_&&p.negative!==0&&p.isub(d)),{div:S.div,mod:p}):d.length>this.length||this.cmp(d)<0?{div:new a(0),mod:this}:d.length===1?b==="div"?{div:this.divn(d.words[0]),mod:null}:b==="mod"?{div:null,mod:new a(this.modn(d.words[0]))}:{div:this.divn(d.words[0]),mod:new a(this.modn(d.words[0]))}:this._wordDiv(d,b);var g,p,S},a.prototype.div=function(d){return this.divmod(d,"div",!1).div},a.prototype.mod=function(d){return this.divmod(d,"mod",!1).mod},a.prototype.umod=function(d){return this.divmod(d,"mod",!0).mod},a.prototype.divRound=function(d){var b=this.divmod(d);if(b.mod.isZero())return b.div;var _=b.div.negative!==0?b.mod.isub(d):b.mod,g=d.ushrn(1),p=d.andln(1),S=_.cmp(g);return S<0||p===1&&S===0?b.div:b.div.negative!==0?b.div.isubn(1):b.div.iaddn(1)},a.prototype.modn=function(d){i(d<=67108863);for(var b=(1<<26)%d,_=0,g=this.length-1;g>=0;g--)_=(b*_+(0|this.words[g]))%d;return _},a.prototype.idivn=function(d){i(d<=67108863);for(var b=0,_=this.length-1;_>=0;_--){var g=(0|this.words[_])+67108864*b;this.words[_]=g/d|0,b=g%d}return this.strip()},a.prototype.divn=function(d){return this.clone().idivn(d)},a.prototype.egcd=function(d){i(d.negative===0),i(!d.isZero());var b=this,_=d.clone();b=b.negative!==0?b.umod(d):b.clone();for(var g=new a(1),p=new a(0),S=new a(0),D=new a(1),nt=0;b.isEven()&&_.isEven();)b.iushrn(1),_.iushrn(1),++nt;for(var st=_.clone(),q=b.clone();!b.isZero();){for(var rt=0,ct=1;(b.words[0]&ct)==0&&rt<26;++rt,ct<<=1);if(rt>0)for(b.iushrn(rt);rt-- >0;)(g.isOdd()||p.isOdd())&&(g.iadd(st),p.isub(q)),g.iushrn(1),p.iushrn(1);for(var dt=0,ut=1;(_.words[0]&ut)==0&&dt<26;++dt,ut<<=1);if(dt>0)for(_.iushrn(dt);dt-- >0;)(S.isOdd()||D.isOdd())&&(S.iadd(st),D.isub(q)),S.iushrn(1),D.iushrn(1);b.cmp(_)>=0?(b.isub(_),g.isub(S),p.isub(D)):(_.isub(b),S.isub(g),D.isub(p))}return{a:S,b:D,gcd:_.iushln(nt)}},a.prototype._invmp=function(d){i(d.negative===0),i(!d.isZero());var b=this,_=d.clone();b=b.negative!==0?b.umod(d):b.clone();for(var g,p=new a(1),S=new a(0),D=_.clone();b.cmpn(1)>0&&_.cmpn(1)>0;){for(var nt=0,st=1;(b.words[0]&st)==0&&nt<26;++nt,st<<=1);if(nt>0)for(b.iushrn(nt);nt-- >0;)p.isOdd()&&p.iadd(D),p.iushrn(1);for(var q=0,rt=1;(_.words[0]&rt)==0&&q<26;++q,rt<<=1);if(q>0)for(_.iushrn(q);q-- >0;)S.isOdd()&&S.iadd(D),S.iushrn(1);b.cmp(_)>=0?(b.isub(_),p.isub(S)):(_.isub(b),S.isub(p))}return(g=b.cmpn(1)===0?p:S).cmpn(0)<0&&g.iadd(d),g},a.prototype.gcd=function(d){if(this.isZero())return d.abs();if(d.isZero())return this.abs();var b=this.clone(),_=d.clone();b.negative=0,_.negative=0;for(var g=0;b.isEven()&&_.isEven();g++)b.iushrn(1),_.iushrn(1);for(;;){for(;b.isEven();)b.iushrn(1);for(;_.isEven();)_.iushrn(1);var p=b.cmp(_);if(p<0){var S=b;b=_,_=S}else if(p===0||_.cmpn(1)===0)break;b.isub(_)}return _.iushln(g)},a.prototype.invm=function(d){return this.egcd(d).a.umod(d)},a.prototype.isEven=function(){return(1&this.words[0])==0},a.prototype.isOdd=function(){return(1&this.words[0])==1},a.prototype.andln=function(d){return this.words[0]&d},a.prototype.bincn=function(d){i(typeof d=="number");var b=d%26,_=(d-b)/26,g=1<<b;if(this.length<=_)return this._expand(_+1),this.words[_]|=g,this;for(var p=g,S=_;p!==0&&S<this.length;S++){var D=0|this.words[S];p=(D+=p)>>>26,D&=67108863,this.words[S]=D}return p!==0&&(this.words[S]=p,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(d){var b,_=d<0;if(this.negative!==0&&!_)return-1;if(this.negative===0&&_)return 1;if(this.strip(),this.length>1)b=1;else{_&&(d=-d),i(d<=67108863,"Number is too big");var g=0|this.words[0];b=g===d?0:g<d?-1:1}return this.negative!==0?0|-b:b},a.prototype.cmp=function(d){if(this.negative!==0&&d.negative===0)return-1;if(this.negative===0&&d.negative!==0)return 1;var b=this.ucmp(d);return this.negative!==0?0|-b:b},a.prototype.ucmp=function(d){if(this.length>d.length)return 1;if(this.length<d.length)return-1;for(var b=0,_=this.length-1;_>=0;_--){var g=0|this.words[_],p=0|d.words[_];if(g!==p){g<p?b=-1:g>p&&(b=1);break}}return b},a.prototype.gtn=function(d){return this.cmpn(d)===1},a.prototype.gt=function(d){return this.cmp(d)===1},a.prototype.gten=function(d){return this.cmpn(d)>=0},a.prototype.gte=function(d){return this.cmp(d)>=0},a.prototype.ltn=function(d){return this.cmpn(d)===-1},a.prototype.lt=function(d){return this.cmp(d)===-1},a.prototype.lten=function(d){return this.cmpn(d)<=0},a.prototype.lte=function(d){return this.cmp(d)<=0},a.prototype.eqn=function(d){return this.cmpn(d)===0},a.prototype.eq=function(d){return this.cmp(d)===0},a.red=function(d){return new X(d)},a.prototype.toRed=function(d){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),d.convertTo(this)._forceRed(d)},a.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(d){return this.red=d,this},a.prototype.forceRed=function(d){return i(!this.red,"Already a number in reduction context"),this._forceRed(d)},a.prototype.redAdd=function(d){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,d)},a.prototype.redIAdd=function(d){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,d)},a.prototype.redSub=function(d){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,d)},a.prototype.redISub=function(d){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,d)},a.prototype.redShl=function(d){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,d)},a.prototype.redMul=function(d){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,d),this.red.mul(this,d)},a.prototype.redIMul=function(d){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,d),this.red.imul(this,d)},a.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(d){return i(this.red&&!d.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,d)};var U={k256:null,p224:null,p192:null,p25519:null};function V(d,b){this.name=d,this.p=new a(b,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function Z(){V.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function $(){V.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function R(){V.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function tt(){V.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function X(d){if(typeof d=="string"){var b=a._prime(d);this.m=b.p,this.prime=b}else i(d.gtn(1),"modulus must be greater than 1"),this.m=d,this.prime=null}function Q(d){X.call(this,d),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}V.prototype._tmp=function(){var d=new a(null);return d.words=Array(Math.ceil(this.n/13)),d},V.prototype.ireduce=function(d){var b,_=d;do this.split(_,this.tmp),b=(_=(_=this.imulK(_)).iadd(this.tmp)).bitLength();while(b>this.n);var g=b<this.n?-1:_.ucmp(this.p);return g===0?(_.words[0]=0,_.length=1):g>0?_.isub(this.p):_.strip(),_},V.prototype.split=function(d,b){d.iushrn(this.n,0,b)},V.prototype.imulK=function(d){return d.imul(this.k)},n(Z,V),Z.prototype.split=function(d,b){for(var _=4194303,g=Math.min(d.length,9),p=0;p<g;p++)b.words[p]=d.words[p];if(b.length=g,d.length<=9)return d.words[0]=0,void(d.length=1);var S=d.words[9];for(b.words[b.length++]=S&_,p=10;p<d.length;p++){var D=0|d.words[p];d.words[p-10]=(D&_)<<4|S>>>22,S=D}S>>>=22,d.words[p-10]=S,S===0&&d.length>10?d.length-=10:d.length-=9},Z.prototype.imulK=function(d){d.words[d.length]=0,d.words[d.length+1]=0,d.length+=2;for(var b=0,_=0;_<d.length;_++){var g=0|d.words[_];b+=977*g,d.words[_]=67108863&b,b=64*g+(b/67108864|0)}return d.words[d.length-1]===0&&(d.length--,d.words[d.length-1]===0&&d.length--),d},n($,V),n(R,V),n(tt,V),tt.prototype.imulK=function(d){for(var b=0,_=0;_<d.length;_++){var g=19*(0|d.words[_])+b,p=67108863&g;g>>>=26,d.words[_]=p,b=g}return b!==0&&(d.words[d.length++]=b),d},a._prime=function(d){if(U[d])return U[d];var b;if(d==="k256")b=new Z;else if(d==="p224")b=new $;else if(d==="p192")b=new R;else{if(d!=="p25519")throw Error("Unknown prime "+d);b=new tt}return U[d]=b,b},X.prototype._verify1=function(d){i(d.negative===0,"red works only with positives"),i(d.red,"red works only with red numbers")},X.prototype._verify2=function(d,b){i((d.negative|b.negative)==0,"red works only with positives"),i(d.red&&d.red===b.red,"red works only with red numbers")},X.prototype.imod=function(d){return this.prime?this.prime.ireduce(d)._forceRed(this):d.umod(this.m)._forceRed(this)},X.prototype.neg=function(d){return d.isZero()?d.clone():this.m.sub(d)._forceRed(this)},X.prototype.add=function(d,b){this._verify2(d,b);var _=d.add(b);return _.cmp(this.m)>=0&&_.isub(this.m),_._forceRed(this)},X.prototype.iadd=function(d,b){this._verify2(d,b);var _=d.iadd(b);return _.cmp(this.m)>=0&&_.isub(this.m),_},X.prototype.sub=function(d,b){this._verify2(d,b);var _=d.sub(b);return _.cmpn(0)<0&&_.iadd(this.m),_._forceRed(this)},X.prototype.isub=function(d,b){this._verify2(d,b);var _=d.isub(b);return _.cmpn(0)<0&&_.iadd(this.m),_},X.prototype.shl=function(d,b){return this._verify1(d),this.imod(d.ushln(b))},X.prototype.imul=function(d,b){return this._verify2(d,b),this.imod(d.imul(b))},X.prototype.mul=function(d,b){return this._verify2(d,b),this.imod(d.mul(b))},X.prototype.isqr=function(d){return this.imul(d,d.clone())},X.prototype.sqr=function(d){return this.mul(d,d)},X.prototype.sqrt=function(d){if(d.isZero())return d.clone();var b=this.m.andln(3);if(i(b%2==1),b===3){var _=this.m.add(new a(1)).iushrn(2);return this.pow(d,_)}for(var g=this.m.subn(1),p=0;!g.isZero()&&g.andln(1)===0;)p++,g.iushrn(1);i(!g.isZero());var S=new a(1).toRed(this),D=S.redNeg(),nt=this.m.subn(1).iushrn(1),st=this.m.bitLength();for(st=new a(2*st*st).toRed(this);this.pow(st,nt).cmp(D)!==0;)st.redIAdd(D);for(var q=this.pow(st,g),rt=this.pow(d,g.addn(1).iushrn(1)),ct=this.pow(d,g),dt=p;ct.cmp(S)!==0;){for(var ut=ct,ft=0;ut.cmp(S)!==0;ft++)ut=ut.redSqr();i(ft<dt);var gt=this.pow(q,new a(1).iushln(dt-ft-1));rt=rt.redMul(gt),q=gt.redSqr(),ct=ct.redMul(q),dt=ft}return rt},X.prototype.invm=function(d){var b=d._invmp(this.m);return b.negative!==0?(b.negative=0,this.imod(b).redNeg()):this.imod(b)},X.prototype.pow=function(d,b){if(b.isZero())return new a(1).toRed(this);if(b.cmpn(1)===0)return d.clone();var _=Array(16);_[0]=new a(1).toRed(this),_[1]=d;for(var g=2;g<_.length;g++)_[g]=this.mul(_[g-1],d);var p=_[0],S=0,D=0,nt=b.bitLength()%26;for(nt===0&&(nt=26),g=b.length-1;g>=0;g--){for(var st=b.words[g],q=nt-1;q>=0;q--){var rt=st>>q&1;p!==_[0]&&(p=this.sqr(p)),rt!==0||S!==0?(S<<=1,S|=rt,(++D===4||g===0&&q===0)&&(p=this.mul(p,_[S]),D=0,S=0)):D=0}nt=26}return p},X.prototype.convertTo=function(d){var b=d.umod(this.m);return b===d?b.clone():b},X.prototype.convertFrom=function(d){var b=d.clone();return b.red=null,b},a.mont=function(d){return new Q(d)},n(Q,X),Q.prototype.convertTo=function(d){return this.imod(d.ushln(this.shift))},Q.prototype.convertFrom=function(d){var b=this.imod(d.mul(this.rinv));return b.red=null,b},Q.prototype.imul=function(d,b){if(d.isZero()||b.isZero())return d.words[0]=0,d.length=1,d;var _=d.imul(b),g=_.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),p=_.isub(g).iushrn(this.shift),S=p;return p.cmp(this.m)>=0?S=p.isub(this.m):p.cmpn(0)<0&&(S=p.iadd(this.m)),S._forceRed(this)},Q.prototype.mul=function(d,b){if(d.isZero()||b.isZero())return new a(0)._forceRed(this);var _=d.mul(b),g=_.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),p=_.isub(g).iushrn(this.shift),S=p;return p.cmp(this.m)>=0?S=p.isub(this.m):p.cmpn(0)<0&&(S=p.iadd(this.m)),S._forceRed(this)},Q.prototype.invm=function(d){return this.imod(d._invmp(this.m).mul(this.r2))._forceRed(this)}})(e,Z3)}),Zn=Object.freeze({__proto__:null,default:kt,__moduleExports:kt});class na{constructor(t){if(t===void 0)throw Error("Invalid BigInteger input");this.value=new kt(t)}clone(){const t=new na(null);return this.value.copy(t.value),t}iinc(){return this.value.iadd(new kt(1)),this}inc(){return this.clone().iinc()}idec(){return this.value.isub(new kt(1)),this}dec(){return this.clone().idec()}iadd(t){return this.value.iadd(t.value),this}add(t){return this.clone().iadd(t)}isub(t){return this.value.isub(t.value),this}sub(t){return this.clone().isub(t)}imul(t){return this.value.imul(t.value),this}mul(t){return this.clone().imul(t)}imod(t){return this.value=this.value.umod(t.value),this}mod(t){return this.clone().imod(t)}modExp(t,r){const i=r.isEven()?kt.red(r.value):kt.mont(r.value),n=this.clone();return n.value=n.value.toRed(i).redPow(t.value).fromRed(),n}modInv(t){if(!this.gcd(t).isOne())throw Error("Inverse does not exist");return new na(this.value.invm(t.value))}gcd(t){return new na(this.value.gcd(t.value))}ileftShift(t){return this.value.ishln(t.value.toNumber()),this}leftShift(t){return this.clone().ileftShift(t)}irightShift(t){return this.value.ishrn(t.value.toNumber()),this}rightShift(t){return this.clone().irightShift(t)}equal(t){return this.value.eq(t.value)}lt(t){return this.value.lt(t.value)}lte(t){return this.value.lte(t.value)}gt(t){return this.value.gt(t.value)}gte(t){return this.value.gte(t.value)}isZero(){return this.value.isZero()}isOne(){return this.value.eq(new kt(1))}isNegative(){return this.value.isNeg()}isEven(){return this.value.isEven()}abs(){const t=this.clone();return t.value=t.value.abs(),t}toString(){return this.value.toString()}toNumber(){return this.value.toNumber()}getBit(t){return this.value.testn(t)?1:0}bitLength(){return this.value.bitLength()}byteLength(){return this.value.byteLength()}toUint8Array(t="be",r){return this.value.toArrayLike(Uint8Array,t,r)}}var Io,kd=Object.freeze({__proto__:null,default:na}),Je=Br(function(e,t){var r=t;function i(a){return a.length===1?"0"+a:a}function n(a){for(var s="",o=0;o<a.length;o++)s+=i(a[o].toString(16));return s}r.toArray=function(a,s){if(Array.isArray(a))return a.slice();if(!a)return[];var o=[];if(typeof a!="string"){for(var u=0;u<a.length;u++)o[u]=0|a[u];return o}if(s==="hex")for((a=a.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(a="0"+a),u=0;u<a.length;u+=2)o.push(parseInt(a[u]+a[u+1],16));else for(u=0;u<a.length;u++){var c=a.charCodeAt(u),h=c>>8,f=255&c;h?o.push(h,f):o.push(f)}return o},r.zero2=i,r.toHex=n,r.encode=function(a,s){return s==="hex"?n(a):a}}),Yt=Br(function(e,t){var r=t;r.assert=xi,r.toArray=Je.toArray,r.zero2=Je.zero2,r.toHex=Je.toHex,r.encode=Je.encode,r.getNAF=function(i,n){for(var a=[],s=1<<n+1,o=i.clone();o.cmpn(1)>=0;){var u;if(o.isOdd()){var c=o.andln(s-1);u=c>(s>>1)-1?(s>>1)-c:c,o.isubn(u)}else u=0;a.push(u);for(var h=o.cmpn(0)!==0&&o.andln(s-1)===0?n+1:1,f=1;f<h;f++)a.push(0);o.iushrn(h)}return a},r.getJSF=function(i,n){var a=[[],[]];i=i.clone(),n=n.clone();for(var s=0,o=0;i.cmpn(-s)>0||n.cmpn(-o)>0;){var u,c,h,f=i.andln(3)+s&3,m=n.andln(3)+o&3;f===3&&(f=-1),m===3&&(m=-1),(1&f)==0?u=0:u=(h=i.andln(7)+s&7)!==3&&h!==5||m!==2?f:-f,a[0].push(u),(1&m)==0?c=0:c=(h=n.andln(7)+o&7)!==3&&h!==5||f!==2?m:-m,a[1].push(c),2*s===u+1&&(s=1-s),2*o===c+1&&(o=1-o),i.iushrn(1),n.iushrn(1)}return a},r.cachedProperty=function(i,n,a){var s="_"+n;i.prototype[n]=function(){return this[s]!==void 0?this[s]:this[s]=a.call(this)}},r.parseBytes=function(i){return typeof i=="string"?r.toArray(i,"hex"):i},r.intFromLE=function(i){return new kt(i,"hex","le")}}),ao=function(e){return Io||(Io=new pi(null)),Io.generate(e)};function pi(e){this.rand=e}var Ad=pi;if(pi.prototype.generate=function(e){return this._rand(e)},pi.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),r=0;r<t.length;r++)t[r]=this.rand.getByte();return t},typeof self=="object")self.crypto&&self.crypto.getRandomValues?pi.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?pi.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:typeof window=="object"&&(pi.prototype._rand=function(){throw Error("Not implemented yet")});else try{if(typeof(void 0).randomBytes!="function")throw Error("Not supported");pi.prototype._rand=function(e){return(void 0).randomBytes(e)}}catch{}ao.Rand=Ad;var ja=Yt.getNAF,Sd=Yt.getJSF,Wa=Yt.assert;function li(e,t){this.type=e,this.p=new kt(t.p,16),this.red=t.prime?kt.red(t.prime):kt.mont(this.p),this.zero=new kt(0).toRed(this.red),this.one=new kt(1).toRed(this.red),this.two=new kt(2).toRed(this.red),this.n=t.n&&new kt(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=[,,,,],this._wnafT2=[,,,,],this._wnafT3=[,,,,],this._wnafT4=[,,,,];var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Re=li;function He(e,t){this.curve=e,this.type=t,this.precomputed=null}li.prototype.point=function(){throw Error("Not implemented")},li.prototype.validate=function(){throw Error("Not implemented")},li.prototype._fixedNafMul=function(e,t){Wa(e.precomputed);var r=e._getDoubles(),i=ja(t,1),n=(1<<r.step+1)-(r.step%2==0?2:1);n/=3;for(var a=[],s=0;s<i.length;s+=r.step){var o=0;for(t=s+r.step-1;t>=s;t--)o=(o<<1)+i[t];a.push(o)}for(var u=this.jpoint(null,null,null),c=this.jpoint(null,null,null),h=n;h>0;h--){for(s=0;s<a.length;s++)(o=a[s])===h?c=c.mixedAdd(r.points[s]):o===-h&&(c=c.mixedAdd(r.points[s].neg()));u=u.add(c)}return u.toP()},li.prototype._wnafMul=function(e,t){var r=4,i=e._getNAFPoints(r);r=i.wnd;for(var n=i.points,a=ja(t,r),s=this.jpoint(null,null,null),o=a.length-1;o>=0;o--){for(t=0;o>=0&&a[o]===0;o--)t++;if(o>=0&&t++,s=s.dblp(t),o<0)break;var u=a[o];Wa(u!==0),s=e.type==="affine"?u>0?s.mixedAdd(n[u-1>>1]):s.mixedAdd(n[-u-1>>1].neg()):u>0?s.add(n[u-1>>1]):s.add(n[-u-1>>1].neg())}return e.type==="affine"?s.toP():s},li.prototype._wnafMulAdd=function(e,t,r,i,n){for(var a=this._wnafT1,s=this._wnafT2,o=this._wnafT3,u=0,c=0;c<i;c++){var h=(Q=t[c])._getNAFPoints(e);a[c]=h.wnd,s[c]=h.points}for(c=i-1;c>=1;c-=2){var f=c-1,m=c;if(a[f]===1&&a[m]===1){var y=[t[f],null,null,t[m]];t[f].y.cmp(t[m].y)===0?(y[1]=t[f].add(t[m]),y[2]=t[f].toJ().mixedAdd(t[m].neg())):t[f].y.cmp(t[m].y.redNeg())===0?(y[1]=t[f].toJ().mixedAdd(t[m]),y[2]=t[f].add(t[m].neg())):(y[1]=t[f].toJ().mixedAdd(t[m]),y[2]=t[f].toJ().mixedAdd(t[m].neg()));var K=[-3,-1,-5,-7,0,7,5,1,3],I=Sd(r[f],r[m]);u=Math.max(I[0].length,u),o[f]=Array(u),o[m]=Array(u);for(var U=0;U<u;U++){var V=0|I[0][U],Z=0|I[1][U];o[f][U]=K[3*(V+1)+(Z+1)],o[m][U]=0,s[f]=y}}else o[f]=ja(r[f],a[f]),o[m]=ja(r[m],a[m]),u=Math.max(o[f].length,u),u=Math.max(o[m].length,u)}var $=this.jpoint(null,null,null),R=this._wnafT4;for(c=u;c>=0;c--){for(var tt=0;c>=0;){var X=!0;for(U=0;U<i;U++)R[U]=0|o[U][c],R[U]!==0&&(X=!1);if(!X)break;tt++,c--}if(c>=0&&tt++,$=$.dblp(tt),c<0)break;for(U=0;U<i;U++){var Q,d=R[U];d!==0&&(d>0?Q=s[U][d-1>>1]:d<0&&(Q=s[U][-d-1>>1].neg()),$=Q.type==="affine"?$.mixedAdd(Q):$.add(Q))}}for(c=0;c<i;c++)s[c]=null;return n?$:$.toP()},li.BasePoint=He,He.prototype.eq=function(){throw Error("Not implemented")},He.prototype.validate=function(){return this.curve.validate(this)},li.prototype.decodePoint=function(e,t){e=Yt.toArray(e,t);var r=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1==2*r)return e[0]===6?Wa(e[e.length-1]%2==0):e[0]===7&&Wa(e[e.length-1]%2==1),this.point(e.slice(1,1+r),e.slice(1+r,1+2*r));if((e[0]===2||e[0]===3)&&e.length-1===r)return this.pointFromX(e.slice(1,1+r),e[0]===3);throw Error("Unknown point format")},He.prototype.encodeCompressed=function(e){return this.encode(e,!0)},He.prototype._encode=function(e){var t=this.curve.p.byteLength(),r=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",t))},He.prototype.encode=function(e,t){return Yt.encode(this._encode(t),e)},He.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},He.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},He.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],i=this,n=0;n<t;n+=e){for(var a=0;a<e;a++)i=i.dbl();r.push(i)}return{step:e,points:r}},He.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],r=(1<<e)-1,i=r===1?null:this.dbl(),n=1;n<r;n++)t[n]=t[n-1].add(i);return{wnd:e,points:t}},He.prototype._getBeta=function(){return null},He.prototype.dblp=function(e){for(var t=this,r=0;r<e;r++)t=t.dbl();return t};var Ed=Yt.assert;function Ve(e){Re.call(this,"short",e),this.a=new kt(e.a,16).toRed(this.red),this.b=new kt(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(e),this._endoWnafT1=[,,,,],this._endoWnafT2=[,,,,]}_i(Ve,Re);var Pd=Ve;function ue(e,t,r,i){Re.BasePoint.call(this,e,"affine"),t===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new kt(t,16),this.y=new kt(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function pe(e,t,r,i){Re.BasePoint.call(this,e,"jacobian"),t===null&&r===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new kt(0)):(this.x=new kt(t,16),this.y=new kt(r,16),this.z=new kt(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}function dn(e){Re.call(this,"mont",e),this.a=new kt(e.a,16).toRed(this.red),this.b=new kt(e.b,16).toRed(this.red),this.i4=new kt(4).toRed(this.red).redInvm(),this.two=new kt(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}Ve.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var t,r;if(e.beta)t=new kt(e.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);t=(t=i[0].cmp(i[1])<0?i[0]:i[1]).toRed(this.red)}if(e.lambda)r=new kt(e.lambda,16);else{var n=this._getEndoRoots(this.n);this.g.mul(n[0]).x.cmp(this.g.x.redMul(t))===0?r=n[0]:(r=n[1],Ed(this.g.mul(r).x.cmp(this.g.x.redMul(t))===0))}return{beta:t,lambda:r,basis:e.basis?e.basis.map(function(a){return{a:new kt(a.a,16),b:new kt(a.b,16)}}):this._getEndoBasis(r)}}},Ve.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:kt.mont(e),r=new kt(2).toRed(t).redInvm(),i=r.redNeg(),n=new kt(3).toRed(t).redNeg().redSqrt().redMul(r);return[i.redAdd(n).fromRed(),i.redSub(n).fromRed()]},Ve.prototype._getEndoBasis=function(e){for(var t,r,i,n,a,s,o,u,c,h=this.n.ushrn(Math.floor(this.n.bitLength()/2)),f=e,m=this.n.clone(),y=new kt(1),K=new kt(0),I=new kt(0),U=new kt(1),V=0;f.cmpn(0)!==0;){var Z=m.div(f);u=m.sub(Z.mul(f)),c=I.sub(Z.mul(y));var $=U.sub(Z.mul(K));if(!i&&u.cmp(h)<0)t=o.neg(),r=y,i=u.neg(),n=c;else if(i&&++V==2)break;o=u,m=f,f=u,I=y,y=c,U=K,K=$}a=u.neg(),s=c;var R=i.sqr().add(n.sqr());return a.sqr().add(s.sqr()).cmp(R)>=0&&(a=t,s=r),i.negative&&(i=i.neg(),n=n.neg()),a.negative&&(a=a.neg(),s=s.neg()),[{a:i,b:n},{a,b:s}]},Ve.prototype._endoSplit=function(e){var t=this.endo.basis,r=t[0],i=t[1],n=i.b.mul(e).divRound(this.n),a=r.b.neg().mul(e).divRound(this.n),s=n.mul(r.a),o=a.mul(i.a),u=n.mul(r.b),c=a.mul(i.b);return{k1:e.sub(s).sub(o),k2:u.add(c).neg()}},Ve.prototype.pointFromX=function(e,t){(e=new kt(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),i=r.redSqrt();if(i.redSqr().redSub(r).cmp(this.zero)!==0)throw Error("invalid point");var n=i.fromRed().isOdd();return(t&&!n||!t&&n)&&(i=i.redNeg()),this.point(e,i)},Ve.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,r=e.y,i=this.a.redMul(t),n=t.redSqr().redMul(t).redIAdd(i).redIAdd(this.b);return r.redSqr().redISub(n).cmpn(0)===0},Ve.prototype._endoWnafMulAdd=function(e,t,r){for(var i=this._endoWnafT1,n=this._endoWnafT2,a=0;a<e.length;a++){var s=this._endoSplit(t[a]),o=e[a],u=o._getBeta();s.k1.negative&&(s.k1.ineg(),o=o.neg(!0)),s.k2.negative&&(s.k2.ineg(),u=u.neg(!0)),i[2*a]=o,i[2*a+1]=u,n[2*a]=s.k1,n[2*a+1]=s.k2}for(var c=this._wnafMulAdd(1,i,n,2*a,r),h=0;h<2*a;h++)i[h]=null,n[h]=null;return c},_i(ue,Re.BasePoint),Ve.prototype.point=function(e,t,r){return new ue(this,e,t,r)},Ve.prototype.pointFromJSON=function(e,t){return ue.fromJSON(this,e,t)},ue.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var r=this.curve,i=function(n){return r.point(n.x.redMul(r.endo.beta),n.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return t}},ue.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},ue.fromJSON=function(e,t,r){typeof t=="string"&&(t=JSON.parse(t));var i=e.point(t[0],t[1],r);if(!t[2])return i;function n(s){return e.point(s[0],s[1],r)}var a=t[2];return i.precomputed={beta:null,doubles:a.doubles&&{step:a.doubles.step,points:[i].concat(a.doubles.points.map(n))},naf:a.naf&&{wnd:a.naf.wnd,points:[i].concat(a.naf.points.map(n))}},i},ue.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},ue.prototype.isInfinity=function(){return this.inf},ue.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var r=t.redSqr().redISub(this.x).redISub(e.x),i=t.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,i)},ue.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,r=this.x.redSqr(),i=e.redInvm(),n=r.redAdd(r).redIAdd(r).redIAdd(t).redMul(i),a=n.redSqr().redISub(this.x.redAdd(this.x)),s=n.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,s)},ue.prototype.getX=function(){return this.x.fromRed()},ue.prototype.getY=function(){return this.y.fromRed()},ue.prototype.mul=function(e){return e=new kt(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},ue.prototype.mulAdd=function(e,t,r){var i=[this,t],n=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,n):this.curve._wnafMulAdd(1,i,n,2)},ue.prototype.jmulAdd=function(e,t,r){var i=[this,t],n=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,n,!0):this.curve._wnafMulAdd(1,i,n,2,!0)},ue.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)},ue.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var r=this.precomputed,i=function(n){return n.neg()};t.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(i)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(i)}}}return t},ue.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},_i(pe,Re.BasePoint),Ve.prototype.jpoint=function(e,t,r){return new pe(this,e,t,r)},pe.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),r=this.x.redMul(t),i=this.y.redMul(t).redMul(e);return this.curve.point(r,i)},pe.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},pe.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),r=this.z.redSqr(),i=this.x.redMul(t),n=e.x.redMul(r),a=this.y.redMul(t.redMul(e.z)),s=e.y.redMul(r.redMul(this.z)),o=i.redSub(n),u=a.redSub(s);if(o.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var c=o.redSqr(),h=c.redMul(o),f=i.redMul(c),m=u.redSqr().redIAdd(h).redISub(f).redISub(f),y=u.redMul(f.redISub(m)).redISub(a.redMul(h)),K=this.z.redMul(e.z).redMul(o);return this.curve.jpoint(m,y,K)},pe.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),r=this.x,i=e.x.redMul(t),n=this.y,a=e.y.redMul(t).redMul(this.z),s=r.redSub(i),o=n.redSub(a);if(s.cmpn(0)===0)return o.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=s.redSqr(),c=u.redMul(s),h=r.redMul(u),f=o.redSqr().redIAdd(c).redISub(h).redISub(h),m=o.redMul(h.redISub(f)).redISub(n.redMul(c)),y=this.z.redMul(s);return this.curve.jpoint(f,m,y)},pe.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var t=this,r=0;r<e;r++)t=t.dbl();return t}var i=this.curve.a,n=this.curve.tinv,a=this.x,s=this.y,o=this.z,u=o.redSqr().redSqr(),c=s.redAdd(s);for(r=0;r<e;r++){var h=a.redSqr(),f=c.redSqr(),m=f.redSqr(),y=h.redAdd(h).redIAdd(h).redIAdd(i.redMul(u)),K=a.redMul(f),I=y.redSqr().redISub(K.redAdd(K)),U=K.redISub(I),V=y.redMul(U);V=V.redIAdd(V).redISub(m);var Z=c.redMul(o);r+1<e&&(u=u.redMul(m)),a=I,o=Z,c=V}return this.curve.jpoint(a,c.redMul(n),o)},pe.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},pe.prototype._zeroDbl=function(){var e,t,r;if(this.zOne){var i=this.x.redSqr(),n=this.y.redSqr(),a=n.redSqr(),s=this.x.redAdd(n).redSqr().redISub(i).redISub(a);s=s.redIAdd(s);var o=i.redAdd(i).redIAdd(i),u=o.redSqr().redISub(s).redISub(s),c=a.redIAdd(a);c=(c=c.redIAdd(c)).redIAdd(c),e=u,t=o.redMul(s.redISub(u)).redISub(c),r=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),f=this.y.redSqr(),m=f.redSqr(),y=this.x.redAdd(f).redSqr().redISub(h).redISub(m);y=y.redIAdd(y);var K=h.redAdd(h).redIAdd(h),I=K.redSqr(),U=m.redIAdd(m);U=(U=U.redIAdd(U)).redIAdd(U),e=I.redISub(y).redISub(y),t=K.redMul(y.redISub(e)).redISub(U),r=(r=this.y.redMul(this.z)).redIAdd(r)}return this.curve.jpoint(e,t,r)},pe.prototype._threeDbl=function(){var e,t,r;if(this.zOne){var i=this.x.redSqr(),n=this.y.redSqr(),a=n.redSqr(),s=this.x.redAdd(n).redSqr().redISub(i).redISub(a);s=s.redIAdd(s);var o=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),u=o.redSqr().redISub(s).redISub(s);e=u;var c=a.redIAdd(a);c=(c=c.redIAdd(c)).redIAdd(c),t=o.redMul(s.redISub(u)).redISub(c),r=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),f=this.y.redSqr(),m=this.x.redMul(f),y=this.x.redSub(h).redMul(this.x.redAdd(h));y=y.redAdd(y).redIAdd(y);var K=m.redIAdd(m),I=(K=K.redIAdd(K)).redAdd(K);e=y.redSqr().redISub(I),r=this.y.redAdd(this.z).redSqr().redISub(f).redISub(h);var U=f.redSqr();U=(U=(U=U.redIAdd(U)).redIAdd(U)).redIAdd(U),t=y.redMul(K.redISub(e)).redISub(U)}return this.curve.jpoint(e,t,r)},pe.prototype._dbl=function(){var e=this.curve.a,t=this.x,r=this.y,i=this.z,n=i.redSqr().redSqr(),a=t.redSqr(),s=r.redSqr(),o=a.redAdd(a).redIAdd(a).redIAdd(e.redMul(n)),u=t.redAdd(t),c=(u=u.redIAdd(u)).redMul(s),h=o.redSqr().redISub(c.redAdd(c)),f=c.redISub(h),m=s.redSqr();m=(m=(m=m.redIAdd(m)).redIAdd(m)).redIAdd(m);var y=o.redMul(f).redISub(m),K=r.redAdd(r).redMul(i);return this.curve.jpoint(h,y,K)},pe.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr(),i=t.redSqr(),n=e.redAdd(e).redIAdd(e),a=n.redSqr(),s=this.x.redAdd(t).redSqr().redISub(e).redISub(i),o=(s=(s=(s=s.redIAdd(s)).redAdd(s).redIAdd(s)).redISub(a)).redSqr(),u=i.redIAdd(i);u=(u=(u=u.redIAdd(u)).redIAdd(u)).redIAdd(u);var c=n.redIAdd(s).redSqr().redISub(a).redISub(o).redISub(u),h=t.redMul(c);h=(h=h.redIAdd(h)).redIAdd(h);var f=this.x.redMul(o).redISub(h);f=(f=f.redIAdd(f)).redIAdd(f);var m=this.y.redMul(c.redMul(u.redISub(c)).redISub(s.redMul(o)));m=(m=(m=m.redIAdd(m)).redIAdd(m)).redIAdd(m);var y=this.z.redAdd(s).redSqr().redISub(r).redISub(o);return this.curve.jpoint(f,m,y)},pe.prototype.mul=function(e,t){return e=new kt(e,t),this.curve._wnafMul(this,e)},pe.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),r=e.z.redSqr();if(this.x.redMul(r).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var i=t.redMul(this.z),n=r.redMul(e.z);return this.y.redMul(n).redISub(e.y.redMul(i)).cmpn(0)===0},pe.prototype.eqXToP=function(e){var t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(r)===0)return!0;for(var i=e.clone(),n=this.curve.redN.redMul(t);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(n),this.x.cmp(r)===0)return!0}},pe.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},pe.prototype.isInfinity=function(){return this.z.cmpn(0)===0},_i(dn,Re);var xd=dn;function he(e,t,r){Re.BasePoint.call(this,e,"projective"),t===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new kt(t,16),this.z=new kt(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}dn.prototype.validate=function(e){var t=e.normalize().x,r=t.redSqr(),i=r.redMul(t).redAdd(r.redMul(this.a)).redAdd(t);return i.redSqrt().redSqr().cmp(i)===0},_i(he,Re.BasePoint),dn.prototype.decodePoint=function(e,t){if((e=Yt.toArray(e,t)).length===33&&e[0]===64&&(e=e.slice(1,33).reverse()),e.length!==32)throw Error("Unknown point compression format");return this.point(e,1)},dn.prototype.point=function(e,t){return new he(this,e,t)},dn.prototype.pointFromJSON=function(e){return he.fromJSON(this,e)},he.prototype.precompute=function(){},he.prototype._encode=function(e){var t=this.curve.p.byteLength();return e?[64].concat(this.getX().toArray("le",t)):this.getX().toArray("be",t)},he.fromJSON=function(e,t){return new he(e,t[0],t[1]||e.one)},he.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},he.prototype.isInfinity=function(){return this.z.cmpn(0)===0},he.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),r=e.redSub(t),i=e.redMul(t),n=r.redMul(t.redAdd(this.curve.a24.redMul(r)));return this.curve.point(i,n)},he.prototype.add=function(){throw Error("Not supported on Montgomery curve")},he.prototype.diffAdd=function(e,t){var r=this.x.redAdd(this.z),i=this.x.redSub(this.z),n=e.x.redAdd(e.z),a=e.x.redSub(e.z).redMul(r),s=n.redMul(i),o=t.z.redMul(a.redAdd(s).redSqr()),u=t.x.redMul(a.redISub(s).redSqr());return this.curve.point(o,u)},he.prototype.mul=function(e){for(var t=(e=new kt(e,16)).clone(),r=this,i=this.curve.point(null,null),n=[];t.cmpn(0)!==0;t.iushrn(1))n.push(t.andln(1));for(var a=n.length-1;a>=0;a--)n[a]===0?(r=r.diffAdd(i,this),i=i.dbl()):(i=r.diffAdd(i,this),r=r.dbl());return i},he.prototype.mulAdd=function(){throw Error("Not supported on Montgomery curve")},he.prototype.jumlAdd=function(){throw Error("Not supported on Montgomery curve")},he.prototype.eq=function(e){return this.getX().cmp(e.getX())===0},he.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},he.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var Md=Yt.assert;function pr(e){this.twisted=(0|e.a)!=1,this.mOneA=this.twisted&&(0|e.a)==-1,this.extended=this.mOneA,Re.call(this,"edwards",e),this.a=new kt(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new kt(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new kt(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),Md(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|e.c)==1}_i(pr,Re);var Cd=pr;function Qt(e,t,r,i,n){Re.BasePoint.call(this,e,"projective"),t===null&&r===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new kt(t,16),this.y=new kt(r,16),this.z=i?new kt(i,16):this.curve.one,this.t=n&&new kt(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}pr.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},pr.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},pr.prototype.jpoint=function(e,t,r,i){return this.point(e,t,r,i)},pr.prototype.pointFromX=function(e,t){(e=new kt(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),i=this.c2.redSub(this.a.redMul(r)),n=this.one.redSub(this.c2.redMul(this.d).redMul(r)),a=i.redMul(n.redInvm()),s=a.redSqrt();if(s.redSqr().redSub(a).cmp(this.zero)!==0)throw Error("invalid point");var o=s.fromRed().isOdd();return(t&&!o||!t&&o)&&(s=s.redNeg()),this.point(e,s)},pr.prototype.pointFromY=function(e,t){(e=new kt(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),i=r.redSub(this.c2),n=r.redMul(this.d).redMul(this.c2).redSub(this.a),a=i.redMul(n.redInvm());if(a.cmp(this.zero)===0){if(t)throw Error("invalid point");return this.point(this.zero,e)}var s=a.redSqrt();if(s.redSqr().redSub(a).cmp(this.zero)!==0)throw Error("invalid point");return s.fromRed().isOdd()!==t&&(s=s.redNeg()),this.point(s,e)},pr.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),r=e.y.redSqr(),i=t.redMul(this.a).redAdd(r),n=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(r)));return i.cmp(n)===0},_i(Qt,Re.BasePoint),pr.prototype.pointFromJSON=function(e){return Qt.fromJSON(this,e)},pr.prototype.point=function(e,t,r,i){return new Qt(this,e,t,r,i)},Qt.fromJSON=function(e,t){return new Qt(e,t[0],t[1],t[2])},Qt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Qt.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},Qt.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr();r=r.redIAdd(r);var i=this.curve._mulA(e),n=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),a=i.redAdd(t),s=a.redSub(r),o=i.redSub(t),u=n.redMul(s),c=a.redMul(o),h=n.redMul(o),f=s.redMul(a);return this.curve.point(u,c,f,h)},Qt.prototype._projDbl=function(){var e,t,r,i=this.x.redAdd(this.y).redSqr(),n=this.x.redSqr(),a=this.y.redSqr();if(this.curve.twisted){var s=(c=this.curve._mulA(n)).redAdd(a);if(this.zOne)e=i.redSub(n).redSub(a).redMul(s.redSub(this.curve.two)),t=s.redMul(c.redSub(a)),r=s.redSqr().redSub(s).redSub(s);else{var o=this.z.redSqr(),u=s.redSub(o).redISub(o);e=i.redSub(n).redISub(a).redMul(u),t=s.redMul(c.redSub(a)),r=s.redMul(u)}}else{var c=n.redAdd(a);o=this.curve._mulC(this.z).redSqr(),u=c.redSub(o).redSub(o),e=this.curve._mulC(i.redISub(c)).redMul(u),t=this.curve._mulC(c).redMul(n.redISub(a)),r=c.redMul(u)}return this.curve.point(e,t,r)},Qt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},Qt.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),r=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),i=this.t.redMul(this.curve.dd).redMul(e.t),n=this.z.redMul(e.z.redAdd(e.z)),a=r.redSub(t),s=n.redSub(i),o=n.redAdd(i),u=r.redAdd(t),c=a.redMul(s),h=o.redMul(u),f=a.redMul(u),m=s.redMul(o);return this.curve.point(c,h,m,f)},Qt.prototype._projAdd=function(e){var t,r,i=this.z.redMul(e.z),n=i.redSqr(),a=this.x.redMul(e.x),s=this.y.redMul(e.y),o=this.curve.d.redMul(a).redMul(s),u=n.redSub(o),c=n.redAdd(o),h=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(a).redISub(s),f=i.redMul(u).redMul(h);return this.curve.twisted?(t=i.redMul(c).redMul(s.redSub(this.curve._mulA(a))),r=u.redMul(c)):(t=i.redMul(c).redMul(s.redSub(a)),r=this.curve._mulC(u).redMul(c)),this.curve.point(f,t,r)},Qt.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},Qt.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},Qt.prototype.mulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!1)},Qt.prototype.jmulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!0)},Qt.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},Qt.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},Qt.prototype.getX=function(){return this.normalize(),this.x.fromRed()},Qt.prototype.getY=function(){return this.normalize(),this.y.fromRed()},Qt.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0},Qt.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(t)===0)return!0;for(var r=e.clone(),i=this.curve.redN.redMul(this.z);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(i),this.x.cmp(t)===0)return!0}},Qt.prototype.toP=Qt.prototype.normalize,Qt.prototype.mixedAdd=Qt.prototype.add;var es=Br(function(e,t){var r=t;r.base=Re,r.short=Pd,r.mont=xd,r.edwards=Cd}),Uo=Ft.rotl32,Tn=Ft.sum32,Dd=Ft.sum32_5,Kd=Qi.ft_1,F3=va.BlockHash,Rd=[1518500249,1859775393,2400959708,3395469782];function vr(){if(!(this instanceof vr))return new vr;F3.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=Array(80)}Ft.inherits(vr,F3);var Id=vr;vr.blockSize=512,vr.outSize=160,vr.hmacStrength=80,vr.padLength=64,vr.prototype._update=function(e,t){for(var r=this.W,i=0;i<16;i++)r[i]=e[t+i];for(;i<r.length;i++)r[i]=Uo(r[i-3]^r[i-8]^r[i-14]^r[i-16],1);var n=this.h[0],a=this.h[1],s=this.h[2],o=this.h[3],u=this.h[4];for(i=0;i<r.length;i++){var c=~~(i/20),h=Dd(Uo(n,5),Kd(c,a,s,o),u,r[i],Rd[c]);u=o,o=s,s=Uo(a,30),a=n,n=h}this.h[0]=Tn(this.h[0],n),this.h[1]=Tn(this.h[1],a),this.h[2]=Tn(this.h[2],s),this.h[3]=Tn(this.h[3],o),this.h[4]=Tn(this.h[4],u)},vr.prototype._digest=function(e){return e==="hex"?Ft.toHex32(this.h,"big"):Ft.split32(this.h,"big")};var Ud={sha1:Id,sha224:Q2,sha256:v0,sha384:rc,sha512:_a};function bn(e,t,r){if(!(this instanceof bn))return new bn(e,t,r);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(Ft.toArray(t,r))}var Bd=bn;bn.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),xi(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=new this.Hash().update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)},bn.prototype.update=function(e,t){return this.inner.update(e,t),this},bn.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)};var Oe=Br(function(e,t){var r=t;r.utils=Ft,r.common=va,r.sha=Ud,r.ripemd=Cu,r.hmac=Bd,r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160}),Td={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}},aa=Br(function(e,t){var r,i=t,n=Yt.assert;function a(o){if(o.type==="short")this.curve=new es.short(o);else if(o.type==="edwards")this.curve=new es.edwards(o);else{if(o.type!=="mont")throw Error("Unknown curve type.");this.curve=new es.mont(o)}this.g=this.curve.g,this.n=this.curve.n,this.hash=o.hash,n(this.g.validate(),"Invalid curve"),n(this.g.mul(this.n).isInfinity(),"Invalid curve, n*G != O")}function s(o,u){Object.defineProperty(i,o,{configurable:!0,enumerable:!0,get:function(){var c=new a(u);return Object.defineProperty(i,o,{configurable:!0,enumerable:!0,value:c}),c}})}i.PresetCurve=a,s("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Oe.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),s("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Oe.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),s("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Oe.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),s("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Oe.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),s("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Oe.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),s("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",cofactor:"8",hash:Oe.sha256,gRed:!1,g:["9"]}),s("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",cofactor:"8",hash:Oe.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]}),s("brainpoolP256r1",{type:"short",prime:null,p:"A9FB57DB A1EEA9BC 3E660A90 9D838D72 6E3BF623 D5262028 2013481D 1F6E5377",a:"7D5A0975 FC2C3057 EEF67530 417AFFE7 FB8055C1 26DC5C6C E94A4B44 F330B5D9",b:"26DC5C6C E94A4B44 F330B5D9 BBD77CBF 95841629 5CF7E1CE 6BCCDC18 FF8C07B6",n:"A9FB57DB A1EEA9BC 3E660A90 9D838D71 8C397AA3 B561A6F7 901E0E82 974856A7",hash:Oe.sha256,gRed:!1,g:["8BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262","547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997"]}),s("brainpoolP384r1",{type:"short",prime:null,p:"8CB91E82 A3386D28 0F5D6F7E 50E641DF 152F7109 ED5456B4 12B1DA19 7FB71123ACD3A729 901D1A71 87470013 3107EC53",a:"7BC382C6 3D8C150C 3C72080A CE05AFA0 C2BEA28E 4FB22787 139165EF BA91F90F8AA5814A 503AD4EB 04A8C7DD 22CE2826",b:"04A8C7DD 22CE2826 8B39B554 16F0447C 2FB77DE1 07DCD2A6 2E880EA5 3EEB62D57CB43902 95DBC994 3AB78696 FA504C11",n:"8CB91E82 A3386D28 0F5D6F7E 50E641DF 152F7109 ED5456B3 1F166E6C AC0425A7CF3AB6AF 6B7FC310 3B883202 E9046565",hash:Oe.sha384,gRed:!1,g:["1D1C64F068CF45FFA2A63A81B7C13F6B8847A3E77EF14FE3DB7FCAFE0CBD10E8E826E03436D646AAEF87B2E247D4AF1E","8ABE1D7520F9C2A45CB1EB8E95CFD55262B70B29FEEC5864E19C054FF99129280E4646217791811142820341263C5315"]}),s("brainpoolP512r1",{type:"short",prime:null,p:"AADD9DB8 DBE9C48B 3FD4E6AE 33C9FC07 CB308DB3 B3C9D20E D6639CCA 703308717D4D9B00 9BC66842 AECDA12A E6A380E6 2881FF2F 2D82C685 28AA6056 583A48F3",a:"7830A331 8B603B89 E2327145 AC234CC5 94CBDD8D 3DF91610 A83441CA EA9863BC2DED5D5A A8253AA1 0A2EF1C9 8B9AC8B5 7F1117A7 2BF2C7B9 E7C1AC4D 77FC94CA",b:"3DF91610 A83441CA EA9863BC 2DED5D5A A8253AA1 0A2EF1C9 8B9AC8B5 7F1117A72BF2C7B9 E7C1AC4D 77FC94CA DC083E67 984050B7 5EBAE5DD 2809BD63 8016F723",n:"AADD9DB8 DBE9C48B 3FD4E6AE 33C9FC07 CB308DB3 B3C9D20E D6639CCA 70330870553E5C41 4CA92619 41866119 7FAC1047 1DB1D381 085DDADD B5879682 9CA90069",hash:Oe.sha512,gRed:!1,g:["81AEE4BDD82ED9645A21322E9C4C6A9385ED9F70B5D916C1B43B62EEF4D0098EFF3B1F78E2D0D48D50D1687B93B97D5F7C6D5047406A5E688B352209BCB9F822","7DDE385D566332ECC0EABFA9CF7822FDF209F70024A57B1AA000C55B881F8111B2DCDE494A5F485E5BCA4BD88A2763AED1CA2B2FA8F0540678CD1E0F3AD80892"]});try{r=Td}catch{r=void 0}s("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Oe.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",r]})});function bi(e){if(!(this instanceof bi))return new bi(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=Je.toArray(e.entropy,e.entropyEnc||"hex"),r=Je.toArray(e.nonce,e.nonceEnc||"hex"),i=Je.toArray(e.pers,e.persEnc||"hex");xi(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,r,i)}var b0=bi;bi.prototype._init=function(e,t,r){var i=e.concat(t).concat(r);this.K=Array(this.outLen/8),this.V=Array(this.outLen/8);for(var n=0;n<this.V.length;n++)this.K[n]=0,this.V[n]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656},bi.prototype._hmac=function(){return new Oe.hmac(this.hash,this.K)},bi.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},bi.prototype.reseed=function(e,t,r,i){typeof t!="string"&&(i=r,r=t,t=null),e=Je.toArray(e,t),r=Je.toArray(r,i),xi(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(r||[])),this._reseed=1},bi.prototype.generate=function(e,t,r,i){if(this._reseed>this.reseedInterval)throw Error("Reseed is required");typeof t!="string"&&(i=r,r=t,t=null),r&&(r=Je.toArray(r,i||"hex"),this._update(r));for(var n=[];n.length<e;)this.V=this._hmac().update(this.V).digest(),n=n.concat(this.V);var a=n.slice(0,e);return this._update(r),this._reseed++,Je.encode(a,t)};var D2=Yt.assert;function Ae(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}var Bo=Ae;Ae.fromPublic=function(e,t,r){return t instanceof Ae?t:new Ae(e,{pub:t,pubEnc:r})},Ae.fromPrivate=function(e,t,r){return t instanceof Ae?t:new Ae(e,{priv:t,privEnc:r})},Ae.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},Ae.prototype.getPublic=function(e,t){return this.pub||(this.pub=this.ec.g.mul(this.priv)),e?this.pub.encode(e,t):this.pub},Ae.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv},Ae.prototype._importPrivate=function(e,t){if(this.priv=new kt(e,t||16),this.ec.curve.type==="mont"){var r=this.ec.curve.one,i=r.ushln(252).sub(r).ushln(3);this.priv=this.priv.or(r.ushln(254)),this.priv=this.priv.and(i)}else this.priv=this.priv.umod(this.ec.curve.n)},Ae.prototype._importPublic=function(e,t){if(e.x||e.y)return this.ec.curve.type==="mont"?D2(e.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||D2(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},Ae.prototype.derive=function(e){return e.mul(this.priv).getX()},Ae.prototype.sign=function(e,t,r){return this.ec.sign(e,this,t,r)},Ae.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},Ae.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var zd=Yt.assert;function zs(e,t){if(e instanceof zs)return e;this._importDER(e,t)||(zd(e.r&&e.s,"Signature without r or s"),this.r=new kt(e.r,16),this.s=new kt(e.s,16),e.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}var Ha=zs;function qd(){this.place=0}function To(e,t){var r=e[t.place++];if(!(128&r))return r;for(var i=15&r,n=0,a=0,s=t.place;a<i;a++,s++)n<<=8,n|=e[s];return t.place=s,n}function K2(e){for(var t=0,r=e.length-1;!e[t]&&!(128&e[t+1])&&t<r;)t++;return t===0?e:e.slice(t)}function zo(e,t){if(t<128)e.push(t);else{var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|r);--r;)e.push(t>>>(r<<3)&255);e.push(t)}}zs.prototype._importDER=function(e,t){e=Yt.toArray(e,t);var r=new qd;if(e[r.place++]!==48||To(e,r)+r.place!==e.length||e[r.place++]!==2)return!1;var i=To(e,r),n=e.slice(r.place,i+r.place);if(r.place+=i,e[r.place++]!==2)return!1;var a=To(e,r);if(e.length!==a+r.place)return!1;var s=e.slice(r.place,a+r.place);return n[0]===0&&128&n[1]&&(n=n.slice(1)),s[0]===0&&128&s[1]&&(s=s.slice(1)),this.r=new kt(n),this.s=new kt(s),this.recoveryParam=null,!0},zs.prototype.toDER=function(e){var t=this.r.toArray(),r=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&r[0]&&(r=[0].concat(r)),t=K2(t),r=K2(r);!(r[0]||128&r[1]);)r=r.slice(1);var i=[2];zo(i,t.length),(i=i.concat(t)).push(2),zo(i,r.length);var n=i.concat(r),a=[48];return zo(a,n.length),a=a.concat(n),Yt.encode(a,e)};var O3=Yt.assert;function Be(e){if(!(this instanceof Be))return new Be(e);typeof e=="string"&&(O3(aa.hasOwnProperty(e),"Unknown curve "+e),e=aa[e]),e instanceof aa.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}var Fd=Be;Be.prototype.keyPair=function(e){return new Bo(this,e)},Be.prototype.keyFromPrivate=function(e,t){return Bo.fromPrivate(this,e,t)},Be.prototype.keyFromPublic=function(e,t){return Bo.fromPublic(this,e,t)},Be.prototype.genKeyPair=function(e){e||(e={});var t=new b0({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||ao(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()});if(this.curve.type==="mont"){var r=new kt(t.generate(32));return this.keyFromPrivate(r)}for(var i=this.n.byteLength(),n=this.n.sub(new kt(2));;)if(!((r=new kt(t.generate(i))).cmp(n)>0))return r.iaddn(1),this.keyFromPrivate(r)},Be.prototype._truncateToN=function(e,t,r){var i=(r=r||8*e.byteLength())-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},Be.prototype.truncateMsg=function(e){var t;return e instanceof Uint8Array?(t=8*e.byteLength,e=this._truncateToN(new kt(e,16),!1,t)):typeof e=="string"?(t=4*e.length,e=this._truncateToN(new kt(e,16),!1,t)):e=this._truncateToN(new kt(e,16)),e},Be.prototype.sign=function(e,t,r,i){typeof r=="object"&&(i=r,r=null),i||(i={}),t=this.keyFromPrivate(t,r),e=this.truncateMsg(e);for(var n=this.n.byteLength(),a=t.getPrivate().toArray("be",n),s=e.toArray("be",n),o=new b0({hash:this.hash,entropy:a,nonce:s,pers:i.pers,persEnc:i.persEnc||"utf8"}),u=this.n.sub(new kt(1)),c=0;;c++){var h=i.k?i.k(c):new kt(o.generate(this.n.byteLength()));if(!((h=this._truncateToN(h,!0)).cmpn(1)<=0||h.cmp(u)>=0)){var f=this.g.mul(h);if(!f.isInfinity()){var m=f.getX(),y=m.umod(this.n);if(y.cmpn(0)!==0){var K=h.invm(this.n).mul(y.mul(t.getPrivate()).iadd(e));if((K=K.umod(this.n)).cmpn(0)!==0){var I=(f.getY().isOdd()?1:0)|(m.cmp(y)!==0?2:0);return i.canonical&&K.cmp(this.nh)>0&&(K=this.n.sub(K),I^=1),new Ha({r:y,s:K,recoveryParam:I})}}}}}},Be.prototype.verify=function(e,t,r,i){return r=this.keyFromPublic(r,i),t=new Ha(t,"hex"),this._verify(this.truncateMsg(e),t,r)||this._verify(this._truncateToN(new kt(e,16)),t,r)},Be.prototype._verify=function(e,t,r){var i=t.r,n=t.s;if(i.cmpn(1)<0||i.cmp(this.n)>=0||n.cmpn(1)<0||n.cmp(this.n)>=0)return!1;var a,s=n.invm(this.n),o=s.mul(e).umod(this.n),u=s.mul(i).umod(this.n);return this.curve._maxwellTrick?!(a=this.g.jmulAdd(o,r.getPublic(),u)).isInfinity()&&a.eqXToP(i):!(a=this.g.mulAdd(o,r.getPublic(),u)).isInfinity()&&a.getX().umod(this.n).cmp(i)===0},Be.prototype.recoverPubKey=function(e,t,r,i){O3((3&r)===r,"The recovery param is more than two bits"),t=new Ha(t,i);var n=this.n,a=new kt(e),s=t.r,o=t.s,u=1&r,c=r>>1;if(s.cmp(this.curve.p.umod(this.curve.n))>=0&&c)throw Error("Unable to find sencond key candinate");s=c?this.curve.pointFromX(s.add(this.curve.n),u):this.curve.pointFromX(s,u);var h=t.r.invm(n),f=n.sub(a).mul(h).umod(n),m=o.mul(h).umod(n);return this.g.mulAdd(f,s,m)},Be.prototype.getKeyRecoveryParam=function(e,t,r,i){if((t=new Ha(t,i)).recoveryParam!==null)return t.recoveryParam;for(var n=0;n<4;n++){var a;try{a=this.recoverPubKey(e,t,n)}catch{continue}if(a.eq(r))return n}throw Error("Unable to find valid recovery factor")};var R2=Yt.assert,I2=Yt.parseBytes,nn=Yt.cachedProperty;function de(e,t){if(this.eddsa=e,t.hasOwnProperty("secret")&&(this._secret=I2(t.secret)),e.isPoint(t.pub))this._pub=t.pub;else if(this._pubBytes=I2(t.pub),this._pubBytes&&this._pubBytes.length===33&&this._pubBytes[0]===64&&(this._pubBytes=this._pubBytes.slice(1,33)),this._pubBytes&&this._pubBytes.length!==32)throw Error("Unknown point compression format")}de.fromPublic=function(e,t){return t instanceof de?t:new de(e,{pub:t})},de.fromSecret=function(e,t){return t instanceof de?t:new de(e,{secret:t})},de.prototype.secret=function(){return this._secret},nn(de,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),nn(de,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),nn(de,"privBytes",function(){var e=this.eddsa,t=this.hash(),r=e.encodingLength-1,i=t.slice(0,e.encodingLength);return i[0]&=248,i[r]&=127,i[r]|=64,i}),nn(de,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),nn(de,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),nn(de,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),de.prototype.sign=function(e){return R2(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},de.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},de.prototype.getSecret=function(e){return R2(this._secret,"KeyPair is public only"),Yt.encode(this.secret(),e)},de.prototype.getPublic=function(e,t){return Yt.encode((t?[64]:[]).concat(this.pubBytes()),e)};var qo=de,Od=Yt.assert,Ga=Yt.cachedProperty,Nd=Yt.parseBytes;function qi(e,t){this.eddsa=e,typeof t!="object"&&(t=Nd(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),Od(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof kt&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}Ga(qi,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),Ga(qi,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),Ga(qi,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),Ga(qi,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),qi.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},qi.prototype.toHex=function(){return Yt.encode(this.toBytes(),"hex").toUpperCase()};var U2=qi,Ld=Yt.assert,B2=Yt.parseBytes;function Ee(e){if(Ld(e==="ed25519","only tested with ed25519 so far"),!(this instanceof Ee))return new Ee(e);e=aa[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=Oe.sha512}var jd=Ee;Ee.prototype.sign=function(e,t){e=B2(e);var r=this.keyFromSecret(t),i=this.hashInt(r.messagePrefix(),e),n=this.g.mul(i),a=this.encodePoint(n),s=this.hashInt(a,r.pubBytes(),e).mul(r.priv()),o=i.add(s).umod(this.curve.n);return this.makeSignature({R:n,S:o,Rencoded:a})},Ee.prototype.verify=function(e,t,r){e=B2(e),t=this.makeSignature(t);var i=this.keyFromPublic(r),n=this.hashInt(t.Rencoded(),i.pubBytes(),e),a=this.g.mul(t.S());return t.R().add(i.pub().mul(n)).eq(a)},Ee.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return Yt.intFromLE(e.digest()).umod(this.curve.n)},Ee.prototype.keyPair=function(e){return new qo(this,e)},Ee.prototype.keyFromPublic=function(e){return qo.fromPublic(this,e)},Ee.prototype.keyFromSecret=function(e){return qo.fromSecret(this,e)},Ee.prototype.genKeyPair=function(e){e||(e={});var t=new b0({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||ao(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.curve.n.toArray()});return this.keyFromSecret(t.generate(32))},Ee.prototype.makeSignature=function(e){return e instanceof U2?e:new U2(this,e)},Ee.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},Ee.prototype.decodePoint=function(e){var t=(e=Yt.parseBytes(e)).length-1,r=e.slice(0,t).concat(-129&e[t]),i=(128&e[t])!=0,n=Yt.intFromLE(r);return this.curve.pointFromY(n,i)},Ee.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},Ee.prototype.decodeInt=function(e){return Yt.intFromLE(e)},Ee.prototype.isPoint=function(e){return e instanceof this.pointClass};var T2=Br(function(e,t){var r=t;r.utils=Yt,r.rand=ao,r.curve=es,r.curves=aa,r.ec=Fd,r.eddsa=jd}),Wd=Object.freeze({__proto__:null,default:T2,__moduleExports:T2});export{tf as A,Hd as J,Qd as _,Gd as e,Yd as g,$d as h,Jd as k,Vd as u,Xd as v,Zd as y};
